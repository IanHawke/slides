<!doctype html>
<html lang="en">
    <head>
        
            <meta charset="utf-8">
            <meta name="robots" content="noindex">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <meta name="author" content="Ian Hawke" />
            <meta name="date" content="2022-03-23" />
        

        <title>Simplex Method | Operational Research and Mathematical Computing</title>

        
    
    
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../static/styles.css">
            <link rel="stylesheet" id="customiseCSS" href="../../static/light.css">
            
            
        
    <link rel="stylesheet" id="customiseCodeCSS" href="../../static/pygmentize.light.css">
    <link rel="stylesheet" href="../../static/codemirror-5.26.0/lib/codemirror.css">
    <link rel="stylesheet" href="../../static/boole.css">
    <link rel="stylesheet" href="../../static/numbasEmbed.css">

    <link rel="stylesheet" href="../../static/bootstrap-toc.css?v=3">
    <link rel="stylesheet" href="../../static/print.css">


        
    
    
            <script defer src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
            <script defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
            <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
            <script defer src="../../static/mathjax_config.js"></script>
            <script type="text/javascript" id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
            <script defer src="../../static/customisation.js"></script>
            <script defer src="../../static/mp4.js"></script>
            
            
        
    <script defer src="../../static/jquery.flexibleArea.js"></script>
    <script defer src="../../static/spin.min.js"></script>
    <script defer src="../../static/codemirror-5.26.0/lib/codemirror.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/octave/octave.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/python/python.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/r/r.js"></script>
    <script defer src="../../static/boole.js"></script>
    <script defer src="../../static/numbasEmbed.js"></script>

    <script defer src="../../static/bootstrap-toc.js"></script>

    </head>
    <body data-spy="scroll" data-target="#chapterTOC" data-offset="50">
        
<div class="collapse" id="navbarToggleCustomise">
	<div class="bg-secondary text-white p-3">
		<form onsubmit="return false;" id="navbarCustomise">
			<div class="form-row">
				<label>Theme Customisation</label>
				<div id="themeSelector" class="form-group col-md-12">
					<button class="btn btn-dark mr-2" value="dark">Dark</button>
					<button class="btn btn-pastel mr-2" value="pastel">Pastel</button>
					<button class="btn btn-light mr-4" value="light">Light</button>
				</div>
			</div>
			<div class="form-row">
				<div class="form-group col-md-4">
					<label style="display: block" for="font-scale">Font size (<span id="font-size-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="font-scale" min="50" max="600" value="100">
					<button id="font-scale-reset" class="btn btn-sm">Reset</button>
				</div>
				<div class="form-group col-md-4">
					<label style="display: block" for="p-space">Spacing (<span id="p-space-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="p-space" min="0" max="600" value="100">
					<button id="p-space-reset" class="btn btn-sm">Reset</button>
				</div>
			</div>
		</form>
	</div>
</div>

<nav aria-label="breadcrumb">
	<ul class="breadcrumb">
		<li class="breadcrumb-item">
			<a href="../../index.html">Operational Research and Mathematical Computing</a>
		</li>
		
		<li class="breadcrumb-item">
			<a href="../../codes/index.html">Codes</a>
		</li>
		
		<li class="breadcrumb-item active">
			Simplex Method
		</li>
		<li class="ml-auto">
			<button class="navbar-toggler p0" type="button" data-toggle="collapse" data-target="#navbarToggleCustomise" aria-controls="navbarToggleCustomise" aria-expanded="false" aria-label="Toggle customisations panel">
				<i class="fa fa-cog" aria-hidden="true" title="Toggle customisations panel"></i> <span class="sr-only">Toggle customisations panel</span>
			</button>
		</li>
	</ul>
</nav>


        <header>
            
            
        </header>
        <main>
            
    <div class="container mt-3">
        <div class="row">
            
            <div id="sidebar" class="col-md-3">
                <nav class="mb-3" id="chapterTOC" data-toggle="toc">
                    <ul class="nav navbar-nav">
                        
                        
                        <li><a id="notebook-link" class="nav-link" href="../../codes/simplex_method_1/simplex_method_1.ipynb" download><i class="fa fa-book" aria-hidden="true" title="Download Notebook"></i>&nbsp;Download Notebook</a></li>
                        
                        
                        <li><a id="pdf-link" class="nav-link" href="../../codes/simplex_method_1/simplex_method_1.pdf" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true" title="Download as PDF"></i>&nbsp;Download as PDF</a></li>
                        
                    </ul>
                </nav>
            </div>
            <div id="content" class="col-md-9"> 
            
            <section class="section1"><h1>Simplex Method</h1>
<p>This will be the single-phase simplex method, assuming that the tableau is given in basic form.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pulp</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">tqdm</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_pivot_bland</span><span class="p">(</span><span class="n">tableau</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Using Bland's rule and the minimum ratio test, find the pivot entry in the tableau.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tableau : array</span>
<span class="sd">        The simplex method tableau in basic form</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    r, s : integer</span>
<span class="sd">        Row and column indexes of the pivot</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Assumes that there is a negative reduced cost that we can pivot on.</span>
<span class="sd">    """</span>
    <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">tableau</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Number of constraints</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Number of variables</span>
    <span class="c1"># Bland's rule: find first negative reduced cost</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1"># Minimum ratio test plus Bland's rule:</span>
    <span class="c1"># find the (first) row i minimizing b_i / a_{is}, a_{is} &gt; 0</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">theta_star</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">theta_star</span><span class="p">:</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">theta_star</span> <span class="o">=</span> <span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">tableau</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simplex</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">pivot_rule</span><span class="o">=</span><span class="n">find_pivot_bland</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Perform the single phase simplex method, assuming the tableau is in basic form.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tableau : array</span>
<span class="sd">        The simplex method tableau in basic form</span>
<span class="sd">    basis : array</span>
<span class="sd">        The list of indexes (in order) forming the basic set</span>
<span class="sd">    pivot_rule : function</span>
<span class="sd">        Given a tableau, returns the pivot index pair</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    soln : dict</span>
<span class="sd">        The solution dictionary with result, objective value, and solution.</span>
<span class="sd">    """</span>
    <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">tableau</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Number of constraints</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Number of variables</span>
    <span class="n">soln</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'result'</span> <span class="p">:</span> <span class="s1">'infeasible'</span><span class="p">,</span>
        <span class="s1">'objective'</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
        <span class="s1">'solution'</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,)),</span>
        <span class="s1">'basis'</span> <span class="p">:</span> <span class="n">basis</span>
    <span class="p">}</span>
    <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">pivot_rule</span><span class="p">(</span><span class="n">tableau</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># No suitable pivot: unbounded</span>
            <span class="n">soln</span><span class="p">[</span><span class="s1">'result'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'unbounded'</span>
            <span class="k">return</span> <span class="n">soln</span>
        <span class="c1"># Pivot</span>
        <span class="n">tableau</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">tableau</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/</span> <span class="n">tableau</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">r</span> <span class="o">!=</span> <span class="n">row</span><span class="p">:</span>
                <span class="n">tableau</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">tableau</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">tableau</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">tableau</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">basis</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>  <span class="c1"># minus 1 &lt;-&gt; costs row</span>
    <span class="c1"># All reduced costs non-negative: optimal solution found</span>
    <span class="n">soln</span><span class="p">[</span><span class="s1">'result'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'optimal'</span>
    <span class="n">soln</span><span class="p">[</span><span class="s1">'objective'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">soln</span><span class="p">[</span><span class="s1">'solution'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">soln</span><span class="p">[</span><span class="s1">'basis'</span><span class="p">]</span> <span class="o">=</span> <span class="n">basis</span>
    <span class="k">return</span> <span class="n">soln</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="c1"># Optimal portfolio</span>
<span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span>   <span class="p">,</span> <span class="mi">1</span>    <span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span>   <span class="p">,</span> <span class="mi">0</span>    <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span>   <span class="p">,</span> <span class="mi">1</span>    <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">simplex</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
<div class="highlight"><pre><span></span>{'result': 'optimal',
 'objective': -0.25,
 'solution': array([5., 5., 2.]),
 'basis': array([2, 1, 4])}
</pre></div>
<div class="highlight"><pre><span></span><span class="c1"># Version for SC's lecture</span>
<span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span> <span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">simplex</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
<div class="highlight"><pre><span></span>{'result': 'optimal',
 'objective': -6.0,
 'solution': array([ 6., 18.]),
 'basis': array([2, 4])}
</pre></div>
</section><section class="section1"><h1>Constructing a random LP in basic form</h1>
<div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># print(tableau)</span>
<span class="c1"># print(basis)</span>
<span class="n">tableau_initial</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">tableau</span><span class="p">)</span>
<span class="n">soln</span> <span class="o">=</span> <span class="n">simplex</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compare_simplex_pulp</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">pivot_rule</span><span class="o">=</span><span class="n">find_pivot_bland</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Compare the solution from the hand-coded method to that from PuLP.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tableau : array</span>
<span class="sd">        The simplex method tableau in basic form</span>
<span class="sd">    basis : array</span>
<span class="sd">        The list of indexes (in order) forming the basic set</span>
<span class="sd">    pivot_rule : function</span>
<span class="sd">        Given a tableau, returns the pivot index pair</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    correct : boolean</span>
<span class="sd">        True if the solutions match</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Current version of the code ignores the basis, assumes basis</span>
<span class="sd">    variables are the final m variables.</span>
<span class="sd">    """</span>
    <span class="n">M</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="n">tableau</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Number of constraints</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span>  <span class="c1"># Number of variables</span>
    <span class="c1"># Find solution from PuLP</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpProblem</span><span class="p">(</span><span class="s2">"Random_compare"</span><span class="p">,</span> <span class="n">pulp</span><span class="o">.</span><span class="n">LpMinimize</span><span class="p">)</span>
    <span class="nb">vars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">vars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pulp</span><span class="o">.</span><span class="n">LpVariable</span><span class="p">(</span><span class="sa">f</span><span class="s1">'x</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">objective</span> <span class="o">=</span> <span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">objective</span> <span class="o">+=</span> <span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">prob</span> <span class="o">+=</span> <span class="n">objective</span><span class="p">,</span> <span class="s2">"objective"</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">constraint</span> <span class="o">=</span> <span class="n">tableau</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">constraint</span> <span class="o">+=</span> <span class="n">tableau</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">prob</span> <span class="o">+=</span> <span class="n">constraint</span> <span class="o">==</span> <span class="n">tableau</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="sa">f</span><span class="s2">"constraint </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">pulp</span><span class="o">.</span><span class="n">COIN_CMD</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="c1"># Find solution using hand-coded simplex</span>
    <span class="n">soln</span> <span class="o">=</span> <span class="n">simplex</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">pivot_rule</span><span class="o">=</span><span class="n">find_pivot_bland</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">soln</span><span class="p">[</span><span class="s1">'result'</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'optimal'</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Result is '</span><span class="p">,</span> <span class="n">soln</span><span class="p">[</span><span class="s1">'result'</span><span class="p">])</span>
    <span class="c1"># Do comparison</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="n">correct</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">soln</span><span class="p">[</span><span class="s1">'objective'</span><span class="p">],</span> <span class="n">pulp</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">objective</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">xb</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">soln</span><span class="p">[</span><span class="s1">'solution'</span><span class="p">],</span> <span class="n">soln</span><span class="p">[</span><span class="s1">'basis'</span><span class="p">]):</span>
        <span class="n">correct</span> <span class="o">=</span> <span class="n">correct</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">xb</span><span class="p">,</span> <span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">varValue</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">correct</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compare_simplex_pulp</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">))</span>
</pre></div>
<div class="highlight"><pre><span></span>True
</pre></div>
<div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">compare_simplex_pulp</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">))</span>
</pre></div>
<div class="highlight"><pre><span></span>True
</pre></div>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">compare_simplex_pulp</span><span class="p">(</span><span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span><span class="p">))</span>
</pre></div>
<div class="highlight"><pre><span></span>3 3 True
7 7 True
7 11 True
11 11 True
11 15 True
11 19 True
15 15 True
15 19 True
15 23 True
15 27 True
19 19 True
19 23 True
19 27 True
19 31 True
19 35 True
23 23 True
23 27 True
23 31 True
23 35 True
23 39 True
23 43 True
27 27 True
27 31 True
27 35 True
27 39 True
27 43 True
27 47 True
27 51 True
31 31 True
31 35 True
31 39 True
31 43 True
31 47 True
31 51 True
31 55 True
31 59 True
35 35 True
35 39 True
35 43 True
35 47 True
35 51 True
35 55 True
35 59 True
35 63 True
35 67 True
39 39 True
39 43 True
39 47 True
39 51 True
39 55 True
39 59 True
39 63 True
39 67 True
39 71 True
39 75 True
</pre></div>
</section><section class="section1"><h1>Timing figure as used in lectures</h1>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">tableau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">tableau</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">tableau</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tableau</span><span class="p">,</span> <span class="n">basis</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="n">student_id</span> <span class="o">=</span> <span class="mi">12345678</span>
<span class="n">ms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">15</span><span class="p">,</span>  <span class="mi">18</span><span class="p">,</span>  <span class="mi">22</span><span class="p">,</span>  <span class="mi">26</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span>  <span class="mi">38</span><span class="p">,</span>  <span class="mi">46</span><span class="p">,</span>  <span class="mi">55</span><span class="p">,</span>  <span class="mi">66</span><span class="p">,</span>  <span class="mi">79</span><span class="p">,</span>  <span class="mi">95</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">284</span><span class="p">,</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span> <span class="mi">492</span><span class="p">,</span> <span class="mi">590</span><span class="p">,</span> <span class="mi">708</span><span class="p">,</span> <span class="mi">850</span><span class="p">,</span> <span class="mi">1021</span><span class="p">,</span> <span class="mi">1225</span><span class="p">])</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">n_instances</span> <span class="o">=</span><span class="mi">50</span>
<span class="n">times_max_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">times_ave_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">ms</span><span class="p">)):</span>
    <span class="n">times_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_instances</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_instances</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">student_id</span><span class="p">)</span>
        <span class="n">times_ss</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s2">"simplex(tableau, basis, pivot_rule=find_pivot_bland)"</span><span class="p">,</span>
                                   <span class="n">setup</span><span class="o">=</span><span class="sa">f</span><span class="s2">"tableau, basis = setup(</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">)"</span><span class="p">,</span>
                                   <span class="nb">globals</span><span class="o">=</span><span class="nb">globals</span><span class="p">(),</span>
                                   <span class="n">number</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">times_max_ss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">times_ss</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">times_ave_ss</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">times_ss</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
<div class="highlight"><pre><span></span>100%|██████████████████████████████████████████████████████████████████████████████████████████| 27/27 [00:14&lt;00:00,  1.89it/s]
</pre></div>
<div class="highlight"><pre><span></span><span class="n">textsize</span><span class="o">=</span><span class="mi">16</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">'font.size'</span><span class="p">:</span> <span class="n">textsize</span><span class="p">})</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">axis</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">times_ave_ss</span><span class="p">,</span> <span class="s1">'kx'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">mew</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Simplex'</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ms</span><span class="p">[</span><span class="mi">4</span><span class="p">:]),</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">times_ave_ss</span><span class="p">[</span><span class="mi">4</span><span class="p">:]),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">ms</span><span class="o">**</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">'b--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">"$m^</span><span class="se">{{</span><span class="si">{</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="se">}}</span><span class="si">}</span><span class="s2">$"</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$m$"</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Average time [ms]"</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$n=30$ fixed"</span><span class="p">)</span>
<span class="n">axis</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
<figure class="figure1" data-title="png"><img alt="png" src="images/Simplex_16_0.png"/></figure></section>
            </div>
        </div>
    </div>

        </main>
		
		<footer class="text-muted">
	<hr>
	<div class="container">
		<div class="float-right">
			<ul style="list-style: none">
			<li><a href="#">Back to top</a></li>
			
			
			<li><a href="../../codes/simplex_method_1/simplex_method_1.pdf" target="_blank"><i class="fa fa-file-pdf-o"></i>&nbsp;Download as PDF</a></li>
			
			</ul>
		</div>
		<p>Generated using <a target="_blank" href="https://github.com/chirun-ncl/chirun">Chirun</a>, written by the E-Learning Unit, School of Mathematics &amp; Statistics, Newcastle University</p>
		<p>This page last generated: 2022-03-23</p>
	</div>
</footer>
		
    </body>
</html>
