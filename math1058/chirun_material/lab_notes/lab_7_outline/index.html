<!doctype html>
<html lang="en">
    <head>
        
            <meta charset="utf-8">
            <meta name="robots" content="noindex">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <meta name="author" content="Ian Hawke" />
            <meta name="date" content="2022-03-08" />
        

        <title>Lab 7 outline | Operational Research and Mathematical Computing</title>

        
    
    
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../static/styles.css">
            <link rel="stylesheet" id="customiseCSS" href="../../static/light.css">
            
            
        
    <link rel="stylesheet" id="customiseCodeCSS" href="../../static/pygmentize.light.css">
    <link rel="stylesheet" href="../../static/codemirror-5.26.0/lib/codemirror.css">
    <link rel="stylesheet" href="../../static/boole.css">
    <link rel="stylesheet" href="../../static/numbasEmbed.css">

    <link rel="stylesheet" href="../../static/bootstrap-toc.css?v=3">
    <link rel="stylesheet" href="../../static/print.css">


        
    
    
            <script defer src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
            <script defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
            <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
            <script defer src="../../static/mathjax_config.js"></script>
            <script type="text/javascript" id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
            <script defer src="../../static/customisation.js"></script>
            <script defer src="../../static/mp4.js"></script>
            
            
        
    <script defer src="../../static/jquery.flexibleArea.js"></script>
    <script defer src="../../static/spin.min.js"></script>
    <script defer src="../../static/codemirror-5.26.0/lib/codemirror.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/octave/octave.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/python/python.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/r/r.js"></script>
    <script defer src="../../static/boole.js"></script>
    <script defer src="../../static/numbasEmbed.js"></script>

    <script defer src="../../static/bootstrap-toc.js"></script>

    </head>
    <body data-spy="scroll" data-target="#chapterTOC" data-offset="50">
        
<div class="collapse" id="navbarToggleCustomise">
	<div class="bg-secondary text-white p-3">
		<form onsubmit="return false;" id="navbarCustomise">
			<div class="form-row">
				<label>Theme Customisation</label>
				<div id="themeSelector" class="form-group col-md-12">
					<button class="btn btn-dark mr-2" value="dark">Dark</button>
					<button class="btn btn-pastel mr-2" value="pastel">Pastel</button>
					<button class="btn btn-light mr-4" value="light">Light</button>
				</div>
			</div>
			<div class="form-row">
				<div class="form-group col-md-4">
					<label style="display: block" for="font-scale">Font size (<span id="font-size-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="font-scale" min="50" max="600" value="100">
					<button id="font-scale-reset" class="btn btn-sm">Reset</button>
				</div>
				<div class="form-group col-md-4">
					<label style="display: block" for="p-space">Spacing (<span id="p-space-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="p-space" min="0" max="600" value="100">
					<button id="p-space-reset" class="btn btn-sm">Reset</button>
				</div>
			</div>
		</form>
	</div>
</div>

<nav aria-label="breadcrumb">
	<ul class="breadcrumb">
		<li class="breadcrumb-item">
			<a href="../../index.html">Operational Research and Mathematical Computing</a>
		</li>
		
		<li class="breadcrumb-item">
			<a href="../../lab_notes/index.html">Lab notes</a>
		</li>
		
		<li class="breadcrumb-item active">
			Lab 7 outline
		</li>
		<li class="ml-auto">
			<button class="navbar-toggler p0" type="button" data-toggle="collapse" data-target="#navbarToggleCustomise" aria-controls="navbarToggleCustomise" aria-expanded="false" aria-label="Toggle customisations panel">
				<i class="fa fa-cog" aria-hidden="true" title="Toggle customisations panel"></i> <span class="sr-only">Toggle customisations panel</span>
			</button>
		</li>
	</ul>
</nav>


        <header>
            
            
        </header>
        <main>
            
    <div class="container mt-3">
        <div class="row">
            
            <div id="sidebar" class="col-md-3">
                <nav class="mb-3" id="chapterTOC" data-toggle="toc">
                    <ul class="nav navbar-nav">
                        
                        
                        <li><a id="notebook-link" class="nav-link" href="../../lab_notes/lab_7_outline/lab_7_outline.ipynb" download><i class="fa fa-book" aria-hidden="true" title="Download Notebook"></i>&nbsp;Download Notebook</a></li>
                        
                        
                        <li><a id="pdf-link" class="nav-link" href="../../lab_notes/lab_7_outline/lab_7_outline.pdf" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true" title="Download as PDF"></i>&nbsp;Download as PDF</a></li>
                        
                    </ul>
                </nav>
            </div>
            <div id="content" class="col-md-9"> 
            
            <section class="section1"><h1>Week 7</h1>
<p>We have introduced Python. Now we need to discuss Excel.</p>
<section class="section2"><h2>Script</h2>
<section class="section3"><h3><code>Excel</code></h3>
<p>Excel, and spreadsheets in general, are a widely used and understood tool. Its strength is that nearly everyone has it available, and it is fast to do basic tasks with.  It's very useful for</p>
<ul>
<li>Distributing data</li>
<li>Performing quick analysis</li>
<li>Communicating general results rapidly to a broad audience</li>
</ul>
<p>However, there are major issues with using spreadsheets. One weakness is that it is easy to make mistakes with spreadsheets and particularly with Excel. Amongst the many examples, the <a href="https://en.wikipedia.org/wiki/Growth_in_a_Time_of_Debt">Reinhart-Rogoff</a> paper on sovereign debt <a href="https://www.bloomberg.com/news/articles/2013-04-18/faq-reinhart-rogoff-and-the-excel-error-that-changed-history">accidentally excluded five rows</a> from a calculation of an average, which qualitatively changed their results. It has been claimed that political austerity measures were strongly motivated by this paper, which in part relies on a spreadsheet error.</p>
<p>We need to talk about reliable methods for getting data into, and out of, spreadsheets. We also need to talk about data organization principles: how to make it easy for others to re-use your data. Finally, we need to look at the standard Excel mathematical functions for data analysis.</p>
<p>One advantage of Python over Excel is that, as a full-featured programming language, it can be more easily used for long and complex tasks. The disadvantage is that many people may be interested in the results, but not interested in (or have the knowledge of) the programming details required to follow the Python code. To communicate the results whilst still showing those interested the full data, it's useful to <em>programmatically</em> take results from Python into a spreadsheet.</p>
<p>For now we will use toy data. As an example,</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
<p>We now want to create an Excel spreadsheet that contains this data. Working with larger datasets will follow similarly. For this we will use the <code>openpyxl</code> library.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openpyxl</span>
</pre></div>
<p>We first create an Excel workbook, purely within Python.</p>
<div class="highlight"><pre><span></span><span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">Workbook</span><span class="p">()</span>
</pre></div>
<p>We will then create a worksheet within the workbook. One already exists, but we will create a new worksheet with a name.</p>
<div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">"Data"</span><span class="p">)</span>
</pre></div>
<p>We will then add titles in the first row, indicating what the data is going to be. These will be strings.</p>
<div class="highlight"><pre><span></span><span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">"x"</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">"sin(x)"</span><span class="p">)</span>
</pre></div>
<p>We will now add the actual data. Think carefully about how the loop indexes work here.</p>
<div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
   <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
   <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
<p>Finally, we will save the workbook.</p>
<div class="highlight"><pre><span></span><span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">'example.xlsx'</span><span class="p">)</span>
</pre></div>
<p>We can now open this workbook and check. You should see two sheets within the workbook. The first is blank; the second contains the data from Python.</p>
<section class="section4"><h4>Exercise</h4>
<p>Add more columns to the workbook, plotting different functions such as <script type="math/tex">\cos^2(x)</script> or <script type="math/tex">\exp(-x)</script>. Ensure there are suitable headers. How could you use dictionaries to make this more efficient?</p>
</section></section></section><section class="section2"><h2>Plotting in Excel</h2>
<p>In the worksheet, highlight all the data including the header row. From the <code>Insert</code> menu, choose <code>Chart &gt; X Y (Scatter)</code>. You should see a chart with different coloured lines, and a legend at the bottom corresponding to the header row. However, there are no axis labels and no title.</p>
<p>Select the chart by clicking on it. In the ribbon bar, left edge, select <code>Add Chart Element</code> and then <code>Axis Titles</code>. Use this to add axis labels.</p>
<p>Try modifying the axes to be logarithmic using <code>Add Chart Element</code>, <code>Axes</code>, select one axis, and go through the options until it shows the logarithmic options. Once done, convert back to linear axes.</p>
<p>By using <code>Ctrl</code> plus clicking (or right-clicking) on the chart, save it as a <code>png</code> file and a <code>pdf</code> file. We will need this to embed in reports.</p>
<p>Now try modifying the data range so that only the first half of the points are plotted. By <code>Ctrl</code> clicking again, choose <code>Select Data...</code> and modify the range. Note that the <code>$</code> symbols fix the range: this will be important when talking about formulas later.</p>
<p>Finally, some of our data sets now look roughly like straight lines. We want to add a trend line to measure their slope. In the ribbon menu, go to <code>Chart Design</code> and select <code>Add Chart Element, Trendline, Linear</code>. This should add the best fit line. Can you extract its slope? Can you annotate the plot with the slope?</p>
</section></section>
            </div>
        </div>
    </div>

        </main>
		
		<footer class="text-muted">
	<hr>
	<div class="container">
		<div class="float-right">
			<ul style="list-style: none">
			<li><a href="#">Back to top</a></li>
			
			
			<li><a href="../../lab_notes/lab_7_outline/lab_7_outline.pdf" target="_blank"><i class="fa fa-file-pdf-o"></i>&nbsp;Download as PDF</a></li>
			
			</ul>
		</div>
		<p>Generated using <a target="_blank" href="https://github.com/chirun-ncl/chirun">Chirun</a>, written by the E-Learning Unit, School of Mathematics &amp; Statistics, Newcastle University</p>
		<p>This page last generated: 2022-03-08</p>
	</div>
</footer>
		
    </body>
</html>
