<!doctype html>
<html lang="en">
    <head>
        
            <meta charset="utf-8">
            <meta name="robots" content="noindex">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <meta name="author" content="D Ian Jones" />
            <meta name="date" content="2022-07-03" />
        

        <title>Course Notes | Multivariable Calculus</title>

        
    
    
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../static/styles.css">
            <link rel="stylesheet" id="customiseCSS" href="../../static/light.css">
            
            
        
    <link rel="stylesheet" id="customiseCodeCSS" href="../../static/pygmentize.light.css">
    <link rel="stylesheet" href="../../static/codemirror-5.26.0/lib/codemirror.css">
    <link rel="stylesheet" href="../../static/boole.css">
    <link rel="stylesheet" href="../../static/numbasEmbed.css">

    <link rel="stylesheet" href="../../static/bootstrap-toc.css?v=3">
    <link rel="stylesheet" href="../../static/print.css">


        
    
    
            <script defer src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
            <script defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
            <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
            <script defer src="../../static/mathjax_config.js"></script>
            <script type="text/javascript" id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
            <script defer src="../../static/customisation.js"></script>
            <script defer src="../../static/mp4.js"></script>
            
            
        
    <script defer src="../../static/jquery.flexibleArea.js"></script>
    <script defer src="../../static/spin.min.js"></script>
    <script defer src="../../static/codemirror-5.26.0/lib/codemirror.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/octave/octave.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/python/python.js"></script>
    <script defer src="../../static/codemirror-5.26.0/mode/r/r.js"></script>
    <script defer src="../../static/boole.js"></script>
    <script defer src="../../static/numbasEmbed.js"></script>

    <script defer src="../../static/bootstrap-toc.js"></script>

    </head>
    <body data-spy="scroll" data-target="#chapterTOC" data-offset="50">
        
<div class="collapse" id="navbarToggleCustomise">
	<div class="bg-secondary text-white p-3">
		<form onsubmit="return false;" id="navbarCustomise">
			<div class="form-row">
				<label>Theme Customisation</label>
				<div id="themeSelector" class="form-group col-md-12">
					<button class="btn btn-dark mr-2" value="dark">Dark</button>
					<button class="btn btn-pastel mr-2" value="pastel">Pastel</button>
					<button class="btn btn-light mr-4" value="light">Light</button>
				</div>
			</div>
			<div class="form-row">
				<div class="form-group col-md-4">
					<label style="display: block" for="font-scale">Font size (<span id="font-size-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="font-scale" min="50" max="600" value="100">
					<button id="font-scale-reset" class="btn btn-sm">Reset</button>
				</div>
				<div class="form-group col-md-4">
					<label style="display: block" for="p-space">Spacing (<span id="p-space-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="p-space" min="0" max="600" value="100">
					<button id="p-space-reset" class="btn btn-sm">Reset</button>
				</div>
			</div>
		</form>
	</div>
</div>

<nav aria-label="breadcrumb">
	<ul class="breadcrumb">
		<li class="breadcrumb-item">
			<a href="../../index.html">Multivariable Calculus</a>
		</li>
		
		<li class="breadcrumb-item">
			<a href="../../notes/index.html">Notes</a>
		</li>
		
		<li class="breadcrumb-item active">
			Course Notes
		</li>
		<li class="ml-auto">
			<button class="navbar-toggler p0" type="button" data-toggle="collapse" data-target="#navbarToggleCustomise" aria-controls="navbarToggleCustomise" aria-expanded="false" aria-label="Toggle customisations panel">
				<i class="fa fa-cog" aria-hidden="true" title="Toggle customisations panel"></i> <span class="sr-only">Toggle customisations panel</span>
			</button>
		</li>
	</ul>
</nav>


        <header>
            
            
        </header>
        <main>
            
    <div class="container mt-3">
        <div class="row">
            
            <div id="sidebar" class="col-md-3">
                <nav class="mb-3" id="chapterTOC" data-toggle="toc">
                    <ul class="nav navbar-nav">
                        
                        
                        
                        <li><a id="pdf-link" class="nav-link" href="../../notes/course_notes/pdf/course_notes.pdf" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true" title="Download as PDF"></i>&nbsp;Download as PDF</a></li>
                        
                    </ul>
                </nav>
            </div>
            <div id="content" class="col-md-9"> 
            
            
<section class="section">
<h2 id="a0000000003">1 Notation and Terminology</h2>
<p>
The following is a summary of commonly used symbols and terminology. <br/>
</p>
<p>
<span class="scshape">Quantifiers</span>
</p>
<p>
<script type="math/tex">\forall </script> – for all 
</p>
<p>
<script type="math/tex">\exists </script> – there exists 
</p>
<p>
<span class="scshape">Terminology</span>
</p>
<p>
Theorem (or Proposition) – a proven mathematical statement 
</p>
<p>
  this is usually of the form <i class="itshape">if such and such then so and so</i>
</p>
<p>
  the Hypothesis is <i class="itshape">such and such</i>
</p>
<p>
  the Conclusion is <i class="itshape">so and so</i>
</p>
<p>
Lemma – a little theorem. 
</p>
<p>
Corollary – a mathematical statement which follows from a previous theorem. 
</p>
<p>
<span class="scshape">Sets</span>
</p>
<p>
<script type="math/tex">\mathbb N</script> – natural numbers <script type="math/tex">\{ 1,2,3,\dots \} </script>
</p>
<p>
<script type="math/tex">\mathbb Z</script> – integers <script type="math/tex">\{ \dots ,-3,-2,-1,0,1,2,3,\dots \} </script>
</p>
<p>
<script type="math/tex">\mathbb Q</script> – rational numbers e.g. <script type="math/tex">1,\frac12, -\frac13</script> etc. 
</p>
<p>
<script type="math/tex">\mathbb R</script> – real numbers <br/>(rational numbers and irrational numbers e.g. <script type="math/tex">\pi =3.14159\dots , \sqrt2=1.41421\dots </script>) 
</p>
<p>
<script type="math/tex">\mathbb C</script> – complex numbers <script type="math/tex">a+ib</script> where <script type="math/tex">a,b</script> are real and <script type="math/tex">i=\sqrt{-1}</script>
</p>
<p>
<script type="math/tex">\emptyset </script> – the empty set <script type="math/tex">\{ \} </script>
</p>
<p>
<script type="math/tex">\in </script> – is a member of (is in e.g. <script type="math/tex">-1\in \mathbb Z</script>, <script type="math/tex">\sqrt{2}\in \mathbb R</script>) 
</p>
<p>
<script type="math/tex">\notin </script> – is not a member of (is in e.g. <script type="math/tex">-1\notin \mathbb N</script>, <script type="math/tex">\sqrt{2}\notin \mathbb Q</script>) 
</p>
<p>
<script type="math/tex">\cup </script> – union (things that are in either or both of the sets) 
</p>
<p>
<script type="math/tex">\cap </script> – intersection (things that are in both sets) 
</p>
<p>
<script type="math/tex">\subseteq </script> – is a subset of subset (is contained in, meaning one set is inside another) 
</p>
<p>
<script type="math/tex">\varsubsetneq </script> – is a subset of proper subset (is strictly contained in, meaning the sets are not equal) 
</p>
</section><section class="section">
<h2 id="a0000000004">2 Greek letters</h2>
<p>
In this module and throughout mathematics you will encounter numerous Greek letters. Here is a table so that you know what they all are and how they are called. 
</p>
<p>
<table class="tabular">
<tr><td colspan="" rowspan="" style="text-align:center"><p>
 A
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
B
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Gamma </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Delta </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
E
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
Z
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\alpha </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\beta </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\gamma </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\delta </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\epsilon </script> or <script type="math/tex">\varepsilon </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\zeta </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Alpha
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Beta
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Gamma
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Delta
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Epsilon
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Zeta
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
H
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Theta </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
I
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
K
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Lambda </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
M
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\eta </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\theta </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\iota </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\kappa </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\lambda </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\mu </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Eta
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Theta
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Iota
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Kappa
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Lambda
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Mu
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
N
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Xi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
O
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Pi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
P
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Sigma </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\nu </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\xi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
o
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\pi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\rho </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\sigma </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Nu
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Xi
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Omicron
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Pi
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Rho
</p>
</td>
<td colspan="" rowspan="" style="text-align:center; border-bottom-style:solid; border-bottom-color:black; border-bottom-width:1px"><p>
Sigma
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
T
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
Y
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Phi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
X
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Psi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Omega </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\tau </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\upsilon </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\phi </script> or <script type="math/tex">\varphi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\chi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\psi </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\omega </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
Tau
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
Upsilon
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
Phi
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
Chi
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
Psi
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
Omega 
</p>
</td>
</tr>
</table>
</p>
</section><!-- Latex Chapter/Part -->
<h1 id="a0000000005">Introduction</h1>
<p>
Calculus is one of the oldest and most fundamental topics in mathematics. Although many people worked on the subject before the 17th Century, Liebnitz and Newton are credited with having independently developed the origins of the comprehensive theory we are familiar with today. 
</p>
<p>
These notes should be read in conjunction with the weekly tutorial sheets and solutions, as the problems in the weekly sheets provide additional examples of many of the things covered in the notes. 
</p>
<p>
We will build on techniques developed in MATH1059 Calculus. 
</p>
<!-- Latex Chapter/Part -->
<h1 id="a0000000006">Multivariable Functions</h1>
<section class="section">
<h2 id="a0000000007">2.1 Functions of More than One Variable</h2>
<p>
All your previous work has been on functions of one variable, for example <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x)=e^{x}+x^{2}</script></span></span> This is a map from a real number <script type="math/tex">x</script> in a domain <script type="math/tex">D\in \mathbb {R}</script> of a function <script type="math/tex">f</script> to a real number <script type="math/tex">y=f(x)</script> in the range <script type="math/tex">R\in \mathbb {R}</script> of <script type="math/tex">f</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f:x \rightarrow y=f(x)</script></span></span>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0002.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.1</span>
<span class="caption_text">Plot of <script type="math/tex">f:x \rightarrow y=f(x)</script></span>
</figcaption> </div>
</figure>
<p>
In this module we will generalise this to allow functions between finite real dimensional (Euclidean) spaces <script type="math/tex">\mathbb {R}^{n}</script> and <script type="math/tex">\mathbb {R}^{m}</script> for integer <script type="math/tex">n, m \ge 1</script>, where <script type="math/tex">\mathbb R</script> is the set of all real numbers. 
</p>
<p>
<b class="bf">Definition: (Multivariate Function)</b> <span class="rm"><p>
A <i class="it">function</i> <script type="math/tex">F:D \to \mathbb R^ m</script> from a subset <script type="math/tex">D</script> of <script type="math/tex">\mathbb {R}^ n</script> to <script type="math/tex">\mathbb R^ m</script> is an assignment of a unique point <script type="math/tex">f(x_1, \dots , x_ n)\in \mathbb R^ m</script> for each point <script type="math/tex">(x_1, \dots , x_ n)\in D</script>. The set <script type="math/tex">D</script> is called the <i class="it">domain</i> of <script type="math/tex">F</script> and the set of all points <script type="math/tex">F(x_1, \dots , x_ n)</script> obtained from the domain is called the <i class="it">range</i> of <script type="math/tex">F</script>. 
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
Suppose <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\sqrt{4-x^2-y^2.}</script></span></span> If we restrict ourselves to only real values of the square root, the domain <script type="math/tex">D</script> is the disk of radius 2 centred at the origin: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\textcolor{red}{D=\{ (x,y) \in R^{2}\;  | \;  x^2+y^2\leqslant 4\} .}</script></span>
<p>
 The function <script type="math/tex">f</script> is thus <script type="math/tex">f:D\to \mathbb R</script>. (Strictly speaking the function <script type="math/tex">f</script> is <script type="math/tex">f:D\to \mathbb R^{+}</script>.) 
</p>
<figure id="mtuple">
<div class="centered"> <img src="../../notes/course_notes/images/img-0004.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.2</span>
<span class="caption_text">Domain of <script type="math/tex">z=\sqrt{4-x^{2}-y^{2}}</script></span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b> Suppose <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\frac{1}{x^{2}+y^{2}}.</script></span></span> The function is well defined (i.e., has finite real values) for all points except <script type="math/tex">(x,y)=(0,0)</script>, where the function has no finite value. Hence the domain <script type="math/tex">D</script> is 
</p>
<span class="dmath"><script type="math/tex; mode=display">\textcolor{red}{D=\{ (x,y) \in \mathbb R^{2}\;  | \;  (x,y)\ne (0,0)\} .}</script></span>
<p>
 The function <script type="math/tex">f</script> is thus <script type="math/tex">f:D\to \mathbb R</script>. 
</p>
<p>
Where there is no confusion, we will often write <script type="math/tex">F:\mathbb R^ n\to \mathbb R^ m</script> instead of <script type="math/tex">F:D\to \mathbb R^ m</script> with the understanding that the function may not be defined on all of <script type="math/tex">\mathbb R^ n</script> but rather on its subset <script type="math/tex">D</script>, the domain. 
</p>
<p>
<b class="bf">Example:</b> If <script type="math/tex">x</script> is the radius of a right cylinder and <script type="math/tex">y</script> is its height, the volume is given by a function <script type="math/tex">F: (x,y)\in \mathbb R^{2}\to z\in \mathbb R</script> such that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=\pi x^{2}y.</script></span></span> Clearly in the context of radius and height measurements, <script type="math/tex">x</script> and <script type="math/tex">y</script> are both here positive, so the domain <script type="math/tex">D</script> is <script type="math/tex">D=\{ (x,y)\in \mathbb R^{2} \;  | \;  x,y\ge 0\} </script>. However the formula for <script type="math/tex">z</script> is valid for all real values of <script type="math/tex">x</script> and <script type="math/tex">y</script>, so, in a mathematical context, we are able to drop reference to a subdomain of <script type="math/tex">\mathbb R^{2}</script>
</p>
<p>
<b class="bf">Definition: (Multivariable functions between arbitrary numbers of dimensions)</b> A function <script type="math/tex">F: {\mathbb R}^ n\rightarrow {\mathbb R}^ m</script> can be viewed as an ordered <script type="math/tex">m</script>-tuple of functions from <script type="math/tex">{\mathbb R}^ n</script> to <script type="math/tex">{\mathbb R}</script>, which we write as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x_1, \ldots , x_ n) = (f_1(x_1, \ldots , x_ n), \ldots , f_ m(x_1,\ldots , x_ n)),</script></span> </span> where each <script type="math/tex">f_ i: {\mathbb R}^ n\rightarrow {\mathbb R}</script> for <script type="math/tex">1\le i\le m</script> is itself a function from <script type="math/tex">{\mathbb R}^ n</script> to <script type="math/tex">{\mathbb R}</script>.  
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
Suppose <script type="math/tex">F(t)= (t \cos (t), t\sin (t))</script>. The domain is all <script type="math/tex">\mathbb R</script> and <script type="math/tex">F:\mathbb R\to \mathbb R^2</script> is a spiral curve in <script type="math/tex">(x,y)</script> space. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0006.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.3</span>
<span class="caption_text">Plot of <script type="math/tex">F:\mathbb R\to \mathbb R^2</script> curve with <script type="math/tex">F(t)= (t \cos (t), t\sin (t))</script> (for part of the domain of <script type="math/tex">\mathbb R</script>).</span>
</figcaption> </div>
</figure>
<p>
In the notation of the above definition, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{1}(x_{1})=x_{1}\cos x_{1}, \qquad f_{2}(x_{1})=x_{1}\sin x_{1}, \qquad x_{1}=t.</script></span></span>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000008">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">1.1</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
<span class="rm"><p>
If you take a Newtonian classical view of the world (see MATH1057) you may specify a particle at any point in time <script type="math/tex">t</script> by its spatial position in 3-D space <script type="math/tex">(x,y,z)</script> relative to some origin and its associated momenta (= mass <script type="math/tex">\times </script> velocity) in each of three directions <script type="math/tex">(p_{x}, p_{y}, p_{z})</script>. 
</p>
<p>
Hence classical particle specification consists of 6 mappings, <script type="math/tex">F: t \to (x,y,z, p_{x},p_{y},p_{z})</script>, i.e., <script type="math/tex">\mathbb R\to \mathbb R^{6}</script>, i.e., you give me a time <script type="math/tex">t</script> and I have to give you back six functions <script type="math/tex">x(t)</script>, <script type="math/tex">y(t)</script>, <script type="math/tex">z(t)</script>, <script type="math/tex">p_{x}(t)</script>, <script type="math/tex">p_{y}(t)</script>, <script type="math/tex">p_{z}(t)</script> before we can define exactly what the particle is doing. 
</p>
</span>
</p>
</div>
</div>
</p>
<p>
To simplify matters (and because humans can only visualise easily up to three dimensions), many of the examples in this module will focus on <script type="math/tex">\mathbb R^2\to \mathbb R</script>, or <script type="math/tex">\mathbb R^3\to \mathbb R</script>. 
</p>
</span>
</p>
</span>
</p>
</span>
</p>
<section class="subsection">
<h3 id="a0000000009">2.1.1 Explicit and Implicit Functions</h3>
<p>
Functions of a single variable have one of two basic flavours. 
</p>
<section class="subsubsection">
<h4 id="a0000000010">Explicit Function</h4>
<p>
A function is an <b class="bf">explicit function</b> if we have or are given an explicit description of <script type="math/tex">f(x)</script> as a formula in terms of <script type="math/tex">x</script>, for instance a formula like <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x) = x^2 \; \; \;  \mbox{or}\; \; \;  f(x) = \exp (\sin (x+(x^3+1)\cos (2x+76))) + \ln (x^2+2).</script></span></span> More generally an explicit function is one where we have an explicit description of how to calculate the value of <script type="math/tex">f(x)</script> given a value of the input <script type="math/tex">x</script>. 
</p>
<p>
Note that sometimes this does not mean that there is an obvious formula. For example, consider the <i class="it">greatest integer function</i>, where we set <script type="math/tex">\lfloor x \rfloor </script> to be the largest integer that is less than or equal to <script type="math/tex">x</script>. We have an explicit description for <script type="math/tex">\lfloor x\rfloor </script> given <script type="math/tex">x</script> from which we can calculate the function but no (immediately obvious) formula (e.g., given an input <script type="math/tex">x=25.46</script>, the output <script type="math/tex">\lfloor x\rfloor </script> is obviously 25). 
</p>
<p>
An example of an explicit function of two variables <script type="math/tex">\mathbb R^{2}\to \mathbb R</script> is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z = x^2 -y^2 + xy\cos (x+y).</script></span></span> Here we may input any real values of <script type="math/tex">x</script> and <script type="math/tex">y</script> into the right hand side and this generates a unique value of <script type="math/tex">z</script> and we can write the function as <script type="math/tex">z=f(x,y)</script>, i.e., the unique output <script type="math/tex">z</script> on the LHS and all the <script type="math/tex">x</script>, <script type="math/tex">y</script> inputs on the RHS 
</p>
<p>
An example of an explicit function of three variables <script type="math/tex">\mathbb R^{3}\to \mathbb R</script> is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">u = x^{2}+yz+e^{x+y+z}.</script></span></span> Here, we may input (the same) values of <script type="math/tex">x</script>, <script type="math/tex">y</script> and <script type="math/tex">z</script> into the right hand sides of the two (paired) equations and this will generate a pair of values of <script type="math/tex">u</script> and <script type="math/tex">v</script>. 
</p>
<p>
An example of an explicit function of <script type="math/tex">\mathbb R^{3}\to \mathbb R^{2}</script> is <span style="color:#FF0000"><div id="a0000000011">
<script type="math/tex; mode=display">
\begin{align}
 u & = & x^{2}+yz+e^{x+y+z}; \nonumber \\ 
v & =&  \cos (x+z^{2})+xyz. \nonumber 
\end{align}
</script>
</div> </span> Here we input <script type="math/tex">x</script> <script type="math/tex">y</script> and <script type="math/tex">z</script> into the right hand side and this generates a unique values of <script type="math/tex">u</script> and <script type="math/tex">v</script>. 
</p>
</section><section class="subsubsection">
<h4 id="a0000000012">Implicit Function</h4>
<p>
A function is an <b class="bf">implicit function</b> if we have a description of the relationship between two (or more) variables, such as <script type="math/tex">x</script> and <script type="math/tex">y</script>, but the function, either is not, or may not be, written in a form that makes one of the variables explicitly the subject in a uniquely defined way. 
</p>
<p>
A simple example of an implicit function comes from the equation of a circle in the plane with centre the origin and radius 1, namely: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x^2 +y^2 = 1</script></span></span> The function is represented in the form <script type="math/tex">F(x,y)=x^{2}+y^{2}= constant</script>. Here, we cannot solve for <script type="math/tex">y</script> as a function of <script type="math/tex">x</script> in a way that is unique for all values <script type="math/tex">x</script> in the domain. Specifically, if we solve for <script type="math/tex">y</script>, we get <script type="math/tex">y = \pm \sqrt{x^2-1}</script>, and so for each <script type="math/tex">-1 <x <1</script>, there are two possible values of <script type="math/tex">y</script> and this violates the definition of function as discussed (albeit briefly) above. 
</p>
<p>
All the following are (non-specific) examples of how implicit functions are generally represented, i.e., as a function of the all variables = a constant (often zero, without loss of generality): <span style="color:#FF0000"> <div id="a0000000013">
<script type="math/tex; mode=display">
\begin{align}
 \ln (x+y)-1=0; \nonumber \\ 
F(x,y)=0 ; \nonumber \\ 
x^{2}+y^{2}+z^{2}-R^{2}=0;\nonumber \\ 
G(x,y,z)=0 \nonumber ; 
\end{align}
</script>
</div> </span> or <span style="color:#FF0000"> <span class="dmath"><script type="math/tex; mode=display">\left\{ \begin{array}{c}U(x_{1},x_{2},\dots , x_{n})=0 \\ V(x_{1},x_{2},\dots , x_{n})=0\end{array}\right.</script></span> </span>
</p>
<p>
In each case (and for given <script type="math/tex">F</script>, <script type="math/tex">G</script>, <script type="math/tex">U</script>, <script type="math/tex">V</script>), it may or may not be possible to solve the equational relation explicitly in terms of one of the variables. When it is possible or not will be studied later on. Actually we will not care whether an explicit representation is possible or not and we will just develop maths that can cope with both types of representations. 
</p>
</section>
</section>
</section><section class="section">
<h2 id="a0000000014">2.2 Graphical Representations of Multivariable Functions</h2>
<p>
Graphically we can represent <script type="math/tex">y=f(x)</script> by a set of points <script type="math/tex">(x,f(x))</script> in the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0002.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.4</span>
<span class="caption_text">Fig to be done</span>
</figcaption> </div>
</figure>
<p>
By contrast the explicit function <script type="math/tex">z =f(x,y)</script> can represent the height <script type="math/tex">z</script> of a surface above the <script type="math/tex">(x,y)</script> plane in the <script type="math/tex">(x,y,z)</script> space 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0008.jpg" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.5</span>
<span class="caption_text">Plot of a multivariate function where the height of the function is <script type="math/tex">z=f(x,y)</script> and is given by <script type="math/tex">f(x,y)=\sin (x)+\sin (y)</script></span>
</figcaption> </div>
</figure>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000015">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">2.1</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
<span class="rm">Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=1-x-y, \qquad 0\le x\le 1, \qquad 0\le y\le 1.</script></span></span> This maps the rectangular set of points <script type="math/tex">0\le x\le 1</script>, <script type="math/tex">0\le y\le 1</script> to a 2-D plane in <script type="math/tex">\mathbb R^{3}</script> passing through the (obvious) points <script type="math/tex">(1,0,0)</script>, <script type="math/tex">(0,1,0)</script> and <script type="math/tex">(0,0,1)</script>. <figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0010.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.6</span>
<span class="caption_text">Surface <script type="math/tex">z=1-x-y</script> plotted in positive octant <script type="math/tex">x\ge 0, y\ge 0, z\ge 0</script>.</span>
</figcaption> </div>
</figure> </span>
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000016">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">2.2</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
<span class="rm"><p>
Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\sqrt{9-x^{2}-y^{2}},</script></span></span> The domain of this real function is given by the circle 
</p>
<span class="dmath"><script type="math/tex; mode=display">\textcolor{red}{D=\{ (x,y) \;  | \;  x^2+y^2\leqslant 9\} ,}</script></span>
<p>
 since any other values of <script type="math/tex">(x,y)</script> lead to complex numbers. 
</p>
<p>
Now if we set <script type="math/tex">z=f(x,y)</script>, then we have to plot the function <script type="math/tex">z=\sqrt{9-x^{2}-y^{2}}</script>. Squaring both sides and rearranging, we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x^{2}+y^{2}+z^{2}=9.</script></span></span> This says that the square of the distance from the origin of all the points on this surface in <script type="math/tex">(x,y,z)</script> space must be 9. Hence this is the equation of the surface of a sphere of radius 3. 
</p>
<p>
Now reverting back to the actual equation <script type="math/tex">z=\sqrt{9-x^{2}-y^{2}}</script>, if we assume that the square root function is positive only, then <script type="math/tex">f(x,y)</script> represents the surface of a hemisphere, centred the origin, radius 3 <b class="bf">above</b>, the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0012.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.7</span>
<span class="caption_text"><script type="math/tex">z=\sqrt{9-x^{2}-y^{2}}</script> where the positive square root is taken.</span>
</figcaption> </div>
</figure>
<p>
 The corresponding function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=-\sqrt{9-x^{2}-y^{2}},</script></span></span> represents the surface of a hemisphere, centred the origin, radius 3, <b class="bf">below</b> the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0014.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.8</span>
<span class="caption_text"><script type="math/tex">z=-\sqrt{9-x^{2}-y^{2}}</script> where the negative square root has been taken.</span>
</figcaption> </div>
</figure>
</span>
</p>
</div>
</div>
</p>
<section class="subsubsection">
<h4 id="a0000000017">Graphs in <script type="math/tex">\mathbb R^{n}, n>3</script></h4>
<p>
All the examples above are <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. We were able to plot these as 2D surfaces in 2+1=3D space. 
</p>
<p>
Consider a function 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">w=f(x,y,z)=x^{2}+y^{2}+z^{2}</script></span></span>
</p>
<p>
This is a mapping <script type="math/tex">\mathbb R^{3}\to \mathbb R</script>. If we wanted to draw both the domain and range on the same plot, we would need to be able to visualise a 3 dimensional <b class="bf">hypersurface</b> in 3+1=4 dimensional space. Clearly this is not possible (in our concept of the world!). 
</p>
<p>
Hence at best we might need to consider only partial representations of the graph. For example, we might consider what the surface <script type="math/tex">w=9</script> looks like and plotting it in <script type="math/tex">4-1=3</script> dimensional space <script type="math/tex">(x,y,z)</script>. We could then re-plot the graph for different chosen values of <script type="math/tex">w</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0016.png" style="width:144.54pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.9</span>
<span class="caption_text">Plot of <script type="math/tex">w=9</script> where <script type="math/tex">w=x^{2}+y^{2}+z^{2}</script>, i.e., a sphere of radius 3 in <script type="math/tex">(x,y,z)</script> space.</span>
</figcaption> </div>
</figure>
<p>
Hence, to avoid brain overload, when we want to visualise graphs, we shall henceforth largely stick to mappings of <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. 
</p>
</section>
</section><section class="section">
<h2 id="a0000000018">2.3 Contours</h2>
<p>
An alternative way of representing surfaces of the form <script type="math/tex">z = f (x, y)</script> is to use a contour plot. This is exactly what is used to represent the height of the ground on an Ordnance Survey map<a class="footnote" href="#a0000000019">
<sup class="footnotemark">1</sup>
</a>. 
</p>
<p>
The following diagram is based on data from Mathematica and depicts a relief and contour plot of Schielhallion. <a href="https://en.wikipedia.org/wiki/Schiehallion_experiment">Schielhallion</a> is a mountain in Perthshire in Scotland. Due to its distinctive shape, size and (lack of) proximity to other hills/mountains, it was chosen (initially by by the astronomer the Reverend Nevil Maskylene) in the 1770-1790s to verify the mean density of the earth . Those experiments required the calculation of the volume of the mountain, which in turn required the development of two vital mathematical techniques. Contour lines were invented (by Charles Hutton) to map out the level heights around the mountain so that it could be approximated as a series of column-like structures. The volume of these columns was calculated by the new technique of numerical integration.<a class="footnote" href="#a0000000020">
<sup class="footnotemark">2</sup>
</a>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0018.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.10</span>
<span class="caption_text">Left: Relief plot of Schielhallion. Right: Contour plot of the same region. </span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Definition: (Contour):</b> A contour (or level set) of a graph of <script type="math/tex">z = f(x,y)</script> is the set of points <script type="math/tex">(x,y)\in \mathbb R^{2}</script> satisfying <script type="math/tex">f(x,y)=c</script> for a chosen <script type="math/tex">c\in \mathbb R</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">L_ c = L_ c (f) = \{  (x,y)\in {\mathbb R}^2\:  |\:  f(x,y) = c\} .</script></span> </span>
</p>
<p>
In words, the contour (or level set of height <script type="math/tex">c</script>) is the set of points in the domain at which the function takes the value <script type="math/tex">c</script>. When presented in this form, the equation for contours is an implicit representation. 
</p>
<p>
One immediate consequence of this is that level sets of different heights are necessarily disjoint: by the definition of function, there cannot exist a point at which the function takes on two different <script type="math/tex">z</script>-values simultaneously. 
</p>
<p>
A contour plot is then the union of the contours for different values of <script type="math/tex">c\in \mathbb R</script>. It is a 2-D plot of a 3-D surface. 
</p>
<p>
<b class="bf">Example:</b> Determine the level contours of the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=1-x-y</script></span> </span>
</p>
<ul class="itemize" id="a0000000021">
<li id="a0000000022"> <p>
The level sets are given by <script type="math/tex">c=f(x,y)</script> for <script type="math/tex">c\in \mathbb R</script>. 
</p>
</li>
<li id="a0000000023"> <p>
Hence we have <script type="math/tex">c=1-x-y</script>. 
</p>
</li>
<li id="a0000000024"> <p>
Rearranging we obtain an explicit relation of <script type="math/tex">y=1-c-x</script>. 
</p>
</li>
<li id="a0000000025"> <p>
These are straight lines in the <script type="math/tex">(x,y)</script> plane of slope -1 and <script type="math/tex">y</script>-intercept <script type="math/tex">1-c</script>. 
</p>
</li>
<li id="a0000000026"> <p>
The contours may then be plotted as follows: 
</p>
</li>
</ul>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0020.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.11</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=1-x-y</script> in the positive <script type="math/tex">(x,y)</script>-plane (and plotted on the surface in the positive octant). These are curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">1-x-y=c</script>, or <script type="math/tex">y=-x+1-c</script>. </span>
</figcaption> </div>
</figure>
<p>
In practice we would only draw the 2-D plot on the right, since the whole point is to avoid having to cope with drawing 3-D surfaces. However in these first examples, we plot both the contours on the 3-D surface and in the 2-D <script type="math/tex">(x,y)</script> plane, just to give an idea of what the contours are and how they relate to the surface. 
</p>
<p>
<b class="bf">Example:</b> Determine the level sets of the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}+y^{2}</script></span> </span>
</p>
<ul class="itemize" id="a0000000027">
<li id="a0000000028"> <p>
<span style="color:#FF0000">The level sets are given by <script type="math/tex">c=f(x,y)</script>.</span>
</p>
</li>
<li id="a0000000029"> <p>
<span style="color:#FF0000">Hence we have <script type="math/tex">c=x^{2}+y^{2}</script>.</span>
</p>
</li>
<li id="a0000000030"> <p>
<span style="color:#FF0000">We see that for real <script type="math/tex">x</script> and <script type="math/tex">y</script>, <script type="math/tex">x^{2}+y^{2}\ge 0</script>. Hence <script type="math/tex">c\ge 0</script> only. So when</span>
</p>
<ul class="itemize" id="a0000000031">
<li id="a0000000032"> <p>
<span style="color:#FF0000"><script type="math/tex">c<0</script>: No real contours exist.</span>
</p>
</li>
<li id="a0000000033"> <p>
<span style="color:#FF0000"><script type="math/tex">c=0</script>: <script type="math/tex">x^{2}+y^{2}=0 \Rightarrow (x,y)=(0,0)</script>.</span>
</p>
</li>
<li id="a0000000034"> <p>
<span style="color:#FF0000"><script type="math/tex">c>0</script>: <script type="math/tex">x^{2}+y^{2}=c \Rightarrow </script> circles centred <script type="math/tex">(0,0)</script>, radius <script type="math/tex">\sqrt{c}</script></span>. 
</p>
</li>
</ul>
</li>
<li id="a0000000035"> <p>
The contours may then be plotted as follows: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0022.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.12</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=x^{2}+y^{2}</script>. These are curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}+y^{2}=c</script>, circles centre the origin of radius <script type="math/tex">\sqrt{c}</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000036"> <p>
Note from the analysis above, the function <script type="math/tex">f(x,y)=x^{2}+y^{2}</script> clearly has a local <b class="bf">minimum</b> value at <script type="math/tex">(0,0)</script>. If you walk away from the origin in whichever direction on the surface <script type="math/tex">z=x^{2}+y^{2}</script>, you will always walk uphill. 
</p>
</li>
<li id="a0000000037"> <p>
Clearly if you consider the function <script type="math/tex">f(x,y)=-(x^{2}+y^{2})</script>, you will have similar shapes of contours, but taking the corresponding negative values of <script type="math/tex">c</script>. Hence, for that function, the origin is a <b class="bf">maximum</b>. If you walk away from the origin in whichever direction on the surface <script type="math/tex">z=-(x^{2}+y^{2})</script>, you will always walk downhill. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0024.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.13</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=-(x^{2}+y^{2})</script>. These are curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}+y^{2}=-c</script>, but clearly <script type="math/tex">c<0</script> and decreases as <script type="math/tex">x^{2}+y^{2}</script> increases. They are still circles, centre the origin, of radius <script type="math/tex">\sqrt{-c}</script>.</span>
</figcaption> </div>
</figure>
</li>
</ul>
<p>
<b class="bf">Remark:</b> <span class="rm"><p>
If the contour levels <script type="math/tex">c</script> are equally spaced, clearly the closer the contour lines are together on the <script type="math/tex">(x,y)</script> plot, the “steeper” the surface is in that direction. 
</p>
<p>
<b class="bf">Example:</b> Determine the level contours of the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}-y^{2}</script></span> </span>
</p>
<ul class="itemize" id="a0000000038">
<li id="a0000000039"> <p>
<span style="color:#FF0000">The level sets are given by <script type="math/tex">c=f(x,y)</script>.</span>
</p>
</li>
<li id="a0000000040"> <p>
<span style="color:#FF0000">Hence we have <script type="math/tex">c=x^{2}-y^{2}</script>.</span>
</p>
</li>
<li id="a0000000041"> <p>
<span style="color:#FF0000">We see that for real <script type="math/tex">x</script> and <script type="math/tex">y</script>, <script type="math/tex">x^{2}-y^{2}\ge 0</script> may be positive, zero or negative.</span>
</p>
</li>
<li id="a0000000042"> <p>
<span style="color:#FF0000">For <script type="math/tex">c=0</script> we have <script type="math/tex">x^{2}=y^{2}</script> or <script type="math/tex">y=\pm x</script>. These are straight lines through the origin.</span>
</p>
</li>
<li id="a0000000043"> <p>
The contours may then be plotted as follows: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0026.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.14</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=x^{2}-y^{2}</script>. These are still curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}-y^{2}=c</script>. These are (for <script type="math/tex">c\ne 0</script>) hyperbolae. The contours corresponding to <script type="math/tex">c=0</script> are the lines <script type="math/tex">y=\pm x</script>. The regions <script type="math/tex">y<|x|</script> have <script type="math/tex">c>0</script>, the regions <script type="math/tex">y>|x|</script> have <script type="math/tex">c<0</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000044"> <p>
This is an example of a simple <b class="bf">saddle</b> point. The region around the origin is separated into four quadrants. 
</p>
</li>
<li id="a0000000045"> <p>
Walking away from the origin on the surface <script type="math/tex">z=x^{2}-y^{2}</script> into two of these quadrants (<script type="math/tex">|y|>|x|</script>) will result in you going downhill. 
</p>
</li>
<li id="a0000000046"> <p>
Walking away from the origin on the surface <script type="math/tex">z=x^{2}-y^{2}</script> into the other two quadrants (<script type="math/tex">|y|<|x|</script>) will result in you walking uphill. 
</p>
</li>
<li id="a0000000047"> <p>
Walking away from the origin on the surface <script type="math/tex">z=x^{2}-y^{2}</script> on the lines <script type="math/tex">y=\pm x</script> and you will keep the same height of 0 and neither walk up nor downhill. 
</p>
</li>
</ul>
<p>
More complicated contour plots can be drawn using computer packages, e.g., Maple, Mathematica or Matlab. Further examples are available on Blackboard. 
</p>
</span>
</p>
</section><section class="section">
<h2 id="a0000000048">2.4 Limits and Continuity</h2>
<section class="subsection">
<h3 id="a0000000049">2.4.1 Definition of limits in <script type="math/tex">\mathbb R^{2}</script></h3>
<p>
 For functions of a single variable, the concept of the limit 
</p>
<span class="dmath"><script type="math/tex; mode=display">\lim _{x\to a}f(x)</script></span>
<p>
 was discussed last semester. 
</p>
<p>
Recall that a function is continuous at <script type="math/tex">x = a</script> iff as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\lim _{x\to a^{+}}f(x) = \lim _{x\to a^{-}}f(x)= f(a).</script></span>
<p>
In detail this means three conditions: 
</p>
<ul class="itemize" id="a0000000050">
<li id="a0000000051"> <p>
First, <script type="math/tex">f</script> has to be defined at <script type="math/tex">a</script> (i.e., <script type="math/tex">c</script> must live in the domain of <script type="math/tex">f</script>). 
</p>
</li>
<li id="a0000000052"> <p>
Second, the limits on both sides of <script type="math/tex">a</script> has to exist. 
</p>
</li>
<li id="a0000000053"> <p>
Third, the value of this limit must equal <script type="math/tex">f(a)</script>. 
</p>
</li>
</ul>
<p>
All these concepts can be extended to multivariate functions as follows. 
</p>
<p>
<b class="bf">Definition: (Limit)</b> Given a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script>. We say <script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} f(x,y)=L,</script> whenever 
</p>
<ol class="enumerate" id="a0000000054" style="list-style: none">
<li id="a0000000055" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
every neighbourhood of the point <script type="math/tex">(a,b)</script> contains a point of the domain of <script type="math/tex">f</script> different from <script type="math/tex">(a,b)</script>, and 
</p>
</li>
<li id="a0000000056" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
for every <script type="math/tex">\varepsilon >0</script>, there exists <script type="math/tex">\delta > 0</script> such that if <script type="math/tex">(x,y)</script> is in the domain and satisfies 
</p>
<span class="dmath"><script type="math/tex; mode=display">0<\sqrt{(x-a)^2+(y-b)^2}< \delta ,</script></span>
<p>
 then <script type="math/tex">|f(x,y)-L|<\varepsilon </script>. 
</p>
</li>
</ol>
<p>
It’s much better to draw a diagram to explain what we mean: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0028.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.15</span>
<span class="caption_text"><script type="math/tex">\forall </script> <script type="math/tex">(x,y)</script> in this disk, we we must have <script type="math/tex">|(f(x,y)-L|\le \epsilon </script> if the limit of <script type="math/tex">f</script> at <script type="math/tex">(a,b)</script> exists.</span>
</figcaption> </div>
</figure>
<p>
 In words this means that for a limit to exist at <script type="math/tex">(a,b)</script>, the value of the function <script type="math/tex">f(x, y)</script> must approach the same value <script type="math/tex">L</script> as <script type="math/tex">(x, y)\to (a,b)</script> from <b class="bf">whichever</b> route you take. 
</p>
<p>
Sometimes it is possible to use the (dreaded) <script type="math/tex">\varepsilon , \delta </script> definition. 
</p>
<p>
<b class="bf">Example:</b> Let us find <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y) \to (0,0)}} (x^2 +y^2+7).</script></span></span> Note that as <script type="math/tex">(x,y)</script> tends to <script type="math/tex">(0,0)</script>, the function approaches the value <script type="math/tex">7</script>. So, we shall try to prove that this is the limit. The following steps gives the standard algorithm for proving the limit. 
</p>
<ul class="itemize" id="a0000000057">
<li id="a0000000058"> <p>
The domain is the <script type="math/tex">(x,y)</script> plane. So every neighbourhood of the point <script type="math/tex">(0,0)</script> is in the domain of <script type="math/tex">f</script> (condition (i) above). 
</p>
</li>
<li id="a0000000059"> <p>
We need to show that for any <script type="math/tex">\varepsilon >0</script>, there exists <script type="math/tex">\delta > 0</script> such that if <script type="math/tex">0<\sqrt{x^2+y^2}< \delta </script>, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">|{x^2 +y^2}+7-7 |<\varepsilon \qquad \Rightarrow \qquad |{x^2 +y^2} |<\varepsilon</script></span> </span>
</p>
</li>
<li id="a0000000060"> <p>
Obviously, if we now set <script type="math/tex">\delta =\sqrt{\varepsilon }</script> for any <script type="math/tex">\varepsilon >0</script> we have found the <script type="math/tex">\delta > 0</script> to satisfy the inequality condition (ii) in the definition above. 
</p>
</li>
<li id="lim-0"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y) \to (0,0)}} (x^2 +y^2+7)=7.</script></span></span>
</p>
</li>
</ul>
<p>
 This looks like a rather obvious answer. In the next example, the value of the limit at the limit point is not so obvious. 
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
Show that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y) \rightarrow (0,0)}} \frac{x^{2}y}{x^2 +y^2} =0.</script></span></span>
</p>
<ul class="itemize" id="a0000000061">
<li id="a0000000062"> <p>
The domain is the whole <script type="math/tex">(x,y)</script>-plane, excluding the origin, where the functional form is 0/0, so ambiguous. 
</p>
</li>
<li id="a0000000063"> <p>
Nevertheless, every neighbourhood of the point <script type="math/tex">(0,0)</script> is in the domain of <script type="math/tex">f</script> (condition (i) above). 
</p>
</li>
<li id="a0000000064"> <p>
Now, we need to show that for <script type="math/tex">\varepsilon >0</script>, there exists <script type="math/tex">\delta > 0</script> such that if <script type="math/tex">0<\sqrt{x^2+y^2}< \delta </script>, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left|\frac{x^{2}y}{x^2 +y^2} -0\right|<\varepsilon .</script></span></span>
</p>
</li>
<li id="a0000000065"> <p>
A shortcut that you can often deploy in these types of examples is to convert to polar coordinates: <script type="math/tex">x=r\cos \theta </script>, <script type="math/tex">y=r\sin \theta </script>. For then, since <script type="math/tex">|\cos \theta |\le 1</script> and <script type="math/tex">|\sin \theta |\le 1</script> and <script type="math/tex">r\ge 0</script>, we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left| \frac{x^{2}y}{x^2 +y^2} -0\right| = \left| \frac{r^{3}\cos ^{2}\theta \sin \theta }{r^{2}}\right|=\left| r\cos ^{2}\theta \sin \theta \right|< |r| =r</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \left| \frac{x^{2}y}{x^2 +y^2} -0\right| < r</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \left| \frac{x^{2}y}{x^2 +y^2} -0\right| < \sqrt{x^{2}+y^{2}}</script></span></span>
</p>
</li>
<li id="a0000000066"> <p>
Hence comparing with the definition of the limit above, if we see that if there has to be a <script type="math/tex">\delta >0</script> such that the LHS has to be less than <script type="math/tex">\epsilon >0</script> whenever <script type="math/tex">0< \sqrt{x^{2}+y^{2}}< \delta </script>, a natural choice is <script type="math/tex">\delta =\epsilon </script>. 
</p>
</li>
</ul>
</span>
</p>
</section><section class="subsection">
<h3 id="a0000000067">2.4.2 Sums, Products, Ratios, Composition of Limits in <script type="math/tex">\mathbb R^{2}</script></h3>
<p>
The above formal <script type="math/tex">\varepsilon , \delta </script> definition is usually too cumbersome to use in practice. Fortunately, to save a lot of pain, the following lemma holds. It speeds up limit-finding when functions are well behaved (proof of the lemma is not required). 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="limit_properties">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">4.1</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
 Let <script type="math/tex">f: \mathbb R^2 \to \mathbb R</script> and <script type="math/tex">g: \mathbb R^2 \to \mathbb R</script>. Suppose 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y)\to (a,b)}} f(x,y)=L\; \; \;  \mbox{and}\; \; \;  \displaystyle {\lim _{(x,y)\to (a,b)}} g(x,y)=M.</script></span>
<p>
 Then 
</p>
<ol class="enumerate" id="a0000000068" style="list-style: none">
<li id="a0000000069" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
<script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} (f(x,y)\pm g(x,y))= L\pm M</script>, 
</p>
</li>
<li id="a0000000070" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
<script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} (f(x,y) g(x,y)) =LM</script>, 
</p>
</li>
<li id="a0000000071" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
<script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} (f(x,y) /g(x,y)) =L/M</script>, as long as <script type="math/tex">M\neq 0</script>. 
</p>
</li>
<li id="a0000000072" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Given a function <script type="math/tex">h:\mathbb R\to \mathbb R</script> that is continuous at <script type="math/tex">L\in \mathbb R</script>, then <script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} h(f(x,y)) =h(L)</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example</b> Find the limit of <script type="math/tex">f(x,y)={x^2+xy+5}</script> as <script type="math/tex">(x,y)</script> approaches <script type="math/tex">(1,0)</script>. 
</p>
<ul class="itemize" id="a0000000073">
<li id="a0000000074"> <p>
The domain contains all points of the <script type="math/tex">(x,y)</script>-plane, so the function is expected to exist at the limit point. Also we then have neighbourhood of the limit point that is in the domain. Therefore we expect that a limit may exist. 
</p>
</li>
<li id="a0000000075"> <p>
<script type="math/tex">f</script> is composed of the sum of the functions <script type="math/tex">x^{2}=x\times x</script>, <script type="math/tex">y= x\times y</script> and 5. 
</p>
</li>
<li id="a0000000076"> <p>
We start with the obvious results that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}x=1, \qquad \lim _{(x,y)\to (1,0)}y=0</script></span></span> This means that the limits exist for the basic building blocks of the function. We can now try to apply Lemma <a class="ref" href="../../notes/course_notes/index.html#limit_properties">4.1</a> as follows. 
</p>
</li>
<li id="quot"> <p>
We can say: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}x^{2}=\lim _{(x,y)\to (1,0)}\left(x \times x\right) = \underbrace{\left(\lim _{(x,y)\to (1,0)}x\right)\times \left(\lim _{(x,y)\to (1,0)}x\right)}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=1\times 1 =1</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}xy=\lim _{(x,y)\to (1,0)}\left(x \times y\right) = \underbrace{\left(\lim _{(x,y)\to (1,0)}x\right)\times \left(\lim _{(x,y)\to (1,0)}y\right)}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=1\times 0 =0</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}5=5</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}(x^{2}+xy+5)=\underbrace{\lim _{(x,y)\to (1,0)}x^{2}+\lim _{(x,y)\to (1,0)}xy+\lim _{(x,y)\to (1,0)}5}_{\rm (i) \  of \  Lemma \  \ref{limit_ properties}}=1+0+6=6</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b>  Find the limit of <script type="math/tex">f(x,y)=\displaystyle {{3x}\over {x+4y}}</script> as <script type="math/tex">(x,y)</script> approaches <script type="math/tex">(1,1)</script>. 
</p>
<ul class="itemize" id="a0000000077">
<li id="a0000000078"> <p>
The domain contains the point <script type="math/tex">(x,y)=(1,1)</script>. 
</p>
</li>
<li id="a0000000079"> <p>
The locus of points where the function is not defined is the straight line <script type="math/tex">y=-x/4</script>. This line passes nowhere near the limit point. Hence, we then have neighbourhood of the limit point that is in the domain. 
</p>
</li>
<li id="a0000000080"> <p>
So the function is expected to exist at the limit point. We can now try to apply Lemma <a class="ref" href="../../notes/course_notes/index.html#limit_properties">4.1</a> as follows. 
</p>
</li>
<li id="a0000000081"> <p>
We obviously have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}x=1, \qquad \lim _{(x,y)\to (1,1)}y=1</script></span></span>
</p>
</li>
<li id="a0000000082"> <p>
Hence we can say: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}3x=\underbrace{3\times \lim _{(x,y)\to (1,1)}x}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=3\times 1 =3</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}x+4y=\underbrace{\lim _{(x,y)\to (1,1)}x+\lim _{(x,y)\to (1,1)}4y}_{\rm (i) \  of \  Lemma \  \ref{limit_ properties}}=1+\underbrace{4\times \lim _{(x,y)\to (1,1)}y}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=1+4=5\ne 0</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}\frac{3x}{x+4y}=\underbrace{\frac{\lim _{(x,y)\to (1,1)}{3x}}{\lim _{(x,y)\to (1,1)}x+4y}}_{\rm (iii) \  of \  Lemma \  \ref{limit_ properties}}=\frac{3}{5}</script></span></span>
</p>
</li>
</ul>
</section><section class="subsection">
<h3 id="a0000000083">2.4.3 Showing that limits do not exist</h3>
<p>
 Sometimes, you have to decide whether the limit exists or not. The following examples illustrate how the requirement that the <script type="math/tex">f(x,y)</script> approaches the same limit, no matter how the limit point is approached, is actually incredibly restrictive. 
</p>
<p>
<b class="bf">Example:</b> If <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\left\{ \begin{array}{cc}x^{2}/(x^{2}+y^{2}) &  (x,y)\ne 0 \\ 1 & (x,y)=0\end{array}\right.</script></span> </span> does <script type="math/tex">\lim _{(x,y)\to (0,0)}</script> exist? 
</p>
<ul class="itemize" id="a0000000084">
<li id="a0000000085"> <p>
The functional form <script type="math/tex">x^{2}/(x^{2}+y^{2})</script> is not defined when <script type="math/tex">(x,y)=(0,0)</script>, since it is of the form <script type="math/tex">0/0</script> (and we can’t use Lemma 2.4.1 part iii, since <script type="math/tex">M=0</script>). 
</p>
</li>
<li id="a0000000086"> <p>
However the function is <b class="bf">defined</b> to have the value 1 at the limit point. 
</p>
</li>
<li id="a0000000087"> <p>
Hence the function <script type="math/tex">f</script> <b class="bf">is</b> defined for the entire <script type="math/tex">(x,y)</script> plane, so it makes sense to ask if a limit exists. 
</p>
</li>
<li id="a0000000088"> <p>
The key thing we have to test is <b class="bf">whether the limit is the same regardless of how we approach the limit point</b>. We proceed as follows. 
</p>
</li>
<li id="a0000000089"> <p>
If we approach the limit point <script type="math/tex">(0,0)</script> along <script type="math/tex">y=0</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,0)=\frac{x^{2}}{x^{2}+0^{2}}=1 \qquad \Rightarrow \qquad \lim _{x\to 0}f(x,0)=1=f(0,0)</script></span> </span> This suggests that the limit may exist and be 1. However we need to check <b class="bf">every possible approach!</b>
</p>
</li>
<li id="a0000000090"> <p>
If we approach the limit point <script type="math/tex">(0,0)</script> along <script type="math/tex">x=0</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(0,y)=\frac{0^{2}}{0^{2}+y^{2}}=0 \qquad \Rightarrow \qquad \lim _{y\to 0}f(0,y)=0</script></span> </span>
</p>
</li>
<li id="a0000000091"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{y\to 0}f(0,y)\ne \lim _{x\to 0}f(x,0)</script></span> </span> and so the limit depends on how the limit point is approached, so the limit <b class="bf">is not unique</b> and so the limit <b class="bf">does not exist</b>! 
</p>
</li>
<li id="a0000000092"> <p>
In fact, consider an approach to the limit point at the origin along the straight lines <script type="math/tex">y=\alpha x</script>. Inserting this into the function we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,\alpha x)=\frac{x^{2}}{x^{2}+\alpha ^{2}x^{2}}=\frac{1}{1+\alpha ^{2}}, \qquad x\ne 0</script></span></span> Hence if we approach along <b class="bf">any</b> straight line, the limit will be different, and so does not exist. In practice it suffices to show that there is ambiguity between just two different ways of approaching. 
</p>
</li>
<li id="a0000000093"> <p>
A graph of the function is shown below, which helps to explain the ambiguity in the limit. Basically, the surface is vertical at the origin. Any curve you chose to take to walk towards the origin will therefore intersect at different heights, depending on how it enters the origin. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0030.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.16</span>
<span class="caption_text">Surface <script type="math/tex">z=f(x,y)=x^{2}/(x^{2}+y^{2})</script> (left). Values of function <script type="math/tex">f(x,\alpha x)</script> along the lines <script type="math/tex">y=\alpha x</script> (right), which take different values <script type="math/tex">\alpha ^{2}/(1+\alpha ^{2})</script> at the origin <script type="math/tex">(x,y)=(0,0)</script>, depending on the value of <script type="math/tex">\alpha </script>. </span>
</figcaption> </div>
</figure>
</li>
</ul>
<p>
This explains why the limit does not exist in this case. The definition of a limit above basically says that the value of a function must be unique at a point. Clearly in this case the function can take any value you like at <script type="math/tex">(x,y)=(0,0)</script> since it is vertical there. 
</p>
<p>
This next example shows the danger of relying on approaches to the limit point along straight lines to determine whether a limit exists or not. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\frac{2x^{2}y}{x^{4}+y^{2}}</script></span></span> Investigate the limiting behaviour as <script type="math/tex">(x,y)\to (0,0)</script>. We can’t use Lemma 2.4.1 since at the limit point we have <script type="math/tex">0/0</script>, i.e., <script type="math/tex">M=0</script>. 
</p>
<ul class="itemize" id="a0000000094">
<li id="a0000000095"> <p>
Suppose we consider the behaviour of the function along any path with <script type="math/tex">y=\alpha x</script>. We have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,\alpha x)=\frac{2x^{2}\alpha x}{x^{4}+\alpha ^{2}x^{2}}=\frac{2\alpha x^{3}}{x^{2}(x^{2}+\alpha ^{2})}=\frac{2\alpha x}{(x^{2}+\alpha ^{2})}</script></span></span> Hence approaching the limit point along any straight line (<script type="math/tex">\alpha \ne 0</script>) into the origin has <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{x\to 0}f(x,\alpha x)=\lim _{x\to 0}\frac{2\alpha x}{(x^{2}+\alpha ^{2})}=\frac{0}{\alpha ^{2}}=0</script></span></span>
</p>
</li>
<li id="a0000000096"> <p>
This suggests that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (0,0)}f(x,y)=0.</script></span></span>
</p>
</li>
<li id="a0000000097"> <p>
However, now consider approaching the limit point along the curve <script type="math/tex">y=x^{2}</script>. Then we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,x^{2})=\frac{2x^{2}\times x^{2}}{x^{4}+(x^{2})^{2}}=\frac{2x^{4}}{x^{4}(1+1)}=1.</script></span></span> Hence approaching the limit point along any <script type="math/tex">y=x^{2}</script> into the origin has <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{x\to 0}f(x,x^{2})=\lim _{x\to 0}1=1.</script></span></span>
</p>
</li>
<li id="a0000000098"> <p>
Hence there is not a unique limit! This underlines the fact that for the limit to exist formally, it must be the same, no matter how the limit point is approached (or how complicated the path you take to approach the limit point). 
</p>
</li>
<li id="a0000000099"> <p>
What is actually going on with the surface near to <script type="math/tex">(x,y)=(0,0)</script> is illustrated below. The surface is vertical at the origin, but folded around the curve <script type="math/tex">y=x^{2}</script>. 
</p>
</li>
</ul>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0032.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.17</span>
<span class="caption_text">3-D plot of <script type="math/tex">z=f(x,y)=2x^{2}y/(x^{4}+y^{2})</script>. If we approach the origin along, say <script type="math/tex">x=0</script>, <script type="math/tex">\lim _{x\rightarrow 0}f(0,y)=0</script>. However, if we approach the origin along the curve <script type="math/tex">y=x^{2}</script> we find <script type="math/tex">\lim _{x\rightarrow 0}f(x,x^{2})=1</script>. In fact if we approach the origin along any curve <script type="math/tex">y=\beta x^{2}</script>, we find <script type="math/tex">\lim _{x\rightarrow 0}f(x,\beta x^{2})=\lim _{x\rightarrow 0}2\beta x^{4}/(x^{4}+\beta ^{2}x^{4})=2 \beta /(1+\beta ^{2})</script>. There is no unique value of <script type="math/tex">f(x,y)</script> at the origin <script type="math/tex">(x,y)=(0,0)</script>, since the surface is vertical there.</span>
</figcaption> </div>
</figure>
<p>
Clearly finding contradictions based on the choice of path taken to approach a limit point is a way of <b class="bf">disproving</b> the existence of a limit.<a class="footnote" href="#a0000000100">
<sup class="footnotemark">3</sup>
</a>
</p>
</section><section class="subsection">
<h3 id="a0000000101">2.4.4 Continuity of multivariable functions</h3>
<p>
Having defined the concept of a limit, we may now define continuity in multivariable functions 
</p>
<p>
<b class="bf">Definition: (Continuity)</b> <span class="rm"><p>
The function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is said to be <i class="it">continuous at <script type="math/tex">(a, b)\in \mathbb R^2</script></i> if 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x, y)\to (a, b)}} f(x, y)=f(a, b).</script></span>
<p>
 If <script type="math/tex">f</script> is continuous at every point of a subset <script type="math/tex">D</script> of <script type="math/tex">\mathbb R^2</script>, then <script type="math/tex">f</script> is said to be <i class="it">continuous on <script type="math/tex">D</script></i>. If <script type="math/tex">D</script> is the whole domain, then <script type="math/tex">f</script> is simply said to be <i class="it">continuous</i>. 
</p>
<p>
It follows that sums and products of continuous functions are again continuous. That is, there are analogous statements to parts (i) and (ii) of Lemma <a class="ref" href="../../notes/course_notes/index.html#limit_properties">4.1</a> for continuity at a point. For quotients one needs to proceed with a bit of care as in part (iii) of Lemma <a class="ref" href="../../notes/course_notes/index.html#limit_properties">4.1</a>. 
</p>
<p>
Of the examples above, 
</p>
<ul class="itemize" id="a0000000102">
<li id="a0000000103"> <p>
<script type="math/tex">x^{2}+y^{2}+7</script> is continuous at <script type="math/tex">(0,0)</script> since the limit is the value of the function there. 
</p>
</li>
<li id="a0000000104"> <p>
<script type="math/tex">2x^{2}y/(x^{4}+y^{2})</script> is <b class="bf">not</b> continuous at <script type="math/tex">(0,0)</script> since its value at <script type="math/tex">(0,0)</script> is not unique. 
</p>
</li>
</ul>
</span>
</p>
</section>
</section><section class="section">
<h2 id="a0000000105">2.5 Partial Derivatives</h2>
<section class="subsection">
<h3 id="a0000000106">2.5.1 Definition of a Partial Derivative</h3>
<p>
 Given a curve <script type="math/tex">y = F(x)</script> we can work out the gradient (slope) of the curve at each point by differentiating <script type="math/tex">F</script>. The formal mathematical definition of a derivative of a function of one variable is 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\rm Slope} = \frac{dF}{dx}=\lim _{h\rightarrow 0}\left\{ \frac{F(x+h)-F(x)}{h}\right\}</script></span>
<p>
 For a smooth function with no kinks, this limit exists and is unique at each point <script type="math/tex">x</script>. There is only one unique slope at each point of a smooth curve. 
</p>
<p>
Now, suppose you are standing on a hill. What is the slope of the hill at that point? A little thought should tell you that it is not unique: It depends on the direction in which you are looking. 
</p>
<p>
For example, you could walk around the hill, on a level contour and keeping the same height. In that case the slope is zero in the direction you walk at each point. You could also aim for the summit, in which case you have to go uphill and the gradient will be far from zero! 
</p>
<p>
A hill can be represented as a function of two variables <script type="math/tex">z = f(x, y)</script> (see figure <a class="ref" href="../../notes/course_notes/index.html#3dplot123">2.17</a>) below. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0008.jpg" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.18</span>
<span class="caption_text">Plot of a multivariate function where the height of the function is <script type="math/tex">z=f(x,y)</script> and is given by <script type="math/tex">f(x,y)=\sin (x)+\sin (y)</script></span>
</figcaption> </div>
</figure>
<p>
Hence when we ask for the slope on a hill, this translates to asking: what is meant by the derivative of a multivariate function? 
</p>
<p>
The standard way to proceed is as follows. All but one of the variables (directions of walking on the hill) are kept constant and we differentiate with respect to the remaining one. Usually we pick two orthogonal directions and work out the slope in these directions. (You will learn in a later course how to find the slope in all other directions from these two). 
</p>
<p>
In two dimensions this corresponds to working out the slope looking at the slope either 
</p>
<ul class="itemize" id="a0000000107">
<li id="a0000000108"> <p>
in the <script type="math/tex">x</script> direction keeping <script type="math/tex">y</script>=constant, or 
</p>
</li>
<li id="a0000000109"> <p>
in the <script type="math/tex">y</script> direction keeping <script type="math/tex">x</script>=constant. 
</p>
</li>
</ul>
<p>
 As these derivatives only involve differentiation with respect to one of the possible variables, they are called <b class="bf">partial derivatives</b>. They are formally defined as follows: 
</p>
<p>
<b class="bf">Definition: (Partial Derivatives)</b> <span class="rm"><p>
For the function <script type="math/tex">z = f (x, y)</script>, the partial derivatives are defined as: 
</p>
<div id="a0000000110">
<script type="math/tex; mode=display">
\begin{align}
 {\rm Slope \  in \  } x {\rm \  direction \  } & =&  \left( \frac{\partial f}{\partial x}\right)_{y={\rm constant}} = \lim _{h\rightarrow 0} \left\{ \frac{f(x+h,y)-f(x,y)}{h}\right\}  \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
{\rm Slope \  in \  } y {\rm \  direction \  } & =&  \left( \frac{\partial f}{\partial y}\right)_{x={\rm constant}} = \lim _{k\rightarrow 0} \left\{ \frac{f(x,y+k)-f(x,y)}{k}\right\}  \nonumber 
\end{align}
</script>
</div>
<p>
 provided that these limits exist. 
</p>
<p>
<b class="bf">NB:</b> Note the curly <script type="math/tex">\partial </script> in the derivative, rather than the usual <script type="math/tex">d</script>. This is to denote that the derivative is of a <i class="it">multivariate</i> function and so is <i class="it">partial</i> with respect to only one of the variables, rather than with respect to all of them. It is <b class="bf">incorrect</b> to use an ordinary <script type="math/tex">d</script> in a partial derivative. Practice drawing the <script type="math/tex">\partial </script>!!! 
</p>
<p>
In practice you compute the partial derivatives in the same way as an ordinary derivative, treating all but the relevant variable as constants. Due to this, very similar rules exist for differentiating combinations of functions. 
</p>
</span>
</p>
</section><section class="subsection">
<h3 id="a0000000111">2.5.2 Partial Derivatives of Combinations of Functions</h3>
<p>
Partial derivatives of sums, products, quotients, compositions obey similar results derivatives involving single variables. 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="rules diff">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.1</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
 Let <script type="math/tex">f(x,y)</script> and <script type="math/tex">g(x,y)</script> be functions of two variables. 
</p>
<ol class="enumerate" id="a0000000112" style="list-style: none">
<li id="a0000000113" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> exists. Then for a constant <script type="math/tex">c\in {\mathbb R}</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x} (cf(x,y)) = c \left( \frac{\partial }{\partial x} f(x,y) \right) = c\frac{\partial f}{\partial x} (x,y),</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000114" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> and <script type="math/tex">\frac{\partial g}{\partial x} (x,y)</script> exist. Then 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x}(f(x,y) + g(x,y)) = \frac{\partial f}{\partial x} (x,y) + \frac{\partial g}{\partial x} (x,y),</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000115" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> and <script type="math/tex">\frac{\partial g}{\partial x} (x,y)</script> exist. For two functions <script type="math/tex">f(x,y)</script> and <script type="math/tex">g(x,y)</script>, we have the product rule: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x} (f(x,y) g(x,y)) = \left( \frac{\partial f}{\partial x} (x,y) \right) g(x,y) + f(x,y) \left( \frac{\partial g}{\partial x} (x,y) \right),</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000116" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> and <script type="math/tex">\frac{\partial g}{\partial x} (x,y)</script> exist. For two functions <script type="math/tex">f(x,y)</script> and <script type="math/tex">g(x,y)</script>, we have the quotient rule: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x} \left( \frac{f(x,y)}{g(x,y)} \right) = \frac{\left( \frac{\partial f}{\partial x} (x,y) \right) g(x,y) - f(x,y) \left( \frac{\partial g}{\partial x} (x,y) \right)}{(g(x,y))^2},</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000117">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We only prove part (i) to show that the proofs are analogous to those when the function has only one variable. Proofs for this lemma are <b class="bf">not</b> required. 
</p>
<span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial }{\partial x} (cf(x,y)) & = \lim _{h\rightarrow 0} \frac{cf(x+h,y) - cf(x,y)}{h} \\ & =c\left(\lim _{h\rightarrow 0} \frac{f(x+h,y) - f(x,y)}{h}\right) \\ & = c\left(\frac{\partial f}{\partial x} (x,y) \right). \end{align*}</script></span>
</div>
</div>
<p>
<b class="bf">Example:</b> <script type="math/tex">f(x,y)=x^{2}-1+y+\sin ({xy})</script>: <span style="color:#FF0000"><div id="a0000000118">
<script type="math/tex; mode=display">
\begin{align}
 \frac{\partial f}{\partial x}& =& \frac{\partial }{\partial x}\left( x^{2}\right)-\frac{\partial }{\partial x}\left( 1\right)+\frac{\partial }{\partial x}\left( y\right)+\frac{\partial }{\partial x} \left( \sin (xy)\right)=2x-0+0+y\cos (xy)=2x+y\cos (xy). \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial f}{\partial y}& =& \frac{\partial }{\partial y}\left( x^{2}\right)-\frac{\partial }{\partial y}\left( 1\right)+\frac{\partial }{\partial y}\left( y\right)+\frac{\partial }{\partial y} \left( \sin (xy)\right)=0-0+1+x\cos (xy)=1+x\cos (xy). 
\end{align}
</script>
</div></span>
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Find the partial derivatives of 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y) = \cos (x) \sin (y) + y\exp (x).</script></span>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}(x,y) = \left( \frac{\rm d}{{\rm d}x} \cos (x) \right) \sin (y) + y\left( \frac{\rm d}{{\rm d}x} \exp (x) \right) = -\sin (x)\sin (y) + y\exp (x).</script></span></span>
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial y}(x,y) = \cos (x) \left( \frac{\rm d}{{\rm d}y} \sin (y) \right)+ \left( \frac{\rm d}{{\rm d}y} y \right)\exp (x) = \cos (x)\cos (y) + \exp (x).</script></span></span>
</p>
<p>
<b class="bf">Example:</b> Find the partial derivatives of 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y) =\frac{\cos y}{x}.</script></span>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}(x,y) = \frac{x \frac{\partial }{\partial x}\left( \cos (y) \right)-\cos (y) \frac{\partial }{\partial x} \left( x\right)}{x^{2}}=\frac{x \times 0-\cos (y) \times 1}{x^{2}}=\frac{-\cos (y)}{x^{2}}.</script></span></span>
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial y}(x,y) = \frac{x \frac{\partial }{\partial y}\left( \cos (y) \right)-\cos (y) \frac{\partial }{\partial y} \left( x\right)}{x^{2}}=\frac{x \times (-\sin y)-\cos (y) \times 0}{x^{2}}=\frac{-\sin (y)}{x}.</script></span></span>
</p>
</section><section class="subsection">
<h3 id="a0000000119">2.5.3 Alternative Notation for Partial Derivatives</h3>
<p>
When a partial derivative of a function <script type="math/tex">z=f(x,y)</script> is evaluated at a point <script type="math/tex">(x, y) = (a,b)</script>, then you often see the following equivalent notation: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left.\frac{\partial z}{\partial x}\right|_{(a,b)} \qquad {\rm or} \qquad \left. \left(\frac{\partial }{\partial x}f(x,y)\right)\right|_{(a,b)} \qquad {\rm or} \qquad \partial _{x}f(x,y)|_{(a,b)} \qquad {\rm or} \qquad z_{x}(a,b)</script></span>
<p>
 for the <script type="math/tex">x</script>-partial derivatives and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left.\frac{\partial z}{\partial y}\right|_{(a,b)} \qquad {\rm or} \qquad \left. \left(\frac{\partial }{\partial y}f(x,y)\right)\right|_{(a,b)} \qquad {\rm or} \qquad \partial _{y}f(x,y)|_{(a,b)} \qquad {\rm or} \qquad z_{y}(a,b)</script></span>
<p>
 for the <script type="math/tex">y</script>-partial derivatives. 
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
For the function <script type="math/tex">f(x,y)=x^{2}-1+y+\sin ({xy})</script>, calculate the slope in the <script type="math/tex">x</script>-direction and <script type="math/tex">y</script>-direction at the point <script type="math/tex">(x,y)=(1,2)</script>. <span style="color:#FF0000"><div id="a0000000120">
<script type="math/tex; mode=display">
\begin{align}
 \left.\frac{\partial f}{\partial x}\right|_{(1,2)}& =& \left.2x+y\cos (xy)\right|_{(x,y)=(1,2)}=2+2\cos (2)=2(1+\cos 2). \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \left.\frac{\partial f}{\partial y}\right|_{(1,2)}& =& \left.1+x\cos (xy)\right|_{(x,y)=(1,2)}=1+\cos (2). 
\end{align}
</script>
</div></span>
</p>
</span>
</p>
</section><section class="subsection">
<h3 id="a0000000121">2.5.4 Partial Derivatives in Higher Dimensions</h3>
<p>
Partial derivatives in higher dimensions are defined as follows. 
</p>
<p>
<b class="bf">Definition:</b> For a function <script type="math/tex">f: {\mathbb R}^ n\rightarrow {\mathbb R}</script> given by <script type="math/tex">f(x_1,\ldots , x_ n)</script>, we have <script type="math/tex">n</script> first order partial derivatives, one with respect to each variable <script type="math/tex">x_1,\ldots , x_ n</script>, is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n)= \lim _{h\rightarrow 0} \left[ \frac{f(x_1,\ldots , x_{j-1}, x_ j + h, x_{j+1}, \ldots , x_ n) - f(x_1,\ldots , x_ n)}{h}\right].</script></span>
<p>
 provided the limit exists. 
</p>
<p>
We don’t normally use the definition to evaluate the partial derivatives of particular functions, any more than we use the definition for a function of one variable to calculate the derivative of that function. 
</p>
<p>
For combinations of functions in higher dimensions, the following lemma, analogous to Lemma 2.5.1, holds: 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="a0000000122">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.2</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
Let <script type="math/tex">f(x_1,\ldots , x_ n)</script> and <script type="math/tex">g(x_1,\ldots , x_ n)</script> be functions of <script type="math/tex">n</script>-variables. Then 
</p>
<ol class="enumerate" id="a0000000123" style="list-style: none">
<li id="a0000000124" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
For a constant <script type="math/tex">c\in {\mathbb R}</script> and for each <script type="math/tex">1\le j\le n</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x_ j} (cf(x_1,\ldots , x_ n)) = c\frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n);</script></span>
</li>
<li id="a0000000125" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
The derivative of a sum is the sum of the derivatives, namely 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x_ j} (f(x_1,\ldots , x_ n) + g(x_1,\ldots , x_ n)) = \frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n) + \frac{\partial g}{\partial x_ j} (x_1,\ldots , x_ n)</script></span>
<p>
 for each <script type="math/tex">1\le j\le n</script>; 
</p>
</li>
<li id="a0000000126" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
We have the product rule: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \lefteqn{\frac{\partial }{\partial x_ j} (f(x_1,\ldots , x_ n) g(x_1,\ldots , x_ n))} \\ &  = &  \left( \frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n) \right) g(x_1,\ldots , x_ n) + f(x_1,\ldots , x_ n) \left( \frac{\partial g}{\partial x_ j} (x_1,\ldots , x_ n) \right) \end{eqnarray*}</script></span>
<p>
 for each <script type="math/tex">1\le j\le n</script>; 
</p>
</li>
<li id="a0000000127" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
We have the quotient rule: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x_ j} \left( \frac{f(x_1,\ldots , x_ n)}{g(x_1,\ldots , x_ n)} \right)</script></span>
<span class="dmath"><script type="math/tex; mode=display">= \frac{\left( \frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n) \right) g(x_1,\ldots , x_ n) - f(x_1,\ldots , x_ n) \left( \frac{\partial g}{\partial x_ j} (x_1,\ldots , x_ n) \right)}{(g(x_1,\ldots , x_ n))^2}</script></span>
<p>
 for each <script type="math/tex">1\le j\le n</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
Really the only difference between this and the lemma for 2 variables (above), is the number of variables in the arguments of the function, and you remember that you treat all the variables as constants, except the one you are differentiating with respect to. 
</p>
<p>
<b class="bf">Example:</b> Find all the partial derivatives of the function 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y,z)=5x^3y^2z-y^2z^2+3x-4</script></span>
<p>
 at <script type="math/tex">(-1,0,2)</script>. 
</p>
<p>
Recall that when we differentiate with respect to <script type="math/tex">x</script>, we treat all other variables as constants and then differentiate normally. So, to calculate <script type="math/tex">\frac{\partial f}{\partial x}</script>, we treat <script type="math/tex">y</script> and <script type="math/tex">z</script> as constants and see that 
</p>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial f}{\partial x} (x,y,z) & = 5\frac{\partial }{\partial x}(x^3y^2z)-\frac{\partial }{\partial x}(y^2z^2)+3\frac{\partial }{\partial x}(x)-\frac{\partial }{\partial x}(4)\\ & =15x^2y^2z + 3.\\ \end{align*}</script></span></span> Similarly, to calculate <script type="math/tex">\frac{\partial f}{\partial y}</script>, we treat <script type="math/tex">x</script> and <script type="math/tex">z</script> as constants and see that <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial f}{\partial y} (x,y,z) & = 5\frac{\partial }{\partial y}(x^3y^2z)-\frac{\partial }{\partial y}(y^2z^2)+3\frac{\partial }{\partial y}(x)-\frac{\partial }{\partial y}(4)\\ & =10x^3y z -2yz^2.\\ \end{align*}</script></span></span> Similarly, to calculate <script type="math/tex">\frac{\partial f}{\partial y}</script>, we treat <script type="math/tex">x</script> and <script type="math/tex">y</script> as constants and see that <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial f}{\partial z} (x,y,z) & = 5\frac{\partial }{\partial z}(x^3y^2z)-\frac{\partial }{\partial z}(y^2z^2)+3\frac{\partial }{\partial z}(x)-\frac{\partial }{\partial z}(4)\\ & =5x^3y^2 - 2y^2z. \end{align*}</script></span></span> Then <script type="math/tex">\frac{\partial f}{\partial x} (-1,0,2)=3</script>, <script type="math/tex">\frac{\partial f}{\partial y} (-1,0,2)=0</script>, and <script type="math/tex">\frac{\partial f}{\partial z} (-1,0,2)=0</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000128">2.5.5 Chain rule</h3>
<p>
Recall that in the single variable case, if we were given a function <script type="math/tex">z = z(x)</script> where <script type="math/tex">x = x(t)</script>, then we could express the derivative of the composite function <script type="math/tex">z = z(x(t))</script> with respect to <script type="math/tex">t</script> using the chain rule: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dt} = \lim _{h\rightarrow 0} \frac{z(x(t+h)) - z(x(t))}{h}= \lim _{h\rightarrow 0} \left( \frac{z(x(t+h)) - z(x(t))}{x(t+h)-x(t)}\right)\left(\frac{x(t+h) - x(t)}{h}\right)=\frac{dz}{dx}\frac{dx}{dt}.</script></span></span>
</p>
<p>
(This follows from the formula for the product of individually well-defined limits.) 
</p>
<p>
What is the analogous situation for multivariable functions? We can illustrate this with a definite example. 
</p>
<p>
<b class="bf">Example:</b> Suppose you are walking in a mountainous region with a map. Your horizontal coordinates on the map are given by <script type="math/tex">(x,y)</script> and your vertical height above sea level is <script type="math/tex">z=f(x,y)</script>. 
</p>
<p>
Now suppose you take a path so that your horizontal coordinates are given at time <script type="math/tex">t</script> by <script type="math/tex">(x,y)=(x(t),y(t))</script>. Your height at time <script type="math/tex">t</script> is then given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x(t),y(t)).</script></span>
<p>
So it is possible to now express <script type="math/tex">z</script> as a function of <script type="math/tex">t</script> only, i.e., <script type="math/tex">z=z(t)</script>. The question we pose is, give this, how fast is your height changing with time, i.e., what is <script type="math/tex">dz/dt</script>? <a class="footnote" href="#a0000000129">
<sup class="footnotemark">4</sup>
</a>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0034.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.19</span>
<span class="caption_text">A schematic representation of the motion of a point on the surface <script type="math/tex">z=f(x,y)</script> that is given when we allow the coordinates of the point <script type="math/tex">(x,y,z)</script> to depend on an additional variable <script type="math/tex">t</script> so that the <script type="math/tex">x</script> coordinate moves as <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script>. The chain rule can then b used to calculate how the rate of change of <script type="math/tex">z</script> with respect to <script type="math/tex">t</script> may be expressed. For example if <script type="math/tex">t</script> is time, then <script type="math/tex">dz/dt</script> gives the vertical speed. </span>
</figcaption> </div>
</figure>
<p>
The solution is obtained by a series of careful steps. 
</p>
<p>
If we treat <script type="math/tex">z</script> as a function of just <script type="math/tex">t</script> we can write down the defintion of <script type="math/tex">dz/dt</script> as 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  {\frac{{\rm d} z}{{\rm d}t}} &  = &  \lim _{h\rightarrow 0} \frac{z(t+h) - z(t)}{h} \\ &  = &  \lim _{h\rightarrow 0} \frac{z(x(t+h), y(t+h)) - z(x(t), y(t))}{h} \\ &  = & \lim _{h\rightarrow 0} \frac{z(x(t+h), y(t+h)) +\left[- z(x(t), y(t+h)+z(x(t), y(t+h))\right]- z(x(t), y(t))}{h}\\ &  = &  \lim _{h\rightarrow 0} \frac{z(x(t+h), y(t+h)) - z(x(t), y(t+h))}{h}+ \lim _{h\rightarrow 0} \frac{z(x(t), y(t+h)) - z(x(t), y(t))}{h} \\ &  = &  \frac{\partial z}{\partial x} (x(t), y(t)) \:  \frac{{\rm d}x}{{\rm d}t} (t)+ \frac{\partial z}{\partial y} (x(t), y(t))\:  \frac{{\rm d}y}{{\rm d}t}(t). \end{eqnarray*}</script></span>
<p>
The last line follows by comparison with the 1-d chain rule above. 
</p>
<p>
Of course the result we have derived here is general and not dependent on the mountain walk context. 
</p>
<p>
So, the Chain Rule says that if <script type="math/tex">z=f(x,y)</script> and <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script> for differentiable <script type="math/tex">f, x</script> and <script type="math/tex">y</script>, and we compose the functions as <script type="math/tex">\mathbb R_{(t)}\to \mathbb R^2_{(x,y)}\to \mathbb R_{(z)}</script>, we have the following result: 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="a0000000130">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.3</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
If <script type="math/tex">z=z(x,y)</script> and <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script> for differentiable <script type="math/tex">f, x</script> and <script type="math/tex">y</script>, we have 
</p>
<div class="eqn" id="a0000000131">
<script type="math/tex; mode=display">\begin{equation}\boxed {{\frac{{\rm d} z}{{\rm d}t} = \frac{\partial z}{\partial x} \:  \frac{{\rm d}x}{{\rm d}t} + \frac{\partial z}{\partial y} \:  \frac{{\rm d}y}{{\rm d}t} .}}\tag{2.1}\end{equation}</script>
</div>
</div>
</div>
</p>
<p>
<b class="bf">Example:</b> Let <script type="math/tex">z=\sin (x+y^2)</script>, and <script type="math/tex">x=t^2</script>, <script type="math/tex">y=e^ t</script>. What is <script type="math/tex">dz/dt</script>? 
</p>
<p>
We have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dx}{dt}=2t, \qquad \frac{dy}{dt}=e^ t</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=\cos (x+y^2), \qquad \frac{\partial z}{\partial y}=2y\cos (x+y^2)</script></span></span>
</p>
<p>
Hence 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dt}= \frac{\partial z}{\partial x} \:  \frac{{\rm d}x}{{\rm d}t} + \frac{\partial z}{\partial y} \:  \frac{{\rm d}y}{{\rm d}t}= 2t\cos (x+y^2)+2ye^ t\cos (x+y^2)=\cos (t^2+e^{2t})\left(2t+2e^{2t}\right)</script></span></span>
</p>
<p>
Note that the last result could have been obtained by directly substituting first for <script type="math/tex">x=t^2</script> and <script type="math/tex">y=e^ t</script> to get <script type="math/tex">z(t)=\sin (t^2+e^ t)</script> and then differentiating <script type="math/tex">z</script> as a simple 1-d function with respect to <script type="math/tex">t</script>. 
</p>
<p>
So in this type of problem we see that <script type="math/tex">x</script> and <script type="math/tex">y</script> are <b class="bf">intermediate variables</b> and <script type="math/tex">t</script> is the actual independent variable. 
</p>
<p>
Suppose now that we have a composition <script type="math/tex">\mathbb R_{(s,t)}^{2}\to \mathbb R^2_{(x,y)}\to \mathbb R_{(z)}</script>, i.e., we have a function <script type="math/tex">z=f(x,y)</script>, but that we have intermediate variable <script type="math/tex">x=x(s,t)</script> and <script type="math/tex">y=y(s,t)</script> with the independent variables being now <script type="math/tex">s</script> and <script type="math/tex">t</script>, so that 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x(s,t),y(s,t))=z(s,t).</script></span>
<p>
The function <script type="math/tex">z</script> is now a multivariable function, depending on two indepdendent variables <script type="math/tex">s</script> and <script type="math/tex">t</script>. The derivatives of <script type="math/tex">z</script> with respect to <script type="math/tex">s</script> and <script type="math/tex">t</script> will now be partials. Hence the analogous chain rule questions to ask now is what are <script type="math/tex">\partial z/\partial s</script> and <script type="math/tex">\partial z/\partial t</script>? 
</p>
<p>
A derivation of the chain rule (not required) delivers the following results: 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="a0000000132">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.4</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
If <script type="math/tex">z=z(x,y)</script> and <script type="math/tex">x=x(s,t)</script> and <script type="math/tex">y=y(s,t)</script> for differentiable <script type="math/tex">f, x</script> and <script type="math/tex">y</script>, we have 
</p>
<div class="eqn" id="eq_221">
<script type="math/tex; mode=display">\begin{equation}\label{eq_221}\boxed { {\frac{\partial z}{\partial s} = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial s} + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial s}} \mbox{ \; \; \; \;  and \; \; \; \; } { \frac{\partial z}{\partial t} = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial t} + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial t} .}}\tag{2.2}\end{equation}</script>
</div>
</div>
</div>
</p>
<p>
<b class="bf">Example:</b> Consider the functions: 
</p>
<span class="dmath"><script type="math/tex; mode=display">z(x,y)=xe^{y},</script></span>
<p>
 with 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=s+3t, \qquad y=s-2t.</script></span>
<ul class="itemize" id="a0000000133">
<li id="a0000000134"> <p>
We have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=e^{y}, \qquad \frac{\partial z}{\partial y}=xe^{y},</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial x}{\partial s}=1, \qquad \frac{\partial x}{\partial t}=3, \qquad \frac{\partial y}{\partial s}=1, \qquad \frac{\partial y}{\partial t}=-2.</script></span></span>
</p>
</li>
<li id="a0000000135"> <p>
Hence the chain rule becomes: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial z}{\partial s}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial s}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial s}\\ & =& \frac{\partial z}{\partial x}+\frac{\partial z}{\partial y}=e^{y}+xe^{y}=e^{y}(1+x)\\ & =& e^{s-2t}(1+s+3t); \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000136"> <p>
and <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial z}{\partial t}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial t}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial t}\\ & =& 3\frac{\partial z}{\partial x}-2\frac{\partial z}{\partial y}=3e^{y}-2xe^{y}=e^{y}(3-2x)\\ & =& e^{s-2t}(3-2s-6t). \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Transformation to polar coordinates. Let <script type="math/tex">z=z(x,y)</script> where <script type="math/tex">x=r\cos \theta </script> and <script type="math/tex">y=r\sin \theta </script>. Find <script type="math/tex">\partial z/\partial r</script> and <script type="math/tex">\partial z/ \partial \theta </script>. 
</p>
<p>
We can use the chain rule from equation (<a class="ref" href="../../notes/course_notes/index.html#eq_221">2.2</a>) with <script type="math/tex">s=r</script> and <script type="math/tex">t=\theta </script>. Then we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial r} = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial r} + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial r}</script></span></span> and <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial \theta } = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial \theta } + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial \theta }</script></span></span> But <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial x}{\partial r}=\cos \theta \qquad \frac{\partial y}{\partial r}=\sin \theta</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial x}{\partial \theta }=-r\sin \theta \qquad \frac{\partial y}{\partial \theta }=r\cos \theta</script></span></span> Hence the <script type="math/tex">r</script> and <script type="math/tex">\theta </script> partial derivatives of <script type="math/tex">z</script> may be expressed in terms of the <script type="math/tex">x</script> and <script type="math/tex">y</script> partial derivatives of <script type="math/tex">z</script> as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial r} = \frac{\partial z}{\partial x}\:  \cos \theta + \frac{\partial z}{\partial y}\:  \sin \theta</script></span></span> and <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial \theta } = -\frac{\partial z}{\partial x}\:  r\sin \theta + \frac{\partial z}{\partial y}\:  r\cos \theta</script></span></span>
</p>
<p>
<b class="bf">Note:</b> A convenient way to express the chain rule (<a class="ref" href="../../notes/course_notes/index.html#eq_221">2.2</a>), that will be useful later, is to recognise that it can be written as a matrix multiplication: 
</p>
<div class="eqn" id="a0000000137">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial z}{\partial s} &  \dfrac {\partial z}{\partial t}\end{array}\right)=\left(\begin{array}{cc}\dfrac {\partial z}{\partial x} &  \dfrac {\partial z}{\partial y}\end{array}\right)\left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right)\tag{2.3}\end{equation}</script>
</div>
</section><section class="subsection">
<h3 id="a0000000138">2.5.6 Graphical Way to Work out the Chain Rule</h3>
<p>
There is a simplified graphical way to remember the chain rules for arbitrary compositions <script type="math/tex">\mathbb R_{(t_1,t_2, \dots t_ m)}\to \mathbb R_{(x_1, x_2, \dots ,x_ n)} \dots \to \mathbb R_{(z)}</script>. For the cases studied above we can construct a chart of chain links that indicates how all the variables depend on one another. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> When <script type="math/tex">z=z(x,y)</script> and <script type="math/tex">x=x(t)</script>, <script type="math/tex">y=y(t)</script> we have: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0036.png" style="width:198.74249999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.20</span>
<span class="caption_text">Chain rule for <script type="math/tex">z=z(x,y)</script>, when <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script>.</span>
</figcaption> </div>
</figure>
<p>
 The rules are simple: 
</p>
<ul class="itemize" id="a0000000139">
<li id="a0000000140"> <p>
Each link in the chain is a partial derivative. 
</p>
</li>
<li id="a0000000141"> <p>
Successive links on a particular chain are multiplied. 
</p>
</li>
<li id="a0000000142"> <p>
Overall contributions from each chain are added. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> <script type="math/tex">z=z(x,y)=x^{2}y+y^{3}</script> with <script type="math/tex">y=\cos x</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0038.png" style="width:191.51549999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.21</span>
<span class="caption_text">Chain rule for <script type="math/tex">z=z(x,y)</script>, when <script type="math/tex">y=y(x)</script></span>
</figcaption> </div>
</figure>
<p>
 Note that on substituting <script type="math/tex">y=\cos x</script> into <script type="math/tex">z=f(x,y)</script> we end up with <script type="math/tex">z=f(x,\cos x)=z(x)</script> only. In other words, if we make the substitution for <script type="math/tex">y</script> in the first place, we find that <script type="math/tex">z</script> is just a function of a single variable <script type="math/tex">x</script>. Hence the final derivative we seek using the chain rule will just be a total derivative <script type="math/tex">dz/dx</script>. 
</p>
<p>
However, if we just use the chain rule, on the way we do need to differentiate with respect to each of the <script type="math/tex">x</script> and <script type="math/tex">y</script> variables partially. Hence we will see <script type="math/tex">\partial z/\partial x</script> appear within the chain rule: this just means that we must differentiate with respect to the first of the original variables <script type="math/tex">x</script>, keeping the other one, <script type="math/tex">y</script>, as a constant. However since <script type="math/tex">y=y(x)</script> only, any derivatives of <script type="math/tex">y</script> with respect to <script type="math/tex">x</script> will also be total and so we can expect <script type="math/tex">dy/dx</script> to appear too. 
</p>
<p>
Hence, when we apply the diagram to derive the chain rule, we find: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dx}=\frac{\partial z}{\partial x}+\frac{\partial z}{\partial y}\frac{dy}{dx}.</script></span>
<p>
 Thus we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=2xy, \qquad \frac{\partial z}{\partial y}=x^{2}+3y^{2}.</script></span>
<p>
 We also have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=-\sin x.</script></span>
<p>
 So 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dx}=\frac{\partial z}{\partial x}+\frac{\partial z}{\partial y}\frac{dy}{dx}=2xy(x)+\left(x^{2}+3y(x)^{2}\right)\left(-\sin x\right)=2x\cos x-\left(x^{2}+3\cos ^{2}x\right)\sin x.</script></span>
<p>
<b class="bf">Exercise 4 U: </b> Check that if you do make the substitution <script type="math/tex">y=\cos x</script> and then differentiate <script type="math/tex">z(x)=f(x,\cos x)</script> with respect to <script type="math/tex">x</script>, that you obtain the same answer as above. 
</p>
<p>
<b class="bf">Example:</b> Suppose we have <script type="math/tex">z=z(x,y)</script>, but <script type="math/tex">x=x(s,t,u)</script> but <script type="math/tex">y=y(s,u)</script> only, and <script type="math/tex">u=u(v</script>). We can represent the functional relationships using the chain diagram below: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0040.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.22</span>
<span class="caption_text">Chain rule for <script type="math/tex">z=z(x,y)</script>, when <script type="math/tex">x=x(s,t,u)</script> and <script type="math/tex">y=y(s,u)</script>.</span>
</figcaption> </div>
</figure>
<p>
Hence following the above shortcut rules, it is easy to see that ultimately <script type="math/tex">z=z(s,t,v)</script> and that. <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial z}{\partial s}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial s}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial s} \\[12 pt] \frac{\partial z}{\partial t}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial t} \\[12 pt] \frac{\partial z}{\partial v}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial u}\frac{\partial u}{\partial v}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial u}\frac{\partial u}{\partial v} \end{eqnarray*}</script></span></span>
</p>
</section><section class="subsection">
<h3 id="constant derivatives">2.5.7 Integration of Partial Derivatives</h3>
<p>
When we integrate an ordinary derivative, from the Fundamental Theorem of Calculus we have: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int \frac{dy}{dx}dx=y(x)+C,</script></span>
<p>
 where <script type="math/tex">C</script> is an arbitrary constant. This is because 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{d}{dx}\left(y(x)+C\right)=\frac{dy}{dx},</script></span>
<p>
 i.e., the derivative of the constant with respect to <script type="math/tex">x</script> is zero. 
</p>
<p>
When we integrate a partial derivative, we get something similar, but the role of the constant is taken by an arbitrary function of the variable(s) which has (have) been held constant in the partial differentiation. Consider a function <script type="math/tex">z(x,y)</script> which has partial derivatives: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}dx=z(x,y)+g(y),</script></span>
<p>
 where <script type="math/tex">g(y)</script> is an arbitrary function of <script type="math/tex">y</script>. This is because, when we differentiate the right hand side, <script type="math/tex">z(x,y)+g(y)</script>, partially with respect to <script type="math/tex">x</script>, keeping <script type="math/tex">y</script> constant, any arbitrary function of <script type="math/tex">y</script> has a zero partial derivative with respect to <script type="math/tex">x</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial }{\partial x}\left(z(x,y)+g(y)\right)\right)_{y={\rm const}}=\left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}+0=\left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}.</script></span>
<p>
Similarly we have: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}dy=z(x,y)+f(x),</script></span>
<p>
 where <script type="math/tex">f(x)</script> is an arbitrary function of <script type="math/tex">x</script>. This is because, when we differentiate the right hand side, <script type="math/tex">z(x,y)+f(x)</script>, partially with respect to <script type="math/tex">y</script>, keeping <script type="math/tex">x</script> constant, any arbitrary function of <script type="math/tex">x</script> has a zero partial derivative with respect to <script type="math/tex">y</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial }{\partial y}\left(z(x,y)+f(x)\right)\right)_{x={\rm const}}=\left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}+0=\left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}.</script></span>
<p>
Note that when we are given two partial derivatives of the same function <script type="math/tex">z</script> we can integrate both derivatives separately as above with respect to the relevant variable to obtain two apparently different representations for <script type="math/tex">z</script>. The resolution of this paradox is that by exploit the arbitrary nature of the functions <script type="math/tex">g(y)</script> and <script type="math/tex">f(x)</script> to “pattern match” the two expressions <script type="math/tex">z(x,y)+g(y)</script> and <script type="math/tex">z(x,y)+f(x)</script> to obtain identical expressions for both integrals: 
</p>
<p>
<b class="bf">Example:</b> Suppose you are <b class="bf">given</b> that a function <script type="math/tex">z(x,y)</script> exists such that 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}=2x+2y, \qquad \left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}=3y^{2}+2x.</script></span></span>
</p>
<p>
Then we have, respectively: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}dx=x^{2}+2xy+g(y),</script></span></span>
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}dy=y^{3}+2xy+f(x).</script></span></span>
</p>
<p>
Given that we are told that <script type="math/tex">z(x,y)</script> exists, both of these expressions should be the same. Clearly both have a <script type="math/tex">2xy</script>, but otherwise they look different. However, a careful term-by-term comparison shows that can be made the same if we match up using the arbitrary functions as: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x)=x^{2}+C, \qquad g(y)=y^{3}+C,</script></span></span>
</p>
<p>
where <script type="math/tex">C</script> is an arbitrary constant. Note that the arbitrariness of the the constant <script type="math/tex">C</script> maintains the arbitrariness of <script type="math/tex">g</script> and <script type="math/tex">f</script>. Whence we have a single expression for <script type="math/tex">z(x,y)</script>, unique up to arbitrary constants (as in the single variable integration case): 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z(x,y)=x^{2}+y^{3}+2xy+C.</script></span></span>
</p>
<p>
You can check for yourselves that if you differentiate this function <script type="math/tex">z(x,y)</script> partially with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script> independently that you cover the partial derivatives that you started off with above. 
</p>
<p>
We can use integration of partial derivatives to arrive at the following neat result: 
</p>
<p>
 Let <script type="math/tex">u(x,y)</script> be a function of the variables <script type="math/tex">x</script> and <script type="math/tex">y</script>, and assume that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial u}{\partial x} (x,y) = \frac{\partial u}{\partial y} (x,y) = 0</script></span>
<p>
 for all <script type="math/tex">(x,y)\in {\mathbb R}^2</script>. Then, <script type="math/tex">u(x,y)</script> is constant on <script type="math/tex">{\mathbb R}^2</script>.   
</p>
<div class="proof_wrapper" id="a0000000143">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We start from the assumption that <script type="math/tex">\frac{\partial u}{\partial x} (x,y) = 0</script> for all <script type="math/tex">(x,y)\in {\mathbb R}^2</script> (i.e., everywhere and not just at a point). 
</p>
<ul class="itemize" id="a0000000144">
<li id="a0000000145"> <p>
Integrating with respect to <script type="math/tex">x</script>, we see that <script type="math/tex">u(x,y) =g(y)</script>, since (from the way integration works above) the constant of integration with respect to <script type="math/tex">x</script> must depend only on <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000146"> <p>
Using now the assumption that <script type="math/tex">\frac{\partial u}{\partial y} (x,y)=0</script> everywhere, this means that <script type="math/tex">\frac{\partial u}{\partial y} (x,y)=g'(y)=0</script> everywhere. 
</p>
</li>
<li id="a0000000147"> <p>
Hence, integrating <script type="math/tex">g'(y)=0</script> with respect to <script type="math/tex">y</script>, since <script type="math/tex">g'(y)</script> is just a function of <script type="math/tex">y</script>, the ordinary 1-D rules of integration apply. Hence <script type="math/tex">g(y)</script>=constant everywhere, and hence that <script type="math/tex">u(x,y)</script> must be constant everywhere. 
</p>
</li>
</ul>
</div>
</div>
</section><section class="subsection">
<h3 id="a0000000148">2.5.8 Example of Use of Chain Rule: First Order PDEs</h3>
<p>
The chain rule is used in the solution of first order exact ordinary differential equations. Chain rules are also useful in the solution of partial differential equations (PDE) by converting the equations form something complicated when expressed in one set of variables, to something simpler to solve in another set. 
</p>
<p>
<b class="bf">Example:</b> Suppose you are looking for a solution to the first order PDE:<a class="footnote" href="#a0000000149">
<sup class="footnotemark">5</sup>
</a>
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial t}+c\frac{\partial z}{\partial x}=0,</script></span>
<p>
 where <script type="math/tex">c</script> is a constant. 
</p>
<p>
Suppose (Rabbit!) the we make a change of variable 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\xi =x-ct, \qquad \eta =x+ct</script></span></span>
</p>
<p>
so that <script type="math/tex">z(x,t)=z(x(\xi ,\eta ),t(\xi ,\eta ))=z(\xi ,\eta ).</script> We can use the chain rule to rewrite the partial derivatives with respect to <script type="math/tex">x</script> and <script type="math/tex">t</script> in the following form, 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial t}=\frac{\partial \xi }{\partial t}\frac{\partial z}{\partial \xi }+\frac{\partial \eta }{\partial t}\frac{\partial z}{\partial \eta }= -c\frac{d z}{d\xi }+c\frac{d z}{d\eta },</script></span></span>
</p>
<p>
and 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=\frac{\partial \xi }{\partial x}\frac{\partial z}{\partial \xi }+\frac{\partial \eta }{\partial x}\frac{\partial z}{\partial \eta }= \frac{\partial z}{\partial \xi }+\frac{\partial z}{\partial \eta }.</script></span></span>
</p>
<p>
Hence the equation simplifies to 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial t}+c\frac{\partial z}{\partial x}=–c\frac{d z}{d\xi }+c\frac{d z}{d\eta }+c\left(\frac{\partial z}{\partial \xi }+\frac{\partial z}{\partial \eta }\right)=2c\frac{\partial z}{\partial \eta }=0.</script></span></span>
</p>
<p>
Hence the PDE simplifies greatly and becomes: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial \eta }=0.</script></span></span>
</p>
<p>
Thus if we integrate with respect to <script type="math/tex">\eta </script> and remember that <script type="math/tex">z</script> also depends on <script type="math/tex">\xi </script> we see that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=F(\xi ),</script></span></span> In other words <script type="math/tex">z</script> is just an arbitrary function of <script type="math/tex">\xi </script> only. 
</p>
<p>
Converting back to the original <script type="math/tex">(x,t)</script> coordinates we have <script type="math/tex">z(x,t)=F(x-ct)</script>. The actual function <script type="math/tex">F</script> could be determined by specifying the initial profile of the wave at <script type="math/tex">t=0</script>. If we set this to be <script type="math/tex">z(x,0)=z_{0}(x)</script> we would then find <script type="math/tex">z(x,0)=F(x)=z_{0}(x).</script> Hence the solution would then be <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z(x,t)=z_{0}(x-ct).</script></span></span> The solution of this equation represents a wave of amplitude <script type="math/tex">z</script> traveling to the right (positive <script type="math/tex">x</script>) with speed <script type="math/tex">c</script> at time <script type="math/tex">t</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000150">2.5.9 Jacobian Matrix and the Chain Rule</h3>
<p>
In this section we consider the so-called <b class="bf">Jacobian matrices</b> of partial derivatives and show how they can be used to encode and to represent the chain rule. We then on to examine the relationship between the inverses of these matrices and so establish conditions for an inverse of a multivariable function to have a local inverse. 
</p>
<p>
Consider the <script type="math/tex">\mathbb R^2 \to \mathbb R^2</script> mapping 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf f}:(x,y)\to \left(f_1(x,y),f_2(x,y)\right).</script></span>
<p>
Here <b class="bf">f</b> is called a <b class="bf">vector</b> function, since the result is an ordered set of two functions <script type="math/tex">f_1(x,y)</script> and <script type="math/tex">f_2(x,y)</script>. These could be the component of a vector whose direction and magnitude depends on the <script type="math/tex">(x,y)</script> position in space, e.g., 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf f}(x,y)= f_1(x,y){\bf i}+f_2(x,y){\bf j}.</script></span>
<p>
The function <b class="bf">f</b> could represent, say, the wind velocity at sea level at any point on a map. 
</p>
<p>
<b class="bf">Definition: (Jacobian Matrix)</b> The Jacobian Matrix of <b class="bf">f</b> <span class="rm">:</span> <script type="math/tex">\mathbb R^2\to \mathbb R^2</script> is defined to be 
</p>
<span class="dmath"><script type="math/tex; mode=display">J_{\bf f}(x,y)=\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x} &  \dfrac {\partial f_2}{\partial y}\end{array}\right)</script></span>
<p>
This is a matrix of partial derivatives. Note the order of the entries. The independent variables <script type="math/tex">(x,y)</script> go on the bottom of each partial derivative as appropriate. Partial derivatives of the function <script type="math/tex">f_ i</script> are in the <script type="math/tex">i^{\rm th}</script> row. The <script type="math/tex">j^{\rm th}</script> column should contain the same independent variable. 
</p>
<p>
Now suppose that we make a change of variable from <script type="math/tex">\mathbb R^2 \to \mathbb R^2</script> defined by 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf g}:(s,t)\to \left(x(s,t),y(s,t)\right).</script></span>
<p>
 Then we can use the chain rule to write 
</p>
<div class="eqn" id="a0000000151">
<script type="math/tex; mode=display">\begin{equation}{\frac{\partial f_1}{\partial s} = \frac{\partial f_1}{\partial x} \:  \frac{\partial x}{\partial s} + \frac{\partial f_1}{\partial y} \:  \frac{\partial y}{\partial s} .}\tag{2.4}\end{equation}</script>
</div>
<div class="eqn" id="a0000000152">
<script type="math/tex; mode=display">\begin{equation}{\frac{\partial f_1}{\partial t} = \frac{\partial f_1}{\partial x} \:  \frac{\partial x}{\partial t} + \frac{\partial f_1}{\partial y} \:  \frac{\partial y}{{\rm d} t} .}\tag{2.5}\end{equation}</script>
</div>
<p>
A little bit of thought shows that we can combine these two equations and represent them as components in the following matrix multiplication: 
</p>
<div class="eqn" id="a0000000153">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial s} &  \dfrac {\partial f_1}{\partial t}\end{array}\right)=\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y}\end{array}\right)\left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right)\tag{2.6}\end{equation}</script>
</div>
<p>
Likewise we could do the same for <script type="math/tex">f_2</script> and obtain 
</p>
<div class="eqn" id="a0000000154">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial f_2}{\partial s} &  \dfrac {\partial f_2}{\partial t}\end{array}\right)=\left(\begin{array}{cc}\dfrac {\partial f_2}{\partial x} &  \dfrac {\partial f_2}{\partial y}\end{array}\right)\left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right)\tag{2.7}\end{equation}</script>
</div>
<p>
Due to the identity of the final <script type="math/tex">2 \times 2</script> matrix in both these expressions, we could again combine these results and write them as a <script type="math/tex">2 \times 2</script> matrix multiplication: 
</p>
<div class="eqn" id="a0000000155">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial s} &  \dfrac {\partial f_1}{\partial t} \\[12 pt] \dfrac {\partial f_2}{\partial s} &  \dfrac {\partial f_2}{\partial t}\end{array}\right)= \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x} &  \dfrac {\partial f_2}{\partial y}\end{array}\right) \left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right).\tag{2.8}\end{equation}</script>
</div>
<p>
Or in terms of the definition of the Jacobian Matrix the chain rule for the mapping 
</p>
<span class="dmath"><script type="math/tex; mode=display">\mathbb R^2_{(s,t)} \stackrel{{\bf g}}{\rightarrow } \mathbb R^2_{(x,y)}\stackrel{{\bf f}}{\rightarrow } \mathbb R^2_{(f_1, f_2)},</script></span>
<p>
may be summarised as: 
</p>
<div class="eqn" id="chain">
<script type="math/tex; mode=display">\begin{equation}\boxed {J_{{\bf f\circ g}}(s,t)=J_{{\bf f}}(x,y)J_{{\bf g}}(s,t)}\tag{2.9}\end{equation}</script>
</div>
<p>
This can be generalised to arbitrary dimensional functions as follows. 
</p>
<p>
<b class="bf">Definition: (Jacobian Matrix in Higher Dimensions)</b> Let <script type="math/tex">F: {\mathbb R}^ n \rightarrow {\mathbb R}^ p</script> be a function where <script type="math/tex">n\ge 1</script> and <script type="math/tex">p\ge 1</script>. Assume <script type="math/tex">\frac{\partial f_ i}{\partial x_ j}</script> exists for all <script type="math/tex">1\leqslant i\leqslant p</script> and <script type="math/tex">1\leqslant j\leqslant n</script> at a point <script type="math/tex">(x_1, \dots ,x_ n)\in D</script>. The <i class="it">Jacobian matrix</i> at <script type="math/tex">(x_1, \dots , x_ n)</script> is the <script type="math/tex">p\times n</script> matrix of first order partial derivatives of the component functions of <script type="math/tex">F(x_1,\ldots , x_ n)</script>. Specifically, for 
</p>
<span class="dmath"><script type="math/tex; mode=display">F(x_1,\ldots , x_ n) = (f_1(x_1,\ldots , x_ n), \ldots , f_ p(x_1,\ldots , x_ n)),</script></span>
<p>
 we set 
</p>
<span class="dmath"><script type="math/tex; mode=display">J_ F(x_1,\ldots , x_ n) = \left( \frac{\partial f_ i}{\partial x_ j}\right) = \left( \begin{array}{ccc} \frac{\partial f_1}{\partial x_1}(x_1,\ldots , x_ n) &  \cdots &  \frac{\partial f_1}{\partial x_ n}(x_1,\ldots , x_ n) \\ \cdot & &  \cdot \\ \cdot & &  \cdot \\ \cdot & &  \cdot \\ \frac{\partial f_ p}{\partial x_1}(x_1,\ldots , x_ n) &  \cdots &  \frac{\partial f_ p}{\partial x_ n}(x_1,\ldots , x_ n) \end{array} \right).</script></span>
<p>
Next, we state the most general form of the Chain Rule. 
</p>
<p>
[The Chain Rule] Let <script type="math/tex">G: \mathbb R^ m\to \mathbb R^ n</script> be differentiable at a point <script type="math/tex">{\bf a} \in \mathbb R^ m</script> and <script type="math/tex">F: \mathbb R^ n\to \mathbb R^ p</script> be differentiable at the point <script type="math/tex">{\bf b}=G({\bf a})</script>. Then <script type="math/tex">F\circ G:\mathbb R^ m\to \mathbb R^ p</script> is differentiable at <script type="math/tex">{\bf a}</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\boxed {J_{F\circ G}({\bf a})=J_ F({\bf b}) \cdot J_ G({\bf a}).}</script></span>
<p>
<b class="bf">Example</b>: Jacobians need not be square matrices! For example, if we have a function: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  F:\mathbb R^ n\to \mathbb R^ p \qquad F & =&  \left(f_1(x_1, \dots , x_ n), \dots , f_ p(x_1, \dots , x_ n)\right) \\ G:\mathbb R^ p\to \mathbb R^ q \qquad G & =&  \left(g_1(f_1, \dots , f_ p), \dots , g_ q(f_1, \dots , f_ p)\right) \end{eqnarray*}</script></span>
<p>
 for arbitrary integer <script type="math/tex">p, q, n</script>, not necessarily equal, is then the chain rule is the matrix product 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \underbrace{\left(\begin{array}{ccc}\dfrac {\partial g_1}{\partial x_1} &  \cdots &  \dfrac {\partial g_1}{\partial x_ n} \\ \vdots &  \ddots &  \vdots \\ \dfrac {\partial g_ q}{\partial x_1} &  \cdots &  \dfrac {\partial g_ q}{\partial x_ n} \end{array}\right)}_{q\times n}= \underbrace{\left(\begin{array}{ccc}\dfrac {\partial g_1}{\partial f_1} &  \cdots &  \dfrac {\partial g_1}{\partial f_ p} \\ \vdots &  \ddots &  \vdots \\ \dfrac {\partial g_ q}{\partial f_1} &  \cdots &  \dfrac {\partial g_ q}{\partial f_ p} \end{array}\right)}_{q\times p} \underbrace{\left(\begin{array}{ccc}\dfrac {\partial f_1}{\partial x_1} &  \cdots &  \dfrac {\partial f_1}{\partial x_ n} \\ \vdots &  \ddots &  \vdots \\ \dfrac {\partial f_ p}{\partial x_1} &  \cdots &  \dfrac {\partial f_ p}{\partial x_ n} \end{array}\right)}_{p\times n} \end{eqnarray*}</script></span>
<p>
<b class="bf">Example:</b> The ordinary total derivative for compositions of single variable <script type="math/tex">\mathbb R\to \mathbb R</script> functions <script type="math/tex">g(x)=g(f(x))</script> is a special case of this result with <script type="math/tex">q=n=p=1</script>. For then the above matrices degenerate to a single entry (with partial derivatives becoming total derivatives): 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dg}{dx}=\frac{dg}{df}\frac{df}{dx}.</script></span>
</section><section class="subsection">
<h3 id="a0000000156">2.5.10 Relationships between Partial Derivatives and Jacobians</h3>
<p>
Recall that in 1 dimension, if <script type="math/tex">y=y(x)</script>, then the inverse function, if it exists, may be denoted by <script type="math/tex">x=x(y)</script>. Inserting the definition of <script type="math/tex">y</script> into the inverse function, we obtain the (tautological) result: 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=x(y(x)).</script></span>
<p>
 Assuming both the function and its inverse to be differentiable, if we differentiate both sides with respect to <script type="math/tex">x</script> we end up with 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dx}{dx}=\frac{dx}{dy}\frac{dy}{dx} \qquad 1=\frac{dx}{dy}\frac{dy}{dx} \qquad \frac{dy}{dx}=1\bigg/\  \left(\frac{dx}{dy}\right).</script></span>
<p>
Does the same result hold for partial derivatives, i..e, given a differentiable <script type="math/tex">z=f(x,y)</script>, does 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=1\bigg/\  \left(\frac{\partial x}{\partial z}\right)?</script></span>
<p>
In general, the answer is an emphastic <b class="bf">NOOOOOOOOOOOOOOOO!</b>
</p>
<p>
The analogous answer (and question!) is obtained by considering the following example: 
</p>
<p>
<b class="bf">Example:</b> Consider the following <script type="math/tex">\mathbb R^2\to \mathbb R^2</script> function 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf f}:(x,y)\to (f_1,f_2)=(f_1(x,y),f_2(x,y))={\bf f}({\bf x})</script></span>
<p>
 and suppose that locally, it has an inverse function 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf x}:(f_1,f_2)\to (x,y)=(x(f_1,f_2),y(f_1,f_2))={\bf x}({\bf f})</script></span>
<p>
 Now, substituting the inverse function into the function (as in the 1-D case) we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf x}={\bf x}({\bf f}({\bf x})).</script></span>
<p>
 The 2-D chain rule with <script type="math/tex">n=p=q=2</script> and <script type="math/tex">g_1 \to x</script> and <script type="math/tex">g_2 \to y</script> gives 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(\begin{array}{cc}\dfrac {\partial x}{\partial x} &  \dfrac {\partial x}{\partial y} \\[12 pt] \dfrac {\partial y}{\partial x}&  \dfrac {\partial y}{\partial y}\end{array} \right)= \left(\begin{array}{cc}\dfrac {\partial x}{\partial f_1} &  \dfrac {\partial x}{\partial f_2} \\[12 pt] \dfrac {\partial y}{\partial f_1}&  \dfrac {\partial y}{\partial f_2}\end{array} \right) \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x}&  \dfrac {\partial f_2}{\partial y}\end{array} \right) \end{eqnarray*}</script></span>
<p>
 Now since <script type="math/tex">x</script> and <script type="math/tex">y</script> are independent variables, 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(\begin{array}{cc}\dfrac {\partial x}{\partial x} &  \dfrac {\partial x}{\partial y} \\[12 pt] \dfrac {\partial y}{\partial x}&  \dfrac {\partial y}{\partial y}\end{array} \right)= \left(\begin{array}{cc}1 &  0 \\[12 pt] 0 &  1 \end{array} \right). \end{eqnarray*}</script></span>
<p>
 Hence we have 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(\begin{array}{cc}1 &  0 \\[12 pt] 0 &  1 \end{array} \right)= \left(\begin{array}{cc}\dfrac {\partial x}{\partial f_1} &  \dfrac {\partial x}{\partial f_2} \\[12 pt] \dfrac {\partial y}{\partial f_1}&  \dfrac {\partial y}{\partial f_2}\end{array} \right) \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x}&  \dfrac {\partial f_2}{\partial y}\end{array} \right) \end{eqnarray*}</script></span>
<p>
 Since the LHS is the identity matrix, the matrices on the RHS must be inverses of each other, i.e., 
</p>
<div id="Jacinv">
<div class="eqnarrayid" id="a0000000157"></div><script type="math/tex; mode=display">
\begin{align}
\tag{2.10}\label{Jacinv} \left(\begin{array}{cc}\dfrac {\partial x}{\partial f_1} &  \dfrac {\partial x}{\partial f_2} \\[12 pt] \dfrac {\partial y}{\partial f_1}&  \dfrac {\partial y}{\partial f_2}\end{array} \right)= \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x}&  \dfrac {\partial f_2}{\partial y}\end{array} \right)^{\displaystyle -1}. 
\end{align}
</script>
</div>
<p>
 Hence the matrices of the Jacobians of the inverse functions are inverses of each other. This is a general result for <script type="math/tex">n=p=q</script> maps leading to square Jacobian matrices. 
</p>
<p>
So in general, for multivariable functions, you can see that <b class="bf">not much</b> can be said about the relationship between individual partial derivatives <script type="math/tex">\partial f/\partial x</script> and <script type="math/tex">\partial x/\partial f</script>. 
</p>
<p>
What can be said is that the Jacobian matrices of the function and the inverse function are inverses of each other! 
</p>
<p>
<b class="bf">Remark:</b> Note that in the case of <script type="math/tex">n=p=q=1</script> for single variable functions, the matrices collapse to just as single entry, so the matrix inverse is just the inverse of a scalar (i.e., the reciprocal), the partials become total derivatives and so we recover the single variable ratio result above: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dx}{df}=1\bigg/\  \left(\frac{df}{dx}\right).</script></span>
<p>
A rather useful result follows from the above derivation. 
</p>
<p>
<b class="bf">Definition: (Jacobian Determinant) </b> Let <script type="math/tex">{\bf f}:\mathbb R^ n\to \mathbb R^ n=(f_1(x_1,\dots , x_ n),f_ n(x_1,\dots x_ n))</script>, then the <b class="bf">Jacobian Determinant</b> is just the determinant of the Jacobian matrix <script type="math/tex">J_{f}</script> and is written as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\rm det} J_{\bf f}=\frac{\partial (f_1 \dots f_ n)}{\partial (x_1 \dots x_ n)}</script></span>
<p>
Then, e.g., in the case of <script type="math/tex">n=2</script>, the following theorem holds. 
</p>
<p>
<b class="bf">(Inverse Functions, Implicit Function Theorem)</b> If <script type="math/tex">f_1=f_1(x,y)</script> and <script type="math/tex">f_2=f_2(x,y)</script> have continuous partial derivatives at a point <script type="math/tex">P: (x,y)=(a,b)</script>, then provided that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left. \frac{\partial (f_1, f_2)}{\partial (x,y)} \right|_ P\ne 0,</script></span>
<p>
 there exists locally a set of inverse functions <script type="math/tex">x=x(f_1,f_2), y=y(f_1,f_2)</script>.  
</p>
<p>
<b class="bf">Very Sketchy Proof:</b> (Not required, but outlined here for information. Note that we are using <script type="math/tex">x_{1}=x, x_{2}=y</script> in the <script type="math/tex">\mathbb R^{2}\to \mathbb R^{2}</script> version of the theorem.) The result (<a class="ref" href="../../notes/course_notes/index.html#Jacinv">2.10</a>) assumed that inverse functions existed. Hence in that instance, the Jacobian matrices will have inverses. For a <script type="math/tex">2\times 2</script> matrix, a necessary condition for the inverse to exist is that its determinant does not vanish. Hence if the Jacobian determinant does not vanish, the inverse matrix will exist, and so by implication the inverse functions. 
</p>
<p>
Note that the theorem does not find the inverse functions, it just guarantees that they exist. They may be complicated or even impossible to write down explicitly. Hence the use of the term <b class="bf">implicit</b> function theorem. 
</p>
<p>
<b class="bf">Example:</b> Given <script type="math/tex">x=r\cos \theta </script> and <script type="math/tex">y=r\sin \theta </script>, find where the inverse functions <script type="math/tex">r(x,y)</script> and <script type="math/tex">\theta (x,y)</script> exist. 
</p>
<p>
From the Implicit Function Theorem, we require the Jacobian determinant to be non-vanishing. We have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial (x, y)}{\partial (r,\theta )}=\left|\begin{array}{cc} \dfrac {\partial x}{\partial r}& \dfrac {\partial x}{\partial \theta } \\[12 pt] \dfrac {\partial y}{\partial r} &  \dfrac {\partial y}{\partial \theta }\end{array}\right|= \left|\begin{array}{cc} \cos \theta & -r\sin \theta \\[12 pt] \sin \theta &  r\cos \theta \end{array}\right|=r</script></span>
<p>
 Hence we see that inverse functions exist locally wherever <script type="math/tex">r\ne 0</script>. This is the polar origin, at which <script type="math/tex">\theta </script> is ambiguous: it can take any value from <script type="math/tex">0</script> to <script type="math/tex">2\pi </script>. 
</p>
<p>
The determinant of a Jacobian matrix will return again later when we consider changes of variables in integrals over multivariate functions. 
</p>
<p>
And finally, Jacobians should not be confused with Jacobites (who were 18th supporters of the claim of the descendants of James II of England (or VII of Scotland) to the throne of England and Scotland). :-) Jacobians are in fact, named after the mathematician Carl Gustav Jacobi (1804-1851). 
</p>
</section>
</section><section class="section">
<h2 id="a0000000158">2.6 Calculation of Derivatives of Implicit Functions.</h2>
<p>
We can use the chain rule and Jacobians to calculate (partial) derivatives associated with implicit functions. 
</p>
<section class="subsection">
<h3 id="a0000000159">2.6.1 Calculation of a Total Derivative</h3>
<p>
Consider the implicit representation: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=0,</script></span></span> for a known, given, real function <script type="math/tex">F</script> for which the partial derivatives with respect to the real variables <script type="math/tex">x</script> and <script type="math/tex">y</script> may be found. Suppose that, in principle, it is possible to rewrite this function with <script type="math/tex">y</script> as the subject, i.e., <script type="math/tex">y=y(x)</script>, locally in some interval around <script type="math/tex">x=x_{0}</script>. What is the derivative of the function <script type="math/tex">y</script> with respect to <script type="math/tex">x</script>, i.e., <script type="math/tex">dy/dx</script>? 
</p>
<p>
We can work this out using the chain rule <i class="it">without needing to even solve initially and explicitly for <script type="math/tex">y=y(x)</script>!</i>
</p>
<ul class="itemize" id="a0000000160">
<li id="a0000000161"> <p>
First, if <script type="math/tex">y=y(x)</script> (whatever <script type="math/tex">y(x)</script> may be - we don’t care), then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=F(x,y(x))=0</script></span></span>
</p>
</li>
<li id="a0000000162"> <p>
Using the chain rule, we can differentiate this with respect to <script type="math/tex">x</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}+\frac{\partial F}{\partial y}\frac{dy}{dx}=0.</script></span></span>
</p>
</li>
<li id="a0000000163"> <p>
Solving this we can obtain: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial y}.</script></span></span>
</p>
</li>
</ul>
<p>
Note that for the total derivative <script type="math/tex">dy/dx</script> to exist the partial derivatives of <script type="math/tex">F</script> need to exist and that <script type="math/tex">\partial F/\partial y \ne 0</script>. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Consider the implicit function representation of the unit circle: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=x^{2}+y^{2}-1=0.</script></span></span>
</p>
<ul class="itemize" id="a0000000164">
<li id="a0000000165"> <p>
We can compute the partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}=2x \qquad \frac{\partial F}{\partial y}=2y.</script></span></span>
</p>
</li>
<li id="a0000000166"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial y}=-\frac{2x}{2y}=-\frac{x}{y}, \qquad y\ne 0.</script></span></span>
</p>
</li>
</ul>
<figure id="ImplicitFirstExample">
<div class="centered"> <img src="../../notes/course_notes/images/img-0042.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.23</span>
<span class="caption_text">Chain rule for implicit function <script type="math/tex">F(x,y(x))=0</script> (left). The derivative <script type="math/tex">dy/dx</script> is the slope of the tangent line to the curve <script type="math/tex">F(x,y)=x^{2}+y^{2}-1=0</script> in the vicinity of the point <script type="math/tex">(x_{0},y_{0})</script> when, e.g., when solving the implicit representation and taking <script type="math/tex">y=+\sqrt{1-x^{2}}</script> as the explicit, single valued, representation (right). The value of <script type="math/tex">dy/dx</script> can also be checked in this case by differentiating the explicit function representation <script type="math/tex">y=+\sqrt{1-x^{2}}</script>. In more complicated problems, this latter direct approach may not be possible if no explicit representation can be found.</span>
</figcaption> </div>
</figure>
</section><section class="subsection">
<h3 id="a0000000167">2.6.2 Calculation of Partial Derivatives from an Implicit Function</h3>
<p>
Consider the implicit function representation: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y,z)=0,</script></span></span> for a known, given, real function <script type="math/tex">F</script> for which the partial derivatives with respect to the real variables <script type="math/tex">x</script>, <script type="math/tex">y</script> and <script type="math/tex">z</script> may be found. Suppose that, in principle, we could solve this locally in some domain around <script type="math/tex">(x,y)=(x_{0},y_{0})</script> to rewrite this with <script type="math/tex">z</script> as the subject, i.e., <script type="math/tex">z=z(x,y)</script>. What are the partial derivatives of the function <script type="math/tex">z</script> with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script>, i.e., <script type="math/tex">{\partial z}/{\partial x}</script>, and <script type="math/tex">{\partial z}/{\partial y}</script>? 
</p>
<p>
We can do this using the chain rule, <i class="it">without needing to even solve initially and explicitly for <script type="math/tex">z=z(x,y)</script>!</i>
</p>
<ul class="itemize" id="a0000000168">
<li id="a0000000169"> <p>
First, if <script type="math/tex">z=z(x,y)</script>, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=F(x,y,z(x,y))=0</script></span></span>
</p>
</li>
<li id="a0000000170"> <p>
Using the chain rule, we can differentiate this with respect to <script type="math/tex">x</script> and solve for <script type="math/tex">\partial z/\partial x</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}+\frac{\partial F}{\partial z}\left(\frac{\partial z}{\partial x}\right)_{y}=0 \qquad \Rightarrow \qquad \left(\frac{\partial z}{\partial x}\right)_{y}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial z}.</script></span></span>
</p>
</li>
<li id="a0000000171"> <p>
Similarly, using the chain rule, we can differentiate this with respect to <script type="math/tex">y</script> and solve for <script type="math/tex">\partial z/\partial y</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial y}+\frac{\partial F}{\partial z}\left(\frac{\partial z}{\partial y}\right)_{x}=0 \qquad \Rightarrow \qquad \left(\frac{\partial z}{\partial y}\right)_{x}=-\frac{\partial F}{\partial y}\bigg/\frac{\partial F}{\partial z}.</script></span></span>
</p>
</li>
</ul>
<p>
 In both cases we see that locally around <script type="math/tex">(x,y)=(x_{0},y_{0})</script>, the partials of <script type="math/tex">z</script> with respect to the independent variables <script type="math/tex">(x,y)</script> exist provided that the partial derivatives of <script type="math/tex">F</script> exist and that <script type="math/tex">\partial F/\partial z\ne 0</script>. 
</p>
<p>
<b class="bf">Example:</b> Consider the implicit function: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=y\sin (x+z)+\ln (y)=0.</script></span></span>
</p>
<ul class="itemize" id="a0000000172">
<li id="a0000000173"> <p>
We can compute the partial derivatives at <script type="math/tex">(x,y,z)=(0,1,0)</script> as follows (note that <script type="math/tex">F(0, 1, 0)=0</script>!): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}=y\cos (x+z) \qquad \frac{\partial F}{\partial y}=\sin (x+z)+1/y, \qquad \frac{\partial F}{\partial z}=y\cos (x+z).</script></span></span>
</p>
</li>
<li id="a0000000174"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial z}{\partial x}\right)_{y}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial z}=-\frac{y\cos (x+z)}{y\cos (x+z)}=-\frac{\cos (0)}{\cos (0)}=-1.</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial z}{\partial y}\right)_{x}=-\frac{\partial F}{\partial y}\bigg/\frac{\partial F}{\partial z}=-\frac{\sin (x+z)+1/y}{y\cos (x+z)}=-\frac{\sin (0)+1}{\cos (0)}=-1.</script></span></span>
</p>
</li>
</ul>
</section><section class="subsection">
<h3 id="a0000000175">2.6.3 Generalisation to Systems of Implicit Functions</h3>
<p>
<i class="it">This section is included for completeness. It is not examinable, but is useful background material.</i>
</p>
<p>
Consider the implicit function representation: 
</p>
<span class="dmath"><script type="math/tex; mode=display">F(x,y,z,w)=0, \qquad G(x,y,z,w)=0.</script></span>
<p>
 for known, given, real functions <script type="math/tex">F</script> and <script type="math/tex">G</script> for which the partial derivatives with respect to the real variables <script type="math/tex">x</script>, <script type="math/tex">y</script>, <script type="math/tex">z</script>, <script type="math/tex">w</script> may be found. Here we may have multiple ways that we might try to solve these relations to obtain an explicit relationships. We may seek solutions at a point in terms of pairs of independent and dependent variables as follows (!!!): 
</p>
<div class="centered"> <table class="tabular">
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(z,w) \\ y=y(z,w),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(y,w) \\ z=z(y,w),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(y,z) \\ w=w(y,z),\end{array}\right.</script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}y=y(x,w) \\ z=y(x,w),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}y=y(x,z) \\ w=w(x,z),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}z=z(x,y) \\ w=w(x,y),\end{array}\right.</script>
</p>
</td>
</tr>
</table> </div>
<p>
Suppose we are asked to find <script type="math/tex">\partial x/\partial z</script>. 
</p>
<p>
If we had been dealing with a single function <script type="math/tex">F(x,y,z)=0</script>, this <b class="bf">partial</b> derivative automatically would imply that <script type="math/tex">x</script> was going to be a function of the remaining variables <script type="math/tex">y</script> and <script type="math/tex">z</script>, i.e., was <script type="math/tex">\left(\partial x/\partial z\right)_{y}</script>, the derivative of <script type="math/tex">x=x(y,z)</script> with respect to <script type="math/tex">z</script>, keeping <script type="math/tex">y</script> constant. 
</p>
<p>
When we were dealing with a more than one function <script type="math/tex">F(x,y,z,w)=0, \  G(x,y,z,w)</script>, asking for <script type="math/tex">\partial x/\partial z</script> alone is ambiguous. Looking at the possible pairs of relations between independent and dependent variables above, we see that <script type="math/tex">x</script> could be expressed in terms of <script type="math/tex">z</script> and either <script type="math/tex">y</script> <b class="bf">or</b> <script type="math/tex">w</script> depending on which pair of independent variables are chosen: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left\{ \begin{array}{c}x=x(z,w) \\ y=y(z,w),\end{array}\right. \qquad {\rm or} \qquad \left\{ \begin{array}{c}x=x(y,z) \\ w=w(y,z),\end{array}\right.</script></span>
<p>
In such cases, we therefore have to specify explicitly the variables we are keeping constant in the partial derivatives: 
</p>
<div class="centered"> <table class="tabular">
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left(\partial x/\partial z\right)_{w}</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Rightarrow </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(z,w) \\ y=y(z,w),\end{array}\right. </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left(\partial x/\partial z\right)_{y}</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Rightarrow </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(y,z) \\ w=w(y,z).\end{array}\right.</script>
</p>
</td>
</tr>
</table> </div>
<p>
Suppose we now look for <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script>. We are treating the independent variables then as <script type="math/tex">z</script> and <script type="math/tex">w</script>. We therefore consider <script type="math/tex">F</script> and <script type="math/tex">G</script> as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">F(x(z,w),y(z,w),z,w)=0, \qquad G(x(z,w),y(z,w),z,w)=0,</script></span>
<p>
 and partially differentiate them with respect to <script type="math/tex">z</script> using the chain rule: 
</p>
<figure id="ChainImplicitSystem">
<div class="centered"> <img src="../../notes/course_notes/images/img-0044.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.24</span>
<span class="caption_text">Chain rule for implicit function <script type="math/tex">F(x(z,w),y(z,w),z,w)=0</script>. A parallel diagram for <script type="math/tex">G(x(z,w),y(z,w),z,w)=0</script> exists, identical in structure, after replacing <script type="math/tex">F</script> with <script type="math/tex">G</script>.</span>
</figcaption> </div>
</figure>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}\left(\frac{\partial x}{\partial z}\right)_{w}+\frac{\partial F}{\partial y}\left(\frac{\partial y}{\partial z}\right)_{w}+\frac{\partial F}{\partial z}=0, \qquad \frac{\partial G}{\partial x}\left(\frac{\partial x}{\partial z}\right)_{w}+\frac{\partial G}{\partial y}\left(\frac{\partial y}{\partial z}\right)_{w}+\frac{\partial G}{\partial z}=0.</script></span>
<p>
Now for given, known, <script type="math/tex">F</script> and <script type="math/tex">G</script>, all the partial derivatives of <script type="math/tex">F</script> and <script type="math/tex">G</script> with respect to <script type="math/tex">x</script>, <script type="math/tex">y</script> and <script type="math/tex">z</script> will be known. The thing we want to find is <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script>. However we also see that each of these expressions involve the also unknown <script type="math/tex">\left(\partial y/\partial z\right)_{w}</script>. This is not a problem, since we now have two linear algebraic equations in two unknowns, <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script> and <script type="math/tex">\left(\partial y/\partial z\right)_{w} </script>, with known coefficients <script type="math/tex">\partial F/\partial x</script>, <script type="math/tex">\partial F/\partial y</script>, <script type="math/tex">\partial F/\partial z</script>, <script type="math/tex">\partial G/\partial x</script>, <script type="math/tex">\partial G/\partial y</script>, <script type="math/tex">\partial G/\partial z</script>. This can be solved easily, (for example using Cramer’s rule or directly by algebraic elimination) to give: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial x}{\partial z}\right)_{w}=-\frac{(\partial F/\partial z)(\partial G/\partial y)- (\partial F/\partial y)(\partial G/\partial z)}{(\partial F/\partial x)(\partial G/\partial y)- (\partial F/\partial y)(\partial G/\partial x)}=-\frac{\partial (F,G)}{\partial (z,y)}\bigg/\frac{\partial (F,G)}{\partial (x,y)}.</script></span>
<p>
Hence the partial derivative <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script> is expressed as the ratio of two Jacobian determinants of <script type="math/tex">F,G</script> with respect to the other variables <script type="math/tex">x, y, z</script>. The corresponding other solution of the algebraic equation gives the other partial derivative as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial y}{\partial z}\right)_{w}=-\frac{(\partial F/\partial z)(\partial G/\partial x)- (\partial F/\partial x)(\partial G/\partial z)}{(\partial F/\partial y)(\partial G/\partial x)- (\partial F/\partial x)(\partial G/\partial y)}=-\frac{\partial (F,G)}{\partial (z,x)}\bigg/\frac{\partial (F,G)}{\partial (y,x)}.</script></span>
<p>
Here we see that a condition for the two functions <script type="math/tex">F</script> and <script type="math/tex">G</script> to be solvable locally at a point <script type="math/tex">(x,y,z,w)=(x_{0},y_{0},z_{0},w_{0})</script> in the form of <script type="math/tex">x=x(z,w)</script> and <script type="math/tex">y=y(z,w)</script> is that the Jacobian determinant of <script type="math/tex">F</script> and <script type="math/tex">G</script> with respect to the newly chosen dependent variables <script type="math/tex">x</script> and <script type="math/tex">y</script> does not vanish, i.e., 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial (F,G)}{\partial (x,y)}\ne 0.</script></span>
<p>
 Generalisations to <script type="math/tex">n</script> functions <script type="math/tex">F_{i}, i=1, \dots n</script> in terms of <script type="math/tex">n+m</script> variables <script type="math/tex">x_{1}, x_{2}, \dots , x_{m}, y_{1},y_{2}, \dots y_{n}</script> are possible. This leads to expressions for partial derivatives <script type="math/tex">(\partial y_{i}/\partial x_{j})_{x_{1},\dots , x_{j-1},x_{j+1}\dots x_{m}}</script> expressed in terms of ratios of <script type="math/tex">n \times n</script> Jacobian determinants. However, that is an exercise in extreme tedium. 
</p>
</section>
</section><section class="section">
<h2 id="a0000000176">2.7 Definition of Gradient</h2>
<p>
We have seen that for a multivariable function <script type="math/tex">f:\mathbb R^{2}\to \mathbb R</script>, we have, in general, two “obvious” partial derivatives that we may take, namely <script type="math/tex">\partial f/\partial x</script> and <script type="math/tex">\partial f/\partial y</script>. A combination of these that is extremely useful, and which will come up time and time again in equations is the <b class="bf">gradient</b> of <script type="math/tex">f</script>. 
</p>
<p>
<b class="bf">Definition: (Gradient)</b> Let <script type="math/tex">f: {\mathbb R}^2\rightarrow {\mathbb R}</script> be a function. Assume that both partial derivatives exist at a point <script type="math/tex">(x,y)\in \mathbb R^2</script>. We define the <em>gradient</em> of <script type="math/tex">f(x,y)</script> to be the vector of partial derivatives 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) = \left( \frac{\partial f}{\partial x} (x,y), \frac{\partial f}{\partial y} (x,y) \right).</script></span>
<p>
One important thing to note is that, while <script type="math/tex">f: {\mathbb R}^2\rightarrow {\mathbb R}</script>, its gradient <script type="math/tex">\nabla f (x,y)</script> is a <b class="bf">vector</b> function <script type="math/tex">\nabla f: {\mathbb R}^2\rightarrow {\mathbb R}^2</script>. For this reason in <script type="math/tex">\mathbb R^{2}</script>, if we assign unit vectors <b class="bf">i</b> and <b class="bf">j</b> to the positive <script type="math/tex">x, y</script> directions respectively, we can write <script type="math/tex">\nabla f</script> as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) = \frac{\partial f}{\partial x} {\bf i} +\frac{\partial f}{\partial y}{\bf j},</script></span>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0046.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.25</span>
<span class="caption_text">Representation of the vector which is the gradient of a function <script type="math/tex">f(x,y)</script> in the <script type="math/tex">(x,y)</script> plane at a point <script type="math/tex">P</script>, <script type="math/tex">(x_{p},y_{p})</script>.</span>
</figcaption> </div>
</figure>
<p>
More generally, we can define the <i class="it">gradient</i> of a function <script type="math/tex">f(x_1,\ldots , x_ n)</script> of <script type="math/tex">n</script> variables to again be the vector of partial derivatives 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x_1, \ldots , x_ n) = \left( \frac{\partial f}{\partial x_1} (x_1,\ldots , x_ n), \ldots , \frac{\partial f}{\partial x_ n} (x_1,\ldots , x_ n)\right).</script></span>
<p>
For <script type="math/tex">f(x,y,z):\mathbb R^{3}\to \mathbb R</script> the gradient can be written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y,z) = \frac{\partial f}{\partial x} {\bf i} +\frac{\partial f}{\partial y}{\bf j}+\frac{\partial f}{\partial z}{\bf k},</script></span>
<p>
 where <b class="bf">k</b> is the unit vector pointing in the positive <script type="math/tex">z</script> direction. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0048.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.26</span>
<span class="caption_text">Representation of the vector which is the gradient of a function <script type="math/tex">f(x,y,z)</script> in <script type="math/tex">(x,y,z)</script> space at a point <script type="math/tex">P</script>, <script type="math/tex">(x_{p},y_{p},z_{p})</script>.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b> Find the gradients of the functions <script type="math/tex">f(x,y)=x+y -1</script>,  <script type="math/tex">g(x, y)= e^ x + xe^ y</script>, and <script type="math/tex">h(x, y, z )=x^2+y^2 +z^2+3</script>. 
</p>
<p>
<span style="color:#FF0000"><script type="math/tex">\nabla f(x,y) = \left( \frac{\partial f}{\partial x} (x,y), \frac{\partial f}{\partial y} (x,y) \right)= (1, 1),</script></span>
</p>
<p>
<span style="color:#FF0000"><script type="math/tex">\nabla g(x,y) = (e^ x+e^ y, xe^ y),</script></span>
</p>
<p>
<span style="color:#FF0000"><script type="math/tex">\nabla h(x,y, z) = (2x, 2y, 2z)</script>.</span>
</p>
<p>
<br/>
</p>
</section><section class="section">
<h2 id="a0000000177">2.8 Tangent Planes</h2>
<p>
A differentiable curve in one dimension has a tangent line at each point. This is the straight line that passes through the chosen point on the curve, but which has the same slope of the curve at that point. 
</p>
<figure id="TangentLine">
<div class="centered"> <img src="../../notes/course_notes/images/img-0050.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.27</span>
<span class="caption_text">Tangent line (dotted), tangent vector <b class="bf">t</b> and normal vector <b class="bf">n</b> at a point <script type="math/tex">P</script> on the (differentiable) curve <script type="math/tex">y=f(x)</script>.</span>
</figcaption> </div>
</figure>
<p>
We can set up unit vectors <b class="bf">i</b>, <b class="bf">j</b>, in the <script type="math/tex">x,y,</script> directions respectively. 
</p>
<p>
Note that a vector that is tangential to the curve at a chosen point <script type="math/tex">P</script> is given by (see figure <a class="ref" href="../../notes/course_notes/index.html#TangentLine">2.27</a>), 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf t}={\bf i} +\left(\frac{df}{dx}\right)_ P{\bf j}.</script></span>
<p>
A vector <b class="bf">n</b> normal to this curve satisfies <script type="math/tex">{\bf t.n}=0</script>. A little bit of thought gives this as 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf n}=-\left(\frac{df}{dx}\right)_ P{\bf i} +{\bf j}.</script></span>
<p>
Suppose we now consider the smooth surface <script type="math/tex">z=f(x,y)</script> (we return to what we mean by “smooth” later, but for now just think of it has having no kinks or creases). At each point on this surface, there will be two normal directions to the surface (parallel, but in opposite directions to each other). 
</p>
<p>
It is then possible to define a <b class="bf">tangent plane</b> <script type="math/tex">{\mathcal T}</script> at a chosen point <script type="math/tex">P</script> on the surface. This is the plane that passes through the point <script type="math/tex">P</script>, but is everywhere perpendicular to either of the normal directions <script type="math/tex">\pm {\bf n}</script> (see figure <a class="ref" href="../../notes/course_notes/index.html#TangentPlane226a">2.28</a>). 
</p>
<figure id="TangentPlane226a">
<div class="centered"> <img src="../../notes/course_notes/images/img-0052.png" style="width:271.0125pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.28</span>
<span class="caption_text">Tangent plane <script type="math/tex">{\mathcal T}</script> at the point <script type="math/tex">P:(a,b,f(a,b)</script> that is everywhere normal to one of the normal vectors <script type="math/tex">\pm {\bf n}</script>. Also show is a general point <script type="math/tex">{\bf r}</script> in the tangent plane and the vector <script type="math/tex">{\bf r}-{\bf OP}</script> that lies wholly within the tangent plane.</span>
</figcaption> </div>
</figure>
<p>
What is the equation of this tangent plane at <script type="math/tex">P</script>? We can proceed as follows: 
</p>
<ul class="itemize" id="a0000000178">
<li id="a0000000179"> <p>
We can set up unit vectors <b class="bf">i</b>, <b class="bf">j</b>, <b class="bf">k</b> in the <script type="math/tex">x,y,</script> and <script type="math/tex">z</script> directions respectively. 
</p>
</li>
<li id="a0000000180"> <p>
Now suppose that the chosen point <script type="math/tex">P</script> on the surface has <script type="math/tex">(x,y,z)</script> coordinates given by <script type="math/tex">(a,b,f(a,b))</script>. It will have a position vector relative to the origin given by <b class="bf">OP</b> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf OP}=a{\bf i}+b{\bf j}+f(a,b){\bf k}.</script></span>
</li>
<li id="a0000000181"> <p>
We know the slope of the surface in the <script type="math/tex">x</script> direction. It is given by <script type="math/tex">(\partial f/\partial x)_ p</script>. This is the rate of change of the height of the surface in the <script type="math/tex">x</script> direction. Hence, by analogy with the 1-D case above, a vector tangential to the surface in the <script type="math/tex">x</script> direction is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf t_ x}={\bf i} +\left(\frac{\partial f}{\partial x}\right)_ P{\bf k}</script></span>
</li>
<li id="a0000000182"> <p>
We also know the slope of the surface in the <script type="math/tex">y</script> direction. It is given by <script type="math/tex">\partial f/\partial y</script>. This is the rate of change of the height of the surface in the <script type="math/tex">y</script> direction. Hence, by analogy with the 1-D case above, a vector tangential to the surface in the <script type="math/tex">y</script> direction is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf t_ y}={\bf j} +\left(\frac{\partial f}{\partial y}\right)_ P{\bf k}</script></span>
</li>
<li id="a0000000183"> <p>
We can now find a normal <b class="bf">n</b> to the surface by taking the vector product of the two tangent vectors. 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf n}={\bf t_ x}\times {\bf t_ y}=\left|\begin{array}{ccc}{\bf i} &  {\bf j} &  {\bf k} \\ 1 &  0 &  \left( \dfrac {\partial f}{\partial x} \right)_ P \\[12 pt] 0 &  1 &  \left( \dfrac {\partial f}{\partial y}\right)_ P \end{array}\right|= -\left(\frac{\partial f}{\partial x}\right)_ P{\bf i}-\left(\frac{\partial f}{\partial y}\right)_ P{\bf j}+{\bf k}</script></span>
</li>
<li id="a0000000184"> <p>
The other normal in the other direction is then 
</p>
<span class="dmath"><script type="math/tex; mode=display">-{\bf n}= \left(\frac{\partial f}{\partial x}\right)_ P{\bf i}+\left(\frac{\partial f}{\partial y}\right)_ P{\bf j}-{\bf k}</script></span>
</li>
<li id="a0000000185"> <p>
Now suppose that the chosen point <script type="math/tex">P</script> on the surface has <script type="math/tex">(x,y,z)</script> coordinates given by <script type="math/tex">(a,b,f(a,b))</script>. It will have a position vector relative to the origin given by <b class="bf">OP</b> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf OP}=a{\bf i}+b{\bf j}+f(a,b){\bf k}.</script></span>
</li>
<li id="a0000000186"> <p>
Likewise, suppose a general point on the tangent plane is given by the position vector <b class="bf">r</b> where 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf r}=x{\bf i}+y{\bf j}+z{\bf k}</script></span>
</li>
<li id="a0000000187"> <p>
The vector <b class="bf">r-OP</b> is a vector that joins the point <script type="math/tex">P</script> to any other general point on the tangent plane at <script type="math/tex">P</script>. The vector <b class="bf">r-OP</b> therefore lies wholly within the tangent plane. Consequently it must be perpendicular to either of the normals <script type="math/tex">\pm </script><b class="bf">n</b> at <script type="math/tex">P</script>. Hence we must have 
</p>
<span class="dmath"><script type="math/tex; mode=display">({\bf r-OP})\cdot {\bf n}=0.</script></span>
</li>
<li id="a0000000188"> <p>
Substituting for <b class="bf">r</b>, <b class="bf">OP</b> and <b class="bf">n</b> this equation becomes 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left\{  x{\bf i}+y{\bf j}+z{\bf k}-(a{\bf i}+b{\bf j}+f(a,b){\bf k})\right\} \cdot {\bf n}=0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">\left\{  (x-a){\bf i}+(y-b){\bf j}+(z-f(a,b)){\bf k}\right\} \cdot {\bf n}=0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">\left\{  (x-a){\bf i}+(y-b){\bf j}+(z-f(a,b)){\bf k}\right\} \cdot \left\{  -\left(\frac{\partial f}{\partial x}\right)_ P{\bf i}-\left(\frac{\partial f}{\partial y}\right)_ P{\bf j}+{\bf k}\right\} =0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">-(x-a)\left(\frac{\partial f}{\partial x}\right)_ P-(y-b)\left(\frac{\partial f}{\partial y}\right)_ P+(z-f(a,b))=0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">\boxed { z=f(a,b)+(x-a)\left(\frac{\partial f}{\partial x}\right)_ P+(y-b)\left(\frac{\partial f}{\partial y}\right)_ P}.</script></span>
</li>
</ul>
<p>
Note that we can express the equation of the plane in terms of the gradient of the function evaluated at <script type="math/tex">P</script> in the following way: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\boxed { z=f(a,b)+\nabla f(a,b) \cdot \left( (x-a){\bf i}+(y-b){\bf j}\right)}.</script></span>
<p>
<b class="bf">Example:</b> Compute the tangent plane to the surface <script type="math/tex">z=x^2+y^2</script> at the point P above <script type="math/tex">(x,y)=(1,2)</script>. 
</p>
<ul class="itemize" id="a0000000189">
<li id="a0000000190"> <p>
Note that <script type="math/tex">z=x^2+y^2</script>, so that in the notation of derivation above we have <script type="math/tex">f(x,y)=x^2-y^2</script>. 
</p>
</li>
<li id="a0000000191"> <p>
We also have the coordinates of the point <script type="math/tex">P</script> on the surface as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">(a,b,f(a,b))=(1,2,f(1,2))=(1,2,1^2+2^2)=(1,2,5)</script></span>.</span>
</p>
</li>
<li id="a0000000192"> <p>
Hence the ingredients for the formula for the tangent surface are: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}=2x, \qquad \Rightarrow \qquad \left(\frac{\partial f}{\partial x}\right)_ P=2\times 1=2</script></span> <span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial y}=2y, \qquad \Rightarrow \qquad \left(\frac{\partial f}{\partial x}\right)_ P=2\times 2=4</script></span></span>
</p>
</li>
<li id="a0000000193"> <p>
Hence the tangent surface at <script type="math/tex">P</script> is given by <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  z& =& f(a,b)+(x-a)\left(\frac{\partial f}{\partial x}\right)_ P+(y-b)\left(\frac{\partial f}{\partial y}\right)_ P\\ \Rightarrow z& =& 5+2(x-1)+4(y-2)\\ \Rightarrow z& =& 2x+4y-5 \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<figure id="TangentPlane1">
<div class="centered"> <img src="../../notes/course_notes/images/img-0054.png" style="width:505.89pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.29</span>
<span class="caption_text">Different views of the tangent plane <script type="math/tex">z=2x+4y-5</script> to the surface <script type="math/tex">z=x^{2}+y^{2}</script> at <script type="math/tex">P=(1,2,5)</script>.</span>
</figcaption> </div>
</figure>
<p>
Recall that for a curve <script type="math/tex">y=F(x)</script> in 1-D, the tangent line at the point <script type="math/tex">(a,F(a))</script> is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">y=F(a)+\left(\frac{df}{dx}\right)_{x=a}(x-a).</script></span>
<p>
 The tangent line gives a linear approximation to the line and is the first two terms of the Taylor series expansion of <script type="math/tex">y=F(x)</script> about <script type="math/tex">(a, F(a))</script>. 
</p>
<p>
It is then not too difficult to see that the tangent plane is a linear expansion of the function <script type="math/tex">z=f(x,y)</script> about the point <script type="math/tex">P= (a,b,f(a,b))</script>. In fact it is the first two terms in the multivariable Taylor series expansion of <script type="math/tex">z=f(x,y)</script> at <script type="math/tex">P</script>, which we will study later. 
</p>
<p>
Tangent hyper-planes can also be derived for hypersurfaces <script type="math/tex">f:\mathbb R^ n\to \mathbb R</script>. The formula take a similar form to that derived above: a sum of linear differences in the variable from the tangent point multiplied by the appropriate partial derivative at that point plus the value of the function at that point. 
</p>
</section><section class="section">
<h2 id="a0000000194">2.9 Differentiability</h2>
<p>
We now examine what it means for a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> to be differentiable. We again recall the definition of a derivative of a function <script type="math/tex">f(x)</script> in one variable at a point <script type="math/tex">x=a</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">f’(a) = \lim _{h\rightarrow 0}\frac{f(a+h) -f(a)}{h}.</script></span>
<p>
 Since <script type="math/tex">f'(a)</script> is a constant, we can carry it over to the right hand side and use basic properties of limits to see that we can rewrite this equation as 
</p>
<div class="eqn" id="a0000000195">
<script type="math/tex; mode=display">\begin{equation}\lim _{h\rightarrow 0} \frac{f(a+h) -f(a) - f'(a)h}{h}=0.\tag{2.11}\end{equation}</script>
</div>
<p>
We can then say that the function <script type="math/tex">f:\mathbb R\to \mathbb R</script> is <i class="it">differentiable</i> at a point <script type="math/tex">x=a</script> if there exists <script type="math/tex">f'(a)\in \mathbb R</script> so that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a+h)-f(a)-f'(a)h}{h}=0.</script></span>
<p>
We also know that the derivative <script type="math/tex">f'(a)</script> has a geometric interpretation as the slope of the line tangent to the graph of the function at the point <script type="math/tex">(a, f(a))\in \mathbb R^2</script>. So, the function is differentiable when such a tangent line exists and hence its slope is well-defined. 
</p>
<p>
If we now consider a function of two variables <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> instead, then the tangent line is replaced by the tangent plane at a given point <script type="math/tex">(a,b, f(a,b))</script>. So, the function would be differentiable at <script type="math/tex">(a,b)</script> when such a tangent plane exists. 
</p>
<p>
The tangent plane does not have a single slope but rather many slopes coming from different directions. We then compute the slopes in the <script type="math/tex">x</script> and <script type="math/tex">y</script> directions, that is, when we fix <script type="math/tex">y=b</script> and <script type="math/tex">x=a</script> respectively and consider the slopes of the lines <script type="math/tex">(x,b, f(x,b))</script> and <script type="math/tex">(a,y, f(a,y))</script> in the tangent plane. These slopes are precisely the partial derivatives of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(a,b)</script>. 
</p>
<p>
So, for a function <script type="math/tex">f(x,y)</script> to be differentiable at <script type="math/tex">(a,b)</script>, the gradient <script type="math/tex">\nabla f(a,b)</script> needs to exist.<a class="footnote" href="#a0000000196">
<sup class="footnotemark">6</sup>
</a>
</p>
<section class="subsection">
<h3 id="a0000000197">2.9.1 Differentiability in the case of two variable functions</h3>
<p>
 Now, let us make the precise definition of differentiability. We will only do this for a function <script type="math/tex">f:\mathbb R^2 \to \mathbb R</script>: 
</p>
<p>
<b class="bf">Definition: (Differentiability)</b> A function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is <i class="it">differentiable</i> at a point <script type="math/tex">(a,b)\in \mathbb R^2</script> if there is a vector <script type="math/tex">{\bf v}=(v_1, v_2)\in \mathbb R^2</script> so that 
</p>
<div class="eqn" id="diff_cont">
<script type="math/tex; mode=display">\begin{equation}\label{diffd}\displaystyle {\lim _{(h,k) \rightarrow (0,0)}} \frac{f(a+h, b+k)-f(a,b)- {\bf v}\cdot (h,k)}{\sqrt{h^2 +k^2}}=0.\tag{2.12}\end{equation}</script>
</div>
<p>
The vector <script type="math/tex">{\bf v}</script> is a bit mysterious. However, the following theorem shows why it is natural in the definition of differentiability and explains precisely what it is. 
</p>
<p>
 If the function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is differentiable at a point <script type="math/tex">(a,b)\in \mathbb R^2</script>, then it is continuous at <script type="math/tex">(a,b)</script>. Moreover, the vector <script type="math/tex">{\bf v}</script> defined by (<a class="ref" href="../../notes/course_notes/index.html#diff_cont">2.12</a>) is unique and is equal to <script type="math/tex">\nabla f(a,b)</script>.  
</p>
<p>
<b class="bf">Proof:</b>
</p>
<ul class="itemize" id="a0000000198">
<li id="a0000000199"> <p>
To see the first assertion note that <script type="math/tex">\displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {\sqrt{h^2 +k^2}}=0.</script> This together with (<a class="ref" href="../../notes/course_notes/index.html#diff_cont">2.12</a>) and the limit rules in lemma 1.4.1, gives us 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {\sqrt{h^2 +k^2}}\cdot \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} \frac{f(a+h, b+k)-f(a,b)- {\bf v}\cdot (h,k)}{\sqrt{h^2 +k^2}}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {f(a+h, b+k)-f(a,b)- {\bf v}\cdot (h,k)}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {f(a+h, b+k)-f(a,b)}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {f(a+h, b+k)=f(a,b)}.</script></span>
<p>
This is the definition of continuity (see section 1.4.4) and so a differentiable function at a point is continuous there also. (NB the converse is <b class="bf">not</b> true! Just fold a piece of paper and make a crease: the surface is continuous, but not differentiable for the reason we now see below.) 
</p>
</li>
<li id="diff"> <p>
To see the second assertion, note that we get the same limit if we let <script type="math/tex">k=0</script> in (<a class="ref" href="../../notes/course_notes/index.html#diff_cont">2.12</a>), since for the limit to exist, which it does by assumption, the value must be the same, regardless of the direction of approach. We can pick to approach the limit from a direction where <script type="math/tex">k=0</script>, without loss of generality. Hence we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(h,0) \rightarrow (0,0)}} \frac{f(a+h, b)-f(a,b)-(v_1, v_2)\cdot (h,0)}{|h|}=0.</script></span>
<p>
Since the limit exists by assumption and equals zero by definition, it does not depend on whether <script type="math/tex">h>0</script> or <script type="math/tex">h<0</script> (any extra negative sign <script type="math/tex">(-1)</script> from the modulus may be divided away into the zero). Hence we can write: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h \rightarrow 0}}\frac{f(a+h, b)-f(a,b)-(v_1, v_2)\cdot (h,0)}{h}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{h \rightarrow 0}} \frac{f(a+h, b)-f(a,b)}{h}-v_1=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad v_1=\displaystyle {\lim _{h \rightarrow 0}} \frac{f(a+h, b)-f(a,b)}{h}=\frac{\partial f}{\partial x}(a,b).</script></span>
<p>
Similarly, by letting <script type="math/tex">h=0</script>, we get 
</p>
<span class="dmath"><script type="math/tex; mode=display">v_2=\displaystyle {\lim _{k\rightarrow 0}} \frac{f(a, b+k)-f(a,b)}{h}=\frac{\partial f}{\partial y}(a,b).</script></span>
<p>
 Note that the vector 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf v}=(v_1, v_2)=\left(\frac{\partial f}{\partial x}(a,b),\frac{\partial f}{\partial y}(a,b)\right)</script></span>
<p>
 is thus just the gradient of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(a,b)</script>. 
</p>
</li>
</ul>
<p>
We have just shown that if a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is differentiable at a point <script type="math/tex">(a,b)\in \mathbb R^2</script>, then it is continuous at <script type="math/tex">(a,b)</script> and its partial derivatives <script type="math/tex">{\displaystyle \frac{\partial f}{\partial x}}</script> and <script type="math/tex">{\displaystyle \frac{\partial f}{\partial y}}</script> exist at that point. Equivalently, if <script type="math/tex">f</script> is differentiable, <script type="math/tex">\nabla f</script> exists at <script type="math/tex">(a,b)</script>. 
</p>
<p>
There is a useful criteria that almost states the converse, guaranteeing that a function is differentiable at a given point. The proof of the theorem is not required, but we will use it in the subsequent examples. 
</p>
<p>
 If both partial derivatives <script type="math/tex">{\displaystyle \frac{\partial f}{\partial x}}</script> and <script type="math/tex">{\displaystyle \frac{\partial f}{\partial y}}</script> of a function <script type="math/tex">f: \mathbb R^2\to \mathbb R</script> exist and are continuous on a neighbourhood of a point <script type="math/tex">(a,b)</script> then <script type="math/tex">f</script> is differentiable at <script type="math/tex">(a,b)</script>.  
</p>
<p>
<b class="bf">Example:</b> Show that the function 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y)= x^2 +y^2+ xy \exp {(x^2+y^2)}</script></span>
<p>
 is differentiable. 
</p>
<p>
First, we compute the partial derivatives. <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\displaystyle \frac{\partial f}{\partial x}}(x,y)=2x +y\exp {(x^2+y^2)}+ 2x^2y\exp {(x^2+y^2)},</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\displaystyle \frac{\partial f}{\partial y}}(x,y)=2y +x\exp {(x^2+y^2)}+ 2xy^2\exp {(x^2+y^2)}.</script></span></span> As these partial derivatives are formed from continuous functions via products, sums and compositions they are also continuous. So, by Theorem <a class="ref" href="../../notes/course_notes/index.html#diff">2</a>, <script type="math/tex">f(x,y)</script> is differentiable. 
</p>
<p>
The definition of differentiability leads us on to a really neat trick. 
</p>
</section>
</section><section class="section">
<h2 id="direction">2.10 Directional derivative</h2>
<section class="subsection">
<h3 id="a0000000200">2.10.1 Definition of Directional Derivative</h3>
<p>
For a function of two or more variables, we have already seen that its partial derivatives describe the rate of change of the function in either <script type="math/tex">x</script> or <script type="math/tex">y</script> directions depending which partial derivative we consider. In this section we discuss how one can measure the rate of change of such a function in <b class="bf">any</b> chosen direction. 
</p>
<p>
We can appeal to the definitions of partial derivatives of a function <script type="math/tex">f(x,y)</script> in the <script type="math/tex">x</script> and <script type="math/tex">y</script> directions and write down a definition of the derivative of a function in the direction of a unit vector <b class="bf">w</b> emerging from the point <script type="math/tex">(a, b, f(a,b))</script> and tangential to the surface in that direction. 
</p>
<p>
<b class="bf">Definition: (Directional Derivative)</b> Let <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> and <script type="math/tex">{\bf u}</script> be a unit vector in <script type="math/tex">{\mathbb R}^2</script>. The <em>directional derivative</em> (or <em>rate of change</em>) of <script type="math/tex">f</script> in the direction <script type="math/tex">{\bf u}</script> at the point <script type="math/tex">(a,b)\in \mathbb R^2</script> is defined to be 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u}(f)(a,b) = \lim _{h\rightarrow 0} \frac{f((a,b) + h{\bf u}) - f(a,b)}{h}.</script></span>
<p>
 provided this limit exists. 
</p>
<figure id="DirectionalDerivativs">
<div class="centered"> <img src="../../notes/course_notes/images/img-0056.png" style="width:271.0125pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.30</span>
<span class="caption_text">The tangent plane <script type="math/tex">{\mathcal T}</script> to surface <script type="math/tex">z=f(x,y)</script> at point <script type="math/tex">P:(a,b,f(a,b))</script> contains an infinite number of vectors <script type="math/tex">{\bf w}_ i</script>. The derivative of the function <script type="math/tex">f(x,y)</script> is, in general, different in each of these directions. The projection of these vectors <script type="math/tex">{\bf w}_{i}</script> onto a unit disk <script type="math/tex">{\mathcal C}</script> centred at <script type="math/tex">Q:(a,b)</script> are unit vectors <script type="math/tex">{\bf u}_{i}</script>. <script type="math/tex">(x,y)</script> plane are unit vectors <script type="math/tex">{\bf u}_{i}</script></span>
</figcaption> </div>
</figure>
<p>
Actually, by working through the definition of the derivative, we can come up with a much simpler formula for the directional derivative that is easy to use in practice. 
</p>
<p>
 Suppose <script type="math/tex">f: \mathbb R^2\to \mathbb R</script> is differentiable at <script type="math/tex">(a,b)\in \mathbb R^2</script> and <script type="math/tex">{\bf u}</script> is a unit vector. Then the directional derivative of <script type="math/tex">f</script> in the direction <script type="math/tex">{\bf u}</script> at <script type="math/tex">(a,b)</script> is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (a,b) = \nabla f(a,b) \cdot {\bf u}.</script></span>
<div class="proof_wrapper" id="a0000000201">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We can write <script type="math/tex">{\bf u} = (\alpha , \beta )\in \mathbb R^2</script> where <script type="math/tex">\alpha ^2+\beta ^2=1</script>, because <script type="math/tex">{\bf u}</script> is a unit vector. Since <script type="math/tex">f: \mathbb R^2\to \mathbb R</script> is differentiable at <script type="math/tex">(a,b)</script>, by (<a class="ref" href="../../notes/course_notes/index.html#diff_cont">2.12</a>) and Theorem <a class="ref" href="../../notes/course_notes/index.html#diff_cont">2.12</a>, we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a +h\alpha ,b+h\beta )-f(a,b)- {\nabla f(a,b)}\cdot (h\alpha ,h\beta )}{\sqrt{(h\alpha )^2 +(h\beta )^2}}=0</script></span>
<p>
 Since <script type="math/tex">\alpha ^2+\beta ^2=1</script>, it follows that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a +h\alpha ,b+h\beta )-f(a,b)- {\nabla f(a,b)}\cdot (h\alpha ,h\beta )}{h}=0.</script></span>
<p>
 This gives us 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a +h\alpha ,b+h\beta )-f(a,b)}{h}=\nabla f(a,b) \cdot (\alpha , \beta ).</script></span>
<p>
 But the left-hand side of the above identity is exactly the directional derivative and thus 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u}(f)(a,b)=\nabla f(a,b) \cdot {\bf u}</script></span>
<p>
 as desired. 
</p>
</div>
</div>
</section><section class="subsection">
<h3 id="a0000000202">2.10.2 Geometric Meaning of Directional Derivative</h3>
<p>
 We are now in a position to deduce the geometric meaning of the gradient that we introduced above, from the definition of the directional derivative. We use the property of dot products that 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf a}\cdot {\bf b} = |{\bf a}|\:  |{\bf b}|\cos (\theta )</script></span>
<p>
 where <script type="math/tex">\theta </script> is the angle between <script type="math/tex">{\bf a}</script> and <script type="math/tex">{\bf b}</script>. Letting <script type="math/tex">\theta </script> be the angle between <script type="math/tex">\nabla f(a,b)</script> and <script type="math/tex">{\bf u}</script>, we see that 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (a,b) = \nabla f(a,b) \cdot {\bf u} = | \nabla f(a,b)| \:  |{\bf u}|\cos (\theta ) = | \nabla f(a,b)|\cos (\theta ),</script></span>
<p>
 since <script type="math/tex">{\bf u}</script> is a unit vector. 
</p>
<p>
We see that since <script type="math/tex">\nabla f(a,b)</script> is given constant vector when evaluated at the point <script type="math/tex">(a,b)</script>, to maximise <script type="math/tex">D_{\bf u} (f) (a,b)</script>, we only need to maximise <script type="math/tex">\cos (\theta )</script>. Therefore, we obtain the following geometric properties of the gradient. 
</p>
<figure id="TangentPlane">
<div class="centered"> <img src="../../notes/course_notes/images/img-0058.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.31</span>
<span class="caption_text">Geometric meaning of directional derivative relative to a unit vector <b class="bf">u</b> and the gradient vector <script type="math/tex">\nabla f</script> at a point <script type="math/tex">(a,b)</script>, superimposed on a contour plot of a <script type="math/tex">\mathbb R^{2}\to \mathbb R</script> function.</span>
</figcaption> </div>
</figure>
<ol class="enumerate" id="a0000000203" style="list-style: none">
<li id="a0000000204" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
The function <script type="math/tex">f</script> increase the most rapidly at <script type="math/tex">(a,b)</script> when <script type="math/tex">\theta = 0</script>, which is when <script type="math/tex">{\bf u}</script> is pointing in the same direction as <script type="math/tex">\nabla f(a,b)</script>.<br/>
</p>
</li>
<li id="a0000000205" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
The function <script type="math/tex">f</script> decrease the most rapidly at <script type="math/tex">(a,b)</script> when <script type="math/tex">\theta = \pi </script>, which is when <script type="math/tex">{\bf u}</script> is pointing in the opposite direction as <script type="math/tex">\nabla f(a,b)</script>.<br/>
</p>
</li>
<li id="a0000000206" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
The rate of change of the function <script type="math/tex">f</script> is zero <script type="math/tex">(a,b)</script> when <script type="math/tex">\theta = {\pi \over 2}</script>, which is when <script type="math/tex">{\bf u}</script> is perpendicular to the direction of <script type="math/tex">\nabla f(a,b)</script>. 
</p>
</li>
<li id="a0000000207" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Choosing <b class="bf">u</b>=<b class="bf">i</b> we obtain 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf i} (f) (x,y)=\nabla f \cdot {\bf i}=\frac{\partial f}{\partial x}</script></span>
</li>
<li id="a0000000208" value="5">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Choosing <b class="bf">u</b>=<b class="bf">j</b> we obtain 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf j} (f) (x,y)=\nabla f \cdot {\bf j}=\frac{\partial f}{\partial y}</script></span>
</li>
</ol>
<p>
 For a given function <script type="math/tex">f(x,y)</script>, the sorts of calculations we do with the directional derivative involve solving the equation <script type="math/tex">D_{\bf u}(f)(a,b) = c</script> when two of the parameters <script type="math/tex">{\bf u}</script>, <script type="math/tex">(a,b)</script> and <script type="math/tex">c</script> are specified. 
</p>
</section><section class="subsection">
<h3 id="a0000000209">2.10.3 Examples of Directional Derivative</h3>
<p>
<b class="bf">Examples:</b>
</p>
<p>
Evaluate the directional derivative of the function <script type="math/tex">z=f(x,y)</script> where <script type="math/tex">f(x,y)=e^{x^2+y^2}</script> at the point <script type="math/tex">(x,y)=(1,1)</script> in the direction 
</p>
<p>
(a) <script type="math/tex">{\bf i}+{\bf j}</script>. 
</p>
<ul class="itemize" id="a0000000210">
<li id="a0000000211"> <p>
Remember that to find the directional derivative <b class="bf">u</b> has to be a <b class="bf">unit vector</b>. Hence we must have that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\frac{{\bf i}+{\bf j}}{|{\bf i}+{\bf j}|}=\frac{1}{\sqrt{2}}\left({\bf i}+{\bf j}\right).</script></span></span>
</p>
</li>
<li id="a0000000212"> <p>
We calculate the gradient of <script type="math/tex">f(x,y)</script> as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) =\frac{\partial }{\partial x}\left(e^{x^2+y^2}\right){\bf i}+\frac{\partial }{\partial y}\left(e^{x^2+y^2}\right){\bf j}=2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000213"> <p>
Therefore we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (x,y) = \nabla f(x,y) \cdot {\bf u}=\left(2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}\right)\cdot \frac{1}{\sqrt{2}}\left({\bf i}+{\bf j}\right)=\left(\sqrt{2}xe^{x^2+y^2}+\sqrt{2}ye^{x^2+y^2}\right).</script></span></span>
</p>
</li>
<li id="a0000000214"> <p>
Hence when <script type="math/tex">(x,y)=(1,1)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (1,1)=\left(\sqrt{2}e^{2}+\sqrt{2}e^{2}\right)=2\sqrt{2}e^{2}.</script></span></span>
</p>
</li>
</ul>
<p>
(b) <script type="math/tex">{\bf i}-{\bf j}</script>
</p>
<ul class="itemize" id="a0000000215">
<li id="a0000000216"> <p>
Remember that to find the directional derivative <b class="bf">u</b> has to be a <b class="bf">unit vector</b>. Hence we must have that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\frac{{\bf i}+{\bf j}}{|{\bf i}-{\bf j}|}=\frac{1}{\sqrt{2}}\left({\bf i}-{\bf j}\right).</script></span></span>
</p>
</li>
<li id="a0000000217"> <p>
We calculate the gradient of <script type="math/tex">f(x,y)</script> as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) =\frac{\partial }{\partial x}\left(e^{x^2+y^2}\right){\bf i}+\frac{\partial }{\partial y}\left(e^{x^2+y^2}\right){\bf j}=2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000218"> <p>
Therefore we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (x,y) = \nabla f(x,y) \cdot {\bf u}=\left(2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}\right)\cdot \frac{1}{\sqrt{2}}\left({\bf i}-{\bf j}\right)=\left(\sqrt{2}xe^{x^2+y^2}-\sqrt{2}ye^{x^2+y^2}\right).</script></span></span>
</p>
</li>
<li id="a0000000219"> <p>
Hence when <script type="math/tex">(x,y)=(1,1)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (1,1)=\left(\sqrt{2}e^{2}-\sqrt{2}e^{2}\right)=0.</script></span></span> So we may also conclude that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\frac{1}{\sqrt{2}}\left({\bf i}-{\bf j}\right)</script></span></span> is in the direction of the level contour of <script type="math/tex">f(x,y)</script> at the point <script type="math/tex">(x,y)=(1,1)</script>. 
</p>
</li>
</ul>
<figure id="TangentPlane">
<div class="centered"> <img src="../../notes/course_notes/images/img-0060.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.32</span>
<span class="caption_text">The level contour lines of <script type="math/tex">f(x,y)=e^{-(x^{2}+2y^{2})}</script> with gradient vectors at the point <script type="math/tex">(x,y)=(1,1)</script> superimposed. The unit vector <b class="bf">u</b><script type="math/tex">=({\bf i}-{\bf j})/Sqrt{2}</script> extending from <script type="math/tex">(1,1)</script> is also shown. Since <script type="math/tex">\nabla f(1,1)\cdot {\bf u}=0</script>, the vector <b class="bf">u</b> is perpendicular to the gradient vector and is thus locally parallel to the level contour line.</span>
</figcaption> </div>
</figure>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b>
</p>
<p>
Evaluate the Directional derivative of the above function at <script type="math/tex">(x,y) =(0,0)</script> in every direction. Comment on the result: 
</p>
<ul class="itemize" id="a0000000220">
<li id="a0000000221"> <p>
Let <script type="math/tex">{\bf u}=\alpha {\bf i}+ \beta {\bf j}</script> where <script type="math/tex">\alpha ^2+\beta ^2=1</script>, so that <script type="math/tex">{\bf u}</script> is a unit vector. 
</p>
</li>
<li id="a0000000222"> <p>
We know that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y)=2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}</script></span></span>
</p>
</li>
<li id="a0000000223"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (x,y)=\left(2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}\right)\cdot \left(\alpha {\bf i}+\beta {\bf j}\right)=\left(2\alpha xe^{x^2+y^2}+2\beta ye^{x^2+y^2}\right)</script></span></span>
</p>
</li>
<li id="a0000000224"> <p>
Hence when <script type="math/tex">(x,y)=(1,1)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (0,0)=\left(2\alpha \times 0 \times e^{0^2+0^2}+2\beta \times 0 \times e^{0^2+0^2}\right)=0, \qquad \forall (\alpha , \beta ).</script></span></span> Hence the directional derivative at <script type="math/tex">(0,0)</script> is everywhere zero in no matter what direction you look in. 
</p>
</li>
<li id="a0000000225"> <p>
Does this mean the function is everywhere constant? Clearly from the previous examples, we know that the directional derivatives do vary, depending on the evaluation point. The actual reason is easily seen by realising that at <script type="math/tex">(x,y)=(0,0)</script> the surface has a local maximum. This gives a hint towards how we are going to find local maxima and minima in the next couple of sections. 
</p>
</li>
</ul>
<figure id="LocalMaximum">
<div class="centered"> <img src="../../notes/course_notes/images/img-0062.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.33</span>
<span class="caption_text">Value of directional derivative of <script type="math/tex">z=e^{-(x^{2}+y^{2})}</script> at <script type="math/tex">(x,y)=(0,0)</script> in any direction <b class="bf">u</b> is zero, since the function is locally horizontal at that point, and is in fact a local maximum. This can also be seen from the fact that the contour at that point is just an isolated point and not a line.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b>
</p>
<p>
Given the function <script type="math/tex">z=f(x,y)=x^2+2y^2</script>, work out the direction of the steepest ascent and the steepest descent at the point <script type="math/tex">(x,y)=(2,1)</script>. 
</p>
<ul class="itemize" id="a0000000226">
<li id="a0000000227"> <p>
We know that the function increases most rapidly at <script type="math/tex">(2,1)</script> when <b class="bf">u</b> is pointing in the same direction as <script type="math/tex">\nabla f(2,1)</script>. 
</p>
</li>
<li id="a0000000228"> <p>
We also know that at that point <script type="math/tex">f</script> decreases most rapidly in the direction <script type="math/tex">-\nabla f(2,1)</script>. 
</p>
</li>
<li id="a0000000229"> <p>
We find that <script type="math/tex">\nabla f(x,y)</script> is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=\frac{\partial }{\partial x}\left(x^2+2y^2\right){\bf i}+\frac{\partial }{\partial y}\left(x^2+2y^2\right){\bf j}=2x{\bf i}+4y{\bf j}</script></span></span>
</p>
</li>
<li id="a0000000230"> <p>
Hence we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(2,1)=(2\times 2){\bf i}+(4\times 1){\bf j}=4{\bf i}+4{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000231"> <p>
Hence the path of steepest ascent at <script type="math/tex">(x,y)=(2,1)</script> is in the direction <script type="math/tex">4{\bf i}+4{\bf j}</script>, or <script type="math/tex">({\bf i}+{\bf j})/\sqrt{2}</script> if you want to express it as a unit vector. 
</p>
</li>
<li id="a0000000232"> <p>
Hence the path of steepest descent at <script type="math/tex">(x,y)=(2,1)</script> is in the direction <script type="math/tex">-4{\bf i}-4{\bf j}</script> or <script type="math/tex">-({\bf i}+{\bf j})/\sqrt{2}</script> if you want to express it as a unit vector. 
</p>
</li>
</ul>
<figure id="TangentPlane">
<div class="centered"> <img src="../../notes/course_notes/images/img-0064.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.34</span>
<span class="caption_text">The level contour lines of <script type="math/tex">f(x,y)=x^{2}+2y^{2}</script> with gradient vectors at the point <script type="math/tex">(x,y)=(2,1)</script> superimposed. Left: The vector <script type="math/tex">\nabla f(2,1)</script> gives the direction of steepest <i class="it">ascent</i> at the point <script type="math/tex">(2,1)</script>, i.e., the direction perpendicular to the level contours lines of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(2,1)</script> with a positive gradient. The value of <script type="math/tex">|\nabla f(2,1)|</script> gives the slope of the surface at that point in the steepest ascent direction. Right: The <b class="bf">unit</b> vector <script type="math/tex">-\nabla f(2,1)/|\nabla f(2,1)|</script> gives the direction of steepest <i class="it">descent</i> at the point <script type="math/tex">(2,1)</script>, i.e., the direction perpendicular to the level contours lines of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(2,1)</script> with a negative gradient. The value of <script type="math/tex">-|\nabla f(2,1)|</script> gives the slope of the surface at that point in the steepest descent direction (although we have chosen only to draw the unit vector on the diagram). </span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b>
</p>
<p>
For the same function calculate the direction of the contour lines through <script type="math/tex">(x,y)=(2,1)</script>. 
</p>
<ul class="itemize" id="a0000000233">
<li id="a0000000234"> <p>
The direction of the level contour lines <b class="bf">u</b> through a point satisfy 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(2,1)\cdot {\bf u} =0,</script></span>
<p>
 i.e., the directional derivative in that direction is zero. 
</p>
</li>
<li id="a0000000235"> <p>
Let <script type="math/tex">{\bf u}=\cos \theta {\bf i} + \sin \theta {\bf j}</script>, where <script type="math/tex">\theta </script> is the angle in the horizontal <script type="math/tex">(x,y)</script> plane to the positive real axis of the level lines at <script type="math/tex">(x,y)=(2,1)</script>. 
</p>
</li>
<li id="a0000000236"> <p>
We thus have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(2,1) \cdot {\bf u} =\left(4{\bf i}+4{\bf j}\right)\cdot \left(\cos \theta {\bf i} + \sin \theta {\bf j}\right)=4\left(\cos \theta +\sin \theta \right)=0.</script></span></span>
</p>
</li>
<li id="a0000000237"> <p>
Hence <script type="math/tex">\theta </script> must satisfy: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\cos \theta +\sin \theta =0 \qquad \Rightarrow \qquad \sin \theta = -\cos \theta \qquad \Rightarrow \qquad \tan \theta =-1 \qquad \Rightarrow \qquad \theta =-\frac{\pi }{4} \  {\rm or} \  \frac{3\pi }{4}.</script></span></span>
</p>
</li>
<li id="a0000000238"> <p>
Hence the level lines are in the directions <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\cos \left(-\frac{\pi }{4} \right) {\bf i} + \sin \left(-\frac{\pi }{4} \right) {\bf j}=\frac{1}{\sqrt{2}}\left( {\bf i} - {\bf j}\right)</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\cos \left(\frac{3\pi }{4} \right) {\bf i} + \sin \left(\frac{3\pi }{4} \right) {\bf j}=\frac{1}{\sqrt{2}}\left( -{\bf i} + {\bf j}\right)</script></span></span>
</p>
</li>
</ul>
<figure id="TangentPlane">
<div class="centered"> <img src="../../notes/course_notes/images/img-0066.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.35</span>
<span class="caption_text">The level contour lines of <script type="math/tex">f(x,y)=x^{2}+2y^{2}</script> with the direction vectors <script type="math/tex">{\bf u}=\pm ({\bf i}-{\bf j})/\sqrt{2}</script> superimposed as <script type="math/tex">(x,y)=(2,1)</script>, where they are parallel to the level contours through that point.</span>
</figcaption> </div>
</figure>
</section>
</section><section class="section">
<h2 id="a0000000239">2.11 Computation of Steepest Paths and Contour Lines</h2>
<p>
 Having seen that we can derive the direction of steepest ascent/descent or level lines at any particular point, we now examine how to compute the corresponding paths of steepest ascent/descent or level lines as you take an extended walk away from any particular point. 
</p>
<p>
<b class="bf">Example:</b> The height on a hill is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=\frac{1}{\sqrt{(1+x^{2}+2y^{2})}}.</script></span>
<p>
 A stream starts at the point <script type="math/tex">(2,1, f(2,1))</script> follows the path of steepest descent away from that point. Compute the trajectory of stream. 
</p>
<ul class="itemize" id="a0000000240">
<li id="a0000000241"> <p>
We know that the path of steepest descent is in the direction of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-\nabla f=-\frac{\partial f}{\partial x}{\bf i} -\frac{\partial f}{\partial y}{\bf j}=-\frac{x}{(1+x^{2}+2y^{2})^{3/2}}{\bf i} -\frac{2y}{(1+x^{2}+2y^{2})^{3/2}}{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000242"> <p>
Let the path of steepest descent in projection be given by <script type="math/tex">y=y(x)</script>. The slope <script type="math/tex">y'(x)</script> must then be parallel at each point to <script type="math/tex">-\nabla f</script>. 
</p>
</li>
<li id="a0000000243"> <p>
Hence we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{y {\rm \  component \  of} (-\nabla f)}{x{\rm \  component \  of} (-\nabla f)}=\frac{-2y}{(1+x^{2}+2y^{2})^{3/2}}\times \frac{(1+x^{2}+2y^{2})^{3/2}}{-x}=\frac{2y}{x}.</script></span></span>
</p>
</li>
<li id="a0000000244"> <p>
Thus the steepest path satisfies <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{2y}{x} \qquad \Rightarrow \qquad \int \frac{dy}{y}=2\int \frac{dx}{x} \qquad \Rightarrow \qquad \ln y=2\ln x + \ln C</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \ln y=\ln \left(Cx^{2}\right) \qquad \Rightarrow \qquad y=Cx^{2}</script></span></span>
</p>
</li>
<li id="a0000000245"> <p>
Inserting the initial point of <script type="math/tex">(x,y)=(2,1)</script> we see that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1=C \times 2^{2}\qquad \Rightarrow \qquad C=1/4.</script></span></span>
</p>
</li>
<li id="a0000000246"> <p>
Hence the steepest descent path from <script type="math/tex">(2,1)</script> follows the path <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=x^{2}/4</script></span></span> in the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="SD1">
<div class="centered"> <img src="../../notes/course_notes/images/img-0068.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.36</span>
<span class="caption_text">Steepest descent path from point above <script type="math/tex">(2,1)</script> on surface <script type="math/tex">z=\frac{1}{\sqrt{1+x^{2}+2y^{2}}}</script>. The left hand diagram shows the contour plot of <script type="math/tex">f(x,y)=</script> constant, together with the projection of the steepest descent path from <script type="math/tex">(2,1)</script> in the <script type="math/tex">(x,y)</script> plane. The right hand diagram is a plot of the surface <script type="math/tex">(x,y,z=f(x,y))</script> in <script type="math/tex">\mathbb R^{3}</script>. The steepest descent path from <script type="math/tex">(2.1)</script> is also show. It is the three dimensional curve with coordinates given by <script type="math/tex">(x,y(x), z=f(x,y(x)))</script> as explained in the text.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000247"> <p>
In <script type="math/tex">(x,y,z)\in \mathbb R^{3}</script>, the steepest descent curve of course sits on the surface <script type="math/tex">z=f(x,y)</script>. Its coordinates are thus given parametrically by <script type="math/tex">(x,y(x), z=f(x,y(x)))</script>, where 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  x& =& x, \\ y& =& y(x)=x^2/4, \\ z& =& f(x,y(x))=\frac{1}{\sqrt{1+x^2+2(x^2/4)^2}}=\frac{1}{\sqrt{1+x^2+{x^4}/8}}. \end{eqnarray*}</script></span>
</li>
</ul>
<p>
<b class="bf">Example:</b> The height on a hill is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=e^{-(x^{2}+3y^{2})}.</script></span>
<p>
 Find the equation of the level contours, i.e., <script type="math/tex">z(x,y)=c</script> (without doing the obvious!). 
</p>
<ul class="itemize" id="a0000000248">
<li id="a0000000249"> <p>
We know that the contour is in the direction <script type="math/tex">{\bf v}</script>, where <script type="math/tex">{\bf v}.\nabla f=0</script>. 
</p>
</li>
<li id="a0000000250"> <p>
We have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f=\frac{\partial f}{\partial x}{\bf i} +\frac{\partial f}{\partial y}{\bf j}=-2xe^{-(x^{2}+3y^{2})}{\bf i} -6ye^{-(x^{2}+3y^{2})}{\bf j}.</script></span>
</li>
<li id="a0000000251"> <p>
Hence a suitable <b class="bf">v</b> would be: 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf v}=6ye^{-(x^{2}+3y^{2})}{\bf i} -2xe^{-(x^{2}+3y^{2})}{\bf j}.</script></span>
</li>
<li id="a0000000252"> <p>
Let the level contour in projection be given by <script type="math/tex">y=y(x)</script>. The slope <script type="math/tex">y'(x)</script> must then be parallel at each point to <script type="math/tex">{\bf v}</script>. 
</p>
</li>
<li id="a0000000253"> <p>
Hence we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{y {\rm \  component \  of \  } {\bf v}}{x{\rm \  component \  of \  } {\bf v}}=\frac{-2xe^{-(x^{2}+3y^{2})}}{6ye^{-(x^{2}+3y^{2})}}=\frac{-x}{3y}.</script></span>
</li>
<li id="a0000000254"> <p>
Thus the level contour satisfies 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{-x}{3y} \qquad \Rightarrow \qquad 3\int y \,  dy=-\int x\,  dx \qquad \Rightarrow \qquad \frac{3}{2}y^{2}=-\frac{x^{2}}{2}+C</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \frac{x^{2}}{2}+\frac{3}{2}y^{2}=C \Rightarrow \qquad \frac{x^{2}}{2C}+\frac{3}{2C}y^{2}=1.</script></span>
</li>
<li id="a0000000255"> <p>
These are confocal ellipses of semi major/minor axes <script type="math/tex">\sqrt{2C}</script> and <script type="math/tex">\sqrt{2C/3}</script>. 
</p>
</li>
<li id="a0000000256"> <p>
Inserting an initial point of <script type="math/tex">(x,y)=(1,1)</script>, say, we see that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{1^{2}}{2}+\frac{3}{2}1^{2}=C \qquad \Rightarrow \qquad C=2.</script></span>
</li>
<li id="a0000000257"> <p>
Hence the level contour through <script type="math/tex">(1,1)</script> follows the path 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{x^{2}}{4}+\frac{3}{4}y^{2}=1</script></span>
<p>
. 
</p>
</li>
</ul>
<figure id="SD1">
<div class="centered"> <img src="../../notes/course_notes/images/img-0070.png" style="width:198.74249999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.37</span>
<span class="caption_text">Level contours <script type="math/tex">\frac{x^{2}}{4C}+\frac{3}{4C}y^{2}=1</script> of surface <script type="math/tex">z=e^{-(x^{2}+3y^{2})}</script>. The bold contour is the level contour through <script type="math/tex">(1,1)</script>, i.e., <script type="math/tex">\frac{x^{2}}{4}+\frac{3}{4}y^{2}=1</script>.</span>
</figcaption> </div>
</figure>
<p>
Of course, we could have just spotted what the level contours were by just observing that <script type="math/tex">z=</script> constant when <script type="math/tex">x^{2}+3y^{2}</script>=constant. However this example is to demonstrate how curves other than steepest descent ones may be calculated. 
</p>
</section><section class="section">
<h2 id="PD1">2.12 Higher Order Partial Derivatives</h2>
<p>
So far we have just looks at the first partial derivatives of multivariable functions. Now we consider higher order partial derivatives. Again we initially focus on <script type="math/tex">f:\mathbb R^2\to \mathbb R</script>. 
</p>
<p>
Suppose that a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> may be differentiated twice. We then have the following sequence of partial derivatives. 
</p>
<figure>
<div class="centered"> <img src="../../notes/course_notes/images/img-0072.png" style="width:415.55249999999995pt"/>
</div>
</figure>
<p>
Thus we have up to four second-order partial derivatives. At higher orders the pyramid structure propagates. (Question: How many partial derivatives are there at order <script type="math/tex">n</script>?) 
</p>
<p>
For ease of writing the subscript notation is often used: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^2 f}{\partial x^2}=f_{xx}, \qquad \frac{\partial ^2 f}{\partial y\partial x}=f_{yx}, \qquad \frac{\partial ^2 f}{\partial x\partial y}=f_{xy}, \qquad \frac{\partial ^2 f}{\partial y^2}=f_{yy}.</script></span>
<p>
<b class="bf">Example:</b> <script type="math/tex">f(x,y)=x^{2}-1+y+\sin ({xy})</script> <span style="color:#FF0000"><div id="a0000000258">
<script type="math/tex; mode=display">
\begin{align}
 \frac{\partial ^{2} f}{\partial x^{2}}& =& \frac{\partial }{\partial x}\left(2x+y\cos (xy)\right)=2-y^{2}\sin (xy). \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial ^2 f}{\partial y\partial x}& =& \frac{\partial }{\partial y}\left(2x+y\cos (xy)\right)=\cos (xy)-xy\sin (xy).\nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial ^2 f}{\partial x\partial y}& =& \frac{\partial }{\partial x}\left(1+x\cos (xy)\right)=\cos (xy)-xy\sin (xy).\nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial ^{2} f}{\partial y^{2}}& =& \frac{\partial }{\partial y}\left(1+x\cos (xy)\right)=-x^{2}\sin (xy). 
\end{align}
</script>
</div></span>
</p>
<p>
<b class="bf">Example:</b> Given <script type="math/tex">w=f(x,y,z)=x\cos (z)+\sin (xy)</script>, calculate <script type="math/tex">\displaystyle {\frac{\partial ^3 w}{\partial z\partial x^2} }</script>, <script type="math/tex">\displaystyle {\frac{\partial ^3 w}{\partial x\partial z\partial x}} </script>, and <script type="math/tex">\displaystyle {\frac{\partial ^3 w}{\partial x^2\partial z}} </script>. 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\frac{\partial ^3 w}{\partial z\partial x^2} }=\frac{\partial ^2 w}{\partial z\partial x}(\cos (z)+y\cos (xy))=\frac{\partial w}{\partial z}(-y^2\sin (x))=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\frac{\partial ^3 w}{\partial x\partial z\partial x} }=\frac{\partial ^2 w}{\partial x\partial z}(\cos (z)+y\cos (xy))=\frac{\partial w}{\partial x}(-\sin (z))=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\frac{\partial ^3 w}{\partial x^2\partial z} }=\frac{\partial ^2 w}{\partial x^2}(-x\sin (z))=\frac{\partial w}{\partial x}(-\sin (z))=0.</script></span></span>
</p>
<p>
The above examples suggest that under certain circumstances the order in which the partial derivatives are performed is irrelevant. In fact the following theorem holds. 
</p>
<p>
 Let <script type="math/tex">f: \mathbb R^ n\to \mathbb R</script> be a function. Suppose for some positive integer <script type="math/tex">k</script>, there exists a neighbourhood <script type="math/tex">U</script> of a point <script type="math/tex">P\in \mathbb R^ n</script> such that <script type="math/tex">f</script> and all its partial derivatives of order less than <script type="math/tex">k</script> are continuous on <script type="math/tex">U</script>. Then any two mixed partial derivatives of order <script type="math/tex">k</script> involving the same variables but in different sequential orders are equal at <script type="math/tex">P</script>, provided those partial derivatives are continuous at <script type="math/tex">P</script>.  
</p>
<p>
Boiled down to something digestible for <script type="math/tex">f:\mathbb R^{2}\to \mathbb R</script> and for second order partial derivatives, we also have the theorem: 
</p>
<p>
<b class="bf">Theorem:</b> If <script type="math/tex">f_{xy}</script> and <script type="math/tex">f_{yx}</script> are continuous at <script type="math/tex">(x,y)= (a,b)</script> then they are equal there. 
</p>
<p>
<b class="bf">Proof:</b> Uses the mean value theorem, but is not required. 
</p>
<p>
So provided the mixed partial derivatives of order up to <script type="math/tex">k</script> are continuous at a point, then all the mixed partial derivatives of order <script type="math/tex">k</script> will all be equal. This reduces dramatically the number of partial derivatives at higher order, so that for example, sufficiently continuous functions and their partial derivatives, <script type="math/tex">f_{xxy}</script> = <script type="math/tex">f_{xyx} = f_{yxx}</script> etc. Hence for such functions, the order in which you do the partial derivatives doesn’t matter. 
</p>
</section><section class="section">
<h2 id="a0000000259">2.13 Changes of Variables in PDES</h2>
<p>
We have seen above that combining the chain rule and changes of variables can be used to simplify first order (partial) differential equations and make them easier to solve. It may be that when expressed in a new set of coordinates that respect the symmetry of the geometry, such an approach can also either simplify the form of PDEs or express the equation in a form that is more amenable to solution in certain geometries. 
</p>
<p>
<b class="bf">Example: (Solving the wave equation in cartesian coordinates)</b> Consider the second order wave equation 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2}u}{\partial t^{2}}=c^{2}\frac{\partial ^{2}u}{\partial x^{2}}.</script></span>
<p>
 We shall see below that the solution of this equation is a superposition of waves travelling to the left and right with speed <script type="math/tex">c</script>. We shall use the intermediate variables: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\xi =x-ct, \qquad \eta =x+ct,</script></span>
<p>
 to write 
</p>
<span class="dmath"><script type="math/tex; mode=display">u=u(\xi (x,t), \eta (x,t))</script></span>
<p>
. 
</p>
<p>
For then we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial t}& =& \frac{\partial u}{\partial \xi }\frac{\partial \xi }{\partial t}+\frac{\partial u}{\partial \eta }\frac{\partial \eta }{\partial t}= c\left(\frac{\partial u}{\partial \xi }-\frac{\partial u}{\partial \eta }\right), \\ \Rightarrow \qquad \frac{\partial ^{2} u}{\partial t^{2}}& =&  \frac{\partial }{\partial t} \left(\frac{\partial u}{\partial t}\right)=c\left(\frac{\partial }{\partial \xi }-\frac{\partial }{\partial \eta }\right)c\left(\frac{\partial u}{\partial \xi }-\frac{\partial u}{\partial \eta }\right) \\ & =& c^{2}\left(\frac{\partial ^{2} u}{\partial \xi ^{2}}-2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right)\\ \end{eqnarray*}</script></span></span> <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial x}& =& \frac{\partial u}{\partial \xi }\frac{\partial \xi }{\partial x}+\frac{\partial u}{\partial \eta }\frac{\partial \eta }{\partial x}= \left(\frac{\partial u}{\partial \xi }+\frac{\partial u}{\partial \eta }\right), \\ \Rightarrow \qquad \frac{\partial ^{2} u}{\partial x^{2}}& =&  \frac{\partial }{\partial x} \left(\frac{\partial u}{\partial x}\right)=\left(\frac{\partial }{\partial \xi }+\frac{\partial }{\partial \eta }\right)\left(\frac{\partial u}{\partial \xi }+\frac{\partial u}{\partial \eta }\right) \\ & =& \left(\frac{\partial ^{2} u}{\partial \xi ^{2}}+2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right)\\ \end{eqnarray*}</script></span></span> So now substituting these two expressions back into the wave equation we obtain: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u}{\partial t^{2}}& =& c\frac{\partial ^{2}u}{\partial x^{2}} \\ c^{2}\left(\frac{\partial ^{2} u}{\partial \xi ^{2}}-2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right)& =& c^{2}\left(\frac{\partial ^{2} u}{\partial \xi ^{2}}+2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right) \\ \Rightarrow \frac{\partial ^{2}u}{\partial \eta \partial \xi }& =& 0 \\ \Rightarrow u(\xi , \eta )& =& F(\xi )+G(\eta ), \\ \Rightarrow u(x, t)& =& F(x-ct)+G(x+ct), \end{eqnarray*}</script></span></span> for arbitrary functions <script type="math/tex">F</script> and <script type="math/tex">G</script>. These might be determined by giving the initial values of the function <script type="math/tex">u(x,0)=F(x)+G(x)</script> and <script type="math/tex">u_{x}(x,0)=F'(x)+G'(x)</script>. You will learn about how to solve such PDEs in second year modules. 
</p>
<p>
<b class="bf">Example: (Rewriting Laplace’s equation in polar coordinates)</b> Consider Laplace’s equation in cartesian coordinates <script type="math/tex">(x,y)</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2}u}{\partial x^{2}}+\frac{\partial ^{2}u}{\partial y^{2}}=0.</script></span>
<p>
 Laplace’s equation is widespread in mathematics and its applications. Its solution in 2-D represents, for example, the shape formed by a soap bubble, the electrostatic potential away from a charge distribution, the gravitational potential away from a mass, the real (or imaginary) part of an analytic complex function, the components of velocity of a steady 2-D incompressible, irrotational fluid flow, <i class="it">etc</i>. In this example we transform the equation from cartesian to plane polar coordinates. This is used to solve the equation whenever there is cylindrical symmetry in the problem. <a class="footnote" href="#a0000000260">
<sup class="footnotemark">7</sup>
</a>
</p>
<p>
Consider the transformations: 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=r\cos \theta , \qquad y= r \sin \theta \qquad \Rightarrow \qquad r=\sqrt{x^{2}+y^{2}}, \qquad \tan \theta =y/x.</script></span>
<p>
 The chain rule is then about transforming from <script type="math/tex">(x,y)</script> to <script type="math/tex">(r,\theta )</script>. We have 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial x}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial x}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial x}, \\ \frac{\partial u}{\partial y}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial y}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial y}. \end{eqnarray*}</script></span>
<p>
Hence we are going to need the following partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial r}{\partial x}=\frac{2x}{2\sqrt{x^{2}+y^{2}}}=\frac{x}{r}=\frac{r\cos \theta }{r}=\cos \theta .</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial r}{\partial y}=\frac{2y}{2\sqrt{x^{2}+y^{2}}}=\frac{y}{r}=\frac{r\sin \theta }{r}=\sin \theta .</script></span></span> The derivatives of <script type="math/tex">\theta </script> with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script> are a little more tricky: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (\tan \theta )}{\partial x}=\sec ^{2}\theta \frac{\partial \theta }{\partial x} \qquad {\rm but} \qquad \frac{\partial (y/x)}{\partial x}=- \frac{y}{x^{2}},</script></span></span> Combining these two identities, using the fact that <script type="math/tex">y/x=\tan \theta </script>, we have in <script type="math/tex">(r,\theta )</script> coordinates: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial \theta }{\partial x} =-\cos ^{2}\theta \frac{y}{x^{2}}= -\cos ^{2}\theta \frac{r\sin \theta }{r^{2}\cos ^{2}\theta }= -\frac{\sin \theta }{r}.</script></span></span> Similarly we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (\tan \theta )}{\partial y}=\sec ^{2}\theta \frac{\partial \theta }{\partial y} \qquad {\rm but} \qquad \frac{\partial (y/x)}{\partial y}= \frac{1}{x},</script></span></span> hence combining these two identities, we have <script type="math/tex">(r,\theta )</script> coordinates: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial \theta }{\partial y} =\frac{\cos ^{2}\theta }{x}=\frac{ \cos ^{2}\theta }{r\cos \theta }= \frac{\cos \theta }{r}</script></span>.</span> Combining these results with the chain rule above we obtain: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial x}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial x}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial x}=\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta }, \\ \frac{\partial u}{\partial y}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial y}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial y}=\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta }. \end{eqnarray*}</script></span>
<p>
 Hence in polar coordinates we can see that the partial derivatives can be written as the following operators: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial }{\partial x}& =& \cos \theta \frac{\partial }{\partial r}-\frac{\sin \theta }{r}\frac{\partial }{\partial \theta }, \\ \frac{\partial }{\partial y}& =& \sin \theta \frac{\partial }{\partial r}+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }. \end{eqnarray*}</script></span></span> Thus we can now write down the second derivatives with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script>: 
</p>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u }{\partial x^{2}}& =& \frac{\partial }{\partial x}\left(\frac{\partial u}{\partial x}\right)=\left(\cos \theta \frac{\partial }{\partial r}- \frac{\sin \theta }{r}\frac{\partial }{\partial \theta }\right)\left(\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta } \right), \\ & =& \cos \theta \frac{\partial }{\partial r}\left(\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta }\right)- \frac{\sin \theta }{r}\frac{\partial }{\partial \theta }\left(\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta }\right), \\ & =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-\cos \theta \sin \theta \frac{\partial }{\partial r}\left(\frac{1}{r}\frac{\partial u}{\partial \theta }\right)-\frac{\sin \theta }{r}\frac{\partial }{\partial \theta }\left(\cos \theta \frac{\partial u}{\partial r}\right)+\frac{\sin \theta }{r^{2}}\frac{\partial }{\partial \theta }\left(\sin \theta \frac{\partial u}{\partial \theta }\right), \\ & =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }-\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\sin ^{2}\theta }{r}\frac{\partial u}{\partial r }-\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }\\ & \qquad &  + \frac{\sin \theta \cos \theta }{r^{2}}\frac{\partial u }{\partial \theta }+\frac{\sin ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}} \\ & =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }-2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\sin ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\sin ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}}.\\ \end{eqnarray*}</script></span></span>
</p>
<p>
Similarly we have: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u }{\partial y^{2}}& =& \frac{\partial }{\partial y}\left(\frac{\partial u}{\partial y}\right)=\left(\sin \theta \frac{\partial }{\partial r}+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }\right)\left(\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta } \right), \\ & =& \sin \theta \frac{\partial }{\partial r}\left(\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta } \right)+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }\left(\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta } \right), \\ & =& \sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+\sin \theta \cos \theta \frac{\partial }{\partial r}\left(\frac{1}{r}\frac{\partial u}{\partial \theta }\right)+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }\left(\sin \theta \frac{\partial u}{\partial r}\right)+\frac{\cos \theta }{r^{2}}\frac{\partial }{\partial \theta }\left(\cos \theta \frac{\partial u}{\partial \theta }\right), \\ & =& \sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-\frac{\sin \theta \cos \theta }{r^{2}}\frac{\partial u}{\partial \theta }+\frac{\sin \theta \cos \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\cos ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial \theta \partial r}\\ & \qquad &  - \frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u }{\partial \theta }+\frac{\cos ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}} \\ & =& \sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }+2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\cos ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\cos ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}}.\\ \end{eqnarray*}</script></span>
<p>
 Now we add the left and right and sides together: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u }{\partial x^{2}}+\frac{\partial ^{2}u }{\partial y^{2}}& =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }-2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\sin ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\sin ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}},\\ & \qquad &  +\sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }+2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\cos ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\cos ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}},\\ & =& \left(\cos ^{2} \theta +\sin ^{2}\theta \right)\frac{\partial ^{2} u}{\partial r^{2}}+\frac{\left(\cos ^{2} \theta +\sin ^{2}\theta \right)}{r}\frac{\partial u}{\partial r}+\frac{\left(\cos ^{2} \theta +\sin ^{2}\theta \right)}{r^{2}}\frac{\partial ^{2} u}{\partial \theta ^{2}}, \\ \frac{\partial ^{2}u }{\partial x^{2}}+\frac{\partial ^{2}u }{\partial y^{2}}& =& \frac{\partial ^{2} u}{\partial r^{2}}+\frac{1}{r}\frac{\partial u}{\partial r}+\frac{1}{r^{2}}\frac{\partial ^{2} u}{\partial \theta ^{2}}. \\ \end{eqnarray*}</script></span>
<p>
 Hence in plane polar coordinates, Laplace’s equation can be written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2} u}{\partial r^{2}}+\frac{1}{r}\frac{\partial u}{\partial r}+\frac{1}{r^{2}}\frac{\partial ^{2} u}{\partial \theta ^{2}}=0.</script></span>
<p>
 Phew! 
</p>
<p>
This result actually has a simpler form: multiply first through by <script type="math/tex">r</script>, then note that the sum of the partial derivatives in <script type="math/tex">r</script> can be written as a derivative 
</p>
<span class="dmath"><script type="math/tex; mode=display">r\frac{\partial ^{2} u}{\partial r^{2}}+\frac{\partial u}{\partial r}=\frac{\partial }{\partial r}\left(r\frac{\partial u}{\partial r}\right).</script></span>
<p>
 Hence Laplace’s equation can be written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">r\frac{\partial }{\partial r}\left(r\frac{\partial u}{\partial r}\right)+\frac{\partial ^{2} u}{\partial \theta ^{2}}=0,</script></span>
<p>
 or 
</p>
<span class="dmath"><script type="math/tex; mode=display">r\frac{\partial }{\partial r}\left(r\frac{\partial u}{\partial r}\right)=-\frac{\partial ^{2} u}{\partial \theta ^{2}}.</script></span>
<p>
 The key point here is that everything on the LHS involves derivatives wrt <script type="math/tex">r</script> and everything on the RHS, derivatives wrt to <script type="math/tex">\theta </script>. This is a key step in solving the equation by separation of variables in plane polar coordinates: see second year modules! 
</p>
<p>
As an aside, suppose we want to find a solution of Laplace’s equation that is a function of <script type="math/tex">r</script>, i.e., radial distance from the origin. Then we have <script type="math/tex">u=u(r)</script> only and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial u}{\partial \theta }=\frac{\partial ^{2} u}{\partial \theta ^{2}}=0.</script></span>
<p>
 Laplace’s equation then becomes: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">r\frac{d }{d r}\left(r\frac{d u}{d r}\right)=0,</script></span></span> i.e., all reference to <script type="math/tex">\theta </script> vanishes and the partial derivatives with respect to <script type="math/tex">r</script> become total. 
</p>
<p>
After dividing by <script type="math/tex">r</script> (for <script type="math/tex">r\ne 0</script>) we can integrate this, now, ODE, twice to obtain: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(r\frac{d u}{d r}\right)& =& A, \\ \frac{d u}{d r}& =& \frac{A}{r}\\ u(r)& =& A \log r + B. \end{eqnarray*}</script></span></span> for arbitrary constants <script type="math/tex">A</script> and <script type="math/tex">B</script>. This shows, for example, that the electrostatic potential due to a straight line source of charge decays logarithmically with radial distance <script type="math/tex">r</script> from the line source. 
</p>
<p>
In three (cartesian) dimensions, Laplace’s equation becomes 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2}u}{\partial x^{2}}+\frac{\partial ^{2}u}{\partial y^{2}}+\frac{\partial ^{2}u}{\partial z^{2}}=0.</script></span>
<p>
 An exercise for you is to show that a radially symmetric solution in 3-D is given by: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">u(r)=\frac{A}{r}+B</script></span></span> where <script type="math/tex">r=\sqrt{x^{2}+y^{2}+z^{2}}</script>. 
</p>
<p>
More generally, in arbitrary coordinates and dimensions, Laplace’s equation is written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla ^{2}u=0.</script></span>
<p>
 The symbol “<script type="math/tex">\nabla </script>” is pronounced “del” (short for “upside down delta”), so that <script type="math/tex">\nabla ^{2}</script> is pronounced “del-squared”. It can be thought of <script type="math/tex">\nabla \cdot \nabla </script>, i.e., the result of taking the scalar product of two gradient operators. (Try this for yourself using the cartesian definition <script type="math/tex">\nabla = \frac{\partial }{\partial x}{\bf i}+ \frac{\partial }{\partial y}{\bf j}</script>. More of this type of thing will come in second year modules. 
</p>
</section><section class="section">
<h2 id="a0000000261">2.14 Multivariable Taylor Series</h2>
<p>
We saw above that the tangent plane could be interpreted as a linear approximation to a multivariate function around a given point <script type="math/tex">P</script>. We can improve on that approximation using the chain rule and higher order derivatives. 
</p>
<p>
Recall that for a single-variable function <script type="math/tex">g(t)</script>, if all the derivatives g exist at a point, say <script type="math/tex">t = 0</script> (that is <script type="math/tex">g(0)</script>, <script type="math/tex">g'(0)</script>, <script type="math/tex">g''(0)</script>,... all exist), then <script type="math/tex">g</script> can be expanded as a power series in a neighbourhood of <script type="math/tex">t = 0</script> via the Taylor-Maclaurin Series expansion 
</p>
<span class="dmath"><script type="math/tex; mode=display">g(t)=\sum _{r=0}^{\infty }\frac{g^{(k)}(0)}{r!}t^{r}=g(0)+g’(0)t+\frac{g''(0)}{2!}t^{2}+\frac{g'''(0)}{3!}t^{3}+\dots .</script></span>
<p>
Now suppose that <script type="math/tex">g(t)</script> is defined as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(t)=f(a+ht,b+kt),</script></span></span> where <script type="math/tex">a, b, h, k</script> are real and <script type="math/tex">f</script> is a multivariate function <script type="math/tex">f(x,y):\mathbb R^{2}\to \mathbb R</script>, with independent variables <script type="math/tex">(x,y)</script> with 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x=x(t)=a+ht, \qquad y=y(t)=b+kt.</script></span></span>
</p>
<p>
But if we want to write down a Taylor series for <script type="math/tex">g(t)</script> about <script type="math/tex">t=0</script>, then we need to compute the derivatives of <script type="math/tex">g</script> at <script type="math/tex">t=0</script>. To do that we will need to use the chain rule: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g’(t)=\frac{d}{dt}f(x(t),y(t))=\frac{\partial f}{\partial x}\frac{dx}{dt}+\frac{\partial f}{\partial y}\frac{dy}{dt}=h\frac{\partial f}{\partial x}+k\frac{\partial f}{\partial y}.</script></span></span>
</p>
<p>
So far so good, now we need the higher derivatives. From above we can see that a derivative with respect to <script type="math/tex">t</script> is, by the chain rule, in this case equivalent to the following linear combination of partial derivatives with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script> acting on <script type="math/tex">f</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{d}{dt}=h\frac{\partial }{\partial x}+k\frac{\partial }{\partial y}</script></span></span> We can apply this to <script type="math/tex">g'(t)</script> to get <script type="math/tex">g''(t)</script> as follows: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  g”(t)& =& \frac{d}{dt}g’(t)=\left(h\frac{\partial }{\partial x}+k\frac{\partial }{\partial y}\right)\left(h\frac{\partial f}{\partial x}+k\frac{\partial f}{\partial y}\right)\\ & =& \left(h^{2}\frac{\partial ^{2} f}{\partial x^{2}}+2hk\frac{\partial ^{2} f}{\partial x\partial y}+k^{2}\frac{\partial f^{2}}{\partial y^{2}}\right) \end{eqnarray*}</script></span></span> We can repeat this for <script type="math/tex">g'''(t)</script> and we find 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*} g”’(t)& =& \frac{d}{dt}g”(t)=\left(h\frac{\partial }{\partial x}+k\frac{\partial }{\partial y}\right)\left(h^{2}\frac{\partial ^{2} f}{\partial x^{2}} +2hk\frac{\partial ^{2} f}{\partial x\partial y}+k^{2}\frac{\partial ^{2} f}{\partial y^{2}}\right)\\ & =& \left(h^{3}\frac{\partial ^{3} f}{\partial x^{3}} +3h^{2}k\frac{\partial ^{3} f}{\partial ^{2}x\partial y}+3hk^{2}\frac{\partial ^{3} f}{\partial x\partial ^{2}y}+k^{3}\frac{\partial ^{3} f}{\partial y^{3}}\right) \end{eqnarray*}</script></span>
<p>
 Going one step further we find, 
</p>
<span class="dmath"><script type="math/tex; mode=display">g^{(iv)}(t)=\left(h^{4}\frac{\partial ^{4} f}{\partial x^{4}} +4h^{3}k\frac{\partial ^{4} f}{\partial ^{3}x\partial y}+6h^{2}k^{2}\frac{\partial ^{4} f}{\partial x^{2}\partial ^{2}y}+4hk^{3}\frac{\partial ^{4} f}{\partial x\partial ^{3}y}+k^{4}\frac{\partial ^{4}f}{\partial y^{4}}\right)</script></span>
<p>
 The pattern should now be a bit clear: 
</p>
<p>
The <script type="math/tex">n^{\rm th}</script> derivative of <script type="math/tex">g(t)=f(a+ht, b+kt)</script> can be represented as the sum of the <script type="math/tex">n^{\rm th}</script> mixed partial derivatives of <script type="math/tex">f</script>, with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script>, weighted by the Pascal triangle combinatorial coefficients multiplied by the powers of <script type="math/tex">h</script> and <script type="math/tex">k</script> corresponding to the respective order of the partial derivatives (<script type="math/tex">h</script> with <script type="math/tex">x</script> and <script type="math/tex">k</script> with <script type="math/tex">y</script>). 
</p>
<p>
The final bit is to realise that if we insert this into the Taylor series for <script type="math/tex">g(t)</script>, then we have to evaluate all the derivatives at <script type="math/tex">t=0</script>. Hence we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  g(0)& =& f(x(0),y(0))=f(a,b),\\ g’(0)& =& h\left(\frac{\partial f}{\partial x}\right)_{(a,b)}+k\left(\frac{\partial f}{\partial y}\right)_{(a,b)}, \\ g”(0)& =& h^{2}\left(\frac{\partial ^{2} f}{\partial x^{2}}\right)_{(a,b)}+2hk\left(\frac{\partial ^{2} f}{\partial x\partial y}\right)_{(a,b)} +k^{2}\left(\frac{\partial ^{2} f}{\partial y^{2}}\right)_{(a,b)}, \\ g”’(0)& =& \dots . \end{eqnarray*}</script></span></span>
</p>
<p>
So finally we can insert the above expressions into the Taylor series for <script type="math/tex">g(t)</script>, but then <b class="bf">chose</b> to set <script type="math/tex">t=1</script> on the LHS. We have <script type="math/tex">g(1)=f(a+h,b+k)</script> so the Taylor series becomes 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  f(a+h,b+k)& =& f(a,b)+h\left(\frac{\partial f}{\partial x}\right)_{(a,b)}+k\left(\frac{\partial f}{\partial y}\right)_{(a,b)}+ \\ & +& \frac{1}{2!}\left(h^{2}\left(\frac{\partial ^{2} f}{\partial x^{2}}\right)_{(a,b)}+2hk\left(\frac{\partial ^{2} f}{\partial x\partial y}\right)_{(a,b)} +k^{2}\left(\frac{\partial ^{2} f}{\partial y^{2}}\right)_{(a,b)}\right) \\ & +& \frac{1}{3!}\left(h^{3}\left(\frac{\partial ^{3} f}{\partial x^{3}}\right)_{(a,b)} +3h^{2}k\left(\frac{\partial ^{3} f}{\partial ^{2}x\partial y}\right)_{(a,b)}+3hk^{2}\left(\frac{\partial ^{3} f}{\partial x\partial ^{2}y}\right)_{(a,b)}+k^{3}\left(\frac{\partial ^{3} f}{\partial y^{3}}\right)_{(a,b)}\right) \\ & +&  \dots . \end{eqnarray*}</script></span>
<p>
 We may substitute for <script type="math/tex">h=x-a</script> and <script type="math/tex">k=y-b</script> and use the more compact subscript notation partial derivatives to obtain 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  f(x,y)& =& f(a,b)+(x-a)f_{x}(a,b)+(y-b)f_{y}(a,b)+ \\ & +& \frac{1}{2!}\left\{ (x-a)^{2}f_{xx}(a,b)+2(x-a)(y-b)f_{xy}(a,b)+(y-b)^{2}f_{yy}(a,b)\right\}  \end{eqnarray*}</script></span>
<span class="dmath"><script type="math/tex; mode=display">+\frac{1}{3!}\left\{ (x-a)^{3}f_{xxx}(a,b)+3(x-a)^{2}(y-b)f_{xxy}(a,b)+3(x-a)(y-b)^{2}f_{yxx}(a,b)+(y-b)^{3}f_{yyy}(a,b)\right\}</script></span>
<span class="dmath"><script type="math/tex; mode=display">+ \dots .</script></span>
<p>
<b class="bf">Notes:</b>
</p>
<ul class="itemize" id="a0000000262">
<li id="a0000000263"> <p>
This gives a way of approximating the function <script type="math/tex">f</script> at points <script type="math/tex">x=a+h</script> and <script type="math/tex">y=b+h</script> given the value of the function and all its partial derivatives at <script type="math/tex">(x,y)=(a,b)</script>. 
</p>
</li>
<li id="a0000000264"> <p>
The first line of the formula is equivalent to the tangent plane approximation of the function <script type="math/tex">z=f(x,y)</script> at the point <script type="math/tex">(x,y,z)=(a,b,f(a,b))</script>. 
</p>
</li>
<li id="a0000000265"> <p>
The “<script type="math/tex">\dots </script>” denotes an infinite sum of terms of increasingly higher order partial derivatives. We make no statement about whether this sum converges (i.e., adds up to something finite). This type of question will be explored in MATH2039. 
</p>
</li>
<li id="a0000000266"> <p>
Nevertheless for the functions we shall deal with here, we can assume that the more terms we take in the multivariate Taylor series, the better the approximation to the function <script type="math/tex">f(x,y)</script>, given the data at <script type="math/tex">(x,y)=(a,b).</script>
</p>
</li>
<li id="a0000000267"> <p>
An analogous argument may be deployed to find the Taylor series for a function <script type="math/tex">f:\mathbb R^{n}\to \mathbb R</script> about a point <script type="math/tex">(x_{1},x_{2}, \dots , x_{n})=(a_{1},a_{2}, \dots a_{n})</script>, but we will restrict ourselves in this module to only <script type="math/tex">n=2</script>. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Calculate the Taylor series expansion of <script type="math/tex">f (x, y) = e^{x} \sin y</script> about the point <script type="math/tex">(1,0)</script> up to third order in <script type="math/tex">x</script> and <script type="math/tex">y</script>: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  f(x,y)=e^{x}\sin y \qquad & \Rightarrow &  \qquad f(1,0)=e^{1}\sin 0 =0 \\ f_{x}=e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{x}(1,0)=e^{1}\sin 0 =0 \\ f_{y}=e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{y}(1,0)=e^{1}\cos 0 =e \\ f_{xx}=e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{xx}(1,0)=e^{1}\sin 0 =0 \\ f_{xy}=e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{xy}(1,0)=e^{1}\cos 0 =e \\ f_{yy}=-e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{yy}(1,0)=-e^{1}\sin 0 =0 \\ f_{xxx}=e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{xx}(1,0)=e^{1}\sin 0 =0 \\ f_{xxy}=e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{xy}(1,0)=e^{1}\cos 0 =e \\ f_{xyy}=-e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{yy}(1,0)=-e^{1}\sin 0 =0 \\ f_{yyy}=-e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{yy}(1,0)=-e^{1}\cos 0 =-e \end{eqnarray*}</script></span></span> Substituting into the Taylor series and retaining terms up to third order in <script type="math/tex">x</script> and <script type="math/tex">y</script> we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  e^{x}\sin y& =& 0+0(x-1)+e(y-0)+\\ & +& \frac{1}{2!}\left\{ 0(x-1)^{2}+2e(x-1)(y-0)+0(y-0)^{2}\right\}  + \\ & +& \frac{1}{3!}\left\{ 0(x-1)^{3}+3e(x-1)^{2}(y-0)+3.0(x-1)(y-0)^{2}-e(y-1)^{3}\right\}  + \dots \\ e^{x}\sin y& =& e\left\{ (y+2(x-1)y+\frac{1}{2}(x-1)^{2}y-\frac{1}{6}y^{3}+\dots \right\} . \end{eqnarray*}</script></span></span>
</p>
</section><section class="section">
<h2 id="a0000000268">2.15 The Differential</h2>
<p>
<b class="bf">Definition:</b> Given a function <script type="math/tex">z=f(x,y)</script> we may define the <b class="bf">differential</b> <script type="math/tex">dz</script> as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">dz=df=\frac{\partial f}{\partial x}dx+\frac{\partial f}{\partial y}dy.</script></span>
<p>
 For a (differentiable) function that possesses a Taylor series expansion, if we interpret <script type="math/tex">dx</script> and <script type="math/tex">dy</script> as small shifts away from the expansion point <script type="math/tex">(a,b)</script>, so that <script type="math/tex">dx=x-a</script> and <script type="math/tex">dy=y-b</script> it can be seen from the definition of the multivariable Taylor series that the differential <script type="math/tex">dz</script> is an approximation to the corresponding change in <script type="math/tex">f</script>, i.e., <script type="math/tex">f(x,y)-f(a,b)</script>. 
</p>
<figure id="TangentPlane">
<div class="centered"> <img src="../../notes/course_notes/images/img-0074.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.38</span>
<span class="caption_text">The graphical interpretation of the differential <script type="math/tex">dz</script> for a function <script type="math/tex">z=f(x,y)</script>. A point <script type="math/tex">P</script> on the surface is given by the coordinates <script type="math/tex">(a,b, f(a,b))</script>. If the x coordinate <script type="math/tex">a</script> is shifted by an amount <script type="math/tex">dx</script> and the <script type="math/tex">y</script> coordinate by an amount <script type="math/tex">dy</script>, <script type="math/tex">P</script> moves to become <script type="math/tex">P'</script> on the surface with coordinates <script type="math/tex">(a+dx, b+dy, f(a+dx, b+dy)</script>. For (vanishingly) small values of <script type="math/tex">dx</script> and <script type="math/tex">dy</script>, the change in the height of <script type="math/tex">P'</script> relative to <script type="math/tex">P</script> is given by <script type="math/tex">dz=(\partial f/\partial x) dx +(\partial f/\partial y) dy \approx \Delta z =f(a+dx,b+dy)-f(a,b)</script>.</span>
</figcaption> </div>
</figure>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Consider <script type="math/tex">z=f(x,y)= x^{2}+y^{3}</script>. Find the differential <script type="math/tex">dz</script> and if <script type="math/tex">x</script> changes from <script type="math/tex">1</script> to <script type="math/tex">1.05</script> and from <script type="math/tex">2</script> to <script type="math/tex">1.95</script>, compare the values of <script type="math/tex">dz</script> and <script type="math/tex">\Delta z =f(1.05,1.95)-f(1,2)</script>. 
</p>
<ul class="itemize" id="a0000000269">
<li id="a0000000270"> <p>
The differential is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dz =\frac{\partial f}{\partial x}dx+\frac{\partial f}{\partial y}dy=2x \,  dx + 3y \,  dy.</script></span></span>
</p>
</li>
<li id="a0000000271"> <p>
We have the increments <script type="math/tex">dx</script> and <script type="math/tex">dy</script> given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dx=1.05-1.00=0.05 \qquad dy=1.95-2=-0.05</script></span></span>
</p>
</li>
<li id="a0000000272"> <p>
Hence at the point <script type="math/tex">(x,y)=(1,2)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dz =2\times 1 \times 0.05+3\times 2^{2} \times (-0.05)= 0.1-0.3 =-0.5.</script></span></span>
</p>
</li>
<li id="a0000000273"> <p>
Finally evaluating <script type="math/tex">\Delta z =f(1.05,1.95)-f(1,2)</script> we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Delta z =f(1.05,1.95)-f(1,2)=1.05^{2}+1.95^{3}-1^{2}-2^{3}=-0.48.</script></span></span> Hence for these small changes <script type="math/tex">dx</script> and <script type="math/tex">dy</script> in the location of <script type="math/tex">(1,2)</script> we see that <script type="math/tex">dz \approx \Delta z</script>. 
</p>
</li>
</ul>
<p>
Differentials are often useful for estimating the dependence of a result on a small change in the underlying independent variables. 
</p>
<p>
<b class="bf">Example:</b> The volume <script type="math/tex">V</script> of a right cylinder of radius <script type="math/tex">r</script> and height <script type="math/tex">h</script> is given by <script type="math/tex">V=\pi r^{2}h</script>. Suppose that <script type="math/tex">r</script> and <script type="math/tex">h</script> are measured as being <script type="math/tex">20</script> cm and <script type="math/tex">10</script> cm respectively, with a maximum error or of <script type="math/tex">0.1</script> cm. Use differentials to estimate the corresponding maximum error in the volume of the cylinder. 
</p>
<ul class="itemize" id="a0000000274">
<li id="a0000000275"> <p>
The differential <script type="math/tex">dV</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV =\frac{\partial v}{\partial r}dr+\frac{\partial V}{\partial h}dh=2 \pi rh \,  dr + \pi r^{2} \,  dh.</script></span></span>. 
</p>
</li>
<li id="a0000000276"> <p>
The maximum possible errors in the measurements of <script type="math/tex">r</script> and <script type="math/tex">h</script> are given by <script type="math/tex">dr</script> and <script type="math/tex">dh</script>. <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dr =|0.1|, \qquad dh=|0.1|.</script></span></span> We take these to be positive, since this from the form of the differential, and the fact that both <script type="math/tex">r>0</script> and <script type="math/tex">h>0</script>, this choice will given the largest value of the differential, and hence an estimate of the maximum possible error (overestimate) of the volume. 
</p>
</li>
<li id="a0000000277"> <p>
We could take them both negative too, but this just gives an identical maximum <b class="bf">underestimate</b> of the volume. Taking opposite signs in <script type="math/tex">dr</script> and <script type="math/tex">dh</script> will not give either the maximum value of <script type="math/tex">|dV|</script>. 
</p>
</li>
<li id="a0000000278"> <p>
Hence we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV =2 \pi rh \,  dr + \pi r^{2} \,  dh = 2\pi \times 20 \times 10 \times |0.1| +\pi \times 20^{2}\times 10 \times |0.1|= 251.327 {\rm cm}^{3}.</script></span></span>
</p>
</li>
<li id="a0000000279"> <p>
This seems like a lot, but bear in mind that <script type="math/tex">V=\pi r^{2}h= 4000\pi = 12,566.4 {\rm cm}^{3}</script>. Hence, given a relative errors in <script type="math/tex">r</script> and <script type="math/tex">h</script> of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dr/r=0.1/20=0.5\%  \qquad dh/h=0.1/10=1\% ,</script></span></span> the relative error in <script type="math/tex">V</script>, is then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV/V =251.327/12,566.4 = 0.02 = 2\% .</script></span></span>
</p>
</li>
</ul>
<p>
 The definition of a differential generalises easily and obviously to <script type="math/tex">\mathbb R^{n}\to \mathbb R</script> functions: 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x_{1},x_{2}, \dots , x_{n}) \qquad \Rightarrow \qquad dz=df=\frac{\partial f}{\partial x_{1}}dx_{1}+\frac{\partial f}{\partial x_{2}}dx_{2}+\dots +\frac{\partial f}{\partial x_{n}}dx_{n}.</script></span>
<p>
<br/>
</p>
</section><section class="section">
<h2 id="a0000000280">2.16 Critical Points of Multivariate Functions</h2>
<p>
 Recall that for a function of one variable, <script type="math/tex">y = f(x)</script> the stationary points are located at the solutions of 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{df}{dx}=0</script></span>
<p>
. 
</p>
<p>
The type of stationary point is characterised according to the value of the second derivative. 
</p>
<figure id="TangentPlane">
<div class="centered"> <img src="../../notes/course_notes/images/img-0076.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.39</span>
<span class="caption_text">Different types of stationary points for <script type="math/tex">{\mathbb R}\rightarrow {\mathbb R}</script> functions.</span>
</figcaption> </div>
</figure>
<span class="dmath"><script type="math/tex; mode=display">\frac{d^{2}f}{dx^{2}}>0: {\rm Minimum} \qquad \frac{d^{2}f}{dx^{2}}<0: {\rm Maximum} \qquad \frac{d^{2}f}{dx^{2}}=0: {\rm Test \  Further}</script></span>
<p>
What is the corresponding set of tests for the existence of a minimum or maximum in multivariate functions? We shall again focus on <script type="math/tex">f:\mathbb R^{2}\to \mathbb R</script>, but the condition we derive is valid for <script type="math/tex">f:\mathbb R^{n}\to \mathbb R</script>. 
</p>
<section class="subsection">
<h3 id="extreme">2.16.1 Conditions for a Local Isolated Critical Point</h3>
<p>
Suppose we <b class="bf">assume</b> there is a local isolated maximum of <script type="math/tex">z=f(x,y)</script> at <script type="math/tex">(x,y)=(a,b)</script> and that the partial derivatives of <script type="math/tex">f</script> exist there. Let us consider the directional derivatives at <script type="math/tex">(a,b)</script>. 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{{\bf u}}(f)=\frac{\partial f}{\partial {\bf u}}=\nabla f\cdot {\bf u},</script></span>
<p>
 in the direction <script type="math/tex">{\bf u}=\cos \theta {\bf i}+\sin \theta {\bf j}</script>, where <script type="math/tex">0\le \theta \le 2\pi </script>. 
</p>
<p>
Let us suppose that <script type="math/tex">\nabla f\ne {\bf 0}</script> at this maximum. Then for <script type="math/tex">\theta </script> such that <b class="bf">u</b> is in the direction of <script type="math/tex">\nabla f</script> we have <script type="math/tex">{\bf u}=\nabla f/|\nabla f|</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial {\bf u}}=\nabla f\cdot \frac{\nabla f}{|\nabla f|}=\frac{|\nabla f|^{2}}{|\nabla f|}=|\nabla f|>0.</script></span>
<p>
Thus in the direction <script type="math/tex">{\bf u} = \nabla f/|\nabla f|</script>, the function is <b class="bf">increasing</b>, which contradicts that the assumption that <script type="math/tex">(a,b)</script> was a local maximum. Hence if the partial derivates exist at a maximum, then the only other possible situation is that <script type="math/tex">\nabla f= {\bf 0}</script> there. 
</p>
<p>
An analogous argument holds for a local minimum by considering the directional derivative in the direction of <script type="math/tex">-\nabla f</script>. 
</p>
<p>
Hence, by contradiction, a local maximum or minimum in an interior part of a domain must have <script type="math/tex">\nabla f={\bf 0}</script>. Points at which this occurs are called <b class="bf">critical points</b>. 
</p>
<p>
A little more work (not required here) leads to a theorem that holds for <script type="math/tex">f:\mathbb R^{n}\to \mathbb R</script>: 
</p>
<p>
 A function <script type="math/tex">f:D\subseteq \mathbb R^ n\to \mathbb R</script> has an absolute or local minimum or maximum value at <script type="math/tex">{\bf a}\in D</script> only if either 
</p>
<ol class="enumerate" id="a0000000281" style="list-style: none">
<li id="a0000000282" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
<script type="math/tex">{\bf a}</script> is a <b class="bf">critical point</b> of <script type="math/tex">f</script>, that is, when <script type="math/tex">\nabla f({\bf a})={\bf 0}</script>, or 
</p>
</li>
<li id="a0000000283" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
<script type="math/tex">{\bf a}</script> is a <b class="bf">singular point</b> of <script type="math/tex">f</script>, that is, when <script type="math/tex">\nabla f({\bf a})</script> does not exist, or 
</p>
</li>
<li id="a0000000284" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
<script type="math/tex">{\bf a}</script> is a <b class="bf">boundary point</b> of the domain <script type="math/tex">D</script>. 
</p>
</li>
</ol>
<ul class="itemize" id="a0000000285">
<li id="a0000000286"> <p>
Part (i) of the theorem is easy to visualise in <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. 
</p>
<p>
<b class="bf">Example:</b> Consider the function <script type="math/tex">z=f(x,y)=1-x^{2}-y^{2}</script>. This has a critical point when <script type="math/tex">\nabla f={\bf 0}</script>, i.e., when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=-2x{\bf i}-2y{\bf j}={\bf 0}.</script></span></span> Note that this implies that both components have to be equal to 0 <b class="bf">simultaneously</b>. Hence we have a critical point when both <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-2x=0, \qquad \Rightarrow \qquad x=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-2y=0, \qquad \Rightarrow \qquad y=0,</script></span></span> i.e., when <script type="math/tex">(x,y)=(0,0)</script>, see figure <a class="ref" href="../../notes/course_notes/index.html#IsoMax">2.40</a>. 
</p>
<figure id="IsoMax">
<div class="centered"> <img src="../../notes/course_notes/images/img-0078.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.40</span>
<span class="caption_text">Plot of <script type="math/tex">z=f(x,y)=1-x^{2}-y^{2}</script> showing the point <script type="math/tex">(x,y,z)=(0,0,1)</script> at which <script type="math/tex">\nabla f={\bf 0}</script>: which is horizontal at that point and a maximum.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000287"> <p>
Part (ii) in the theorem holds, for example if there is no critical point, but the function is singular and diverges. 
</p>
<p>
<b class="bf">Example:</b> Consider the function <script type="math/tex">z=f(x,y)=1/(x^{2}+y^{2})</script> when evaluated over any domain <script type="math/tex">D:(x,y)</script> including <script type="math/tex">(x,y)=(0,0)</script>. 
</p>
<p>
We have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) =\frac{2x}{(x^{2}+y^{2})^{2}}{\bf i}+\frac{2y}{(x^{2}+y^{2})^{2}}{\bf j}.</script></span></span>
</p>
<p>
At the origin, <script type="math/tex">(x,y)=(0,0)</script> a little limit exercise<a class="footnote" href="#a0000000288">
<sup class="footnotemark">8</sup>
</a> shows that both components in <script type="math/tex">\nabla f(0,0)</script> diverges and so does not exist. 
</p>
<p>
A sketch of the function <script type="math/tex">z=1/(x^{2}+y^{2)}</script> shows that it too diverges to <script type="math/tex">+\infty </script> at <script type="math/tex">(x,y)=(0,0)</script> but nowhere else, and so it is a local maximum (see figure <a class="ref" href="../../notes/course_notes/index.html#SingMax">2.41</a>). 
</p>
<figure id="SingMax">
<div class="centered"> <img src="../../notes/course_notes/images/img-0080.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.41</span>
<span class="caption_text">Plot of <script type="math/tex">z=1/(x^{2}+y^{2})</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000289"> <p>
Part (iii) in the theorem holds, for example if there is no critical point, but there is a finite bounded domain. 
</p>
<p>
<b class="bf">Example:</b> Consider the plane <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=1-x-y</script></span></span> when evaluated over the domain <script type="math/tex">D:(x,y):\left\{ x\ge 0, y\ge 0, y\ge 1-x\right\} </script>. 
</p>
<p>
There is no point on that domain which has <script type="math/tex">\nabla f ={\bf 0}</script>, since the partial derivatives are both just a constant <script type="math/tex">-1</script>. 
</p>
<p>
But clearly on the boundary of that domain, the point <script type="math/tex">(x,y,z)=(0,0,1)</script> is a local maximum (see figure <a class="ref" href="../../notes/course_notes/index.html#PlaneMax">2.42</a>). 
</p>
<p>
This is an example of how when no point interior to a domain satisfies <script type="math/tex">\nabla f={\bf 0}</script>, the maxima or minima of a function may be found on the boundary. This is an example of a <b class="bf">constrained</b> maximum 
</p>
<figure id="PlaneMax">
<div class="centered"> <img src="../../notes/course_notes/images/img-0082.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.42</span>
<span class="caption_text">Constained maximum on a boundary</span>
</figcaption> </div>
</figure>
</li>
</ul>
<p>
Note that <b class="bf">critical points</b> are not just local <b class="bf">maxima</b> or <b class="bf">minima</b>! 
</p>
<p>
<b class="bf">Example:</b> Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=x^{2}-y^{2}.</script></span></span> This has a critical point when <script type="math/tex">\nabla f={\bf 0}</script>, i.e., when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=2x{\bf i}-2y{\bf j}={\bf 0}.</script></span></span> Note that this implies that both components have to be equal to 0 <b class="bf">simultaneously </b>. Hence we have a critical point when both <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x=0, \qquad \Rightarrow \qquad x=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2y=0, \qquad \Rightarrow \qquad y=0,</script></span></span> i.e., when <script type="math/tex">(x,y)=(0,0)</script>. However if we plot the function <script type="math/tex">z=f(x,y)</script> near to the origin, see figure <a class="ref" href="../../notes/course_notes/index.html#IsoSaddle">2.43</a>, we see that even though <script type="math/tex">\nabla f=0</script> there, that point is neither a maximum not a minimum. 
</p>
<figure id="IsoSaddle">
<div class="centered"> <img src="../../notes/course_notes/images/img-0026.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.43</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=x^{2}-y^{2}</script>. These are still curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}-y^{2}=c</script>. These are (for <script type="math/tex">c\ne 0</script>) hyperbolae. The contours corresponding to <script type="math/tex">c=0</script> are the lines <script type="math/tex">y=\pm x</script>. The regions <script type="math/tex">y<|x|</script> have <script type="math/tex">c>0</script>, the regions <script type="math/tex">y>|x|</script> have <script type="math/tex">c<0</script>.</span>
</figcaption> </div>
</figure>
<p>
For: 
</p>
<ul class="itemize" id="a0000000290">
<li id="a0000000291"> <p>
If you take a vertical section through the origin along the <script type="math/tex">x</script> axis, the origin looks like a minimum, <script type="math/tex">z=f(x,0)=x^{2}</script>. 
</p>
</li>
<li id="a0000000292"> <p>
If you take a vertical section through the origin along the <script type="math/tex">y</script> axis, the origin looks like a maximum, <script type="math/tex">z=f(0,y)=-y^{2}</script>
</p>
</li>
</ul>
<p>
 The origin is the typical example of the third type of critical point that satisfies <script type="math/tex">\nabla f={\bf 0}</script>, namely a <b class="bf">saddle point</b>. It is called a saddle point because the local shape of the surface <script type="math/tex">z=f(x,y)</script> looks like a horse saddle. 
</p>
<p>
Note that is also possible to have <b class="bf">non-isolated critical points</b>. For these situations, <script type="math/tex">\nabla f={\bf 0}</script> along whole curves, not just at single points. An easy visualisation is to take a piece of paper and curve it over to create a “<script type="math/tex">\cup </script>” or “<script type="math/tex">\cap </script>” shape. We do not consider such cases in this module. 
</p>
</section><section class="subsection">
<h3 id="a0000000293">2.16.2 Higher Dimensions</h3>
<p>
In higher dimensions the same condition for the existence of a critical point holds. 
</p>
<p>
<b class="bf">Example:</b> Consider the function <script type="math/tex">f:\mathbb R^{3}\to \mathbb R</script> given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y,z)=5+x^{2}+y^{2}+z^{2}+xy.</script></span></span> The critical points are given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}+f_{z}{\bf k}={\bf 0}.</script></span></span> Hence we simultaneously need: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{x}=2x+y=0, \qquad f_{y}=2y+x=0, \qquad f_{z}=2z=0.</script></span></span> The third equation immediate gives <script type="math/tex">z=0</script>. Solving the first two as simultaneous equations for <script type="math/tex">x</script> and <script type="math/tex">y</script> gives <script type="math/tex">x=0</script>, <script type="math/tex">y=0</script>. hence there is a critical point at <script type="math/tex">(x,y,z)=(0,0,0)</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000294">2.16.3 Characterisation of an Isolated Interior Critical Point: Hessian Matrix</h3>
<p>
We focus on case (i) in the theorem above, i.e., critical points for which <script type="math/tex">\nabla f={\bf 0}</script>. Having seen that this can lead to a maximum, a minimum or a saddle, how can we systematically tell the difference between them algebraically? As in the 1-d case, this will use the second (here partial) derivatives. We shall again restrict an explicit discussion to <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. 
</p>
<p>
Consider the Taylor expansion of the function <script type="math/tex">z=f(x,y)</script> around an isolated interior critical point <script type="math/tex">P</script> at the point <script type="math/tex">(x,y)=(a,b)</script>. From above, we know that <script type="math/tex">\nabla f(a, b)={\bf 0}</script>. So the Taylor series expansion about <script type="math/tex">P</script> becomes <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  f(x,y) = f(a,b)& +& \left\{ \cancelto {=0}{f_{x}}(a,b)(x-a)+\cancelto {=0}{f_{y}}(a,b)(y-b)\right\} +\\ & +& \frac{1}{2!}\left\{ f_{xx}(a,b)(x-a)^{2}+2f_{xy}(a,b)(x-a)(y-b)+f_{yy}(a,b)(x-a)^{2}\right\} +\dots \\ \end{eqnarray*}</script></span></span> which on using the shorthand <script type="math/tex">h=(x-a)</script> and <script type="math/tex">k=(y-b)</script> becomes <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow f(x,y) = f(a,b)+\frac{1}{2!}\left\{ h^{2}f_{xx}(a,b)+2hkf_{xy}(a,b)+k^{2}f_{yy}(a,b)\right\} +\dots</script></span></span> Let us now suppose that we are in the immediate neighbourhood <script type="math/tex">N</script> of the critical point <script type="math/tex">P</script>, such that the orders higher than quadratic in the Taylor series are negligible. 
</p>
<p>
Thus whether the critical point is a maximum or minimum will depend on the sign of the quadratic terms, or quadratic form: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">Q=\left\{ h^{2}f_{xx}(a,b)+2hkf_{xy}(a,b)+k^{2}f_{yy}(a,b)\right\} .</script></span></span> Clearly we have: 
</p>
<ul class="itemize" id="a0000000295">
<li id="a0000000296"> <p>
If <script type="math/tex">Q>0</script> <script type="math/tex">\forall </script> <script type="math/tex">(h,k)\ne (0,0)\in N</script>, <script type="math/tex">\Rightarrow </script> <script type="math/tex">P</script> is a <b class="bf">minimum</b> (<script type="math/tex">f</script> is greater than <script type="math/tex">f(a,b)</script> in <script type="math/tex">N</script>). 
</p>
</li>
<li id="a0000000297"> <p>
If <script type="math/tex">Q<0</script> <script type="math/tex">\forall </script> <script type="math/tex">(h,k)\ne (0,0)\in N</script>. <script type="math/tex">\Rightarrow </script> <script type="math/tex">P</script> is a <b class="bf">maximum</b> (<script type="math/tex">f</script> is less than than <script type="math/tex">f(a,b)</script> in <script type="math/tex">N</script>). 
</p>
</li>
</ul>
<p>
 We don’t really want to have to check this for all <script type="math/tex">(h,k)\in N</script> as we would be here forever. Fortunately, we can rearrange the formula to put it in terms of sums of squared quantities. 
</p>
<span class="dmath"><script type="math/tex; mode=display">Q=\frac{1}{f_{xx}}\left\{ \left(hf_{xx}+kf_{xy}\right)^{2}+\left(f_{xx}f_{yy}-f_{xy}^{2}\right)k^{2}\right\}</script></span>
<p>
It’s now not too difficult to see that the sign of <script type="math/tex">Q</script> depends on the sign of <script type="math/tex">f_{xx}</script> and the sign of the combination <script type="math/tex">f_{xx}f_{yy}-f_{xy}^{2}</script>, since all the other terms in the expression are squared and so are positive. Since these are independent of <script type="math/tex">h</script> and <script type="math/tex">k</script> we don;t have to check the sign of <script type="math/tex">Q</script> throughout the neighbourhood, but just by evaluating these quantities at <script type="math/tex">P</script>. 
</p>
<p>
Hence we can state the following. 
</p>
<p>
For a critical point <script type="math/tex">P</script> with <script type="math/tex">\nabla f(a,b)={\bf 0}</script>, 
</p>
<ul class="itemize" id="a0000000298">
<li id="a0000000299"> <p>
<script type="math/tex">f_{xx}(a,b)>0</script> and <script type="math/tex">f_{xx}(a,b)f_{yy}(a,b)-f_{xy}^{2}(a,b)>0</script> <script type="math/tex">\Rightarrow </script> <script type="math/tex">Q>0</script>, so <b class="bf">minimum</b>; 
</p>
</li>
<li id="a0000000300"> <p>
<script type="math/tex">f_{xx}(a,b)<0</script> and <script type="math/tex">f_{xx}(a,b)f_{yy}(a,b)-f_{xy}^{2}(a,b)>0</script> <script type="math/tex">\Rightarrow </script> <script type="math/tex">Q<0</script>, so <b class="bf">maximum</b>. 
</p>
</li>
</ul>
<p>
What happens if <script type="math/tex">f_{xx}(a,b)f_{yy}(a,b)-f_{xy}^{2}(a,b)<0</script>? 
</p>
<p>
For the sake of brevity, if this is the case we define <script type="math/tex">f_{xx}f_{yy}-f_{xy}^{2}=-D^{2}</script>, where <script type="math/tex">D</script> is real, so that <script type="math/tex">-D^{2}</script> is always negative. Then the equation <script type="math/tex">Q=0</script> has two real roots and <script type="math/tex">Q</script> may be rearranged as (Gory and we’ll just quote and use the result!): 
</p>
<span class="dmath"><script type="math/tex; mode=display">Q=\gamma (k-\alpha h)(k-\beta h); \qquad \alpha =\frac{-f_{xx}}{f_{xy}-D}, \qquad \beta =\frac{-f_{xx}}{f_{xy}+D}, \qquad \gamma =f_{yy}.</script></span>
<p>
 Recalling the definitions of <script type="math/tex">h=x-a</script> and <script type="math/tex">k=y-b</script>, we can sketch the following diagrams in the neighbourhood of <script type="math/tex">P</script>, i.e, <script type="math/tex">(h,k)=(0,0)</script>: 
</p>
<figure id="Saddle">
<div class="centered"> <img src="../../notes/course_notes/images/img-0085.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.44</span>
<span class="caption_text">Schematic representation of the domains giving the signs of <script type="math/tex">Q</script> in the neighbourhood of <script type="math/tex">h=x-a</script> and <script type="math/tex">k=y-b</script>.</span>
</figcaption> </div>
</figure>
<p>
The diagram shows that in two sectors, <script type="math/tex">f</script> increases away from the critical point, whereas in two others, it decreases. The critical point is neither a maximum nor a minimum, but the <b class="bf">saddle point</b> we saw above. 
</p>
<p>
Notice that the quantity <script type="math/tex">f_{xx}f_{yy}-f_{xy}^{2}</script> is a major player in determining the nature of the critical point. Notice that it can also be written as the determinant of a matrix of partial derivatives. This is called a Hessian determinant: 
</p>
<p>
<b class="bf">Definition:</b> Assuming that the function <script type="math/tex">z=f(x.y)</script> possesses continuous second partial derivatives and that all the first partial derivatives exist. We define the <b class="bf">Hessian matrix</b> of <script type="math/tex">f</script> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">H(f)(x,y)=\left(\begin{array}{cc}\dfrac {\partial ^{2}f}{\partial x^{2}} &  \dfrac {\partial ^{2}f}{\partial x\partial y} \\[12 pt]\dfrac {\partial ^{2}f}{\partial y\partial x} &  \dfrac {\partial ^{2}f}{\partial y^{2}} \end{array}\right)</script></span>
<p>
 The <b class="bf">Hessian determinant</b> <script type="math/tex">\Delta </script> is defined as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\Delta (x,y)={\rm det}H(f)(x,y)=\left|\begin{array}{cc}\dfrac {\partial ^{2}f}{\partial x^{2}} &  \dfrac {\partial ^{2}f}{\partial x\partial y} \\[12 pt]\dfrac {\partial ^{2}f}{\partial y\partial x} &  \dfrac {\partial ^{2}f}{\partial y^{2}} \end{array}\right|.</script></span>
<p>
All of the above can now be summarised in the following theorem (no proof required): 
</p>
<p>
<b class="bf">(Classification of Critical points in <script type="math/tex">\mathbb R^{2}</script>):</b> Let <script type="math/tex">f(x,y)</script> be a function of two variables and let <script type="math/tex">(a,b)</script> be a critical point. Assume that <script type="math/tex">f(x,y)</script> has continuous second order partial derivatives on a neighbourhood of <script type="math/tex">(a,b)</script>. Set <script type="math/tex">\Delta (a,b) = {\rm det} H(f)(a,b)</script>. 
</p>
<ul class="itemize" id="a0000000301">
<li id="a0000000302" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(i)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) >0</script> and <script type="math/tex">\frac{\partial ^2 f}{\partial x^2}(a,b) > 0</script>, then <script type="math/tex">f(x,y)</script> has a local minimum at <script type="math/tex">(a,b)</script>. 
</p>
</li>
<li id="a0000000303" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(ii)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) >0</script> and <script type="math/tex">\frac{\partial ^2 f}{\partial x^2}(a,b) < 0</script>, then <script type="math/tex">f(x,y)</script> has a local maximum at <script type="math/tex">(a,b)</script>. 
</p>
</li>
<li id="a0000000304" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(iii)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) < 0</script>, then <script type="math/tex">f(x,y)</script> has a saddlepoint at <script type="math/tex">(a,b)</script>. 
</p>
</li>
<li id="second derivative 2 variable" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(iv)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) = 0</script>, then we have no information. 
</p>
</li>
</ul>
<p>
<b class="bf">NB:</b> You may be worrying about what happens when <script type="math/tex">\Delta (a,b)>0</script> and <script type="math/tex">\partial ^{2}f/\partial x^{2}=0</script>. The answer is that it can never occur because the condition on the continuity of of the second order partial derivatives means that the mixed partials are equal: <script type="math/tex">f_{xy}(a,b)=f_{yx}(a,b)</script>. Hence <script type="math/tex">\Delta (a,b)=f_{xx}(a,b)f_{y}(a,b)-f_{xy}(a,b)^{2}</script>and so if <script type="math/tex">f_{xx}=0</script>, <script type="math/tex">\Delta (a,b)\le 0</script>. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}+y^{2}</script></span>.</span> From an example above, we know that there is a single critical point at <script type="math/tex">(x,y)=(0,0)</script>. Evaluating the second partial derivatives we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=2, \qquad f_{xy}(x,y)=0, \qquad f_{yy}(x,y)=2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(0,0)=2 >0, \qquad \Delta (0,0)=f_{xx}(0,0)f_{yy}(0,0)-f_{xy}^{2}(0,0) = 2.2 -0 =4 >0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(0,0)</script> is a minimum</span>. 
</p>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=1-x^{2}-xy-y^{2}</script></span>. </span>
</p>
<ul class="itemize" id="a0000000305">
<li id="a0000000306"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(-2x-y){\bf i}+(-x-2y){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000307"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-2x-y=0 \qquad \Rightarrow \qquad y=-2x</script></span> <span class="dmath"><script type="math/tex; mode=display">-x-2y=0 \qquad \Rightarrow \qquad y=-x/2</script></span></span>
</p>
</li>
<li id="a0000000308"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <span style="color:#FF0000"><script type="math/tex">(x,y)=(0,0)</script>.</span>
</p>
</li>
<li id="a0000000309"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2, \qquad f_{xy}(x,y)=-1, \qquad f_{yy}(x,y)=-2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(0,0)=-2 <0, \qquad \Delta (0,0)=f_{xx}(0,0)f_{yy}(0,0)-f_{xy}^{2}(0,0) = (-2).(-2) -(-1)^{2} =3 >0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(0,0)</script> is a maximum</span>. 
</p>
</li>
</ul>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x+y-x^{2}-xy</script></span>. </span>
</p>
<ul class="itemize" id="a0000000310">
<li id="a0000000311"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(1-2x-y){\bf i}+(1-x){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000312"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1-2x-y=0 \qquad \Rightarrow \qquad y=-2x+1</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1-x=0 \qquad \Rightarrow \qquad x=1</script></span></span>
</p>
</li>
<li id="a0000000313"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <script type="math/tex">(x,y)=(1,-1)</script>
</p>
</li>
<li id="a0000000314"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2, \qquad f_{xy}(x,y)=-1, \qquad f_{yy}(x,y)=0,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(1,-1)=-2<0, \qquad \Delta (1,-1)=f_{xx}(1,-1)f_{yy}(1,-1)-f_{xy}^{2}(1,-1) = -2.0 -(-1)^{2} =-1 <0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(1,-1)</script> is a saddlepoint</span>. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x+y^{2}-x^{3}/3</script></span>.</span>
</p>
<ul class="itemize" id="a0000000315">
<li id="a0000000316"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(1-x^{2}){\bf i}+(2y){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000317"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1-x^{2}=0 \qquad \Rightarrow \qquad x=\pm 1</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=0 \qquad \Rightarrow \qquad y=0</script></span></span>
</p>
</li>
<li id="a0000000318"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <script type="math/tex">(x,y)=(1,0)</script> and <script type="math/tex">(x,y)=(-1,0)</script>
</p>
</li>
<li id="a0000000319"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: 
</p>
<ul class="itemize" id="a0000000320">
<li id="a0000000321"> <p>
At (1,0): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2x, \qquad f_{xy}(x,y)=0, \qquad f_{yy}(x,y)=2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(1,0)=-2<0, \qquad \Delta (1,0)=f_{xx}(1,0)f_{yy}(1,0)-f_{xy}^{2}(1,0) = -2.2 -(0)^{2} =-4 <0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(1,0)</script> is a saddlepoint.</span>
</p>
</li>
<li id="a0000000322"> <p>
At (-1,0): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2x, \qquad f_{xy}(x,y)=0, \qquad f_{yy}(x,y)=2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(-1,0)=2>0, \qquad \Delta (-1,0)=f_{xx}(-1,0)f_{yy}(-1,0)-f_{xy}^{2}(-1,0) = 2.2 -(0)^{2} =+4 >0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(-1,0)</script> is a minimum.</span>
</p>
</li>
</ul>
</li>
</ul>
<figure id="Saddle">
<div class="centered"> <img src="../../notes/course_notes/images/img-0087.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.45</span>
<span class="caption_text">The surface <script type="math/tex">z=x+y^{2}-x^{3}/3</script> and its critical points.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}-3xy^{2}+2y^{4}</script></span>.</span>
</p>
<ul class="itemize" id="a0000000323">
<li id="a0000000324"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(2x-3y^{2}){\bf i}+(-6xy+8y^{3}){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000325"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x-3y^{2}=0 \qquad \Rightarrow \qquad y^{2}=2x/3</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-6xy+8y^{3}=0 \qquad \Rightarrow \qquad y=0, y^{2}=3x/4</script></span></span>
</p>
</li>
<li id="a0000000326"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <script type="math/tex">(x,y)=(0,0)</script>. 
</p>
</li>
<li id="a0000000327"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: 
</p>
<ul class="itemize" id="a0000000328">
<li id="a0000000329"> <p>
At (0,0): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=2, \qquad f_{xy}(x,y)=-6y, \qquad f_{yy}(x,y)=-6x+24y^{2},</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(0,0)=2>0, \qquad \Delta (0,0)=f_{xx}(0,0)f_{yy}(0,0)-f_{xy}^{2}(0,0) = 2.(-6.0+24.0)-(-6.0)^{2} =0,</script></span></span> so the Hessian matrix test fails at <span style="color:#FF0000"><script type="math/tex">(0,0)</script>.</span> More information is needed. (In fact looking at contour plots around <script type="math/tex">(0,0)</script> suggests that the critical point is a saddlpoint.) 
</p>
</li>
</ul>
</li>
</ul>
</section><section class="subsection">
<h3 id="a0000000330">2.16.4 Higher Dimensions</h3>
<p>
The classification of critical points in higher dimensions follows from a simple extension of the above results. It proceeds by calculation of successive sub-determinants of the relevant Hessian matrix. 
</p>
<p>
<b class="bf">Example:</b> The Hessian matrix of a doubly differentiable <script type="math/tex">\mathbb R^{3}\to \mathbb R</script> function <script type="math/tex">f(x,y,z)</script> is 
</p>
<span class="dmath"><script type="math/tex; mode=display">Hf=\left(\begin{array}{ccc}f_{xx} &  f_{xy} &  f_{xz} \\ f_{yx} &  f_{yy} &  f_{yz} \\ f_{zx} &  f_{zy} &  f_{zz}\end{array}\right)</script></span>
<p>
<b class="bf">Definition:</b> Given an <script type="math/tex">n</script> by <script type="math/tex">n</script> matrix with elements <script type="math/tex">a_{ij}</script>, we define a sequence of <script type="math/tex">k</script> by <script type="math/tex">k</script> determinants (<script type="math/tex">k=1</script> to <script type="math/tex">n</script>) of upper-left sub-determinants as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\Delta _{0}=1; \qquad \Delta _{1}=a_{11}; \qquad \Delta _{2}=\left|\begin{array}{cc}a_{11} &  a_{12} \\ a_{21} &  a_{22}\end{array}\right|; \qquad \dots \qquad \Delta _{k}=\left|\begin{array}{ccc}a_{11} &  \cdots &  a_{1k} \\ \vdots &  \ddots &  \vdots \\ a_{k1} &  \cdots &  a_{kk}\end{array}\right|.</script></span>
<p>
Given this definition, the following theorem can be proved (proof not required): 
</p>
<p>
<b class="bf">(Classification of Critical Points in <script type="math/tex">\mathbb R^{n}</script>):</b> Suppose that <script type="math/tex">P</script> is a critical point of a multivariate function <script type="math/tex">f</script> interior to the domain of <script type="math/tex">f</script>. Suppose that the second partial derivatives of <script type="math/tex">f</script> are continuous in the neighbourhood of <script type="math/tex">P</script>. Then 
</p>
<ul class="itemize" id="a0000000331">
<li id="a0000000332" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(a)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has <script type="math/tex">\Delta _{i}>0, i=0,\dots , n</script>, then <script type="math/tex">f</script> has a local <b class="bf">minimum</b> at <script type="math/tex">P</script>; 
</p>
</li>
<li id="a0000000333" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(b)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has <script type="math/tex">\Delta _{i}\ne 0, i=0,\dots , n</script>, with <script type="math/tex">\Delta _{1}<0, \Delta _{2}>0, \Delta _{3}<0, \Delta _{4}>0 \dots </script>, etc., then <script type="math/tex">f</script> has a local <b class="bf">maximum</b> at <script type="math/tex">P</script>; 
</p>
</li>
<li id="a0000000334" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(c)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has <script type="math/tex">\Delta _{i}\ne 0, i=0,\dots , n</script> but the <script type="math/tex">\Delta _{i}</script> have neither of the above sign patterns, then <script type="math/tex">f</script> has a <b class="bf">saddlepoint</b> at <script type="math/tex">P</script>; 
</p>
</li>
<li id="a0000000335" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(d)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has one or more <script type="math/tex">\Delta _{i}=0</script>, then no information about <script type="math/tex">P</script> may be obtained from this test. there may be a maximum, minimum or saddlepoint at <script type="math/tex">P</script>. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Classify the critical points of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">w=f(x,y,z)=5+x^{2}+y^{2}+z^{2}+xy</script></span>.</span>
</p>
<ul class="itemize" id="a0000000336">
<li id="a0000000337"> <p>
The critical point is at <script type="math/tex">\nabla f={\bf 0}</script>. So we have 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=\frac{\partial f}{\partial x}{\bf i}+\frac{\partial f}{\partial y}{\bf j}+\frac{\partial f}{\partial z}{\bf k}=(2x+y){\bf i}+(2y+x){\bf j}+2z{\bf k}={\bf 0}.</script></span></span>
</p>
<p>
From which we immediately see that <script type="math/tex">z=0</script>. 
</p>
<p>
The <script type="math/tex">x</script> and <script type="math/tex">y</script> and <script type="math/tex">z</script> coordinates of <script type="math/tex">P</script> are given by the simultaneous solution of 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x+y=0, \qquad x+2y=0, \qquad z=0,</script></span></span>
</p>
<p>
from which we see that <script type="math/tex">x=y=z=0</script>. 
</p>
<p>
Hence <script type="math/tex">P</script> is at <script type="math/tex">(0,0,0)</script>. 
</p>
</li>
<li id="a0000000338"> <p>
The Hessian matrix and its sub-determinants are: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left.Hf\right|_{P}=\left(\begin{array}{ccc}f_{xx} &  f_{xy} &  f_{xz} \\ f_{yx} &  f_{yy} &  f_{yz} \\ f_{zx} &  f_{zy} &  f_{zz}\end{array}\right)_{P}=\left(\begin{array}{ccc}2 &  1 &  0 \\ 1 &  2 &  0 \\ 0 &  0 &  2\end{array}\right)</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Delta _{0}=1; \qquad \Delta _{1}=2; \qquad \Delta _{2}=\left|\begin{array}{cc}2 &  1 \\ 1 &  2\end{array}\right|=2; \qquad \Delta _{3}=\left|\begin{array}{ccc}2 &  1 &  0 \\ 1 &  2 &  0 \\ 0 &  0 &  2\end{array}\right|=6.</script></span>
<p>
Hence all the <script type="math/tex">\Delta _{i}, i=0,1,2,3</script> are greater than zero. Hence the critical point <script type="math/tex">P</script> is a minimum. 
</p>
</li>
</ul>
<p>
Hessians should not be confused with mercenaries used in the American War of Independence, or Deputy-Führers of the same names. 
</p>
</section>
</section><section class="section">
<h2 id="a0000000339">2.17 Maximisation and Minimisation with a Constraint: <br/>Lagrange Multipliers </h2>
<p>
Consider the following problem: 
</p>
<p>
<b class="bf">Example:</b> Find the dimensions and area of the largest rectangle inside the ellipse 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{x^{2}}{4}+y^{2}=1.</script></span>
<figure id="Saddle">
<div class="centered"> <img src="../../notes/course_notes/images/img-0089.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.46</span>
<span class="caption_text">Rectangle of area <script type="math/tex">A=4xy</script> embedded within the ellipse <script type="math/tex">x^{2}/4+y^{2}=1</script>.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000340">
<li id="a0000000341"> <p>
Consider a rectangle that lies within the ellipse with the top right corner being at the point <script type="math/tex">(x,y)</script> that lies on the ellipse (see diagram). By symmetry the other three corners of the rectangle are at <script type="math/tex">(x, -y), (-x,y)</script> and <script type="math/tex">(-x,-y)</script>. 
</p>
</li>
<li id="a0000000342"> <p>
The lengths of the sides are <script type="math/tex">2x</script> and <script type="math/tex">2y</script>, so the area of the rectangle within the ellipse is <script type="math/tex">A=4xy</script>. 
</p>
</li>
<li id="a0000000343"> <p>
The goal is then to <b class="bf">maximise</b> <script type="math/tex">A=4xy</script> subject to the <b class="bf">constraint </b>that <script type="math/tex">x^{2}/4+y^{2}=1</script>. 
</p>
</li>
<li id="a0000000344"> <p>
In this example it is easy to see that we could eliminate <script type="math/tex">y</script> by solving the constraint for <script type="math/tex">y</script> and substituting the resulting expression<a class="footnote" href="#a0000000345">
<sup class="footnotemark">9</sup>
</a> <script type="math/tex">y=\sqrt{4-x^{2}}/2</script> in terms of <script type="math/tex">x</script> into the formula for <script type="math/tex">A</script> to obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">A=2x\sqrt{4-x^{2}}.</script></span></span>
</p>
</li>
<li id="a0000000346"> <p>
The finding of the critical point <script type="math/tex">x</script> corresponding to the maximum of <script type="math/tex">A</script> would then take place by just differentiating <script type="math/tex">A</script> with respect to <script type="math/tex">x</script> and setting <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dA}{dx}=2\sqrt{4-x^{2}}-\frac{2x^{2}}{\sqrt{4-x^{2}}}=0 \qquad \Rightarrow \qquad x=\sqrt{2}.</script></span></span> where we have taken the positive value of <script type="math/tex">x</script> since it is the length of a rectangle. 
</p>
</li>
<li id="a0000000347"> <p>
Hence we have <script type="math/tex">y=\sqrt{4-2}/2=1/\sqrt{2}</script> and so <script type="math/tex">A=4\sqrt{2}/\sqrt{2}=4.</script>
</p>
</li>
</ul>
<p>
In this case we were able to reduce the problem to one of single variable calculus by being able to solve the constraint equation (<script type="math/tex">x^{2}/4+y^{2}=1</script>) exactly for one of the variables. What happens when the constraint is not solvable for one of the variables, e.g., <script type="math/tex">(x+y)=e^{-xy}</script>? In the general case, we shall use the <b class="bf">Method of Lagrange Multipliers.</b>
</p>
<section class="subsection">
<h3 id="a0000000348">2.17.1 General Statement of Problem of Optimisation with an Algebraic Constraint </h3>
<p>
We will restrict ourselves to <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. We require the solution of the following problem. 
</p>
<p>
<b class="bf">Problem:</b> Find the maximum or minimum of <script type="math/tex">f(x,y)</script>, subject to <script type="math/tex">g(x,y)=0</script>. 
</p>
<ul class="itemize" id="a0000000349">
<li id="a0000000350"> <p>
To do this we form what is called the the <b class="bf">Lagrangian</b> <script type="math/tex">{\mathcal L}</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\mathcal L(x,y,\lambda )}=f(x,y)+\lambda g(x,y),</script></span></span> where <script type="math/tex">\lambda </script> is a constant, called the <b class="bf">Lagrange multipler</b>. 
</p>
</li>
<li id="a0000000351"> <p>
Now <script type="math/tex">g(x,y)=0</script> defines a curve <script type="math/tex">\mathcal C</script> in <script type="math/tex">\mathbb R^{2}</script>. 
</p>
</li>
<li id="a0000000352"> <p>
We seek to optimise <script type="math/tex">{\mathcal L}</script> with respect to all three of its variables <script type="math/tex">x, y,\lambda </script>. The critical point is when <script type="math/tex">\nabla _{x,y,\lambda }{\mathcal L}={\bf 0}</script>, i.e., when <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial {\mathcal L}}{\partial x}& =& \frac{\partial f}{\partial x}+\lambda \frac{\partial g}{\partial x}=0, \\ \frac{\partial {\mathcal L}}{\partial y}& =& \frac{\partial f}{\partial y}+\lambda \frac{\partial g}{\partial y}=0, \\ \frac{\partial {\mathcal L}}{\partial \lambda }& =& g(x,y)=0. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000353"> <p>
Clearly from the third line, if we find the critical point of <script type="math/tex">{\mathcal L}</script> we automatically satisfy the constraint <script type="math/tex">g(x,y)=0</script>. Hence the critical points of <script type="math/tex">{\mathcal L}</script> lie on <script type="math/tex">{\mathcal C}</script>. 
</p>
</li>
<li id="a0000000354"> <p>
But the Lagrangian <script type="math/tex">\mathcal L</script> is identical to <script type="math/tex">f</script> on <script type="math/tex">{\mathcal C}</script> (where <script type="math/tex">g(x,y)=0</script>). 
</p>
</li>
<li id="a0000000355"> <p>
Hence if we are on <script type="math/tex">{\mathcal C}</script> and we find the critical point of <script type="math/tex">\mathcal L</script> from the above three equations, we are also finding the critical point of <script type="math/tex">f</script> on <script type="math/tex">{\mathcal C}</script>, i.e., we are finding the max/min of <script type="math/tex">f(x,y)</script> subject to the constraint <script type="math/tex">g(x,y)=0</script>. 
</p>
</li>
<li id="a0000000356"> <p>
We can go further, and eliminate the Lagrange multiplier <script type="math/tex">\lambda </script> from the first two equations: 
</p>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial f}{\partial x}+\lambda \frac{\partial g}{\partial x}=0, \qquad & \Rightarrow &  \qquad \lambda = -\frac{\partial f}{\partial x}\bigg/ \  \frac{\partial g}{\partial x} \\ \frac{\partial f}{\partial y}+\lambda \frac{\partial g}{\partial y}=0 \qquad & \Rightarrow &  \qquad \lambda = -\frac{\partial f}{\partial y}\bigg/ \  \frac{\partial g}{\partial y} \\ \Rightarrow \frac{\partial f}{\partial x}\bigg/ \  \frac{\partial g}{\partial x}& =& \frac{\partial f}{\partial y}\bigg/ \  \frac{\partial g}{\partial y} \end{eqnarray*}</script></span></span> which may be rearranged to give: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x} \frac{\partial g}{\partial y}- \frac{\partial g}{\partial x}\frac{\partial f}{\partial y}=0</script></span></span> or, in terms of the Jacobian determinant, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=0.</script></span></span>
</p>
</li>
<li id="a0000000357"> <p>
Hence the critical point will be given by the simultanenous solution of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=0, \qquad g(x,y)=0.</script></span></span>
</p>
</li>
<li id="a0000000358"> <p>
Note that the actual value of the Lagrange multiplier is therefore <b class="bf">irrelevant</b>! 
</p>
</li>
</ul>
<p>
We may now repeat the above example as follows: 
</p>
<p>
<b class="bf">Example:</b> We have the area function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=4xy</script></span></span> and the constraint function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=x^{2}/4+y^{2}-1=0</script></span>.</span>
</p>
<ul class="itemize" id="a0000000359">
<li id="a0000000360"> <p>
Using the above method, the relevant partial derivatives are: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}=4y, \qquad \frac{\partial f}{\partial y}=4x, \qquad \frac{\partial g}{\partial x}=\frac{x}{2}, \qquad \frac{\partial g}{\partial y}=2y.</script></span></span>
</p>
</li>
<li id="a0000000361"> <p>
Substituting into the Jacobian determinant we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=\left(\frac{\partial f}{\partial x}\frac{\partial g}{\partial y}-\frac{\partial g}{\partial x}\frac{\partial f}{\partial y}\right)=(4y)(2y)-(4x)(x/2)=8y^{2}-2x^{2}=0</script></span></span>
</p>
</li>
<li id="a0000000362"> <p>
Hence we have a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y^{2}=x^{2}/4</script></span></span> <b class="bf">and</b> (from the third equation <script type="math/tex">\partial {\mathcal L}/\partial \lambda =0</script> above) <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=x^{2}/4+y^{2}-1=0.</script></span></span> Hence we can substitute for <script type="math/tex">y</script> in <script type="math/tex">g</script> to obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x^{2}/4+x^{2}/4-1=0 \qquad \Rightarrow x^{2}=2 \qquad \Rightarrow x=\pm \sqrt{2}.</script></span></span> Hence using <script type="math/tex">y^{2}=x^{2}/4</script> we obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y^{2}=2/4 \qquad \Rightarrow x=\pm 1/\sqrt{2}.</script></span></span>
</p>
</li>
<li id="a0000000363"> <p>
Finally since <script type="math/tex">x</script> and <script type="math/tex">y</script> are meant to be the lengths of sides of a rectangle, they both have to be positive. So the critical point is when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">(x,y)=(\sqrt{2},1/\sqrt{2})</script></span></span> and the area is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">4\sqrt{2}/\sqrt{2}=4.</script></span></span>
</p>
</li>
<li id="a0000000364"> <p>
Note that we don’t choose to show that this is a maximum here. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> A farmer wants to enclose a rectangle of land next to a stream (see diagram) She will build 3 fences, the two perpendicular to the stream will be of length <script type="math/tex">x</script>, the one parallel to the stream will be of length <script type="math/tex">y</script>. If the farmer has only 100m length of fencing, what is the maximum area that she may enclose? 
</p>
<figure id="Saddle">
<div class="centered"> <img src="../../notes/course_notes/images/img-0091.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">2.47</span>
<span class="caption_text">Area of enclosed rectangular field is <script type="math/tex">A=xy</script>. Since it is adjacent to the stream only three fences are built with total perimeter <script type="math/tex">2x+y=100</script>m.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000365">
<li id="a0000000366"> <p>
The problem is to maximise <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=xy</script></span></span> subject to <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=2x+y-100=0.</script></span></span>
</p>
</li>
<li id="a0000000367"> <p>
Using the above method, the relevant partial derivatives are: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}=y, \qquad \frac{\partial f}{\partial y}=x, \qquad \frac{\partial g}{\partial x}=2, \qquad \frac{\partial g}{\partial y}=1.</script></span></span>
</p>
</li>
<li id="a0000000368"> <p>
Substituting into the Jacobian determinant we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=\left(\frac{\partial f}{\partial x}\frac{\partial g}{\partial y}-\frac{\partial g}{\partial x}\frac{\partial f}{\partial y}\right)=(y)(1)-(x)(2)=y-2x=0</script></span></span>
</p>
</li>
<li id="a0000000369"> <p>
Hence we have a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=2x</script></span> </span> <b class="bf">and</b> (from the third equation <script type="math/tex">\partial {\mathcal L}/\partial \lambda =0</script> above) <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=2x+y-100=0.</script></span></span> Hence we can substitute for <script type="math/tex">y</script> in <script type="math/tex">g</script> to obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x+2x-100=0 \qquad \Rightarrow x=25.</script></span></span> Hence using <script type="math/tex">y=2x</script> we obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=50.</script></span></span>
</p>
</li>
<li id="a0000000370"> <p>
So the critical point is when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">(x,y)=(25,50)</script></span></span> and the area is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">25\times 50 =1,250 {\rm m}^{2}.</script></span></span>
</p>
</li>
</ul>
<p>
Other types of problems involving optimisation with a constraint are possible (e.g., there are multiple constraints and/or at least on of the constraints is an inequality), but we will leave these for later modules. 
</p>
<p>
One interesting use of optimisation with a set of algebraic constraints is in the selection of an optimal portfolio of stocks to maximise the expected return. This problem is dealt with in MATH3022.  
</p>
</section>
</section><!-- Latex Chapter/Part -->
<h1 id="a0000000371">Multiple Integration</h1>
<section class="section">
<h2 id="a0000000372">3.1 Introduction</h2>
<p>
Having dealt with the differentiation of functions of multiple variables, we now consider the integration of functions <script type="math/tex">\mathbb R^{n}\to \mathbb R</script>. 
</p>
<p>
You have already sen the integral <script type="math/tex">I</script> of a (continuous) function of one variable <script type="math/tex">y=f(x)</script> over and interval <script type="math/tex">a\le x\le b</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I= \int _{a}^{b}f(x)dx.</script></span></span> The geometrical meaning of this symbol is the area of the plane region bounded by the curve <script type="math/tex">y=f(x)</script>, the <script type="math/tex">x</script>-axis and the line <script type="math/tex">x=a</script> and <script type="math/tex">x=b</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0093.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.1</span>
<span class="caption_text">Area under a curve.</span>
</figcaption> </div>
</figure>
<p>
Consider now the meaning of a <b class="bf">double</b> integral of a function <script type="math/tex">\mathbb R^{2}\to \mathbb R</script> of two variables, <script type="math/tex">z=f(x,y)</script> over a two dimensional domain <script type="math/tex"> \mathcal D</script> in the <script type="math/tex">(x,y)</script>-plane. 
</p>
<p>
By analogy, this is the <b class="bf">volume</b> of a three dimensional region <script type="math/tex">{\mathcal V}</script>, bounded above by the surface <script type="math/tex">x=f(x,y)</script>, below by the <script type="math/tex">(x,y)</script>-plane (<script type="math/tex">z=0</script>), and the vertical (irregular) cylinder sides parallel to the <script type="math/tex">z</script>-axis, emerging from the boundary of the domain <script type="math/tex">\mathcal D</script> (see figure). 
</p>
<p>
The region <script type="math/tex">\mathcal D</script> is called the <b class="bf">domain</b> of integration. We will represent the integral with the symbol <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\mathcal V}=\int _{\mathcal D}f(x,y)\  dA.</script></span></span> The symbol <script type="math/tex">dA</script> is the elemental area element in the <script type="math/tex">(x,y)</script>-plane. We can consider the volume integral as a limit in the following way. 
</p>
<ul class="itemize" id="a0000000373">
<li id="a0000000374"> <p>
We discretise the domain <script type="math/tex">\mathcal D</script> into infinitesimal elements of area <script type="math/tex">dA</script>. 
</p>
</li>
<li id="a0000000375"> <p>
If we are using cartesian coordinates, <script type="math/tex">(x,y)</script> and the infinitesimal elements are rectangles, we can write <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dA=dx \,  dy,</script></span></span> where <script type="math/tex">dx</script> and <script type="math/tex">dy</script> are the sides of the infinitesimal rectangles. 
</p>
</li>
<li id="a0000000376"> <p>
Now <script type="math/tex">dA</script> at the point <script type="math/tex">(x_{i},y_{j})</script> can be regarded as the base of a vertical rectangular column of height <script type="math/tex">f(x_{i},y_{j})</script>
</p>
</li>
<li id="a0000000377"> <p>
Then the integral <script type="math/tex">{\mathcal V}</script> is the limit <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\mathcal V}=\lim _{dA\rightarrow 0}\sum _{i,j} f(x_{i},y_{j})dA</script></span></span>
</p>
</li>
</ul>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0095.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.2</span>
<span class="caption_text">Volume under surface is the limit of the sum of the volumes of the columns of height <script type="math/tex">f(x_{i},y_{i})</script> each with base area <script type="math/tex">dA</script> as <script type="math/tex">dA\rightarrow 0</script>. </span>
</figcaption> </div>
</figure>
<p>
When we are evaluating an integral explicitly in terms of <script type="math/tex">(x,y)</script>, it is normal to write the integral in the form <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">V=\iint _{\mathcal D} f(x,y) dx \,  dy.</script></span></span> The “double” integration signs denote that we integrate both in the <script type="math/tex">x</script> direction and also the <script type="math/tex">y</script> direction. The order in which you carry out the integrations will be discussed later. 
</p>
</section><section class="section">
<h2 id="a0000000378">3.2 Properties of the Multiple Integral</h2>
<ol class="enumerate" id="a0000000379" style="list-style: none">
<li id="a0000000380" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
<b class="bf">Area of a Domain:</b> The area of a domain <script type="math/tex">\mathcal D</script> in the <script type="math/tex">(x,y)</script> plane is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">A=\int _{\mathcal D}\,  1 \,  dA.</script></span></span> At first site this looks like the volume of an irregularly bounded vertical cylinder of with base <script type="math/tex">\mathcal D</script> and height 1, which indeed it is. But we also know that the general formula for the volume of a vertical cylinder of constant height is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\rm Volume \  = \  area \  of \  } {\mathcal D} \  \times \  {\rm height \  of \  cylinder.}</script></span></span> Since the height of the cylinder is 1, the numerical value of the volume (forgetting the units!) is the same as the area of <script type="math/tex">\mathcal D</script>. 
</p>
<p>
Therefore we may use double integrals to measure areas of regions of the plane. <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\rm Area \  of \  } {\mathcal D} = \int _{\mathcal D} \,  1 \,  dA =\int _{\mathcal D} \,  dA.</script></span></span>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0097.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.3</span>
<span class="caption_text">Right cylinder of height 1 and base area <script type="math/tex">{\mathcal D}</script> also has (numerical) volume <script type="math/tex">{\mathcal D}</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000381" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
<b class="bf">The integral is linear:</b> For constants <script type="math/tex">\lambda </script> and <script type="math/tex">\mu </script> we have: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal D}\left(\lambda f(x,y) +\mu g(x,y)\right) \,  dA =\lambda \int _{\mathcal D}f(x,y) \;  dA +\mu \int _{\mathcal D}g(x,y) \;  dA.</script></span>
<p>
 This just says that if have multiple copies of two different volume cylinders, the total volume is just the sum of all the copies. 
</p>
</li>
<li id="a0000000382" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
<b class="bf">Inequalities are preserved:</b> If we have two integrable functions <script type="math/tex">f</script>, <script type="math/tex">g</script> and that <script type="math/tex">f(x,y)\le g(x,y)</script> over the integration domain <script type="math/tex">\mathcal D</script> then 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal D}f(x,y) \,  dA \le \int _{\mathcal D}g(x,y) \,  dA.</script></span>
<p>
 This just says that if you have two irregular cylinders, one of which has a height smaller than or equal to the other, then the overall taller cylinder will have the greater volume. 
</p>
</li>
<li id="a0000000383" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
<b class="bf">Modulus Property:</b>
</p>
<span class="dmath"><script type="math/tex; mode=display">\left|\int _{\mathcal D}f(x,y) \,  dA \right|\le \int _{\mathcal D}\left|f(x,y)\right| \,  dA</script></span>
<p>
 This just reflects the fact that if <script type="math/tex">f(x,y)</script> dips below the horizontal <script type="math/tex">(x,y)</script> axis and becomes negative in parts of the domain <script type="math/tex">\mathcal D</script>, then the volume becomes negative (cf. 1-D integrals and negative areas). 
</p>
</li>
<li id="a0000000384" value="5">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		5.
	</span>
<p>
<b class="bf">Additivity of Domains:</b> If <script type="math/tex">\mathcal D_{1}</script>, <script type="math/tex">\mathcal D_{2}</script>, <script type="math/tex">\mathcal D_{3}</script>, …<script type="math/tex">\mathcal D_{k}</script> are non-overlapping domains in the <script type="math/tex">(x,y)</script>-plane, on each of which <script type="math/tex">f(x,y)</script> is integrable, then <script type="math/tex">f(x,y)</script> is integrable over the union of these domains <script type="math/tex">{\mathcal D}</script> = <script type="math/tex">\mathcal D_{1} \cup </script> <script type="math/tex">\mathcal D_{2} \cup </script> <script type="math/tex">\mathcal D_{3} \cup </script> …<script type="math/tex">\cup \mathcal D_{k}</script>. 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal D}f(x,y) \,  dA = \sum _{j=1}^{k}\int _{\mathcal D_{j}}f(x,y) \,  dA.</script></span>
<p>
 This just says the volume of a series of cylinders of height <script type="math/tex">f(x,y)</script> over bases <script type="math/tex">\mathcal D_{i}</script> is just the sum of the individual volumes. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0099.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.4</span>
<span class="caption_text">If <script type="math/tex">{\mathcal D}={\mathcal D}_{1}\cup {\mathcal D}_{2}\cup {\mathcal D}_{3}</script> then <script type="math/tex">\int _{\mathcal D} f(x,y) dA =\sum _{j=1}^{3} \int _{\mathcal D_{i}}f(x,y) dA.</script> </span>
</figcaption> </div>
</figure>
</li>
</ol>
</section><section class="section">
<h2 id="a0000000385">3.3 Evaluation of Double Integrals</h2>
<section class="subsection">
<h3 id="simple fubini">3.3.1 Rectangular Domains</h3>
<p>
Consider an integral over a rectangular domain <script type="math/tex">\mathcal R</script> in the <script type="math/tex">(x,y)</script> plane. How do we know whether to integrate in the <script type="math/tex">x</script> direction or the <script type="math/tex">y</script> direction first? Fortunately we are guided by a theorem due to Fubini<a class="footnote" href="#a0000000386">
<sup class="footnotemark">10</sup>
</a> (proof not required): 
</p>
<p>
 (Fubini)  Let <script type="math/tex">{\mathcal R} = [a,b]\times [c,d]</script> be a rectangle in <script type="math/tex">{\mathbb R}^2</script> whose sides are parallel to the coordinate axes and let <script type="math/tex">f(x,y)</script> be a function that is continuous on <script type="math/tex">R</script>. Then, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _ a^ b \int _ c^ d f(x,y) \:  {\rm d}y \:  {\rm d}x = \int _ c^ d \int _ a^ b f(x,y) \:  {\rm d}x \:  {\rm d}y.</script></span>
<p>
<b class="bf">Example 1:</b> Find the volume of the solid lying above the square in the <script type="math/tex">(x,y)</script>-plane defined by <script type="math/tex">0\le x\le 1</script>, <script type="math/tex">1\le y\le 2</script> and below the plane <script type="math/tex">z=4-x-y</script>. 
</p>
<ul class="itemize" id="a0000000387">
<li id="a0000000388"> <p>
The integral we want is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">V=\int _{\mathcal D}z(x,y) \,  dA = \int _{\mathcal D}(4-x-y) \,  dA.</script></span></span>
</p>
</li>
<li id="a0000000389"> <p>
The rectangular domain <script type="math/tex">\mathcal D</script> is rectangular, and <script type="math/tex">4-x-y</script> is clearly continuous<a class="footnote" href="#a0000000390">
<sup class="footnotemark">11</sup>
</a> so by the Fubini theorem, the double integral may be evaluated either way: you will (have to) get the same answer! 
</p>
</li>
<li id="a0000000391"> <p>
We will evaluate the <script type="math/tex">x</script>-integral first, treating <script type="math/tex">y</script> as a constant, then integrate with respect to <script type="math/tex">y</script>, as follows: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0101.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.5</span>
<span class="caption_text">Volume: <script type="math/tex">0\le z\le 4-x-y, \  \  0\le x\le 1, \  \  1\le y\le 2</script>.</span>
</figcaption> </div>
</figure>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  V& =& \int _{y=1}^{y=2}dy \int _{x=0}^{x=1}dx (4-x-y), \\ & =&  \int _{y=1}^{y=2}dy\left[4x-\frac{x^{2}}{2}-yx\right]_{x=0}^{x=1}, \\ & =&  \int _{y=1}^{y=2}dy\left[\left(4\times (1)-\frac{(1)^{2}}{2}-y\times (1)\right)-\left(4\times (0)-\frac{(0)^{2}}{2}-y\times (0)\right)\right], \\ & =&  \int _{y=1}^{y=2}dy\left[4-\frac{1}{2}-y\right], \\ & =&  \int _{y=1}^{y=2}dy\left[\frac{7}{2}-y\right], \\ & =&  \left[\frac{7}{2}y-\frac{y^{2}}{2}\right]_{y=1}^{y=2}, \\ & =&  \left[\left(\frac{7}{2}\times (2)-\frac{(2)^{2}}{2}\right)-\left(\frac{7}{2}\times (1)-\frac{(1)^{2}}{2}\right)\right],\\ & =&  2. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000392"> <p>
Now to demonstrate Fubini, we first integrate with respect to <script type="math/tex">y</script>, treating <script type="math/tex">x</script> as a constant on each slice, then integrate with respect to <script type="math/tex">x</script>, as follows: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0103.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.6</span>
<span class="caption_text">Left <script type="math/tex">x</script>-simple evaluation. Right: <script type="math/tex">y</script>-simple evaluation.</span>
</figcaption> </div>
</figure>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  V& =& \int _{x=0}^{x=1}dx \int _{y=1}^{y=2}dy (4-x-y), \\ & =&  \int _{x=0}^{x=1}dx\left[4y-xy-\frac{y^{2}}{2}\right]_{y=1}^{y=2}, \\ & =&  \int _{x=0}^{x=1}dx\left[\left(4\times (2)-2x-\frac{(2)^{2}}{2}\right)-\left(4\times (1)-x-\frac{(1)^{2}}{2}\right)\right], \\ & =&  \int _{x=0}^{x=1}dx\left[8-2-4+\frac{1}{2}-2x+x\right], \\ & =&  \int _{x=0}^{x=1}dx\left[\frac{5}{2}-x\right], \\ & =&  \left[\frac{5}{2}x-\frac{x^{2}}{2}\right]_{x=0}^{x=1}, \\ & =&  \left[\left(\frac{5}{2}\times (1)-\frac{(1)^{2}}{2}\right)-\left(\frac{5}{2}\times (0)-\frac{(0)^{2}}{2}\right)\right],\\ & =&  2. \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Note:</b> The limits on the inner integral do not depend here on the integration variable of the outer limit. This is because, in this example, the domain of integration <script type="math/tex">\mathcal D</script> is a rectangle. If <script type="math/tex">\mathcal D</script> were not a rectangle, the inner limits <b class="bf">would</b> depend on the outer integration variable. 
</p>
</section><section class="subsection">
<h3 id="a0000000393">3.3.2 Simple Domains</h3>
<p>
Not all domains of integration are rectangular. However when we have non-rectangular domains, evaluation of an integral is easiest when the domain of integration is said to be <b class="bf">simple</b>, see diagram. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0105.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.7</span>
<span class="caption_text">Left: <script type="math/tex">y</script>-simple domain <script type="math/tex">{\mathcal D}</script>. Right <script type="math/tex">x</script>-simple domain <script type="math/tex">{\mathcal D}</script>.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Definition (<script type="math/tex">x</script>- and <script type="math/tex">y</script>- Simple Domains):</b>
</p>
<ul class="itemize" id="a0000000394">
<li id="a0000000395"> <p>
<b class="bf"><script type="math/tex">y</script>-Simple:</b> A <script type="math/tex">y</script>-simple domain is one that is bounded by two <b class="bf">vertical</b> lines <script type="math/tex">x=a</script> and <script type="math/tex">x=b</script> and two continuous graphs <script type="math/tex">y=c(x)</script> and <script type="math/tex">y=d(x)</script>. 
</p>
</li>
<li id="a0000000396"> <p>
<b class="bf"><script type="math/tex">x</script>-Simple:</b> A <script type="math/tex">x</script>-simple domain is one that is bounded by two <b class="bf">horizontal</b> lines <script type="math/tex">y=c</script> and <script type="math/tex">y=d</script> and two continuous graphs <script type="math/tex">x=a(y)</script> and <script type="math/tex">x=b(y)</script>. 
</p>
</li>
</ul>
<p>
<br/>
</p>
</section><section class="subsection">
<h3 id="a0000000397">3.3.3 Evaluation of an Integral over a Simple Domain</h3>
<p>
Suppose that <script type="math/tex">\mathcal D</script> is <script type="math/tex">y</script>-simple and is bounded by 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=a, \qquad x=b, \qquad y=c(x), \qquad y=d(x),</script></span>
<p>
 where <script type="math/tex">c(x)</script> and <script type="math/tex">d(x)</script> are both continuous functions. The integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA</script></span>
<p>
 is the volume of the vertical cylinder of base <script type="math/tex">\mathcal D</script> and bounded at the top by <script type="math/tex">z=f(x,y)</script>. 
</p>
<p>
We shall now consider how to evaluate this multiple integral using an approach akin to the very thin slicing of a loaf of bread. The volume of the loaf is the sum of the volume all the slices (assuming no crumbs). 
</p>
<ul class="itemize" id="a0000000398">
<li id="a0000000399"> <p>
Consider a very thin slice of the solid, perpendicular to the <script type="math/tex">x</script>-axis as the point <script type="math/tex">x</script> of width <script type="math/tex">dx</script> (see diagram). 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0107.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.8</span>
<span class="caption_text">Left: <script type="math/tex">x</script>-slicing. Right: <script type="math/tex">y</script>-slicing</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000400"> <p>
The slice is bounded between the values 
</p>
<span class="dmath"><script type="math/tex; mode=display">c(x)\le y \le d(x)</script></span>
<p>
. 
</p>
</li>
<li id="a0000000401"> <p>
The area of the vertical slice is thus 
</p>
<span class="dmath"><script type="math/tex; mode=display">\alpha (x)= \int _{y=c(x)}^{y=d(x)}f(x,y) dy.</script></span>
</li>
<li id="a0000000402"> <p>
The volume of each vertical slice is <script type="math/tex">\alpha (x) dx</script> for <script type="math/tex">a\le x\le b</script>. 
</p>
</li>
<li id="a0000000403"> <p>
In the limit as the slice thicknesses <script type="math/tex">dx\rightarrow 0</script> and <script type="math/tex"> dy\rightarrow 0</script> we thus have 
</p>
<span class="dmath"><script type="math/tex; mode=display">I = \int _{x=a}^{x=b}\alpha (x) \,  dx</script></span>
</li>
<li id="a0000000404"> <p>
But remembering the definitions of the volume <script type="math/tex">I</script> and <script type="math/tex">\alpha (x)</script> above, we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA= \int _{x=a}^{x=b}\left[ \int _{y=c(x)}^{y=d(x)}f(x,y) dy\right]dx</script></span>
<p>
 We usually drop the square brackets with the understanding that the first <script type="math/tex">d</script>-something is the inner integral that is done first. Hence we can write 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA= \int _{x=a}^{x=b} \int _{y=c(x)}^{y=d(x)}f(x,y) dy \,  dx</script></span>
</li>
<li id="a0000000405"> <p>
Note that since the volume should not ultimately contain terms in <script type="math/tex">y</script> or <script type="math/tex">x</script>, the limits are often the key to understanding which of the integrals should be performed first. Hence, after practice, it is usually possible to leave out the explicit references to <script type="math/tex">x=</script> and <script type="math/tex">y=</script> in the limits and write the integral as. 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA= \int _{a}^{b} \int _{c(x)}^{d(x)}f(x,y) dy \,  dx</script></span>
</li>
<li id="a0000000406"> <p>
With this also in mind, an alternative representation I may use is: 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA= \int _{a}^{b} dx \int _{c(x)}^{d(x)}dy \,  f(x,y).</script></span>
<p>
 The advantage of writing the <script type="math/tex">dx</script> and the <script type="math/tex">dy</script> next to the relevant integral sign is that it reminds you what what has to be substituted in as the limits after each of the integrations. The implication here is that the <script type="math/tex">y</script> integral must still be done first, since it has limits that depend on <script type="math/tex">x</script>, the integration that is here done last. 
</p>
</li>
</ul>
<p>
If <script type="math/tex">\mathcal D</script> is <script type="math/tex">x</script>-simple, we could repeat the same procedure with slices perpendicular to to <script type="math/tex">y</script>-axis. (The volume of a loaf can’t change, no matter how you slice it!). 
</p>
<p>
Under those circumstances we could then evaluate the integral as (see above diagram): 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA= \int _{y=c}^{y=d} \beta (y) \,  dy, \qquad \beta (y)=\int _{x=a(y)}^{x=b(y)}f(x,y) dx</script></span>
<p>
 or equivalently 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA= \int _{c}^{d} \int _{a(y)}^{b(y)}f(x,y) dx \,  dy,</script></span>
<p>
 or equivalently 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{D}f(x,y) \,  dA= \int _{c}^{d} dy \int _{a(y)}^{b(y)}dx \,  f(x,y).</script></span>
</section><section class="subsection">
<h3 id="a0000000407">3.3.4 Regular Domains</h3>
<p>
<b class="bf">Definition (Regular Domain):</b> A domain that is not simple, but which can be split up into a series of <script type="math/tex">x</script>-simple or <script type="math/tex">y</script>-simple domains is called <b class="bf">regular</b>. An integral over a regular domain is evaluated as the sum of integrals over each constituent simple domain (property 5 above). 
</p>
<p>
<b class="bf">Example:</b> Consider a bagel-shaped domain, <script type="math/tex">1\le \sqrt{x^{2}+y^{2}}\le 2</script>. This is not a simple domain as it has a hole in the middle and the functions that define the boundary are multi-valued. However by careful slicing, the bagel can me turned into the sum of simple domains, each of which have boundaries that may be written in terms of single-valued functions. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0109.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.9</span>
<span class="caption_text">Slicing and dicing your <b class="bf">regular</b> bagel domain <script type="math/tex">\mathcal D</script>, to obtain, e.g., a representation of <script type="math/tex">y</script>-simple domains, such that <script type="math/tex">{\mathcal D}={\mathcal D}_{1}+{\mathcal D}_{2}+{\mathcal D}_{3}+{\mathcal D}_{3}</script>.</span>
</figcaption> </div>
</figure>
<p>
The integral of a function <script type="math/tex">z=f(x,y)</script> over the bagel-domain can therefore be evaluated as follows: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D} f(x,y)\,  dx dy =\sum _{i=1}^{4}\iint _{\mathcal D_{i}} f(x,y)\,  dx dy.</script></span></span>
</p>
</section><section class="subsection">
<h3 id="a0000000408">3.3.5 Examples of Evaluation of Double Integrals</h3>
<p>
 The following examples stress the importance of drawing the domain of integration in the <script type="math/tex">(x,y)</script>-plane. It gives geometrical insight that can lead to an understanding of what is going on and in some cases, considerable simplications. 
</p>
<p>
<b class="bf">Example 2:</b> Evaluate <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{\mathcal T}xy \,  dA,</script></span></span> over the triangle <script type="math/tex">\mathcal T</script> in the <script type="math/tex">(x,y)</script>-plane, with vertices <script type="math/tex">(0,0)</script>, <script type="math/tex">(1,0)</script> and <script type="math/tex">(1,1)</script>. 
</p>
<p>
The triangle is both <script type="math/tex">x</script>-simple and <script type="math/tex">y</script>-simple (see diagram), so again we can chose the order in which we perform the integrations. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0111.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.10</span>
<span class="caption_text">Volume: <script type="math/tex">0\le z\le xy</script>,    <script type="math/tex">0\le y\le x</script>,   <script type="math/tex">0\le x\le 1</script>. </span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000409">
<li id="a0000000410"> <p>
Evaluating the integral as <script type="math/tex">y</script>-simple we first integrate with respect to <script type="math/tex">y</script>, treating <script type="math/tex">x</script> as a constant on each slice, then integrate with respect to <script type="math/tex">x</script>. 
</p>
</li>
<li id="a0000000411"> <p>
Consider the diagram. For each constant slice of <script type="math/tex">x</script>, we need to integrate <script type="math/tex">y</script> from <script type="math/tex">0</script> to the sloping side of the triangle <script type="math/tex">\mathcal T</script>. The sloping side of <script type="math/tex">\mathcal T</script> has the equation <script type="math/tex">y=x</script> The coordinate of the intersection of the slice at a general point <script type="math/tex">x</script> with the sloping side of <script type="math/tex">\mathcal T</script> is <script type="math/tex">(x, y(x))=(x,x)</script>
</p>
</li>
<li id="a0000000412"> <p>
Having integrated over each of these <script type="math/tex">x</script>-slices, we then have to integrate over the range <script type="math/tex">0\le x\le 1</script> (see diagram). 
</p>
</li>
<li id="a0000000413"> <p>
The integral thus becomes <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  V& =& \int _{x=0}^{x=1}dx \int _{y=0}^{y=x}dy \,  xy, \\ & =&  \int _{x=0}^{x=1}dx\left[x\frac{y^{2}}{2}\right]_{y=0}^{y=x}, \\ & =&  \int _{x=0}^{x=1}dx\left[\left(x\frac{(x)^{2}}{2}\right)-\left(x\frac{(0)^{2}}{2}\right)\right], \\ & =&  \int _{x=0}^{x=1}dx\left[\frac{x^{3}}{2}\right], \\ & =&  \left[\frac{x^{4}}{8}\right]_{x=0}^{x=1}, \\ & =&  \frac{1}{8}. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000414"> <p>
Evaluating the integral as <script type="math/tex">x</script>-simple we first integrate with respect to <script type="math/tex">x</script>, treating <script type="math/tex">y</script> as a constant on each slice, then integrate with respect to <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000415"> <p>
Consider the diagram. For each constant slice of <script type="math/tex">y</script>, we need to integrate <script type="math/tex">x</script> from the sloping side of the triangle <script type="math/tex">\mathcal T</script> to <script type="math/tex">x=1</script>. The sloping side of <script type="math/tex">\mathcal T</script> has the equation <script type="math/tex">y=x</script> The coordinate of the intersection of the slice at a general point <script type="math/tex">y</script> with the sloping side of <script type="math/tex">\mathcal T</script> is <script type="math/tex">(x(y), y)=(y,y)</script>
</p>
</li>
<li id="a0000000416"> <p>
Having integrated over each of these <script type="math/tex">y</script>-slices, we then have to integrate over the range <script type="math/tex">0\le y\le 1</script> (see diagram). 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0113.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.11</span>
<span class="caption_text">Left: <script type="math/tex">y</script>-Simple evaluation: Right: <script type="math/tex">x</script>-Simple evaluation.</span>
</figcaption> </div>
</figure>
<p>
<span style="color:#FF0000"><p>
The integral thus becomes 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  V& =& \int _{y=0}^{x=1}dy \int _{x=y}^{x=1}dx \,  xy, \\ & =&  \int _{y=0}^{y=1}dy\left[\frac{x^{2}}{2}y\right]_{x=y}^{x=1}, \\ & =&  \int _{y=0}^{y=1}dy\left[\left(\frac{(1)^{2}}{2}y\right)-\left(\frac{(y)^{2}}{2}y\right)\right], \\ & =&  \int _{y=0}^{y=1}dy\left[\frac{y}{2}-\frac{y^{3}}{2}\right], \\ & =&  \left[\frac{y^{2}}{4}-\frac{y^{4}}{8}\right]_{y=0}^{y=1}, \\ & =&  \frac{1}{8}. \end{eqnarray*}</script></span>
</span>
</p>
</li>
</ul>
<p>
Sometimes altering the order of the integration can make the integral easier to evaluate. 
</p>
<p>
<b class="bf">Example 3:</b> Evaluate <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{\mathcal D} e^{y^{3}}\,  dA,</script></span></span> where <script type="math/tex">\mathcal D</script> is the domain in the figure below, bounded as <script type="math/tex">0\le x\le 1</script>, <script type="math/tex">\sqrt{x} \le y \le 1</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0115.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.12</span>
<span class="caption_text">Left: <script type="math/tex">y</script>-simple evaluation of <script type="math/tex">\int _{\mathcal D}e^{y^{3}}\, dA</script>. Right: <script type="math/tex">x</script>-simple evaluation of <script type="math/tex">\int _{\mathcal D}e^{y^{3}}\, dA</script></span>
</figcaption> </div>
</figure>
<p>
If we just plug in the limits we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{x=0}^{x=1} dx \int _{y=\sqrt{x}}^{y=1}dy \,  e^{y^{3}}</script></span></span> However this leads to an immediate problem: we have no idea what the indefinite integral of <script type="math/tex">e^{y^{3}}</script> is. (If you don’t believe me, try to find it in a table of integrals, or ask WolframAlpha to do it.) 
</p>
<p>
The trick here is to <b class="bf">reverse</b> the order of integration and do the <script type="math/tex">x</script> integral <b class="bf">first</b>, and <b class="bf">then</b> the <script type="math/tex">y</script>-integral. To do this we need to work out the new limits for the integral. Hence we now consider the same integral but evaluate it as <script type="math/tex">x</script>-simple. 
</p>
<ul class="itemize" id="a0000000417">
<li id="a0000000418"> <p>
We are now going to integrate first with respect to <script type="math/tex">x</script>. The limits for a constant <script type="math/tex">y</script>-slice are (see diagram) <script type="math/tex">0\le x \le x(y)=y^{2}</script>. The limits for the second, <script type="math/tex">y</script>-integral are just <script type="math/tex">0\le y\le 1</script>. 
</p>
</li>
<li id="a0000000419"> <p>
We then have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{y=0}^{y=1} dy \int _{x=0}^{x=y^{2}}dx \,  e^{y^{3}}.</script></span></span>
</p>
</li>
<li id="a0000000420"> <p>
The point of swapping the order of integration is that we can now easily do at least the first <script type="math/tex">x</script> integral: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I & =&  \int _{y=0}^{y=1}dy\left[xe^{y^{3}}\right]_{x=0}^{x=y^{2}},\\ & =& \int _{y=0}^{y=1}dy\left[\left((y^{2})e^{y^{3}}\right)-\left((0)e^{y^{3}}\right)\right], \\ & =& \int _{y=0}^{y=1}dy\,  y^{2}e^{y^{3}}. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000421"> <p>
Now the key point here is that we are left with a <script type="math/tex">y</script>-integral that we <b class="bf">can</b> do. By inspection we see that the integrand is an exact derivative: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y^{2}e^{y^{3}}=\frac{d}{dy}\left(\frac{e^{y^{3}}}{3}\right).</script></span></span>
</p>
</li>
</ul>
<p>
 Hence we can now perform the (second) <script type="math/tex">y</script>-integral to obtain <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I & =& \int _{y=0}^{y=1}dy\,  y^{2}e^{y^{3}}, \\ & =& \frac{1}{3}\int _{y=0}^{y=1}dy\,  \frac{d}{dy}\left(e^{y^{3}}\right) \\ & =& \frac{1}{3}\left[e^{y^{3}}\right]_{y=0}^{y=1} \\ & =& \frac{1}{3}\left(e^{1}-e^{0}\right) \\ & =& \frac{1}{3}\left(e-1\right) \\ \end{eqnarray*}</script></span></span>
</p>
</section><section class="subsection">
<h3 id="a0000000422">3.3.6 Double Integrals in Polar Coordinates</h3>
<section class="subsubsection">
<h4 id="a0000000423">Polar Coordinates</h4>
<p>
 Some integrals are much simpler t evaluate if they are expressed in alternative coordinate systems to cartesians <script type="math/tex">(x,y)</script>. For example, when you have a circular domain <script type="math/tex">\mathcal D</script>, or a radially-symmetric integrand, it is often easier to evaluate the integral in terms of polar coordinates. 
</p>
<p>
Recall that in polar coordinates there is an origin called a <b class="bf">pole</b> and denoted by <script type="math/tex">O</script> and a <b class="bf">polar axis</b> which is a half-line extending from <script type="math/tex">O</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0117.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.13</span>
<span class="caption_text">Plane polar coordinates</span>
</figcaption> </div>
</figure>
<p>
The position of a point <script type="math/tex">P</script> in the plane is determined by its polar coordinates <script type="math/tex">(r, \theta )</script> where: 
</p>
<p>
<br/>
</p>
<ul class="itemize" id="a0000000424">
<li id="a0000000425"> <p>
<script type="math/tex">r</script> is the distance from <script type="math/tex">O</script> to <script type="math/tex">P</script>, <script type="math/tex">|{\bf OP}|</script>. 
</p>
</li>
<li id="a0000000426"> <p>
<script type="math/tex">\theta </script> is the angle that the vector <b class="bf">OP</b> make with the polar axis, counterclockwise angles being counted as positive. 
</p>
</li>
<li id="a0000000427"> <p>
Normally we fix <script type="math/tex">\theta </script> in a given <script type="math/tex">2\pi </script> range, e.g., <script type="math/tex">0\le \theta \le 2\pi </script> since <script type="math/tex">(r, \theta ) =(r, \theta +2n\pi ), n\in {\mathbb Z}</script>. 
</p>
</li>
</ul>
<p>
 The conversion between cartesian and polar coordinates are as follows: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left.\begin{array}{c}x=r\cos \theta \\ y=r\sin \theta \end{array}\right\} \leftrightarrow \left\{ \begin{array}{c}r=\sqrt{x^2+y^2} \\ \tan \theta = y/ x\end{array}\right.</script></span></span>
</p>
</section><section class="subsubsection">
<h4 id="a0000000428">The Use of Polar Coordinates in Double Integrals</h4>
<p>
 To illustrate the use of polars, we consider the following examples: 
</p>
<p>
<b class="bf">Example 1:</b> Find the volume <script type="math/tex">V</script> of the solid region lying above the <script type="math/tex">(x,y)</script> plane and beneath the paraboloid <script type="math/tex">z=1-x^{2}-y^{2}</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0119.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.14</span>
<span class="caption_text">The volume we want is that above the grey horizontal <script type="math/tex">(x,y)</script>-plane, but below the meshed surface. The black circle is <script type="math/tex">x^{2}+y^{2}=1</script> and denotes the intersection of the two and so is the boundary of <script type="math/tex">\mathcal D</script> for this example. It looks rather like the <script type="math/tex">{\rm O}_{2}</script> in London....</span>
</figcaption> </div>
</figure>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0121.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.15</span>
<span class="caption_text">Evaluating the paraboloid integral using a <script type="math/tex">y</script>-simple approach</span>
</figcaption> </div>
</figure>
<p>
The paraboloid intersects the <script type="math/tex">(x,y)</script>-plane in the circle <script type="math/tex">z=0 \Rightarrow x^{2}+y^{2}=1</script>. The domain <script type="math/tex">\mathcal D</script> is thus <script type="math/tex">x</script>-simple or <script type="math/tex">y</script>-simple. We can then pick, say, the <script type="math/tex">y</script>-simple route and so in cartesian coordinates the required volume is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">V=\int _{\mathcal D}(1-x^{2}-y^{2}) \,  dA =\int _{x=-1}^{x=+1}dx \int _{y=-\sqrt{1-x^{2}}}^{y=+\sqrt{1-x^{2}}}dy \,  (1-x^{2}-y^{2}).</script></span></span> The integral can be done, but it involves a lot of messy algebra. It is much neater to convert the problem to polar coordinates. 
</p>
<ul class="itemize" id="a0000000429">
<li id="a0000000430"> <p>
The domain of integration becomes <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x^{2}+y^{2}\le 1 \qquad \Rightarrow \qquad r\le 1, \qquad 0\le \theta \le 2\pi .</script></span></span>
</p>
</li>
<li id="a0000000431"> <p>
The integrand becomes <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1-x^{2}-y^{2}=1-\left(r\cos \theta \right)^{2}-\left(r\sin \theta \right)^{2}=1-r^{2}(\cos ^{2}\theta +\sin ^{2}\theta )=1-r^{2}.</script></span></span>
</p>
</li>
</ul>
<p>
 Hence the integral becomes <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">V=\int _{\mathcal D}(1-r^{2}) \,  dA’,</script></span></span> but where <script type="math/tex">dA'</script> is now the elemental area expressed in polar coordinates <script type="math/tex">(r,\theta )</script>, <b class="bf">not</b> cartesians. 
</p>
<p>
Now it is vitally important to realise that just because <script type="math/tex">dA = dx dy</script>, it does not mean that when expressed in polars, the equivalent infinitesimal area element <script type="math/tex">dA'</script> is equal to <script type="math/tex">dr d\theta </script>. For a start this is dimensionally wrong: both <script type="math/tex">dx</script> and <script type="math/tex">dy</script> have units of length, so <script type="math/tex">dA</script> has units of (length)<script type="math/tex">^{2}</script>. While <script type="math/tex">dr</script> has a unit of length, <script type="math/tex">d\theta </script> is just an angle, with (numerically) no units. Hence <script type="math/tex">dr d\theta </script> only has units of length, not (length)<script type="math/tex">^{2}</script>. 
</p>
<p>
If we sketch the respective elemental areas in cartesian and polar coordinates we can deduce graphically what the representation for <script type="math/tex">dA</script> is in polar coordinates. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0123.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.16</span>
<span class="caption_text">Left: <script type="math/tex">dA=dx\, dy</script> in cartesians. Right: In the limit as <script type="math/tex">dr</script> and <script type="math/tex">d\theta \rightarrow 0</script>, <script type="math/tex">dA'=rdr\, d\theta </script> in plane polars.</span>
</figcaption> </div>
</figure>
<p>
We find that in the limits that <script type="math/tex">dx, dy\rightarrow 0</script> and <script type="math/tex">dr, d\theta \rightarrow 0</script> that both elemental areas are to leading order rectangles. Hence we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dA=dx\times dy=dx \,  dy \  {\rm in \  cartesians}, \qquad dA’=dr \times r d\theta =rdrd\theta \  {\rm in \  plane \  polars}.</script></span></span> In general whenever you change coordinates in a multidimensional integral, you have to be very careful about what <script type="math/tex">dA</script> becomes. We study a systematic way of working this out in the next section. 
</p>
<p>
Returning to the volume integral we see that in polars it becomes explicitly <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">V=\int _{\mathcal D}(1-r^{2}) \,  dA=\int _{r=0}^{r=1}dr \int _{\theta =0}^{\theta =2\pi } d\theta \,  r(1-r^{2}).</script></span></span> Note the extra <script type="math/tex">r</script> in the integrand that comes from the change of variable! 
</p>
<p>
Modulo that complication, look now at how easy the integral is to evaluate. The limits have decoupled and the integrand only depends on one of the variables <script type="math/tex">r</script>. This is because of the radial symmetry of both the integrand (it only depends on <script type="math/tex">r</script>) and the domain of integration (it’s a circle). Therefore the double integral is effectively just the product of two separate, independent integrals. We have: 
</p>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  V& =& \int _{r=0}^{r=1}dr \int _{\theta =0}^{\theta =2\pi } d\theta \,  r(1-r^{2})\\ & =& \int _{\theta =0}^{\theta =2\pi } d\theta \int _{r=0}^{r=1}dr \,  (r-r^{3})\\ & =& \int _{\theta =0}^{\theta =2\pi } d\theta \left[\frac{r^{2}}{2}-\frac{r^{4}}{4}\right]_{r=0}^{r=1} \\ & =& \int _{\theta =0}^{\theta =2\pi } d\theta \left(\frac{1}{2}-\frac{1}{4}\right) \\ & =& \frac{1}{4}\int _{\theta =0}^{\theta =2\pi } d\theta \\ & =& \frac{1}{4}\left[\theta \right]_{\theta =0}^{\theta =2\pi } \\ & =& \frac{\pi }{2}. \end{eqnarray*}</script></span></span>
</p>
<p>
<b class="bf">Summary:</b> To change from polar coordinates: 
</p>
<ol class="enumerate" id="a0000000432" style="list-style: none">
<li id="a0000000433" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
Express the integrand as a function of <script type="math/tex">r</script> and <script type="math/tex">\theta </script>. 
</p>
</li>
<li id="a0000000434" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
Express the domain of integration (limits) in polar coordinates. 
</p>
</li>
<li id="a0000000435" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
Write the area element <script type="math/tex">dA=rdrd\theta </script>. 
</p>
</li>
<li id="a0000000436" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
Evaluate the integral. 
</p>
</li>
</ol>
<p>
Sometimes changes of variables can be used to evaluate integrals that we otherwise would not know how to evaluate. 
</p>
<p>
<b class="bf">Example:</b> Consider the integral <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{-\infty }^{+\infty }e^{-x^{2}}dx.</script></span></span> This integral comes up everywhere in probability theory as the normalisation term for the normal distribution. You may know the value as <script type="math/tex">\sqrt{\pi }</script>, but how do you obtain that? There is no antiderivative for <script type="math/tex">e^{-x^{2}}</script> in terms of simple functions. One trick is to use polar coordinates as follows. We consider the integral <script type="math/tex">I^{2}</script> and write it as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I^{2}=\left(\int _{-\infty }^{+\infty }e^{-x^{2}}dx\right)\times \left(\int _{-\infty }^{+\infty }e^{-y^{2}}dy\right).</script></span></span> The second integral is exactly the same as the first, it is just that we are using a different dummy integration variable. If we do that we may rewrite the integrals as a double integral over <script type="math/tex">\mathbb R^{2}</script> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I^{2}=\int _{-\infty }^{+\infty }dx \int _{-\infty }^{+\infty } dy \,  e^{-(x^{2}+y^{2})}.</script></span></span> Now look at the integrand. It has the tell-tale radial symmetry of polar coordinates, since<script type="math/tex">x</script> and <script type="math/tex">y</script> only appear together in combinations of the type <script type="math/tex">x^{2}+y^{2}</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0125.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.17</span>
<span class="caption_text">Double Gaussian integral domain in 2-D cartesians (left) and plane polars (right).</span>
</figcaption> </div>
</figure>
<p>
So following the summary above, we have 
</p>
<p>
<b class="bf">Summary:</b>
</p>
<ol class="enumerate" id="a0000000437" style="list-style: none">
<li id="a0000000438" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
Express the integrand as a function of <script type="math/tex">r</script> and <script type="math/tex">\theta </script>: <span style="color:#FF0000"><script type="math/tex">e^{-(x^{2}+y^{2})} \rightarrow e^{-r^{2}}</script>.</span>
</p>
</li>
<li id="a0000000439" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
Express the domain of integration (limits) in polar coordinates: the <script type="math/tex">\mathbb R^{2}</script> plane can (with a bit of care) be expressed as <span style="color:#FF0000"><script type="math/tex">0\le r\le + \infty </script>, <script type="math/tex">0\le \theta \le 2\pi </script>.</span>
</p>
</li>
<li id="a0000000440" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
Write the area element <span style="color:#FF0000"><script type="math/tex">dA=rdrd\theta </script>.</span>
</p>
</li>
<li id="a0000000441" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
Evaluate the integral: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I^{2}=\int _{r=0}^{r=+\infty }dr \int _{\theta =0}^{\theta =2\pi } d\theta \,  re^{-r^{2}}.</script></span></span>
</p>
</li>
</ol>
<p>
 Once again the integrals have decoupled: the limits do not depend on each other and the integrand is now just a function or <script type="math/tex">r</script>. We may evaluate the integral as follows: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I^{2}& =& \int _{r=0}^{r=+\infty }dr \int _{\theta =0}^{\theta =2\pi } d\theta \,  re^{-r^{2}}\\ & =& \int _{\theta =0}^{\theta =2\pi } d\theta \int _{r=0}^{r=+\infty }dr \,  re^{-r^{2}}\\ & =& \int _{\theta =0}^{\theta =2\pi } d\theta \int _{r=0}^{r=+\infty }dr \,  \frac{d}{dr}\left(-\frac{e^{-r^{2}}}{2}\right)\\ & =& \int _{\theta =0}^{\theta =2\pi } d\theta \,  \left[\frac{-e^{-r^{2}}}{2}\right]_{r=0}^{r=+\infty }\\ & =& \int _{\theta =0}^{\theta =2\pi } d\theta \,  \left[\frac{1}{2}\right]\\ & =& \frac{1}{2}\int _{\theta =0}^{\theta =2\pi } d\theta \\ & =& \pi . \end{eqnarray*}</script></span></span> Hence, since <span style="color:#FF0000"><script type="math/tex">I^{2}=\pi </script></span>, we have that <span style="color:#FF0000"><script type="math/tex">I=\sqrt{\pi }</script></span>. 
</p>
<p>
Other examples of changes of variables to polar coordinates are in the problem sheets. 
</p>
</section>
</section><section class="subsection">
<h3 id="a0000000442">3.3.7 Changes of Variables in Double Integrals</h3>
<p>
 The transformation of double integrals to polar coordinates is just a special case of a general change of variables formula for double integrals. Often a general change of variables can help to simplify the algebraic representation of a domain of integration, or to deliver a simplification of the integrand. 
</p>
<p>
A transformation of coordinates in a double integral is a set of two functions <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">u=U(x,y), \qquad v=V(x,y),</script></span></span> that give a relationship between the old variables <script type="math/tex">(x,y)</script> and the new variables <script type="math/tex">(u,v)</script>. 
</p>
<p>
We <b class="bf">assume</b> that this transformation is locally invertible, i.e., that there exists a pair of inverse functions <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x=X(u,v), \qquad y=Y(u,v).</script></span></span>
</p>
<p>
These functions map the domain <script type="math/tex">\mathcal D</script> of integration in the <script type="math/tex">(x,y)</script> domain onto a domain <script type="math/tex">\mathcal D'</script> in the <script type="math/tex">(u, v)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0127.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.18</span>
<span class="caption_text">Transformations between domain <script type="math/tex">{\mathcal D}</script> in <script type="math/tex">(x,y)</script> plane and domain <script type="math/tex">{\mathcal D’}</script> in <script type="math/tex">(u,v)</script> plane.</span>
</figcaption> </div>
</figure>
<p>
The integral transforms as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D}f(x,y) dA =\iint _{\mathcal D'}f(X(u,v),Y(u,v)) dA’</script></span></span> The goal here is to find out how the elemental unit of area transforms from <script type="math/tex">dA=dx\, dy</script> to <script type="math/tex">dA'</script> in the <script type="math/tex">(u,v)</script>-plane. 
</p>
<p>
To do this we consider and infinitesimal rectangular patchwork <script type="math/tex">dA=dx\, dy</script> at the point <script type="math/tex">(x,y)</script> somewhere in the domain <script type="math/tex">\mathcal D</script>. We label the four corners of this as <script type="math/tex">A,B, C, D</script> (see diagram). 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0129.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.19</span>
<span class="caption_text">Effect of transformation <script type="math/tex">u=U(x,y)</script>, <script type="math/tex">v=V(x,y)</script> on <script type="math/tex">dA=dx\, dy</script></span>
</figcaption> </div>
</figure>
<p>
Under the transformation <script type="math/tex">u=U(x,y), v=V(x,y)</script>, these corners map respectively to the points <script type="math/tex">A', B', C', D'</script> in the <script type="math/tex">(u,v)</script> plane. 
</p>
<p>
Due to the infinitesimal size, of the original rectangle in the <script type="math/tex">(x,y)</script> plane, the new infinitesimal patchwork <script type="math/tex">dA'</script> will approximately be a parallelogram. The coordinates of its vertices will be 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  A: (x,y) & \rightarrow &  A’: (U(x,y),V(x,y)) \\ B: (x+dx,y) & \rightarrow &  B’: (U(x+dx,y),V(x+dx,y)) \\ C: (x+dx,y+dy) & \rightarrow &  C’: (U(x+dx,y+dy),V(x+dx,y+dy)) \\ D: (x,y+dy) & \rightarrow &  D’: (U(x,y+dy),V(x,y+dy)) \\ \end{eqnarray*}</script></span>
<p>
Suppose we set up unit vectors <script type="math/tex">{\bf i}</script> and <script type="math/tex">{\bf j}</script> parallel to the <script type="math/tex">u</script> and <script type="math/tex">v</script> axes in the <script type="math/tex">(u,v)</script> plane. 
</p>
<p>
Now, from the diagram above, the area of the parallelogram <script type="math/tex">dA'</script> in the <script type="math/tex">(u,v)</script> plane is given by the standard vector product result of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dA’=|{\bf A’B’}\times {\bf A’D’}|,</script></span></span> where from the coordinates above, 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf A’B’}=\left(U(x+dx,y)-U(x,y)\right){\bf i}+\left(V(x+dx,y)-V(x,y)\right){\bf j}</script></span>
<span class="dmath"><script type="math/tex; mode=display">{\bf A’D’}=\left(U(x,y+dy)-U(x,y)\right){\bf i}+\left(V(x,y+dy)-V(x,y)\right){\bf j}</script></span>
<p>
 These can be expanded about <script type="math/tex">(x,y)</script> using Taylor’s theorem (or use the definition of partial derivatives) to yield 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf A’B’}=\left(\frac{\partial U}{\partial x} dx\right){\bf i}+\left(\frac{\partial V}{\partial x} dx\right){\bf j}+{\mathcal O}(dx)^{2},</script></span>
<span class="dmath"><script type="math/tex; mode=display">{\bf A’D’}=\left(\frac{\partial U}{\partial y} dy\right){\bf i}+\left(\frac{\partial V}{\partial y} dy\right){\bf j}+{\mathcal O}(dy)^{2}.</script></span>
<p>
 Hence in the limit as <script type="math/tex">dx</script> and <script type="math/tex">dy \rightarrow 0</script>, we have (using subscripts to denote partial derivatives to save space) 
</p>
<span class="dmath"><script type="math/tex; mode=display">dA’=\left|\left|\begin{array}{ccc}{\bf i} &  {\bf j} &  {\bf k} \\[6pt] U_ xdx &  V_ xdx &  0 \\[6pt] U_ ydy &  V_ ydy &  0\end{array}\right|\right|=\left|\left| \begin{array}{cc}U_ x &  U_ y \\ V_ x &  V_ y\end{array}\right|dx\, dy\,  {\bf k}\right|=\left|\left|\begin{array}{cc}U_ x &  U_ y \\ V_ x &  V_ y\end{array}\right| \right|dx\, dy=\left|\frac{\partial (U,V)}{\partial (x,y)}\right|dA</script></span>
<p>
 Thus the transformed infinitesimal element depends on the modulus of the Jacobian of the transformation functions at that point. Our initial assumption that a local inversion of the functions existed means that the Jacobian is non-vanishing. Hence, using the reciprocity property of Jacobians, we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dx\, dy=\left|\frac{\partial (X,Y)}{\partial (u,v)}\right|du\, dv.</script></span></span> Finally we can then write <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D}f(x,y) \, dx\, dy=\iint _{\mathcal D'}f(X(u,v),Y(u,v))\left|\frac{\partial (X,Y)}{\partial (u,v)}\right|\, du\, dv.</script></span></span>
</p>
<p>
<b class="bf">Example:</b> We can verify that this result is consistent with the geometrical result we obtained for plane polar coordinates: 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=r\cos \theta , \qquad y=r\sin \theta .</script></span>
<p>
 Using the formula above, we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dx\,  dy=\left|\frac{\partial (x,y)}{\partial (r,\theta )}\right| dr \,  d\theta = \left|\left|\begin{array}{cc}x_ r &  x_\theta \\ y_ r &  y_\theta \end{array}\right|\right|dr \,  d\theta =\left|\left|\begin{array}{cc}\cos \theta &  -r\sin \theta \\ \sin \theta &  r\cos \theta \end{array}\right|\right|dr\, d\theta =\left|r(\cos ^{2}\theta +\sin ^{2}\theta )\right|dr\,  d\theta .</script></span></span> Hence, since <script type="math/tex">r>0</script> we have <script type="math/tex">|r|=r</script> and so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad dx\,  dy=rdr\, d\theta .</script></span></span>
</p>
</section><section class="subsection">
<h3 id="a0000000443">3.3.8 Recipe for Change of Variables in Double Integrals</h3>
<p>
 The recipe for changing variables in double integrals is as follows: 
</p>
<ol class="enumerate" id="a0000000444" style="list-style: none">
<li id="a0000000445" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
Identify the transformations between the old variables <script type="math/tex">(x,y)</script> and the new variables <script type="math/tex">(u,v)</script>: <script type="math/tex">x=X(u,v), y=Y(u,v)</script>. 
</p>
</li>
<li id="a0000000446" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
Express the integrand as a function of the new variables <script type="math/tex">(u,v)</script>. 
</p>
</li>
<li id="a0000000447" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
Write the boundaries of the domain of integration in terms of the new variables <script type="math/tex">(u,v)</script>. 
</p>
</li>
<li id="a0000000448" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
Write the area element as <script type="math/tex">dA=|J(u,v)| \, du\, dv</script> where 
</p>
<span class="dmath"><script type="math/tex; mode=display">J(u,v)=\left|\begin{array}{cc}\dfrac {\partial x}{\partial u} &  \dfrac {\partial x}{\partial v} \\[12pt]\dfrac {\partial y}{\partial u} &  \dfrac {\partial y}{\partial v}\end{array}\right|.</script></span>
</li>
<li id="a0000000449" value="5">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		5.
	</span>
<p>
Evaluate the integral! 
</p>
</li>
</ol>
<p>
 The motivation for changing the variable could be to exploit a symmetry to simplify the integrand, or to simplify or decouple the limits, so as to make it easier to perform the integral. 
</p>
<p>
<b class="bf">Example:</b>
</p>
<p>
Use an appropriate change of variables to find the area of an ellipse with shape given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=1,</script></span>
<p>
 where <script type="math/tex">a</script>, <script type="math/tex">b</script> are positive constants. 
</p>
<ol class="enumerate" id="a0000000450" style="list-style: none">
<li id="a0000000451" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
The key thing here is to realise that an ellipse is just a squashed circle. We can convert the ellipse to a circle by using the coordinate transformation <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x=X(u,v)=au, \qquad y=Y(u,v)=bv.</script></span></span> For then we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{x^{2}}{a^{2}}+\frac{y^{2}}{b^{2}}=1 \qquad \Rightarrow \qquad \frac{(au)^{2}}{a^{2}}+\frac{(bv)^{2}}{b^{2}}=1 \qquad \Rightarrow \qquad u^{2}+v^{2}=1.</script></span></span> In other words, in the new <script type="math/tex">(u,v)</script> plane, the ellipse becomes a circle of radius 1. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0131.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.20</span>
<span class="caption_text">Ellipse to circle mapping.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000452" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
The integral we want in the <script type="math/tex">(x,y)</script>-plane is actually <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D}1\,  dxdy,</script></span></span> since <script type="math/tex">f(x,y)=1</script> will give the numerical value of the area of the ellipse. Obviously we then have 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(X(u,v),Y(u,v))=1,</script></span>
<p>
 i.e., the integrand in the case is a constant and so will not change under the transformation. 
</p>
</li>
<li id="a0000000453" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
As we have seen in 1), the domain of integration changes from the ellipse in the <script type="math/tex">(x,y)</script> plane to the circle <script type="math/tex">(u,v)</script>: <script type="math/tex">u^{2}+v^{2}\le 1.</script>
</p>
</li>
<li id="a0000000454" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
The Jacobian transformation is: <script type="math/tex">dA=dxdy=|J(u,v)| \, du\, dv</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">J(u,v)=\left|\begin{array}{cc}\dfrac {\partial x}{\partial u} &  \dfrac {\partial x}{\partial v} \\[12pt]\dfrac {\partial y}{\partial u} &  \dfrac {\partial y}{\partial v}\end{array}\right|=\left|\begin{array}{cc}a &  0 \\[12pt]0&  b\end{array}\right|=ab.</script></span></span> Hence we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dx\, dy=ab\, du\, dv.</script></span></span>
</p>
</li>
<li id="a0000000455" value="5">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		5.
	</span>
<p>
The integral is thus <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D}1\,  dx\,  dy = \iint _{u^{2}+v^{2}\le 1}1\,  ab \,  du\, dv=ab\underbrace{\iint _{u^{2}+v^{2}\le 1} \,  du\, dv}_{\text{Area of a circle of radius 1}}=\pi ab.</script></span></span>
</p>
</li>
</ol>
<p>
This next example shows how sometimes you are given a transformation which is easier to work with backwards. 
</p>
<p>
<b class="bf">Example:</b>
</p>
<p>
Evaluate the integral <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D}\frac{dx\, dy}{xy}</script></span></span> where <script type="math/tex">\mathcal D</script> is the region: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x+y\le 3, \qquad x+y\ge 1, \qquad y\ge x, \qquad y\le 2x</script></span></span> using the transformation <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">u=U(x,y)=x+y, \qquad v=V(x,y)=y/x.</script></span></span>
</p>
<ol class="enumerate" id="a0000000456" style="list-style: none">
<li id="a0000000457" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
Note that we have been given the transformation here (and in terms of <script type="math/tex">u=U(x,y)</script> and <script type="math/tex">v=V(x,y)</script>). (In a difficult exam problem, the exact transformation, or a strong hint would be given to you!) 
</p>
<p>
The purpose of the transformation is to convert a regular, but complicated, domain <script type="math/tex">\mathcal D</script> in the <script type="math/tex">(x,y)</script>-plane into a much simpler, rectangular domain <script type="math/tex">{\mathcal D’}</script> in the <script type="math/tex">(u,v)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0133.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.21</span>
<span class="caption_text">Polygon to rectangle mapping.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000458" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
The integral we want in the <script type="math/tex">(x,y)</script>-plane transforms as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D} \frac{dx\, dy}{xy}=\iint _{\mathcal D'} \frac{du\, dv}{X(u,v)Y(u,v)}|J(u,v)|.</script></span></span> Note that we don’t have explicit forms for <script type="math/tex">X(u,v)</script> and <script type="math/tex">Y(u,v)</script> yet. We could invert the above given transformations <script type="math/tex">u=U(x,y)=x+y, v=V(x,y)=y/x,</script> but this might be messy. Sometimes it pays to wait and see what form the Jacobian <script type="math/tex">J(u,v)</script> takes. 
</p>
</li>
<li id="a0000000459" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
As we have seen in 1), the domain of integration changes from the polygon in the <script type="math/tex">(x,y)</script> plane to a rectangle <script type="math/tex">(u,v)</script>: <script type="math/tex">1\le u\le 3, 1\le v\le 2</script>. 
</p>
</li>
<li id="a0000000460" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
The Jacobian transformation is: <script type="math/tex">dA=dxdy=|J(u,v)| \, du\, dv</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">J(u,v)=\left|\begin{array}{cc}\dfrac {\partial x}{\partial u} &  \dfrac {\partial x}{\partial v} \\[12pt]\dfrac {\partial y}{\partial u} &  \dfrac {\partial y} {\partial v}\end{array}\right|.</script></span></span> However, here, since we have been given the transformation as <script type="math/tex">u=U(x,y)</script>, <script type="math/tex">v=V(x,y)</script>, it’s easier to do partial derivatives of <script type="math/tex">u</script> and <script type="math/tex">v</script> with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script>. Hence we instead carry out the transformation in the backwards direction <a class="footnote" href="#a0000000461">
<sup class="footnotemark">12</sup>
</a> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">du\, dv=\left|\left|\begin{array}{cc}\dfrac {\partial u}{\partial x} &  \dfrac {\partial u}{\partial y} \\[12pt]\dfrac {\partial v}{\partial x} &  \dfrac {\partial v} {\partial y}\end{array}\right|\right|dx\, dy= \left|\left|\begin{array}{cc}1 &  1 \\[12pt]-\dfrac {y}{x^{2}} &  \dfrac {1} {x}\end{array}\right|\right|dx\, dy=\left|\frac{x+y}{x^{2}}\right|dx\, dy=\left(\frac{x+y}{x^{2}}\right)dx\, dy,</script></span></span> since both <script type="math/tex">x>0</script> and <script type="math/tex">y>0</script>. 
</p>
<p>
Solving this for <script type="math/tex">dx\, dy</script> gives <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dx\, dy=\frac{x^{2}}{x+y}du\, dv.</script></span></span> On the face of it this looks stupid as we have mixed up <script type="math/tex">x</script>, <script type="math/tex">y</script> and <script type="math/tex">u</script>, <script type="math/tex">v</script> on the RHS. But look what happens when we substitute in to the original integral: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D} \frac{dx\, dy}{xy}=\iint _{\mathcal D'}\frac{1}{xy}\left(\frac{x^{2}}{x+y}\right)du\, dv=\iint _{\mathcal D'}\frac{x}{y}\left(\frac{1}{x+y}\right)du\, dv=\iint _{\mathcal D'}\frac{1}{v}\left(\frac{1}{u}\right)du\, dv.</script></span></span> The form of the integrand and the Jacobian combine to give something that can be simply expressed in terms of the new variables <script type="math/tex">u,v</script>. 
</p>
</li>
<li id="a0000000462" value="5">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		5.
	</span>
<p>
The integral is thus <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\iint _{\mathcal D} \frac{dx\, dy}{xy}= \int _{u=1}^{u=3}du\int _{v=1}^{v=2}dv\frac{1}{uv}=\int _{1}^{3}\frac{du}{u}\int _{1}^{2}\frac{dv}{v}=\left[\ln u\right]_{1}^{3}\left[\ln v\right]_{1}^{2}=(\ln 3)(\ln 2).</script></span></span>
</p>
</li>
</ol>
<p>
<br/>
</p>
</section>
</section><section class="section">
<h2 id="a0000000463">3.4 Evaluation of Triple Integrals</h2>
<p>
Once it is clear to extend definite integration from one to two-dimensional domains, the extension to three (or more) dimensions is relatively straightforward. 
</p>
<p>
If <script type="math/tex">f(x,y,z)</script> is a function defined on a domain <script type="math/tex">\mathcal D</script> in <script type="math/tex">\mathbb R^{3}</script>, then we denote the integral of <script type="math/tex">f</script> over <script type="math/tex">{\mathcal D}</script> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal D}f(x,y,z)dV,</script></span>
<p>
 where <script type="math/tex">dV</script> denotes a small volume element. In cartesians, we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV=dx\,  dy\,  dz.</script></span></span>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0135.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.22</span>
<span class="caption_text">Volume element <script type="math/tex">dV=dx\; dy\; dz.</script></span>
</figcaption> </div>
</figure>
<p>
The integral can be interpreted as a hyper-volume (the 4-dimensional volume of a function in 3-dimensional space, <i class="it">cf.</i> the double integral case). More intuitively, for example, we could interpret <script type="math/tex">f(x,y,z)</script> as the density of a 3-D object, so that the integral of <script type="math/tex">f</script> over the object’s volume <script type="math/tex">\mathcal D</script> is the mass of the object. <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\rm Mass}=\int _{\mathcal D}f(x,y,z)dV.</script></span></span> The procedure for evaluating the integrals in 3-D is effectively the same as that studied for 2-D; we integrate the three variables in succession. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example 1:</b> Let <script type="math/tex">{\mathcal B}</script> be the rectangular box <script type="math/tex">0\le x\le a, \  0\le y\le b, \  0\le z\le c.</script> Evaluate the integral <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{\mathcal B}(xy^{2}+z^{3}) dV.</script></span></span>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0137.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.23</span>
<span class="caption_text">Slice with <script type="math/tex">z=</script>constant, then <script type="math/tex">y=</script>constant, then integrate with respect to <script type="math/tex">x</script>.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000464">
<li id="a0000000465"> <p>
We slice the box with <b class="bf">planes</b> perpendicular to the <script type="math/tex">z</script>-axis, i.e., a constant <script type="math/tex">z</script>-slice. 
</p>
</li>
<li id="a0000000466"> <p>
The <script type="math/tex">z</script> integral is done last. 
</p>
</li>
<li id="a0000000467"> <p>
The slices are rectangles. 
</p>
</li>
<li id="a0000000468"> <p>
On each constant <script type="math/tex">z</script>-slice, we consider a straight line perpendicular to the to the <script type="math/tex">y</script>-axis and integrate first along <script type="math/tex">x</script> on that <script type="math/tex">y=</script>constant line. 
</p>
</li>
<li id="a0000000469"> <p>
So the order of integration is (chosen) here to be: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x-{\rm first}, \qquad y-{\rm second}, \qquad z-{\rm third}.</script></span></span>
</p>
</li>
<li id="a0000000470"> <p>
Hence we have: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I& =& \int _{z=0}^{z=c}\, dz\int _{y=0}^{y=b}\, dy\int _{x=0}^{x=a}\, dx\left(xy^{2}+z^{3}\right) \\ & =& \int _{0}^{c}\, dz\int _{0}^{b}\, dy\left[\frac{x^{2}y^{2}}{2}+xz^{3}\right]_{x=0}^{x=a}, \\ & =& \int _{0}^{c}\, dz\int _{0}^{b}\, dy\left[\frac{a^{2}y^{2}}{2}+az^{3}\right]_{0}^{a}, \\ & =& \int _{0}^{c}\, dz\left[\frac{a^{2}y^{3}}{2\times 3}+az^{3}y\right]_{y=0}^{y=b}, \\ & =& \int _{0}^{c}\, dz\left[\frac{a^{2}b^{3}}{6}+abz^{3}\right], \\ & =& \left[\frac{a^{2}b^{3}z}{6}+ab\frac{z^{4}}{4}\right] _{z=0}^{z=c},\\ & =& \left[\frac{a^{2}b^{3}c}{6}+ab\frac{c^{4}}{4}\right], \\ & =& \frac{abc}{2}\left[\frac{ab^{2}}{3}+\frac{c^{3}}{2}\right]. \\ \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000471"> <p>
Of course, we could alter the order of integration and we would still obtain the same answer. 
</p>
</li>
</ul>
<p>
<b class="bf">Example 2:</b> If <script type="math/tex">{\mathcal T}</script> is the tetrahedron with vertices <script type="math/tex">(0,0,0)</script>, <script type="math/tex">(1,0,0)</script>, <script type="math/tex">(0,1,0)</script> and <script type="math/tex">(0,0,1)</script>, evaluate <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal T}\, y\,  dV.</script></span></span>
</p>
<ul class="itemize" id="a0000000472">
<li id="a0000000473"> <p>
From the vertices of the tetrahedron, the domain of integration is the volume under <script type="math/tex">z=1-x-y</script>, for <script type="math/tex">x>0</script>, <script type="math/tex">y>0</script>, <script type="math/tex">z>0</script>. 
</p>
</li>
<li id="a0000000474"> <p>
We slice the pyramid with slices perpendicular to the <script type="math/tex">y</script>-axis, i.e., a constant <script type="math/tex">y</script>-slice. 
</p>
</li>
<li id="a0000000475"> <p>
On each constant <script type="math/tex">y</script>-slice, we cut along strips perpendicular to the <script type="math/tex">x</script>-axis, i.e,, integrate first along <script type="math/tex">x</script> on that <script type="math/tex">y=</script>constant line. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0139.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.24</span>
<span class="caption_text">Domain <script type="math/tex">{\mathcal T}</script>. Take triangle slices: <script type="math/tex">y=</script>constant, <script type="math/tex">x=</script>constant: first integrate <script type="math/tex">0\le z\le 1-x-y</script>, then integrate <script type="math/tex">0\le x\le y</script>, then integrate <script type="math/tex">0\le y\le 1</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000476"> <p>
The ranges of integration are, in order of the performing of the integration: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">0\le z\le 1-x-y, \qquad 0\le x\le 1-y, \qquad 0\le y\le 1.</script></span></span>
</p>
</li>
<li id="a0000000477"> <p>
Hence we have: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  J& =& \int _{y=0}^{y=1}\, dy\int _{x=0}^{x=1-y}\, dx\int _{z=0}^{z=1-x-y}\, dz\, y ,\\ & =& \int _{y=0}^{y=1}\, dy\int _{x=0}^{x=1-y}\, dx\left[yz\right]_{z=0}^{z=1-x-y}, \\ & =& \int _{y=0}^{y=1}\, dy\int _{x=0}^{x=1-y}\, dx\left[y(1-x-y)\right], \\ & =& \int _{y=0}^{y=1}\, dy\left[y(x-\frac{x^{2}}{2}-yx)\right]_{x=0}^{x=1-y}, \\ & =& \int _{y=0}^{y=1}\, dy\left[y((1-y)-\frac{(1-y)^{2}}{2}-y(1-y))\right],\\ & =& \int _{y=0}^{y=1}\, dy\left[\frac{y}{2}-y^{2}+\frac{y^{3}}{2}\right],\\ & =& \left[\frac{y^{2}}{4}-\frac{y^{3}}{3}+\frac{y^{4}}{8}\right]_{y=0}^{y=1},\\ & =& \left[\frac{1}{4}-\frac{1}{3}+\frac{1}{8}\right],\\ & =& \frac{1}{24}. \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<section class="subsection">
<h3 id="a0000000478">3.4.1 Change of Variables in Triple Integrals</h3>
<p>
There are several commonly occurring alternative coordinate systems in <script type="math/tex">\mathbb R^{3}</script> which may be used to simplify the evaluation of triple integrals when the domain of integration and/or the integrand possess certain symmetries. 
</p>
<section class="subsubsection">
<h4 id="a0000000479">Cylindrical Polar Coordinates</h4>
<p>
 The cylindrical polar coordinate system is a straightforward extension of the 2-D polar coordinate system to 3-D. It uses the 2-D plane polar coordinate system in planes parallel to th <script type="math/tex">(x,y)</script> plane, while retaining the cartesian <script type="math/tex">z</script>-coordinate for measuring vertical distances, hence the name “cylindrical”. The relationship between cartesian <script type="math/tex">(x,y,z)</script> and cylindrical polar coordinates <script type="math/tex">(r, \theta , z)</script> is given by 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x=r\cos \theta , \qquad y=r\sin \theta , \qquad z=z.</script></span></span>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0141.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.25</span>
<span class="caption_text">The relationship between cartesians and cylindrical polar coordinates.</span>
</figcaption> </div>
</figure>
<p>
As the above diagram might suggest, the cylindrical polar system is very useful for problems that have some radial symmetry about a central axis. 
</p>
<p>
By comparison with plane polar coordinates, when expressed in cylindrical polars the volume element <script type="math/tex">dV</script>, it is not too difficult to see that in the limit as <script type="math/tex">dr, d\theta , dz\rightarrow 0</script> it transforms as: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0143.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.26</span>
<span class="caption_text"><script type="math/tex">dV'=r\; dr\; d\theta \; dz</script> in the limit as <script type="math/tex">dr, d\theta , dz\rightarrow 0</script>.</span>
</figcaption> </div>
</figure>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV=dx\,  dy\,  dz \  {\rm in \  cartesians}, \qquad dV’=dr \times rd\theta \times dz = r\, dr\, d\theta \, dz\  {\rm in \  cylindrical \  polars}.</script></span></span>
</p>
<p>
<b class="bf">Example 1:</b> Evaluate <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{\mathcal D}(x^{2}+y^{2})dV</script></span></span> over the region bounded by the cylinders <script type="math/tex">x^{2}+y^{2}=1</script>, and <script type="math/tex">x^{2}+y^{2}=4</script>, the plane <script type="math/tex">z=0</script>, <script type="math/tex">z=1</script>, <script type="math/tex">x=0</script> and <script type="math/tex">x=y</script>. 
</p>
<ul class="itemize" id="a0000000480">
<li id="a0000000481"> <p>
The form of the integrand <script type="math/tex">x^{2}+y^{2}</script> suggests using cylindrical polar coordinates, since it becomes <script type="math/tex">x^{2}+y^{2}=r^{2}</script>. 
</p>
</li>
<li id="a0000000482"> <p>
We must then check if the domain <script type="math/tex">\mathcal D</script> can be represented nicely in terms of cylindrical polar coordinates. (If not, there is no real point in converting coordinate systems.) 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0145.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.27</span>
<span class="caption_text">Domain of integration <script type="math/tex">\mathcal D</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000483"> <p>
We have the following conversions between the bounding surfaces: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  {\rm Cartesian} \qquad & \Rightarrow &  \qquad {\rm Cylindrical \  Polar} \\ x^{2}+y^{2}=1 \qquad & \Rightarrow &  \qquad r=1 \qquad \qquad (x^2+y^{2}=r^{2}) \\ x^{2}+y^{2}=4 \qquad & \Rightarrow &  \qquad r=2 \qquad \qquad (x^2+y^{2}=r^{2}) \\ z=0 \qquad & \Rightarrow &  \qquad z=0 \qquad \qquad (z=z) \\ z=1 \qquad & \Rightarrow &  \qquad z=1 \qquad \qquad (z=z) \\ x=0 \qquad & \Rightarrow &  \qquad \theta =\pi /2, \qquad (x=r\cos \theta =0) \\ x=y \qquad & \Rightarrow &  \qquad \theta =\pi /4, \qquad (r\cos \theta =r\sin \theta \Rightarrow \tan \theta =\pi /4) \\ \end{eqnarray*}</script></span></span> Note that all the limits will then decouple and so evaluating the integral in cylindricals in this example means just evaluating the triple integral as the product of three one-dimensional integrals. 
</p>
</li>
<li id="a0000000484"> <p>
Hence the domain of integration becomes (see diagram): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1\le r\le 2, \qquad \pi /4\le \theta \le \pi /2, \qquad 0\le z\le 1.</script></span></span>
</p>
</li>
<li id="a0000000485"> <p>
The volume element <script type="math/tex">dV</script> becomes <script type="math/tex">dV=r \, dr \,  d\theta \,  dz</script> in cylindrical polars. 
</p>
</li>
<li id="a0000000486"> <p>
The integral then becomes <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I& =& \int _{\mathcal D}(x^{2}+y^{2})dV= \int _{z=0}^{z=1}\int _{\theta =0}^{\theta =\pi /4}\int _{r=1}^{r=2}r^{2}dV,\\ & =&  \int _{z=0}^{z=1}\int _{\theta =0}^{\theta =\pi /4}\int _{r=1}^{r=2}r^{2}r\, dr\, d\theta \, dz,\\ & =&  \int _{z=0}^{z=1}dz\int _{\theta =0}^{\theta =\pi /4}d\theta \int _{r=1}^{r=2}r^{3}dr, \\ & =&  \left[z\right]_{z=0}^{z=1}\left[\theta \right]_{\theta =0}^{\theta =\pi /4}\left[\frac{r^{4}}{4}\right]_{r=1}^{r=2}, \\ & =&  \left[1-0\right]\left[\frac{\pi }{4}-0\right]\left[\frac{16}{4}-\frac{1}{4}\right], \\ & =&  \frac{15\pi }{16}. \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Example 2:</b> Evaluate the volume of a solid <script type="math/tex">\mathcal D</script> obtained by rotating the parabola <script type="math/tex">x=1-z^{2}</script> around the <script type="math/tex">z</script>-axis. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0147.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.28</span>
<span class="caption_text">Volume of revolution obtain by rotating <script type="math/tex">x=1-z^{2}</script> around the <script type="math/tex">z</script>-axis.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000487">
<li id="a0000000488"> <p>
The volume of <script type="math/tex">{\mathcal D}</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal D}1 dV.</script></span></span> (You can rationalise this as saying that if the volume has unit density, then the mass (= integral over density) of the object is numerically the same as the volume.) 
</p>
</li>
<li id="a0000000489"> <p>
Clearly since the body is an axisymmetric solid of revolution, formed by rotating a curve around the (cylindrical) <script type="math/tex">z</script> axis. Hence it makes sense to evaluate this in terms of cylindrical polars.<a class="footnote" href="#a0000000490">
<sup class="footnotemark">13</sup>
</a>
</p>
</li>
<li id="a0000000491"> <p>
Consider the diagram above, in cylindrical polars, the boundaries of the volume become <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  0\le \theta \le 2\pi & :&  {\rm the \  body \  makes \  a \  full \  rotation \  about \  the} \  z\  {\rm axis.} \\ 0\le r \le 1-z^{2} & :&  {\rm consider \  w.l.o.g. \  the} \  x{\rm -plane, \  the \  distance \  of\  curve} \   r {\rm \  from \  the } \  z{\rm -axis \  is } \  x. \\ -1\le z \le +1 & :&  {\rm consider \  w.l.o.g. \  the} \  x{\rm -plane, \  the \  curve \  intersects \  the} \  z{\rm -axis \  at } \  z=\pm 1. \\ \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000492"> <p>
Hence the volume integral is <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  {\rm Volume}& =&  \int _{z=-1}^{z=+1}\int _{\theta =0}^{\theta =2\pi }\int _{r=0}^{r=1-z^{2}}r\, dr\, d\theta \, dz,\\ & =&  \int _{z=-1}^{z=+1}dz\int _{\theta =0}^{\theta =2\pi }d\theta \left[\frac{r^{2}}{2}\right]_{r=0}^{r=1-z^{2}}, \\ & =&  \int _{z=-1}^{z=+1}dz\left[\theta \right]_{\theta =0}^{\theta =2\pi }\frac{(1-z^{2})^{2}}{2},\\ & =& \pi \int _{z=-1}^{z=+1}dz(1-z^{2})^{2},\\ & =& \pi \int _{z=-1}^{z=+1}dz(1-2z^{2}+z^{4}),\\ & =& \pi \left[z-\frac{2z^{3}}{3}+\frac{z^{5}}{5}\right]_{z=-1}^{z=+1},\\ & =& 2\pi \left[1-\frac{2}{3}+\frac{1}{5}\right],\\ & =& \frac{16\pi }{15}.\\ \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
</section><section class="subsubsection">
<h4 id="a0000000493">Spherical Polar Coordinates</h4>
<p>
 The spherical polar coordinate system is similar to (but not exactly the same as<a class="footnote" href="#a0000000494">
<sup class="footnotemark">14</sup>
</a> the coordinate system that locates places on the surface of the earth, namely latitude and longitude. A point <script type="math/tex">P</script> in <script type="math/tex">\mathbb R^{3}</script> is represented in spherical polar coordinates by <script type="math/tex">(r, \theta , \phi )</script> where 
</p>
<ul class="itemize" id="a0000000495">
<li id="a0000000496"> <p>
<script type="math/tex">r</script> is the distance of <script type="math/tex">P</script> from the origin <script type="math/tex">O</script> of the coordinate system. 
</p>
</li>
<li id="a0000000497"> <p>
<script type="math/tex">\theta </script> is the angle that the radial line <script type="math/tex">OP</script> makes with the positive <script type="math/tex">z</script> axis, i.e., <script type="math/tex">\pi /2-</script>latitude. 
</p>
</li>
<li id="a0000000498"> <p>
<script type="math/tex">\phi </script> is the angle between the plane containing <script type="math/tex">P</script>, the <script type="math/tex">z</script> axis and the <script type="math/tex">(x,z)</script> plane, i.e., longitude. 
</p>
</li>
</ul>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0149.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.29</span>
<span class="caption_text">The relationship between cartesians and spherical polar coordinates.</span>
</figcaption> </div>
</figure>
<p>
It is conventional to consider <script type="math/tex">r\ge 0</script>, <script type="math/tex">0\le \theta \le \pi </script> and <script type="math/tex">0 \le \phi \le 2\pi .</script> The relations between the two coordinate systems are then (see diagram): <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \left.\begin{array}{c}x=r\sin \theta \cos \phi \\ y=r\sin \theta \sin \phi \\ z=r\cos \theta \end{array}\right\}  \Longleftrightarrow \left\{ \begin{array}{c}r=\sqrt{x^2+y^2+z^2} \\ \tan \theta =\sqrt{x^2+y^2}/z \\ \tan \phi =y/x\end{array}\right. \end{eqnarray*}</script></span></span>
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Find the cartesian coordinates of <script type="math/tex">P</script> with spherical coordinates <script type="math/tex">(2, \pi /3, \pi /2)</script>. 
</p>
<ul class="itemize" id="a0000000499">
<li id="a0000000500"> <p>
In spherical polars we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">r=2, \qquad \theta =\pi /3,\qquad \phi =\pi /2.</script></span></span>
</p>
</li>
<li id="a0000000501"> <p>
Hence in cartesians this transforms to: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  x& =& r\sin \theta \cos \phi =2 \sin (\pi /3) \cos (\pi /2) = 2\times (\sqrt{3}/2) \times 0 =0; \\ y& =& r\sin \theta \sin \phi =2 \sin (\pi /3) \sin (\pi /2) = 2\times (\sqrt{3}/2) \times 1 =\sqrt{3}; \\ z& =& r\cos \theta =2 \cos (\pi /3) = 2\times (1/2) =1. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000502"> <p>
Hence the cartesian coordinates are <span style="color:#FF0000"><script type="math/tex">(0, \sqrt{3},1)</script>.</span>
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Find the spherical polar coordinates of <script type="math/tex">Q</script> with cartesian coordinates <script type="math/tex">(1, 1, \sqrt{2})</script>. 
</p>
<ul class="itemize" id="a0000000503">
<li id="a0000000504"> <p>
In cartesian polars we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x=1, \qquad y=1,\qquad z=\sqrt{2}.</script></span></span>
</p>
</li>
<li id="a0000000505"> <p>
Hence in cartesians this transforms to: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  r& =& \sqrt{x^{2}+y^{2}+z^{2}} =\sqrt{1^{2}+1^{2}+(\sqrt{2})^{2}} = \sqrt{4}=2; \\ \tan \theta & =& \sqrt{x^{2}+y^{2}}/{z}=\sqrt{1^{2}+1^{2}}/{\sqrt{2}}=1 \qquad \Rightarrow \qquad \theta =\pi /4;\\ \tan \phi & =& y/x=1/1=1 \qquad \Rightarrow \qquad \phi =\pi /4. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000506"> <p>
Hence the spherical polar coordinates are <span style="color:#FF0000"><script type="math/tex">(2, \pi /4,\pi /4)</script></span>. 
</p>
</li>
</ul>
<p>
Spherical polars are very useful for problems which have a spherical symmetry, for example in the study of the gravitational force of a planet. In spherical polars the volume element <script type="math/tex">dV</script> can be represented by considering the diagram below in the limit as <script type="math/tex">dr, d\theta , d\phi \rightarrow 0</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0151.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.30</span>
<span class="caption_text">Volume element expressed in spherical polars is <script type="math/tex">dV=r^{2}\sin \theta \;  dr\; d\theta \;  d\phi </script>.</span>
</figcaption> </div>
</figure>
<p>
We conclude that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV=r^{2}\sin \theta \;  dr\; d\theta \;  d\phi .</script></span></span>
</p>
<p>
<b class="bf">Example:</b> Evaluate the mass <script type="math/tex">M</script> of a half-ball <script type="math/tex">\mathcal H</script> of radius <script type="math/tex">a</script> and of density 
</p>
<span class="dmath"><script type="math/tex; mode=display">\rho (x,y,z)=x^{2}+y^{2}+z^{2}</script></span>
<p>
. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0153.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.31</span>
<span class="caption_text">Half ball <script type="math/tex">{\mathcal H}</script>: <script type="math/tex">x^{2}+y^{2}+z^{2}\le 1, z\ge 0</script>.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000507">
<li id="a0000000508"> <p>
Clearly the density is spherically symmetric and, in spherical polars is given as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\rho =x^{2}+y^{2}+z^{2}=r^{2}.</script></span></span>
</p>
</li>
<li id="a0000000509"> <p>
The domain of integration, the half-sphere has spherical symmetry: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  {\rm Cartesian} \qquad & \Rightarrow &  \qquad {\rm Spherical \  Polars} \\ 0\le x^{2}+y^{2}+z^{2}\le a^{2} \qquad & \Rightarrow &  \qquad 0\le r\le a \qquad \qquad (x^2+y^{2}+z^{2}=r^{2}); \\ z\ge 0 \qquad & \Rightarrow &  \qquad 0\le \theta \le \pi /2, \qquad {\bf and} \qquad 0\le \phi \le 2\pi . \\ \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000510"> <p>
Hence it makes sense to try spherical polar coordinates. 
</p>
</li>
<li id="a0000000511"> <p>
The volume element is then <span style="color:#FF0000"><script type="math/tex">dV=r^{2}\sin \theta \;  dr\; d\theta \;  d\phi </script>.</span>
</p>
</li>
<li id="a0000000512"> <p>
The required integral is then <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  M& =& \int _{\mathcal H}\rho \,  dV, \\ & =& \int _{\phi =0}^{2\pi }\int _{\theta =0}^{\pi /2}\int _{r=0}^{a} \rho \,  r^{2} \sin \theta \,  dr d\theta d\phi , \\ & =& \int _{\phi =0}^{2\pi }\int _{\theta =0}^{\pi }\int _{r=0}^{a} r^{2} r^{2} \sin \theta \,  dr d\theta d\phi ,\\ & =& \int _{\phi =0}^{2\pi }d\phi \int _{\theta =0}^{\pi /2}\sin \theta d\theta \int _{r=0}^{a} r^{4} dr ,\\ & =& \left[\phi \right]_{0}^{2\pi }\left[-\cos \theta \right]_{\theta =0}^{\pi /2}\left[\frac{r^{5}}{5}\right]_{r=0}^{a},\\ & =& 2\pi \left[-(0)-(-1)\right]\left[\frac{a^{5}}{5}\right],\\ & =& \frac{2\pi a^{5}}{5}. \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
</section><section class="subsubsection">
<h4 id="a0000000513">General Changes of Variables in Triple Integrals</h4>
<p>
 We need to know how to change the elemental volume for arbitrary changes of variables in <script type="math/tex">\mathbb R^{3}</script>. 
</p>
<p>
The formulae we studied in <script type="math/tex">\mathbb R^{2}</script> can be easily extended to <script type="math/tex">\mathbb R^{3}</script>. In this case the cartesian cuboid <script type="math/tex">dx\; dy\; dz</script> maps onto a parallelepided, whose volume is given by a <script type="math/tex">3\times 3</script> determinant. The idea is as follows. 
</p>
<p>
A coordinate transformation is an invertible set of three <script type="math/tex">\mathbb R^{3}\to \mathbb R^{3}</script> functions: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \left.\begin{array}{c}x=X(u,v,w) \\ y=Y(u,v,w)\\ z=Z(u,v,w)\end{array}\right\}  \Longleftrightarrow \left\{ \begin{array}{c}u=U(x,y,z) \\ v=V(x,y,z)\\ w=W(x,y,z)\end{array}\right. \end{eqnarray*}</script></span>
<p>
 The volume element <script type="math/tex">dV</script> transforms as 
</p>
<span class="dmath"><script type="math/tex; mode=display">dV=dx\; dy\; dz.\qquad \Leftrightarrow \qquad dV’=|J(u,v,w)|du\; dv\; dw,</script></span>
<p>
 where 
</p>
<span class="dmath"><script type="math/tex; mode=display">J(u,v,w)=\frac{\partial (x,y,z)}{\partial (u,v,w)}=\left|\begin{array}{ccc}\dfrac {\partial x}{\partial u} &  \dfrac {\partial x}{\partial v} &  \dfrac {\partial x} {\partial w} \\[12pt]\dfrac {\partial y}{\partial u} &  \dfrac {\partial y}{\partial v} &  \dfrac {\partial y}{\partial w} \\[12pt]\dfrac {\partial z} {\partial u} &  \dfrac {\partial z}{\partial v} &  \dfrac {\partial z}{\partial w}\end{array}\right|</script></span>
<p>
<b class="bf">Example:</b> Verify the Jacobian transformation for spherical polar coordinates: 
</p>
<ul class="itemize" id="a0000000514">
<li id="a0000000515"> <p>
We have 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=r\sin \theta \cos \phi , \qquad y=r\sin \theta \sin \phi , \qquad z=r\cos \theta .</script></span>
</li>
<li id="a0000000516"> <p>
Hence the Jacobian <script type="math/tex">J(r, \theta , \phi )</script> becomes: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*} J(r, \theta , \phi )& =& \frac{\partial (x,y,z)}{\partial (r,\theta ,\phi )}=\left|\begin{array}{ccc}\dfrac {\partial x}{\partial r} &  \dfrac {\partial x}{\partial \theta } &  \dfrac {\partial x} {\partial \phi } \\[12pt]\dfrac {\partial y}{\partial r} &  \dfrac {\partial y}{\partial \theta } &  \dfrac {\partial y}{\partial \phi } \\[12pt]\dfrac {\partial z} {\partial r} &  \dfrac {\partial z}{\partial \theta } &  \dfrac {\partial z}{\partial \phi }\end{array}\right|, \\ & =& \left|\begin{array}{ccc}\  \sin \theta \; \cos \phi &  r\cos \theta \; \cos \phi &  -r\sin \theta \; \sin \phi \\[12pt]\sin \theta \; \sin \phi &  r\cos \theta \; \sin \phi &  r\sin \theta \; \cos \phi \\[12pt]\cos \phi &  -r\sin \theta &  0\end{array}\right|, \\ & =& \dots , \\ & =& r^{2}\sin \theta . \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
</section>
</section>
</section><!-- Latex Chapter/Part -->
<h1 id="a0000000517">Line Integrals and Green’s Theorem</h1>
<section class="section">
<h2 id="a0000000518">4.1 Line Integrals</h2>
<p>
At A-level and in MATH1059 you learned how to integrate a function <script type="math/tex">y(x)</script> along the <script type="math/tex">x</script>-axis. In the previous chapter of this module, you learned how to integrate a function <script type="math/tex">f(x,y)</script> over a 2-d domain <script type="math/tex">{\mathcal D}</script> in the <script type="math/tex">(x,y)</script> plane. 
</p>
<p>
In this chapter we will learn how to integrate real valued <script type="math/tex">\mathbb R^{2}\to \mathbb R</script> functions <script type="math/tex">P(x,y)</script> or <script type="math/tex">Q(x,y)</script> over a curve <script type="math/tex">\mathcal C</script> given by a portion of the curve <script type="math/tex">y=f(x)</script> in the <script type="math/tex">(x,y)</script> plane. These types of integral are called “line integrals” and can be written as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} P(x,y) \,  dx \qquad {\rm and} \qquad \int _{\mathcal C} Q(x,y) \,  dy,</script></span>
<p>
 or more generally as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} \left\{ P(x,y) \,  dx+Q(x,y) \,  dy\right\} .</script></span>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0155.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.1</span>
<span class="caption_text">The curve <script type="math/tex">{\mathcal C}</script> over which the line integral is taken is the portion of the curve <script type="math/tex">y=f(x)</script> between endpoints <script type="math/tex">A</script> and <script type="math/tex">B</script>.</span>
</figcaption> </div>
</figure>
<p>
There is a simple analogy to help to explain what a line integral is: 
</p>
<ul class="itemize" id="a0000000519">
<li id="a0000000520"> <p>
The integral <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{x=a}^{x=b} y(x) dx</script></span></span> corresponds to the area of paint you need to paint one side of a straight fence of height <script type="math/tex">y(x)</script> between <script type="math/tex">x=a</script> and <script type="math/tex">x=b</script>. 
</p>
</li>
<li id="a0000000521"> <p>
Let <script type="math/tex">\mathcal C</script> denote the curve along the base of a fence in the <script type="math/tex">(x,y)</script> plane given by the equation <script type="math/tex">y=f(x)</script>. Let <script type="math/tex">ds</script> be the elemental arc length distance along the tangential direction of a curve <script type="math/tex">{\mathcal C}</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0157.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.2</span>
<span class="caption_text">Pythagoras and arc length.</span>
</figcaption> </div>
</figure>
<p>
Pythagoras shows that <script type="math/tex">ds</script> and elemental steps along the curve in the <script type="math/tex">x</script> and <script type="math/tex">y</script> directions, <script type="math/tex">dx</script> and <script type="math/tex">dy</script>, respectively, are related by: 
</p>
<span class="dmath"><script type="math/tex; mode=display">ds=\sqrt{(dx)^{2}+(dy)^{2}} \qquad \Rightarrow \qquad ds=\sqrt{1+\left(\frac{dy}{dx}\right)^{2}}dx.</script></span>
<p>
 The integral <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} R(x,y) ds=\int _{\mathcal C} R(x,y) \sqrt{1+\left(\frac{dy}{dx}\right)^{2}}dx=\int _{\mathcal C} P(x,y) dx,</script></span></span> say, corresponds to the area of paint you need to paint one side of a fence of height <script type="math/tex">R(x,y)</script>
</p>
</li>
</ul>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0159.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.3</span>
<span class="caption_text">Vertical fences that need painting: one with a straight line for a base (left) and one with a curved base (right).</span>
</figcaption> </div>
</figure>
<p>
Note that if you set <script type="math/tex">R(x,y)=1</script> you end up with an expression for working out the length of the curve <script type="math/tex">{\mathcal C}</script> between <script type="math/tex">A</script> and <script type="math/tex">B</script>: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} 1 ds=\int _{\mathcal C} ds=[{\rm Length \  of \  curve}]_{A}^{B}={\rm Length \  of} \  {\mathcal C} \  {\rm between} \  A \  {\rm and} \  B.</script></span></span>
</p>
<p>
Hence if we define <script type="math/tex">{\mathcal L}</script> to be the length of the curve between <script type="math/tex">A</script> and <script type="math/tex">B</script> we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\mathcal L= \int _{\mathcal C} \sqrt{1+\left(\frac{dy}{dx}\right)^{2}}dx.</script></span>
</section><section class="section">
<h2 id="a0000000522">4.2 Evaluation of Line Integrals in a Plane</h2>
<p>
 Consider the combined line integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} \left\{ P(x,y) \,  dx+Q(x,y) \,  dy\right\} ,</script></span>
<p>
 over the portion of the differentiable curve <script type="math/tex">y=f(x)</script> in the <script type="math/tex">(x,y)</script> plane between <script type="math/tex">x=a</script> and <script type="math/tex">x=b</script>. 
</p>
<p>
The integral may be broken down and evaluated as: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} P(x,y) \,  dx=\int _{x=a}^{x=b}P(x,f(x))dx,</script></span></span> and, since “<script type="math/tex">dy=f'(x)dx</script>”, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} Q(x,y) \,  dy=\int _{x=a}^{x=b}Q(x,f(x))f’(x)dx.</script></span></span>
</p>
<p>
Alternatively if <script type="math/tex">{\mathcal C}</script> was given as a differentiable function <script type="math/tex">x=g(y)</script> between <script type="math/tex">y=c</script> and <script type="math/tex">y=d</script>, we could evaluate the two parts of the integral as (using “<script type="math/tex">dx=g'(y)dy</script>”) <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} P(x,y) \,  dx=\int _{y=c}^{y=d}P(g(y),y)g’(y)dy,</script></span></span> and <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} Q(x,y) \,  dy=\int _{y=c}^{y=d}Q(g(y),y)dy.</script></span></span>
</p>
<p>
<b class="bf">Example:</b> Let <script type="math/tex">P(x,y)=x+y</script>. Evaluate the line integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C_{1}} P(x,y) \,  dx</script></span>
<p>
 where <script type="math/tex">{\mathcal C_{1}}</script> is the curve <script type="math/tex">y=1-x</script> from <script type="math/tex">x=0</script> to <script type="math/tex">x=1</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0161.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.4</span>
<span class="caption_text">The curves <script type="math/tex">{\mathcal C_{1}}</script> and <script type="math/tex">{\mathcal C_{2}}</script> in the examples.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000523">
<li id="a0000000524"> <p>
The integrand on the curve <script type="math/tex">{\mathcal C_{1}}</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x+y =x+1-x =1.</script></span></span>
</p>
</li>
<li id="a0000000525"> <p>
The line integral then becomes <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C_{1}} P(x,y) \,  dx=\int _{x=0}^{x=1} (x+1-x) \,  dx=\int _{x=0}^{x=1} 1 \,  dx =\left[x\right]_{x=0}^{x=1}=1</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Let <script type="math/tex">P(x,y)=x+y</script>. Evaluate the line integral <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C_{2}} P(x,y) \,  dx</script></span></span> where <script type="math/tex">{\mathcal C_{2}}</script> is the curve <script type="math/tex">y=x^{2}</script> from <script type="math/tex">x=0</script> to <script type="math/tex">x=1</script>. 
</p>
<ul class="itemize" id="a0000000526">
<li id="a0000000527"> <p>
The integrand on the curve <script type="math/tex">C_{2}</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x+y =x+x^{2}.</script></span></span>
</p>
</li>
<li id="a0000000528"> <p>
The line integral then becomes <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C_{2}} P(x,y) \,  dx=\int _{\mathcal C_{2}} P(x,x^{2}) \,  dx=\int _{x=0}^{x=1} (x+x^{2}) \,  dx =\left[\frac{x^{2}}{2}+\frac{x^{3}}{3}\right]_{x=0}^{x=1}=\frac{5}{6}.</script></span></span>
</p>
</li>
</ul>
<p>
For these examples, we can equally evaluate these integrals by representing the curve of integration <script type="math/tex">{\mathcal C}</script> in terms of equivalent functional representations <script type="math/tex">x=g(y)</script>. 
</p>
<p>
<b class="bf">Example:</b> Integrating <script type="math/tex">P(x,y)=x+y</script> when <script type="math/tex">{\mathcal C_{1}}</script> given by <script type="math/tex">y=1-x</script> is expressed as <script type="math/tex">x=g(y)</script>. 
</p>
<ul class="itemize" id="a0000000529">
<li id="a0000000530"> <p>
The curve <script type="math/tex">y=1-x</script> may be rearranged as <span style="color:#FF0000"><script type="math/tex">x=1-y</script></span>. 
</p>
</li>
<li id="a0000000531"> <p>
The limit of integration <script type="math/tex">x=0</script> becomes <span style="color:#FF0000"><script type="math/tex">y=1-0=1</script></span>. 
</p>
</li>
<li id="a0000000532"> <p>
The limit of integration <script type="math/tex">x=1</script> becomes <span style="color:#FF0000"><script type="math/tex">y=1-1=0</script></span>. 
</p>
</li>
<li id="a0000000533"> <p>
The integrand on the curve <script type="math/tex">{\mathcal C_{1}}</script> when written as <script type="math/tex">x=g(y)=1-y</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x+y =1-y+y=1</script></span>.</span>
</p>
</li>
<li id="a0000000534"> <p>
If <script type="math/tex">x=1-y</script>, then <span style="color:#FF0000"><script type="math/tex">dx=-dy</script></span>. 
</p>
</li>
<li id="a0000000535"> <p>
We thus have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C_{1}} P(x,y) \,  dx=\int _{y=1}^{y=0} (1-y+y) \,  (-1)dy=-\int _{y=1}^{y=0} 1 \,  dy =-\left[y\right]_{y=1}^{x=0}=1.</script></span></span> Which is the same value as the corresponding line integral above. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Integrating <script type="math/tex">P(x,y)=x+y</script> when <script type="math/tex">{\mathcal C_{2}}</script> given by <script type="math/tex">y=x^{2}</script> is expressed as <script type="math/tex">x=g(y)</script>. 
</p>
<ul class="itemize" id="a0000000536">
<li id="a0000000537"> <p>
The curve <script type="math/tex">y=x^{2}</script> may be rearranged as <script type="math/tex">x=+\sqrt{y}</script>, since we are in the positive quadrant. 
</p>
</li>
<li id="a0000000538"> <p>
The limit of integration <script type="math/tex">x=0</script> becomes <span style="color:#FF0000"><script type="math/tex">y=0^{2}=0</script></span>. 
</p>
</li>
<li id="a0000000539"> <p>
The limit of integration <script type="math/tex">x=1</script> becomes <span style="color:#FF0000"><script type="math/tex">y=1^{2}=1</script></span>. 
</p>
</li>
<li id="a0000000540"> <p>
The integrand on the curve <script type="math/tex">{\mathcal C_{2}}</script> when written as <script type="math/tex">x=g(y)=+\sqrt{y}</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x+y =+\sqrt{y}-y</script></span>.</span>
</p>
</li>
<li id="a0000000541"> <p>
If <script type="math/tex">x=+\sqrt{y}</script>, then <span style="color:#FF0000"><script type="math/tex">dx=\frac{1}{2}y^{-1/2}dy</script>.</span>
</p>
</li>
<li id="a0000000542"> <p>
We thus have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C_{2}} P(x,y) \,  dx=\int _{y=0}^{y=1} (+\sqrt{y}+y) \,  \frac{1}{2}y^{-1/2}dy=\frac{1}{2}\int _{y=0}^{y=1} (1+\sqrt{y}) \,  dy =\frac{1}{2}\left[y+\frac{2}{3}y^{3/2}\right]_{y=0}^{y=1}=\frac{5}{6}.</script></span></span> Which is the same value as the corresponding line integral above. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Evaluate the line integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{\mathcal C}(x^{2}+2y)\, dx+(x+y^{2})\,  dy</script></span>
<p>
 between the points <script type="math/tex">(0,1)</script> and <script type="math/tex">(2,3)</script> along the curve <script type="math/tex">{\mathcal C}</script> given by <script type="math/tex">y=x+1</script>. 
</p>
<ul class="itemize" id="a0000000543">
<li id="a0000000544"> <p>
First, we choose to evaluate the integral by expressing it entirely in terms of <script type="math/tex">x</script>. 
</p>
</li>
<li id="a0000000545"> <p>
If <script type="math/tex">y=x+1</script> then in the second part of the integral, <span style="color:#FF0000"><script type="math/tex">dy=dx</script>.</span>
</p>
</li>
<li id="a0000000546"> <p>
Hence we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I& =& \int _{x=0}^{x=2}(x^{2}+2(x+1))\, dx+(x+(x+1)^{2})\,  dx, \\ & =& \int _{x=0}^{x=2}(x^{2}+2x+2)\, dx+(x+x^{2}+2x+1)\,  dx, \\ & =& \int _{x=0}^{x=2}(2x^{2}+5x+3)\, dx, \\ & =& \left[\frac{2}{3}x^{3}+\frac{5}{2}x^{2}+3x\right]_{x=0}^{x=2}\, dx, \\ & =&  \frac{64}{3}. \end{eqnarray*}</script></span></span> Equally we can evaluate this integral by representing <script type="math/tex">{\mathcal C}</script> in terms of a function <script type="math/tex">x=g(y)</script> in the second part of the integral 
</p>
</li>
<li id="a0000000547"> <p>
If <script type="math/tex">y=x+1</script> then we can rearrange this to give <script type="math/tex">x=y-1</script>, hence <script type="math/tex">\Rightarrow dx=dy</script>. 
</p>
</li>
<li id="a0000000548"> <p>
From the question statement, we see the limit <script type="math/tex">x=0</script> corresponds to <script type="math/tex">y=1</script> and the limit <script type="math/tex">x=1</script> corresponds to <script type="math/tex">y=3</script>. 
</p>
</li>
<li id="a0000000549"> <p>
Thus we can evaluate the integral as follows: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I& =& \int _{\mathcal C}(x^{2}+2y)\, dx+(x+y^{2})\,  dy, \\ & =& \int _{y=1}^{y=3}((y-1)^{2}+2y)\, dy+\int _{y=1}^{y=3}((y-1)+y^{2})\,  dy, \\ & =& \int _{y=1}^{y=3}(y^{2}-2y+1+2y)\, dy+\int _{y=1}^{y=3}(y^{2}+y-1)\,  dy, \\ & =& \int _{y=1}^{y=3}(2y^{2}+y)\, dy, \\ & =& \left[\frac{2}{3}y^{3}+y\right]_{y=1}^{y=3}\, dx, \\ & =& \left[\frac{54}{3}+\frac{9}{2}\right]-\left[\frac{2}{3}+\frac{1}{2}\right],\\ & =&  \frac{64}{3}. \end{eqnarray*}</script></span></span> Which is the same answer as we obtained before. 
</p>
</li>
</ul>
</section><section class="section">
<h2 id="a0000000550">4.3 Properties of Line Integrals</h2>
<p>
 The following properties of line integrals hold 
</p>
<ol class="enumerate" id="a0000000551" style="list-style: none">
<li id="a0000000552" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
<b class="bf">Reversal of Direction of Integration</b> <br/>Line integrals may be evaluated in either direction along a curve <script type="math/tex">{\mathcal C}</script> given by <script type="math/tex">y=f(x)</script>. Suppose the two endpoints of the curve of integration are <script type="math/tex">A</script> and <script type="math/tex">B</script> with corresponding <script type="math/tex">x</script> coordinates <script type="math/tex">x=a</script> and <script type="math/tex">x=b</script> respectively. We then have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{A}^{B}P(x,y) dx = \int _{x=a}^{x=b}P(x,f(x))dx = -\int _{x=b}^{x=a}P(x,f(x))dx =-\int _{B}^{A}P(x,y) dx.</script></span></span> Hence the sign of the line integral changes if the direction of traversal of <script type="math/tex">{\mathcal C}</script> is reversed. 
</p>
</li>
<li id="a0000000553" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
<b class="bf">Integrals Parallel to the Axes</b> <br/>If the path of integration is such that <script type="math/tex">{\mathcal C}</script> is a line parallel to the <script type="math/tex">y</script>-axis, say <script type="math/tex">x=a</script>, where <script type="math/tex">a</script> is a constant, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C}P(x,y) dx =0.</script></span></span> This follows since on <script type="math/tex">{\mathcal C}</script> we have <script type="math/tex">x=a</script> so “<script type="math/tex">dx=0.</script>” 
</p>
<p>
Similarly, if the path of integration is such that <script type="math/tex">{\mathcal C}</script> is a line parallel to the <script type="math/tex">x</script>-axis, say <script type="math/tex">y=c</script>, where <script type="math/tex">c</script> is a constant, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C}Q(x,y) dy =0.</script></span></span> This follows since on <script type="math/tex">{\mathcal C}</script> we have <script type="math/tex">y=c</script> so “<script type="math/tex">dy=0.</script>” 
</p>
</li>
<li id="a0000000554" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
<b class="bf">Addition of Paths</b>
</p>
<p>
Suppose the curve of integration <script type="math/tex">{\mathcal C}</script> is given by <script type="math/tex">y=f(x)</script> possessing end points with <script type="math/tex">x</script>-coordinates <script type="math/tex">a</script> and <script type="math/tex">b</script>, but is divided into two parts with a common point <script type="math/tex">(x_{c},y_{c})</script>. Then we have <span style="color:#FF0000"> <span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C}P(x,y) \,  dx = \int _{x=a}^{x=b}P(x,f(x)) \,  dx = \int _{x=a}^{x=x_{c}}P(x,f(x)) \, dx+ \int _{x=x_{c}}^{x=b}P(x,f(x)) \, dx.</script></span></span>
</p>
<p>
Similar results apply to 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C}Q(x,y) \,  dy</script></span>
<p>
 and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} \left\{ P(x,y) \,  dx+Q(x,y) \,  dy\right\} .</script></span>
<p>
 These results may also be extend to cases where there are more than two divisions of the the curve of integration. 
</p>
</li>
<li id="a0000000555" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
<b class="bf">Multivalued Curves</b> <br/>If <script type="math/tex">{\mathcal C}</script> is represented by the curve <script type="math/tex">y=f(x)</script> but for some value(s) of <script type="math/tex">x</script> more than one value of <script type="math/tex">y</script> is obtained (see figure), then the line integral must be decomposed into a sum over portions of the curve <script type="math/tex">{\mathcal C}</script> where <script type="math/tex">y</script> is single-valued. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0163.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.5</span>
<span class="caption_text">The curves <script type="math/tex">{\mathcal C}</script> is multivalued for <script type="math/tex">x_ b\le x\le x_{c}</script> (where the curve, as traversed from <script type="math/tex">A</script> to <script type="math/tex">B</script> is first vertical). It must be split up into two single-valued portions, the lower curve given by <script type="math/tex">y=f_{1}(x)</script>, the upper curve given by <script type="math/tex">y=f_{2}(x)</script>.</span>
</figcaption> </div>
</figure>
<p>
For example, in the above figure, we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C}P(x,y) \,  dx = \int _{x=a}^{x=x_{c}}P(x,f_{1}(x)) \,  dx+\int _{x=x_{c}}^{x=b}P(x,f_{2}(x)) \,  dx.</script></span></span>
</p>
<p>
Similar results apply to 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C}Q(x,y) \,  dy</script></span>
<p>
 for multivalued <script type="math/tex">x=g(y)</script> and the combination 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} \left\{ P(x,y) \,  dx+Q(x,y) \,  dy\right\} .</script></span>
</li>
</ol>
<p>
<b class="bf">Example: Multivalued Curve</b>
</p>
<p>
Evaluate the integral <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{\mathcal C}(x+y) dx</script></span></span> from <script type="math/tex">(x,y)=(0,1)</script> to <script type="math/tex">(x,y)=(0,-1)</script> where <script type="math/tex">C</script> is the semicircle <script type="math/tex">y=\sqrt{1-x^{2}}</script>
</p>
<figure id="mvc">
<div class="centered"> <img src="../../notes/course_notes/images/img-0165.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.6</span>
<span class="caption_text">Contours <script type="math/tex">{\mathcal C_{1}}</script> and <script type="math/tex">{\mathcal C_{2}}</script> in the multivalued curve example.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000556">
<li id="a0000000557"> <p>
The issue, from point 4 above, is that the equation of the path of integration <script type="math/tex">{\mathcal C}</script> is not single-valued. For every value of <script type="math/tex">x</script> on the path, there are two corresponding values of <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000558"> <p>
We split the path into two: 
</p>
<ul class="itemize" id="a0000000559">
<li id="a0000000560"> <p>
<span style="color:#FF0000"><script type="math/tex">{\mathcal C_{1}}</script>: <script type="math/tex">y=+\sqrt{1-x^{2}}</script> between <script type="math/tex">(x,y)=(0,1)</script> and <script type="math/tex">(x,y)=(1,0)</script>.</span>
</p>
</li>
<li id="a0000000561"> <p>
<span style="color:#FF0000"><script type="math/tex">{\mathcal C_{2}}</script>: <script type="math/tex">y=-\sqrt{1-x^{2}}</script> between <script type="math/tex">(x,y)=(1,0)</script> and <script type="math/tex">(x,y)=(0,-1)</script>.</span>
</p>
</li>
</ul>
</li>
<li id="a0000000562"> <p>
Hence the integral becomes <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I& =& \int _{\mathcal C}(x+y) dx=\int _{\mathcal C_{1}}(x+y) dx+\int _{\mathcal C_{2}}(x+y) dx, \\ & =& \int _{x=0}^{x=1}(x+\sqrt{1-x^{2}}) dx+\int _{x=1}^{x=0}(x-\sqrt{1-x^{2}}) dx, \\ & =& \int _{x=0}^{x=1}(x+\sqrt{1-x^{2}}) dx-\int _{x=0}^{x=1}(x-\sqrt{1-x^{2}}) dx, \\ & =& 2\int _{x=0}^{x=1}\sqrt{1-x^{2}} dx \\ & =& 2\times \frac{1}{2}\left[x\sqrt{1-x^{2}}+\arcsin x\right]_{x=0}^{x=1}, \\ & =& \frac{\pi }{2}. \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
A natural question arises: if the endpoints of the line integral are the same, is the value of the line integral the same regardless of which path is taken between the endpoints? In general the answer is “no”, as the following example illustrates. 
</p>
<p>
<b class="bf">Example: Value of line integral along different paths</b>
</p>
<p>
Evaluate the line integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C} \left\{  (x+y)\,  dx+xy \,  dy\right\} ,</script></span>
<p>
 along the following curves: 
</p>
<ol class="enumerate" id="a0000000563" style="list-style: none">
<li id="a0000000564" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
From <script type="math/tex">(0,0)</script> to <script type="math/tex">(1,1)</script> along the curve <script type="math/tex">\mathcal C_{1}</script> given by <script type="math/tex">y=x</script>. 
</p>
</li>
<li id="a0000000565" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
From <script type="math/tex">(0,0)</script> to <script type="math/tex">(1,0)</script> along the curve <script type="math/tex">\mathcal C_{2}</script> given by <script type="math/tex">y=0</script>, then from <script type="math/tex">(1,0)</script> to <script type="math/tex">(1,1)</script> along the curve <script type="math/tex">\mathcal C_{3}</script> given by <script type="math/tex">x=1</script>. 
</p>
</li>
</ol>
<p>
Both these integrations have the same integrands and endpoints. They just differ by the curves over which the integrals are performed. 
</p>
<figure id="mv1">
<div class="centered"> <img src="../../notes/course_notes/images/img-0167.png" style="width:162.6075pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.7</span>
<span class="caption_text">Different paths between the endpoints <script type="math/tex">A</script> and <script type="math/tex">B</script>, either the direct path <script type="math/tex">{\mathcal C_{1}}</script> or the joined path via the intermediate point <script type="math/tex">(1,0)</script>, <script type="math/tex">{\mathcal C_{2}}\cup {\mathcal C_{3}}</script>.</span>
</figcaption> </div>
</figure>
<p>
We evaluate these integrals in turn as follows: 
</p>
<ol class="enumerate" id="a0000000566" style="list-style: none">
<li id="a0000000567" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
From <script type="math/tex">(0,0)</script> to <script type="math/tex">(1,1)</script> along <script type="math/tex">y=x</script>. 
</p>
<ul class="itemize" id="a0000000568">
<li id="a0000000569"> <p>
Without loss of generality, we write both integrals in terms of <script type="math/tex">x</script>. 
</p>
</li>
<li id="a0000000570"> <p>
If <script type="math/tex">y=x</script> we have <script type="math/tex">dy=dx</script> in the second integral. 
</p>
</li>
<li id="a0000000571"> <p>
Hence the integral becomes: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I_{\mathcal C_{1}}& =& \int _{\mathcal C_{1}} (x+y)\,  dx+xy \,  dy, \\ & =& \int _{x=0}^{x=1} (x+x)\,  dx+\int _{x=0}^{x=1}x\times x \,  dx, \\ & =& \int _{x=0}^{x=1} 2x\,  dx+\int _{x=0}^{x=1}x^{2} \,  dx, \\ & =& \left[x^{2}\right]_{0}^{1}+\left[\frac{x^{3}}{3}\right]_{0}^{1}, \\ & =& 1+\frac{1}{3}, \\ & =& \frac{4}{3}. \\ \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
</li>
<li id="a0000000572" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
From <script type="math/tex">(0,0)</script> to <script type="math/tex">(1,0)</script> along the curve <script type="math/tex">{\mathcal C_{2}}</script>, <script type="math/tex">y=0</script>, then from <script type="math/tex">(1,0)</script> to <script type="math/tex">(1,1)</script> along the curve <script type="math/tex">{\mathcal C_{3}}</script>, <script type="math/tex">x=1</script>. 
</p>
<ul class="itemize" id="a0000000573">
<li id="a0000000574"> <p>
On the first leg <script type="math/tex">{\mathcal C_{2}}</script> along <script type="math/tex">y=0</script> we have <script type="math/tex">dy=0</script>. Hence we have: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I_{\mathcal C_{2}}& =& \int _{\mathcal C_{2}} (x+y)\,  dx+xy \,  dy, \\ & =& \int _{x=0}^{x=1} (x+0)\,  dx +0 \\ & =& \left[\frac{1}{2}x^{2}\right]_{0}^{1},\\ & =& \frac{1}{2}. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000575"> <p>
On the second leg <script type="math/tex">{\mathcal C_{3}}</script> along <script type="math/tex">x=1</script> we have <script type="math/tex">dx=0</script>. Hence we have: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I_{\mathcal C_{3}}& =& \int _{\mathcal C_{3}} (x+y)\,  dx+xy \,  dy, \\ & =& \int _{y=0}^{y=1} 0+1\times y \,  dy, \\ & =& \left[\frac{1}{2}y^{2}\right]_{0}^{1},\\ & =& \frac{1}{2}. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000576"> <p>
Hence the total line integral along <script type="math/tex">{\mathcal C}_{2} \cup {\mathcal C}_{3}</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I_{{\mathcal C_{2}}\cup {\mathcal C_{3}}}=I_{\mathcal C_{2}}+I_{\mathcal C_{3}}=\frac{1}{2}+\frac{1}{2}=1.</script></span></span>
</p>
</li>
</ul>
</li>
</ol>
<p>
 Hence we see that, even though the limits of the integrals are the same, the values of the integrals across the different paths differ and <script type="math/tex">I_{\mathcal C_{1}}\ne I_{{\mathcal C_{2}}\cup {\mathcal C_{3}}}.</script>
</p>
<p>
For arbitrary general integrands <script type="math/tex">P(x,y)</script> and <script type="math/tex">Q(x,y)</script> the integrals between the same endpoints will depend on the paths taken. Later we will examine the conditions on <script type="math/tex">P(x,y)</script> and <script type="math/tex">Q(x,y)</script> under which integrals are independent of the particular path taken between the same endpoints. 
</p>
</section><section class="section">
<h2 id="a0000000577">4.4 Line Integrals Around Closed Curves</h2>
<p>
We now consider the line integral around a closed, non-intersecting, curve, which starts and finishes at the same point. 
</p>
<p>
We need to specify the direction in which we traverse the closed curve. The convention adopted is that a counterclockwise traversal is said to be in the positive direction, a clockwise traversal is said to be in the negative direction. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0169.png" style="width:325.215pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.8</span>
<span class="caption_text">Left: counterclockwise, positive traversal of <script type="math/tex">{\mathcal C}</script>. Right: clockwise, negative traversal of <script type="math/tex">{\mathcal C}</script>.</span>
</figcaption> </div>
</figure>
<p>
When integrals are evaluated counterclockwise (respectively clockwise) around a closed curve <script type="math/tex">{\mathcal C}</script> we denote this by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\oint _{\mathcal C}, \qquad {\rm or \  respectively} \qquad \oint _{\mathcal C}.</script></span>
<p>
Note that you might tempted to think that since the endpoints are the same, the value of line intgrals over closed paths is always zero. They can be zero, but as the following examples suggest, they are not always so. 
</p>
<p>
To evaluate such integrals over closed paths, we need to break the integration contour <script type="math/tex">{\mathcal C}</script> into component parts that each have a single-valued representation. 
</p>
<p>
For example for the left hand (convex) curve in the diagram below, we can break the <script type="math/tex">{\mathcal C}</script> up into <script type="math/tex">{\mathcal C_{1}}</script> denoted by <script type="math/tex">y=f_{1}(x)</script> and <script type="math/tex">{\mathcal C_{2}}</script> denoted by <script type="math/tex">y=f_{2}(x)</script>, with endpoints <script type="math/tex">A</script> and <script type="math/tex">B</script> (where the curve is vertical). 
</p>
<p>
For the right hand (non-convex) curve in the diagram below, we can break the <script type="math/tex">{\mathcal C}</script> up into four parts <script type="math/tex">{\mathcal C_{i}}, i=1,2,3,4</script> each separately denoted by <script type="math/tex">y=f_{i}(x), i=1,2,3,4</script>, along the portions <script type="math/tex">AB</script>, <script type="math/tex">BC</script>, <script type="math/tex">CD</script> and <script type="math/tex">DA</script>, respectively. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0171.png" style="width:325.215pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.9</span>
<span class="caption_text">Partitioning of closed curves to obtain single-valued portions.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b> Evaluate the line integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">\oint _{\mathcal C} \left\{ 2xy dy -x^{2} dx\right\} ,</script></span>
<p>
 where <script type="math/tex">{\mathcal C}</script> is made up of the sides of the triangle with vertices <script type="math/tex">O=(0,0), A=(1,0), B=(1,1)</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0173.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.10</span>
<span class="caption_text">Contours in triangle example.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000578">
<li id="a0000000579"> <p>
If we traverse the sides of the triangle in a counterclockwise direction, then we must traverse successively <script type="math/tex">OA</script>, <script type="math/tex">AB</script> <script type="math/tex">BO</script>. 
</p>
</li>
<li id="a0000000580"> <p>
On each of these sides the function representations of the paths are single-valued: 
</p>
<ul class="itemize" id="a0000000581">
<li id="a0000000582"> <p>
<span style="color:#FF0000">OA: <script type="math/tex">y=0 \qquad \Rightarrow \qquad dy=0, \qquad 0\le x\le 1,</script></span>
</p>
</li>
<li id="a0000000583"> <p>
<span style="color:#FF0000">AB: <script type="math/tex">x=1 \qquad \Rightarrow \qquad dx=0, \qquad 0\le y\le 1,</script></span>
</p>
</li>
<li id="a0000000584"> <p>
<span style="color:#FF0000">BO: <script type="math/tex">y=x, \qquad \Rightarrow \qquad dy=dx\qquad 1\ge x\ge 0.</script></span>
</p>
</li>
</ul>
</li>
<li id="a0000000585"> <p>
Hence the integral is the sum of three integrals over <script type="math/tex">OA, AB, BO</script> as follows: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \oint _{\mathcal C} \left\{ 2xy dy -x^{2} dx\right\} & =& \int _{OA}\left\{ 2xy dy -x^{2} dx\right\} +\int _{AB}\left\{ 2xy dy -x^{2} dx\right\} +\int _{BO}\left\{ 2xy dy -x^{2} dx\right\} , \\ & =& \int _{OA}\left\{ 0 -x^{2} dx\right\} +\int _{AB}\left\{ 2\times 1\times y dy -0\right\} +\int _{BO}\left\{ 2x\times x dx -x^{2} dx\right\} , \\ & =& -\int _{x=0}^{x=1} x^{2} dx+2\int _{y=0}^{y=1} y dy +\int _{x=1}^{x=0}x^{2} dx, \\ & =& -\left[\frac{x^{3}}{3}\right]_{x=0}^{x=1}+2\left[\frac{y^{2}}{2}\right]_{y=0}^{y=1} +\left[\frac{x^{3}}{3}\right]_{x=1}^{x=0}, \\ & =& -\frac{1}{3}+1-\frac{1}{3}, \\ & =& \frac{1}{3} \ne 0. \\ \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
 Note carefully the order of the integration limits. 
</p>
<p>
<b class="bf">Example:</b> Evaluate the line integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">\oint _{\mathcal C} ydx,</script></span>
<p>
 where <script type="math/tex">{\mathcal C}</script> is the circle <script type="math/tex">x^{2}+y^{2}=a^{2}</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0175.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.11</span>
<span class="caption_text">Contours in circle example.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000586">
<li id="a0000000587"> <p>
The representation of <script type="math/tex">{\mathcal C}</script>, <script type="math/tex">y=\sqrt{a^{2}-x^{2}}</script> is not single-valued. 
</p>
</li>
<li id="a0000000588"> <p>
We split the contour up into two halves on which the contour is a single-valued function of <script type="math/tex">x</script>: 
</p>
<ul class="itemize" id="a0000000589">
<li id="a0000000590"> <p>
<span style="color:#FF0000">Upper semi-circle <script type="math/tex">{\mathcal C_{1}}</script>: <script type="math/tex">y=+\sqrt{a^{2}-x^{2}} \qquad {\rm with} \qquad +a\ge x\ge -a,</script></span>
</p>
</li>
<li id="a0000000591"> <p>
<span style="color:#FF0000">Lower semi-circle <script type="math/tex">{\mathcal C_{2}}</script>: <script type="math/tex">y=-\sqrt{a^{2}-x^{2}} \qquad {\rm with} \qquad -a\le x\le a.</script></span>
</p>
</li>
</ul>
</li>
<li id="a0000000592"> <p>
Hence the integral is the sum of two integrals as follows: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \oint _{\mathcal C} y dx& =& \int _{\mathcal C_{1}}ydx+ \int _{\mathcal C_{2}}ydx, \\ & =& +\int _{x=+a}^{x=-a}\sqrt{a^{2}-x^{2}}dx+\int _{x=-a}^{x=+a}\left(-\sqrt{a^{2}-x^{2}}\right)dx, \\ & =& -\int _{x=-a}^{x=+a}\sqrt{a^{2}-x^{2}}dx-\int _{x=-a}^{x=+a}\sqrt{a^{2}-x^{2}}dx, \\ & =& -2\int _{x=-a}^{x=+a}\sqrt{a^{2}-x^{2}}dx, \\ & =& -4\int _{x=0}^{x=+a}\sqrt{a^{2}-x^{2}}dx, \\ & =& -\pi a^{2}. \\ \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
 The integration can be done by a change of variables using <script type="math/tex">x=a\sin u</script>. 
</p>
<p>
Note that, up to a sign, this line integral gives the area of the enclosed circle. We could also have found the same result by integrating 
</p>
<span class="dmath"><script type="math/tex; mode=display">\oint _{\mathcal C} xdy.</script></span>
<p>
In fact a general result is that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\oint _{\mathcal C} xdy=-\oint _{\mathcal C} ydx=\frac{1}{2}\oint _{\mathcal C} (x \, dy-y \,  dx)=A,</script></span>
<p>
 where <script type="math/tex">A</script> is the area of the shape enclosed by the nonintersecting closed curve <script type="math/tex">{\mathcal C}</script>. We shall prove this result later. 
</p>
<p>
<br/>
</p>
</section><section class="section">
<h2 id="a0000000593">4.5 Connectivity of Regions</h2>
<p>
We now introduce the concept of connectivity of a planar region. This will be used in later sections. 
</p>
<p>
<b class="bf">Definition: (Connectivity)</b> A plane region <script type="math/tex">{\mathcal R}</script> is said to be simply connected if every simple (i.e., non-intersecting) closed curve <script type="math/tex">{\mathcal C}</script> lying in <script type="math/tex">{\mathcal R}</script> can be continuously shrunk to a point within <script type="math/tex">{\mathcal R}</script>
</p>
<p>
This idea is illustrated in see figure on the left below. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0177.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.12</span>
<span class="caption_text">Left: Simply connected region <script type="math/tex">{\mathcal R}</script>. Middle: Doubly connected region <script type="math/tex">{\mathcal R}</script>. Right: Triply connected region <script type="math/tex">{\mathcal R}</script>.</span>
</figcaption> </div>
</figure>
<p>
In the middle diagram above the curve <script type="math/tex">{\mathcal C_{1}}</script> may be shrunk to a point without leaving <script type="math/tex">{\mathcal R}</script>. However the curve <script type="math/tex">{\mathcal C_{2}}</script> cannot be shrunk to a point in <script type="math/tex">{\mathcal R}</script>. There are thus two types of curves in <script type="math/tex">{\mathcal R}</script>, those like <script type="math/tex">{\mathcal C_{1}}</script> and those like <script type="math/tex">{\mathcal C_{2}}</script>. <script type="math/tex">{\mathcal R}</script> is this not simply connected. Due to the existence of two different types of curves in <script type="math/tex">{\mathcal R}</script> it is, however, said to be doubly connected. 
</p>
<p>
Similarly in the right hand diagram above, the region <script type="math/tex">{\mathcal R}</script> is said to be triply connected as there are three different types of curves: 
</p>
<ul class="itemize" id="a0000000594">
<li id="a0000000595"> <p>
<script type="math/tex">{\mathcal C_{1}}</script> those that may be shrunk to a point; 
</p>
</li>
<li id="a0000000596"> <p>
<script type="math/tex">{\mathcal C_{2}}</script> those that may be shrunk to encircle one hole; 
</p>
</li>
<li id="a0000000597"> <p>
<script type="math/tex">{\mathcal C_{3}}</script> those that may be shrunk to encircle two holes. 
</p>
</li>
</ul>
<p>
In general if there are <script type="math/tex">n-1</script> holes in region <script type="math/tex">{\mathcal R}</script>, the region is said to be <script type="math/tex">n-</script>fold connected. 
</p>
<p>
<br/>
</p>
</section><section class="section">
<h2 id="a0000000598">4.6 Independence of Path</h2>
<p>
We now deduce the conditions under which the value of a line integral with the same endpoints is independent of the path between them. 
</p>
<p>
Suppose <script type="math/tex">F(x,y)</script> is a single valued continuous function of <script type="math/tex">(x,y)</script> with single valued and continuous first partial derivatives in a region <script type="math/tex">{\mathcal R}</script> of the <script type="math/tex">(x,y)-</script>plane. 
</p>
<p>
Let <script type="math/tex">{\mathcal C}</script> be a curve lying entirely within <script type="math/tex">{\mathcal R}</script> with endpoints <script type="math/tex">A:(x_{1},y_{1})</script> and <script type="math/tex">B:(x_{1},y_{1})</script>. We define <script type="math/tex">{\mathcal C}</script> parametrically as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\mathcal C}: x=f(t), y=g(t),</script></span>
<p>
 for <script type="math/tex">t_{1}\le t\le t_{2}</script> with <script type="math/tex">f(t_{i})=x_{i}, g(t_{i})=y_{i}, i=1,2</script>. 
</p>
<p>
Consider the following line integral of <script type="math/tex">F(x,y)</script> along <script type="math/tex">{\mathcal C}</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int _{\mathcal C}\frac{\partial F}{\partial x} dx + \frac{\partial F}{\partial y} dy</script></span></span> This can be written in terms of the parameter <script type="math/tex">t</script> as follows <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \int _{\mathcal C}\frac{\partial F}{\partial x} dx + \frac{\partial F}{\partial y} dy& =&  \int _{\mathcal C}\frac{\partial F}{\partial x} \frac{dx}{dt}dt + \frac{\partial F}{\partial y} \frac{dy}{dt}dt\\ & =&  \int _{t_{1}}^{t_{2}}\left(\frac{\partial F}{\partial x} \frac{dx}{dt} + \frac{\partial F}{\partial y} \frac{dy}{dt}\right)dt \\ & =&  \int _{t_{1}}^{t_{2}}\frac{dF(f(t),g(t))}{dt}dt \\ & =& F(f(t_{2}),g(t_{2})-F(f(t_{1}),g(t_{1})) \\ & =& F(x_{2},y_{2})-F(x_{1},y_{1}), \end{eqnarray*}</script></span></span> where we have used the chain rule to go between the second and third lines. 
</p>
<p>
Note that the final result only depends on the endpoints and not on the actual contour of integration <script type="math/tex">{\mathcal C}</script>. 
</p>
<p>
Thus we can now see that the condition for the value of a line integral of the form 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{\mathcal C}\left\{ P(x,y)dx+Q(x,y)dy\right\} ,</script></span>
<p>
 to be independent of the contour of integration <script type="math/tex">{\mathcal C}</script> is the existence of a function <script type="math/tex">F(x,y)</script> such that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">P(x,y)=\frac{\partial F(x,y)}{\partial x} \qquad Q(x,y)=\frac{\partial F(x,y)}{\partial y}.</script></span></span> The additional trick (<i class="it">cf.</i> first order exact ODEs) is to observe that we have no need to actually find the function <script type="math/tex">F(x,y)</script>. The conditions assumed for <script type="math/tex">F</script> means that it’s mixed partial derivatives exist and are equal. Thus we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial P(x,y)}{\partial y}=\frac{\partial ^{2} F(x,y)}{\partial y \partial x} = \frac{\partial ^{2} F(x,y)}{\partial x \partial y}=\frac{\partial Q(x,y)}{\partial x}.</script></span></span> Hence the condition for the existence of <script type="math/tex">F(x,y)</script> and therefore the path independence of <script type="math/tex">I</script> is that for <script type="math/tex">(x,y)\in {\mathcal R}</script> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\boxed {\frac{\partial P(x,y)}{\partial y}=\frac{\partial Q(x,y)}{\partial x}.}</script></span></span>
</p>
<p>
A caveat to this is that if <script type="math/tex">{\mathcal R}</script> is not simply connected, this result does not hold. 
</p>
<section class="subsection">
<h3 id="a0000000599">4.6.1 Path Independence for Closed Curves</h3>
<p>
 Consider the following path integral around a closed curve in a simply connected region <script type="math/tex">{\mathcal R}</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\oint _{\mathcal C}\left\{ P(x,y)dx+Q(x,y)dy\right\} .</script></span>
<p>
 If the integral is independent of path, then we have <script type="math/tex">I=0</script> for all simple closed curves in <script type="math/tex">{\mathcal R}</script>. 
</p>
<p>
The proof is straightforward. 
</p>
<p>
Consider two paths between the points <script type="math/tex">A</script> and <script type="math/tex">B</script> in a simply connected region <script type="math/tex">{\mathcal R}</script>. Let the endpoints be connected by two paths <script type="math/tex">{\mathcal C_{1}}</script> and <script type="math/tex">{\mathcal C_{2}}</script> as in the diagram 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0179.png" style="width:144.54pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.13</span>
<span class="caption_text">Two different paths <script type="math/tex">{\mathcal C_{1}}</script> and <script type="math/tex">{\mathcal C_{2}}</script> between the endpoints <script type="math/tex">A</script> and <script type="math/tex">B</script> in a simply connectd region <script type="math/tex">{\mathcal R}</script>.</span>
</figcaption> </div>
</figure>
<p>
Then we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I& =& \oint _{\mathcal C}\left\{ P(x,y)dx+Q(x,y)dy\right\} \\ & =& \int _{\mathcal C_{1}}\left\{ P(x,y)dx+Q(x,y)dy\right\} -\int _{\mathcal C_{2}}\left\{ P(x,y)dx+Q(x,y)dy\right\}  \\ & =& 0, \end{eqnarray*}</script></span></span> since, by assumption the integrals are independent of path, and so the terms in the second line are identical. 
</p>
<p>
The reverse also holds, namely that if <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\oint _{\mathcal C}\left\{ P(x,y)dx+Q(x,y)dy\right\} =0</script></span></span> for all simple closed curves <script type="math/tex">{\mathcal C}</script> in the simply connected region <script type="math/tex">{\mathcal R}</script>, then the integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int \left\{ P(x,y)dx+Q(x,y)dy\right\}</script></span>
<p>
 is independent of the path between any two given endpoints in <script type="math/tex">{\mathcal R}</script>. 
</p>
<p>
When you come to study complex analysis, the path independence of integrals of complex analytical functions is called Cauchy’s theorem. 
</p>
<p>
<b class="bf">Example:</b> Consider the integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\int _{A}^{B} (y\cos x \,  dx + \sin x \,  dy),</script></span>
<p>
 where <script type="math/tex">A</script> is the point <script type="math/tex">(0,0)</script> and <script type="math/tex">B</script> is the point <script type="math/tex">(\pi /4,\pi /4)</script>. 
</p>
<p>
This integral is independent of the path jointing <script type="math/tex">A</script> and <script type="math/tex">B</script> in the <script type="math/tex">(x,y)</script> plane, since if we set <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">P(x,y)=y\cos x, \qquad Q(x,y)=\sin x,</script></span></span> we observe that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial P}{\partial y}=\cos x = \frac{\partial Q}{\partial x}.</script></span></span>
</p>
<p>
Consequently, from above, the line integral can be written as an exact derivative of a function <script type="math/tex">F(x,y)</script>. We can find what <script type="math/tex">F(x,y)</script> is by integration both partial derivatives and comparing the results (see Chapter 1): 
</p>
<p>
<span style="color:#FF0000"><div id="a0000000600">
<div class="eqnarrayid" id="a0000000601"></div><script type="math/tex; mode=display">
\begin{align}
\tag{4.1} \frac{\partial F}{\partial x} & =&  y\cos x \qquad \Rightarrow \qquad F(x,y)=\int y\cos x \,  dx =y\sin x +g(y); \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial F}{\partial y} & =&  \sin x \qquad \Rightarrow \qquad F(x,y)=\int \sin x \,  dy =y\sin x + h(y); \\ 
\nonumber 
\end{align}
</script>
</div></span>
</p>
<p>
where <script type="math/tex">g(y)</script> and <script type="math/tex">h(x)</script> are arbitrary functions. A comparison of the two expressions shows that they can only be equal if <script type="math/tex">g(y)=h(x)=</script> constant. Hence up to an arbitrary constant (which will vanish in the final definite integration below) it is not too difficult to see that: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=y\cos x.</script></span> </span>
</p>
<p>
Thus the integral can be easily evaluated as: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\int _{A}^{B} (y\cos x \,  dx + \sin x \,  dy) =\int _{A}^{B} d(y\sin x)=\left[y\sin x\right]_{(0,0)}^{(\pi /4,\pi /4)}=\frac{\pi }{4\sqrt{2}}.</script></span></span>
</p>
</section>
</section><section class="section">
<h2 id="a0000000602">4.7 Green’s Theorem</h2>
<p>
Green’s theorem is one of the most fundamental and beautiful theorems involving line integrals.<a class="footnote" href="#a0000000603">
<sup class="footnotemark">15</sup>
</a> It links the value of an integral over a curve to that of an integral over the region the curve bounds. It is of fundamental importance in many fields of the physical and mathematical sciences. It is a two-dimensional special case of the Kelvin- Stokes and divergence theorems and can also be used to prove results involving integrals in complex analysis, all of which you may learn next year. 
</p>
<section class="subsection">
<h3 id="a0000000604">4.7.1 Statement of Green’s Theorem</h3>
<p>
<b class="bf">Theorem: (Green’s Theorem)</b> Suppose <script type="math/tex">P(x,y)</script> and <script type="math/tex">Q(x,y)</script> are two functions which are finite and continuous inside and on the non- self-intersecting boundary <script type="math/tex">{\mathcal C}</script> of some simply connected region <script type="math/tex">{\mathcal R}</script> of the <script type="math/tex">(x,y)</script>-plane. If the first partial derivatives of the these functions are continuous inside and on the boundary of <script type="math/tex">{\mathcal R}</script>, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\boxed {\oint _{\mathcal C}\left\{ P(x,y)\,  dx + Q(x,y) \,  dy\right\} =\iint _{\mathcal R}\left\{ \frac{\partial Q(x,y)}{\partial x}- \frac{\partial P(x,y)}{\partial y}\right\} \,  dx \,  dy.}</script></span></span>
</p>
</section><section class="subsection">
<h3 id="a0000000605">4.7.2 Sketch Proof of Green’s Theorem</h3>
<p>
The proof of the theorem when the boundary <script type="math/tex">{\mathcal C}</script> is a simple (non-self-intersecting) closed curve and <script type="math/tex">{\mathcal R}</script> is simply connected, is relatively straightforward. The following diagram will be helpful. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0181.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.14</span>
<span class="caption_text">The region <script type="math/tex">{\mathcal R}</script> is the same in both diagrams. The boundary curve <script type="math/tex">{\mathcal C}</script> is also the same. In the left-hand diagram, <script type="math/tex">{\mathcal C}</script> decomposed into two curves <script type="math/tex">{\mathcal C_{1}}</script>, <script type="math/tex">{\mathcal C_{2}}</script>, with single valued representations <script type="math/tex">y=y_{1}(x)</script> and <script type="math/tex">y=y_{2}(x)</script>, respectively with <script type="math/tex">{\mathcal C}={\mathcal C_{1}}\cup {\mathcal C_{2}}</script>. In the right-hand diagram, the same boundary <script type="math/tex">{\mathcal C}</script> is now decomposed into two curves <script type="math/tex">{\mathcal C_{3}}</script>, <script type="math/tex">{\mathcal C_{4}}</script>, with single valued representations <script type="math/tex">x=x_{3}(y)</script> and <script type="math/tex">x=x_{4}(y)</script>, respectively with <script type="math/tex">{\mathcal C}={\mathcal C_{3}}\cup {\mathcal C_{4}}</script>.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000606">
<li id="a0000000607"> <p>
Consider the 2-d integral <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \iint _{\mathcal R}\frac{\partial P(x,y)}{\partial y}\,  dx \,  dy & =& \int _{x=a}^{x=b}\,  dx\int _{y=y_{1}(x)}^{y=y_{2}(x)}\frac{\partial P(x,y)}{\partial y} \,  dy \\ & =& \int _{x=a}^{x=b}\Big[P(x,y)\Big]_{y=y_{1}(x)}^{y=y_{2}(x)}\,  dx \\ & =& \int _{x=a}^{x=b}\left\{ P(x,y_{2}(x))-P(x,y_{1}(x))\right\} \,  dx \\ & =& -\int _{x=a}^{x=b}P(x,y_{1}(x))\,  dx+\int _{x=a}^{x=b}P(x,y_{2}(x))\,  dx \\ & =& -\int _{x=a}^{x=b}P(x,y_{1}(x))\,  dx-\int _{x=b}^{x=a}P(x,y_{2}(x))\,  dx \\ & =& -\oint _{\mathcal C}P(x,y)\,  dx. \\ \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000608"> <p>
Now consider the 2-d integral 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \iint _{\mathcal R}\frac{\partial Q(x,y)}{\partial x}\,  dx \,  dy & =& \int _{y=c}^{y=d}\,  dy\int _{x=x_{3}(y)}^{x=x_{4}(y)}\frac{\partial Q(x,y)}{\partial x} \,  dx \\ & =& \int _{y=c}^{y=d}\Big[Q(x,y)\Big]_{x=x_{3}(y)}^{x=x_{4}(y)}\,  dy \\ & =& \int _{y=c}^{y=d}\left\{ Q(x_{4}(y),y)-Q(x_{3}(y),y)\right\} \,  dy \\ & =& \int _{y=c}^{y=d}Q(x_{4}(y),y)\,  dy-\int _{y=c}^{y=d}Q(x_{3}(y),y)\,  dy \\ & =& \int _{y=c}^{y=d}Q(x_{4}(y),y)\,  dy+\int _{y=d}^{y=c}Q(x_{3}(y),y)\,  dy \\ & =& \oint _{\mathcal C}Q(x,y)\,  dy. \end{eqnarray*}</script></span>
</li>
<li id="a0000000609"> <p>
Subtracting the first result from the second delivers the following result, as required: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\oint _{\mathcal C}\left\{ P(x,y)\,  dx + Q(x,y) \,  dy\right\} =\iint _{\mathcal R}\left\{ \frac{\partial Q(x,y)}{\partial x}-\frac{\partial P(x,y)}{\partial y}\right\} \,  dx \,  dy.</script></span></span>
</p>
</li>
</ul>
</section><section class="subsection">
<h3 id="a0000000610">4.7.3 Special Case of Green’s Theorem</h3>
<p>
A special case of Green’s theorem leads to a surprising and immediately useful result. 
</p>
<p>
Consider the special case of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">P(x,y)=y, \qquad Q(x,y)=-x.</script></span></span> Inserting these functions into Green’s theorem we obtain: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \oint _{\mathcal C}\left\{ P(x,y)\,  dx + Q(x,y) \,  dy\right\} & =& \iint _{\mathcal R}\left\{ \frac{\partial Q(x,y)}{\partial x}-\frac{\partial P(x,y)}{\partial y}\right\} \,  dx \,  dy. \\ \Rightarrow \qquad \oint _{\mathcal C}\left\{ y \,  dx - x \,  dy\right\} & =& \iint _{\mathcal R}\left\{ -\frac{\partial x}{\partial x}-\frac{\partial y}{\partial y}\right\} \,  dx \,  dy. \\ \Rightarrow \qquad \oint _{\mathcal C}\left\{ y \,  dx - x \,  dy\right\} & =& -2\iint _{\mathcal R}\,  dx \,  dy. \\ \Rightarrow \qquad \frac{1}{2}\oint _{\mathcal C}\left\{ x \,  dy-y \,  dx \right\} & =& \iint _{\mathcal R}\,  dx \,  dy=A. \\ \Rightarrow \qquad A& =& \frac{1}{2}\oint _{\mathcal C}\left\{ x \,  dy-y \,  dx \right\} . \end{eqnarray*}</script></span></span> In other words, the area of the simply-connected region enclosed by the non-self-intersecting curve <script type="math/tex">{\mathcal C}</script> can be given by a simple line integral. This result underpins the principle of the <a href="https://en.wikipedia.org/wiki/Planimeter"><b class="bf">planimeter</b></a>, a mechanical device for measuring the area of an arbitrary two dimensional shape. 
</p>
<p>
Note that the above area result can also be simplified by making the same substitutions <script type="math/tex">P(x,y)=y, Q(x,y)=-x</script> into the two integrals used to prove Green’s theorem above. For then they generate: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  A& =& \iint _{\mathcal R}\,  dx \,  dy=-\oint _{\mathcal C}y\,  dx, \\ A& =& \iint _{\mathcal R}\,  dx \,  dy=\oint _{\mathcal C}x\,  dy. \end{eqnarray*}</script></span>
</section><section class="subsection">
<h3 id="a0000000611">4.7.4 Examples of the use of Green’s Theorem</h3>
<p>
<b class="bf">Example:</b> Use Green’s theorem to evaluate the line integral 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">I=\oint _{\mathcal C}\left\{ (x^{2}+y)\,  dx + (x+\sin y) \,  dy\right\} ,</script></span></span>
</p>
<p>
where <script type="math/tex">{\mathcal C}</script> is the boundary of the unit square with vertices <script type="math/tex">(0,0), (1,0), (1,1), (0,1)</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0183.png" style="width:144.54pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.15</span>
<span class="caption_text">Contour <script type="math/tex">{\mathcal C}</script> around unit square in example.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000612">
<li id="a0000000613"> <p>
From the form of the line integral, we identify <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">P(x,y)=x^{2}+y, \qquad Q(x,y)=x+\sin y.</script></span></span>
</p>
</li>
<li id="a0000000614"> <p>
The functions <script type="math/tex">P</script> and <script type="math/tex">Q</script> are continuous and possess continuous first partial derivatives (obvious). 
</p>
</li>
<li id="a0000000615"> <p>
The integration curve <script type="math/tex">{\mathcal C}</script> is not self intersecting and encircles a region <script type="math/tex">{\mathcal R}</script> that is simply connected. 
</p>
</li>
<li id="a0000000616"> <p>
Hence we may apply Green’s theorem. 
</p>
</li>
<li id="a0000000617"> <p>
Hence we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  I=\oint _{\mathcal C}\left\{ (x^{2}+y)\,  dx + (x+\sin y) \,  dy\right\} & =& \iint _{\mathcal R}\left\{ \frac{\partial Q(x,y)}{\partial x}- \frac{\partial P(x,y)}{\partial y}\right\} \,  dx \,  dy, \\ & =& \iint _{\mathcal R}\left\{ \frac{\partial (x+\sin y)}{\partial x}-\frac{\partial (x^{2}+y)}{\partial y}\right\} \,  dx \,  dy, \\ & =& \int _{x=0}^{x=1}\,  dx \int _{y=0}^{y=1}\,  dy\left\{ 1-1\right\} , \\ & =& 0. \\ \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Use Green’s theorem to evaluate the line integral 
</p>
<span class="dmath"><script type="math/tex; mode=display">I=\oint _{\mathcal C}\left\{ (e^{x}-2y)\,  dx + (x+\cos ({1457y^{956}})) \,  dy\right\} ,</script></span>
<p>
where <script type="math/tex">{\mathcal C}</script> is the boundary of the circle, centred at the origin and radius <script type="math/tex">a</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0185.png" style="width:144.54pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.16</span>
<span class="caption_text"><script type="math/tex">{\mathcal C}</script> is a circle of radius <script type="math/tex">a</script> in the example.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000618">
<li id="a0000000619"> <p>
From the form of the line integral, we identify 
</p>
<span class="dmath"><script type="math/tex; mode=display">P(x,y)=e^{x}-2y, \qquad Q(x,y)=x+\cos ({1457y^{956})}.</script></span>
</li>
<li id="a0000000620"> <p>
The functions <script type="math/tex">P</script> and <script type="math/tex">Q</script> are continuous and possess continuous first partial derivatives (obvious). 
</p>
</li>
<li id="a0000000621"> <p>
The integration curve <script type="math/tex">{\mathcal C}</script> is not self intersecting and encircles a region <script type="math/tex">{\mathcal R}</script> that is simply connected. 
</p>
</li>
<li id="a0000000622"> <p>
Hence we may apply Green’s theorem. 
</p>
</li>
<li id="a0000000623"> <p>
Hence we have 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  I=\oint _{\mathcal C}\left\{ (e^{x}-2y)\,  dx + x+\cos ({1457y^{956})} \,  dy\right\} & =& \iint _{\mathcal R}\left\{ \frac{\partial Q(x,y)}{\partial x}- \frac{\partial P(x,y)}{\partial y}\right\} \,  dx \,  dy, \\ & =& \iint _{\mathcal R}\left\{ \frac{\partial (x+\cos ({1457y^{956}}))}{\partial x}-\frac{\partial (e^{x}-2y)}{\partial y}\right\} \,  dx \,  dy, \\ & =& \iint _{\mathcal R}\left\{ 1+2\right\} \,  dx \,  dy, \\ & =& 3\iint _{\mathcal R}\,  dx \,  dy,\\ & =& 3\times {\rm Area \  of \  circle, \  radius \  } a, \\ & =& 3 \pi a^{2}. \\ \end{eqnarray*}</script></span>
</li>
</ul>
<p>
<b class="bf">Example:</b> Use Green’s theorem to find the area of an ellipse whose boundary is given by given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=a\cos t, \qquad y=b\sin t, \qquad 0\le t\le 2\pi .</script></span>
<figure id="3dplot123">
<div class="centered"> <img src="../../notes/course_notes/images/img-0187.png" style="width:144.54pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">4.17</span>
<span class="caption_text">Ellipse of semi-major axis <script type="math/tex">a</script> and semi-minor axis <script type="math/tex">b</script>.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000624">
<li id="a0000000625"> <p>
We use the special case of Green’s theorem: 
</p>
<span class="dmath"><script type="math/tex; mode=display">A=\frac{1}{2}\oint _{\mathcal C}\left\{ x \,  dy-y \,  dx\right\} ,</script></span>
<p>
 where <script type="math/tex">A</script> is the area of the ellipse and <script type="math/tex">{\mathcal C}</script> is its perimeter. 
</p>
</li>
<li id="a0000000626"> <p>
On <script type="math/tex">{\mathcal C}</script> we have 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  x=a\cos t \qquad & \Rightarrow &  \qquad dx=-a \sin t, \\ y=b\sin t \qquad & \Rightarrow &  \qquad dy=b \cos t. \end{eqnarray*}</script></span>
</li>
<li id="a0000000627"> <p>
The integration curve <script type="math/tex">{\mathcal C}</script> is not self intersecting and encircles a region <script type="math/tex">{\mathcal R}</script> that is simply connected. 
</p>
</li>
<li id="a0000000628"> <p>
Hence we may apply Green’s theorem. 
</p>
</li>
<li id="a0000000629"> <p>
Hence we have 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  A& =& \frac{1}{2}\oint _{\mathcal C}\left\{ x \,  dy-y \,  dx\right\} , \\ & =& \frac{1}{2}\oint _{\mathcal C}\left\{ a\cos t \,  dy-b\sin t \,  dx\right\} , \\ & =& \frac{1}{2}\int _{t=0}^{t=2\pi }\left\{ (a\cos t) \times (b\cos t) dt -b\sin t \times (-a\sin t) dt\right\} , \\ & =& \frac{1}{2}\int _{t=0}^{t=2\pi }\left\{ (ab\cos ^{2} t +ab\sin ^{2} t)dt\right\} , \\ & =& \frac{ab}{2}\int _{t=0}^{t=2\pi }\left\{ (\cos ^{2} t +\sin ^{2} t)dt\right\} , \\ & =& \frac{ab}{2}\int _{t=0}^{t=2\pi }dt, \\ & =& \frac{ab}{2}\times 2\pi , \\ & =& \pi ab. \\ \end{eqnarray*}</script></span>
</li>
</ul>
</section>
</section>
<hr/>
<ol>
<li id="a0000000019">the OS are actually based in Southampton <a href="https://www.ordnancesurvey.co.uk/">https://www.ordnancesurvey.co.uk/</a> </li>
<li id="a0000000020">You can read more about the mathematical aspects of the experiment <a href="https://www.citylab.com/design/2016/06/contour-lines-hutton-schiehallion/486308/">here</a>. Details of the theory underpinning the calculation can be found <a href="https://en.wikipedia.org/wiki/Schiehallion_experiment">here</a>. The original experiment was accurate to around 20% of the currently accepted value for the density of the earth. Subsequent experiments on the same mountain achieve estimates within 1%.</li>
<li id="a0000000100">Don’t panic! if you have a problem like this in an exam, you will be given a hint.</li>
<li id="a0000000129">Note that in this example, when <script type="math/tex">z</script> is expressed in terms of the ultimate independent variables we find that there is only 1 indepdendent variable. Therefore the final derivative with respect to that variable is a total one.</li>
<li id="a0000000149">DON’T PANIC: you won’t be expected to do this until MATH2038! This is just an example to show you how the chain rule is useful.</li>
<li id="a0000000196">One should expect the converse not to be true as we only choose two specific lines on the tangent plane in order to describe the gradient vector. But as we shall see, this is almost true.</li>
<li id="a0000000260">Such problems will be discussed next year, but the transformation here serves as a good exercise in use of the chain rule.</li>
<li id="a0000000288">Use <script type="math/tex">x=r\cos \theta </script> and <script type="math/tex">y=r\sin \theta </script> etc.</li>
<li id="a0000000345">We take the positive square root as <script type="math/tex">y</script> is a length.</li>
<li id="a0000000386">Surprisingly, given the long history of calculus, dating from only 1907!)</li>
<li id="a0000000390">since <script type="math/tex">x</script> is continuous <script type="math/tex">y</script> is continuous, <script type="math/tex">4-x-y</script> is continuous <i class="it">etc.</i></li>
<li id="a0000000461">or by the inversion property of Jacobians from Chapter 1: <span class="dmath"><script type="math/tex; mode=display">J(u,v)=\frac{\partial (X,Y)}{\partial (u,v)}=1\bigg/\frac{\partial (U,V)}{\partial (x,y)}.</script></span></li>
<li id="a0000000490">Some of you may have treated similar problems at A-level using other methods, but we are using this example as a way to illustrate how to compute volumes of solids of revolution using cylindrical polars.</li>
<li id="a0000000494">the earth is not actually spherical but squashed at the poles to form a “oblate spheroid”.</li>
<li id="a0000000603">Green’s Theorem is named after George Green (1793-1841). He was self-taught and had minimal schooling as a child. His father was a baker and Green spent much of his adult life running a windmill in Sneinton in Nottinghamshire. Nevertheless, in 1828 he privately published a text on the application of mathematics to electricity and magnetism. At the time, only 51 people bought it, but it contains results of fundamental importance in many fields of mathematics and science. Some of the subscribers encouraged Green to go to Cambridge to do an undergraduate degree. He entered in 1832, aged 39 and finally graduated in 1838 with a BA, some 10 years after his research work (thereby proving that you don’t need to have been anywhere near Cambridge to change the world)! He died only 3 years later, with some rumours of alcoholism. The picture on the back of these lecture notes is of your lecturer pondering some maths on Green’s grave in the churchyard in Sneinton. Green’s mill still stands today and can be visited <a href="http://www.greensmill.org.uk/">both physically and electonically</a></li>
</ol>

            </div>
        </div>
    </div>

        </main>
		
		<footer class="text-muted">
	<hr>
	<div class="container">
		<div class="float-right">
			<ul style="list-style: none">
			<li><a href="#">Back to top</a></li>
			
			
			<li><a href="../../notes/course_notes/pdf/course_notes.pdf" target="_blank"><i class="fa fa-file-pdf-o"></i>&nbsp;Download as PDF</a></li>
			
			</ul>
		</div>
		<p>Generated using <a target="_blank" href="https://github.com/chirun-ncl/chirun">Chirun</a>, written by the E-Learning Unit, School of Mathematics &amp; Statistics, Newcastle University</p>
		<p>This page last generated: 2022-07-03</p>
	</div>
</footer>
		
    </body>
</html>
