<!doctype html>
<html lang="en">
    <head>
        
            <meta charset="utf-8">
            <meta name="robots" content="noindex">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
            <meta name="author" content="Ian Hawke" />
            <meta name="date" content="2022-07-03" />
        

        <title>Multivariable Functions | Operational Research and Mathematical Computing</title>

        
    
    
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../../static/styles.css">
            <link rel="stylesheet" id="customiseCSS" href="../../../static/light.css">
            
            
        
    <link rel="stylesheet" id="customiseCodeCSS" href="../../../static/pygmentize.light.css">
    <link rel="stylesheet" href="../../../static/codemirror-5.26.0/lib/codemirror.css">
    <link rel="stylesheet" href="../../../static/boole.css">
    <link rel="stylesheet" href="../../../static/numbasEmbed.css">

    <link rel="stylesheet" href="../../../static/bootstrap-toc.css?v=3">
    <link rel="stylesheet" href="../../../static/print.css">


        
    
    
            <script defer src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
            <script defer src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
            <script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
            <script defer src="../../../static/mathjax_config.js"></script>
            <script type="text/javascript" id="MathJax-script" defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
            <script defer src="../../../static/customisation.js"></script>
            <script defer src="../../../static/mp4.js"></script>
            
            
        
    <script defer src="../../../static/jquery.flexibleArea.js"></script>
    <script defer src="../../../static/spin.min.js"></script>
    <script defer src="../../../static/codemirror-5.26.0/lib/codemirror.js"></script>
    <script defer src="../../../static/codemirror-5.26.0/mode/octave/octave.js"></script>
    <script defer src="../../../static/codemirror-5.26.0/mode/python/python.js"></script>
    <script defer src="../../../static/codemirror-5.26.0/mode/r/r.js"></script>
    <script defer src="../../../static/boole.js"></script>
    <script defer src="../../../static/numbasEmbed.js"></script>

    <script defer src="../../../static/bootstrap-toc.js"></script>

    </head>
    <body data-spy="scroll" data-target="#chapterTOC" data-offset="50">
        
<div class="collapse" id="navbarToggleCustomise">
	<div class="bg-secondary text-white p-3">
		<form onsubmit="return false;" id="navbarCustomise">
			<div class="form-row">
				<label>Theme Customisation</label>
				<div id="themeSelector" class="form-group col-md-12">
					<button class="btn btn-dark mr-2" value="dark">Dark</button>
					<button class="btn btn-pastel mr-2" value="pastel">Pastel</button>
					<button class="btn btn-light mr-4" value="light">Light</button>
				</div>
			</div>
			<div class="form-row">
				<div class="form-group col-md-4">
					<label style="display: block" for="font-scale">Font size (<span id="font-size-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="font-scale" min="50" max="600" value="100">
					<button id="font-scale-reset" class="btn btn-sm">Reset</button>
				</div>
				<div class="form-group col-md-4">
					<label style="display: block" for="p-space">Spacing (<span id="p-space-display">100%</span>)</label>
					<input type="range" class="form-control-range col-9 mr-2" id="p-space" min="0" max="600" value="100">
					<button id="p-space-reset" class="btn btn-sm">Reset</button>
				</div>
			</div>
		</form>
	</div>
</div>

<nav aria-label="breadcrumb">
	<ul class="breadcrumb">
		<li class="breadcrumb-item">
			<a href="../../../index.html">Operational Research and Mathematical Computing</a>
		</li>
		
		<li class="breadcrumb-item">
			<a href="../../../notes/notes_by_chapter/index.html">Notes by chapter</a>
		</li>
		
		<li class="breadcrumb-item active">
			Multivariable Functions
		</li>
		<li class="ml-auto">
			<button class="navbar-toggler p0" type="button" data-toggle="collapse" data-target="#navbarToggleCustomise" aria-controls="navbarToggleCustomise" aria-expanded="false" aria-label="Toggle customisations panel">
				<i class="fa fa-cog" aria-hidden="true" title="Toggle customisations panel"></i> <span class="sr-only">Toggle customisations panel</span>
			</button>
		</li>
	</ul>
</nav>


        <header>
            
            
        </header>
        <main>
            
    <div class="container mt-3">
        <div class="row">
            
            <div id="sidebar" class="col-md-3">
                <nav class="mb-3" id="chapterTOC" data-toggle="toc">
                    <ul class="nav navbar-nav">
                        
                        
                        
                        <li><a id="pdf-link" class="nav-link" href="../../../notes/notes_by_chapter/multivariable_functi/multivariable_functi.pdf" target="_blank"><i class="fa fa-file-pdf-o" aria-hidden="true" title="Download as PDF"></i>&nbsp;Download as PDF</a></li>
                        
                    </ul>
                </nav>
            </div>
            <div id="content" class="col-md-9"> 
            
            
<!-- Latex Chapter/Part -->
<h1 id="a0000000637">Multivariable Functions</h1>
<section class="section">
<h2 id="a0000000638">3.1 Functions of More than One Variable</h2>
<p>
All your previous work has been on functions of one variable, for example <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x)=e^{x}+x^{2}</script></span></span> This is a map from a real number <script type="math/tex">x</script> in a domain <script type="math/tex">D\in \mathbb {R}</script> of a function <script type="math/tex">f</script> to a real number <script type="math/tex">y=f(x)</script> in the range <script type="math/tex">R\in \mathbb {R}</script> of <script type="math/tex">f</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f:x \rightarrow y=f(x)</script></span></span>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0002.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.1</span>
<span class="caption_text">Plot of <script type="math/tex">f:x \rightarrow y=f(x)</script></span>
</figcaption> </div>
</figure>
<p>
In this module we will generalise this to allow functions between finite real dimensional (Euclidean) spaces <script type="math/tex">\mathbb {R}^{n}</script> and <script type="math/tex">\mathbb {R}^{m}</script> for integer <script type="math/tex">n, m \ge 1</script>, where <script type="math/tex">\mathbb R</script> is the set of all real numbers. 
</p>
<p>
<b class="bf">Definition: (Multivariate Function)</b> <span class="rm"><p>
A <i class="it">function</i> <script type="math/tex">F:D \to \mathbb R^ m</script> from a subset <script type="math/tex">D</script> of <script type="math/tex">\mathbb {R}^ n</script> to <script type="math/tex">\mathbb R^ m</script> is an assignment of a unique point <script type="math/tex">f(x_1, \dots , x_ n)\in \mathbb R^ m</script> for each point <script type="math/tex">(x_1, \dots , x_ n)\in D</script>. The set <script type="math/tex">D</script> is called the <i class="it">domain</i> of <script type="math/tex">F</script> and the set of all points <script type="math/tex">F(x_1, \dots , x_ n)</script> obtained from the domain is called the <i class="it">range</i> of <script type="math/tex">F</script>. 
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
Suppose <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\sqrt{4-x^2-y^2.}</script></span></span> If we restrict ourselves to only real values of the square root, the domain <script type="math/tex">D</script> is the disk of radius 2 centred at the origin: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\textcolor{red}{D=\{ (x,y) \in R^{2}\;  | \;  x^2+y^2\leqslant 4\} .}</script></span>
<p>
 The function <script type="math/tex">f</script> is thus <script type="math/tex">f:D\to \mathbb R</script>. (Strictly speaking the function <script type="math/tex">f</script> is <script type="math/tex">f:D\to \mathbb R^{+}</script>.) 
</p>
<figure id="mtuple">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0004.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.2</span>
<span class="caption_text">Domain of <script type="math/tex">z=\sqrt{4-x^{2}-y^{2}}</script></span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b> Suppose <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\frac{1}{x^{2}+y^{2}}.</script></span></span> The function is well defined (i.e., has finite real values) for all points except <script type="math/tex">(x,y)=(0,0)</script>, where the function has no finite value. Hence the domain <script type="math/tex">D</script> is 
</p>
<span class="dmath"><script type="math/tex; mode=display">\textcolor{red}{D=\{ (x,y) \in \mathbb R^{2}\;  | \;  (x,y)\ne (0,0)\} .}</script></span>
<p>
 The function <script type="math/tex">f</script> is thus <script type="math/tex">f:D\to \mathbb R</script>. 
</p>
<p>
Where there is no confusion, we will often write <script type="math/tex">F:\mathbb R^ n\to \mathbb R^ m</script> instead of <script type="math/tex">F:D\to \mathbb R^ m</script> with the understanding that the function may not be defined on all of <script type="math/tex">\mathbb R^ n</script> but rather on its subset <script type="math/tex">D</script>, the domain. 
</p>
<p>
<b class="bf">Example:</b> If <script type="math/tex">x</script> is the radius of a right cylinder and <script type="math/tex">y</script> is its height, the volume is given by a function <script type="math/tex">F: (x,y)\in \mathbb R^{2}\to z\in \mathbb R</script> such that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=\pi x^{2}y.</script></span></span> Clearly in the context of radius and height measurements, <script type="math/tex">x</script> and <script type="math/tex">y</script> are both here positive, so the domain <script type="math/tex">D</script> is <script type="math/tex">D=\{ (x,y)\in \mathbb R^{2} \;  | \;  x,y\ge 0\} </script>. However the formula for <script type="math/tex">z</script> is valid for all real values of <script type="math/tex">x</script> and <script type="math/tex">y</script>, so, in a mathematical context, we are able to drop reference to a subdomain of <script type="math/tex">\mathbb R^{2}</script>
</p>
<p>
<b class="bf">Definition: (Multivariable functions between arbitrary numbers of dimensions)</b> A function <script type="math/tex">F: {\mathbb R}^ n\rightarrow {\mathbb R}^ m</script> can be viewed as an ordered <script type="math/tex">m</script>-tuple of functions from <script type="math/tex">{\mathbb R}^ n</script> to <script type="math/tex">{\mathbb R}</script>, which we write as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x_1, \ldots , x_ n) = (f_1(x_1, \ldots , x_ n), \ldots , f_ m(x_1,\ldots , x_ n)),</script></span> </span> where each <script type="math/tex">f_ i: {\mathbb R}^ n\rightarrow {\mathbb R}</script> for <script type="math/tex">1\le i\le m</script> is itself a function from <script type="math/tex">{\mathbb R}^ n</script> to <script type="math/tex">{\mathbb R}</script>.  
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
Suppose <script type="math/tex">F(t)= (t \cos (t), t\sin (t))</script>. The domain is all <script type="math/tex">\mathbb R</script> and <script type="math/tex">F:\mathbb R\to \mathbb R^2</script> is a spiral curve in <script type="math/tex">(x,y)</script> space. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0006.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.3</span>
<span class="caption_text">Plot of <script type="math/tex">F:\mathbb R\to \mathbb R^2</script> curve with <script type="math/tex">F(t)= (t \cos (t), t\sin (t))</script> (for part of the domain of <script type="math/tex">\mathbb R</script>).</span>
</figcaption> </div>
</figure>
<p>
In the notation of the above definition, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{1}(x_{1})=x_{1}\cos x_{1}, \qquad f_{2}(x_{1})=x_{1}\sin x_{1}, \qquad x_{1}=t.</script></span></span>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000639">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">1.1</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
<span class="rm"><p>
If you take a Newtonian classical view of the world (see MATH1057) you may specify a particle at any point in time <script type="math/tex">t</script> by its spatial position in 3-D space <script type="math/tex">(x,y,z)</script> relative to some origin and its associated momenta (= mass <script type="math/tex">\times </script> velocity) in each of three directions <script type="math/tex">(p_{x}, p_{y}, p_{z})</script>. 
</p>
<p>
Hence classical particle specification consists of 6 mappings, <script type="math/tex">F: t \to (x,y,z, p_{x},p_{y},p_{z})</script>, i.e., <script type="math/tex">\mathbb R\to \mathbb R^{6}</script>, i.e., you give me a time <script type="math/tex">t</script> and I have to give you back six functions <script type="math/tex">x(t)</script>, <script type="math/tex">y(t)</script>, <script type="math/tex">z(t)</script>, <script type="math/tex">p_{x}(t)</script>, <script type="math/tex">p_{y}(t)</script>, <script type="math/tex">p_{z}(t)</script> before we can define exactly what the particle is doing. 
</p>
</span>
</p>
</div>
</div>
</p>
<p>
To simplify matters (and because humans can only visualise easily up to three dimensions), many of the examples in this module will focus on <script type="math/tex">\mathbb R^2\to \mathbb R</script>, or <script type="math/tex">\mathbb R^3\to \mathbb R</script>. 
</p>
</span>
</p>
</span>
</p>
</span>
</p>
<section class="subsection">
<h3 id="a0000000640">3.1.1 Explicit and Implicit Functions</h3>
<p>
Functions of a single variable have one of two basic flavours. 
</p>
<section class="subsubsection">
<h4 id="a0000000641">Explicit Function</h4>
<p>
A function is an <b class="bf">explicit function</b> if we have or are given an explicit description of <script type="math/tex">f(x)</script> as a formula in terms of <script type="math/tex">x</script>, for instance a formula like <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x) = x^2 \; \; \;  \mbox{or}\; \; \;  f(x) = \exp (\sin (x+(x^3+1)\cos (2x+76))) + \ln (x^2+2).</script></span></span> More generally an explicit function is one where we have an explicit description of how to calculate the value of <script type="math/tex">f(x)</script> given a value of the input <script type="math/tex">x</script>. 
</p>
<p>
Note that sometimes this does not mean that there is an obvious formula. For example, consider the <i class="it">greatest integer function</i>, where we set <script type="math/tex">\lfloor x \rfloor </script> to be the largest integer that is less than or equal to <script type="math/tex">x</script>. We have an explicit description for <script type="math/tex">\lfloor x\rfloor </script> given <script type="math/tex">x</script> from which we can calculate the function but no (immediately obvious) formula (e.g., given an input <script type="math/tex">x=25.46</script>, the output <script type="math/tex">\lfloor x\rfloor </script> is obviously 25). 
</p>
<p>
An example of an explicit function of two variables <script type="math/tex">\mathbb R^{2}\to \mathbb R</script> is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z = x^2 -y^2 + xy\cos (x+y).</script></span></span> Here we may input any real values of <script type="math/tex">x</script> and <script type="math/tex">y</script> into the right hand side and this generates a unique value of <script type="math/tex">z</script> and we can write the function as <script type="math/tex">z=f(x,y)</script>, i.e., the unique output <script type="math/tex">z</script> on the LHS and all the <script type="math/tex">x</script>, <script type="math/tex">y</script> inputs on the RHS 
</p>
<p>
An example of an explicit function of three variables <script type="math/tex">\mathbb R^{3}\to \mathbb R</script> is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">u = x^{2}+yz+e^{x+y+z}.</script></span></span> Here, we may input (the same) values of <script type="math/tex">x</script>, <script type="math/tex">y</script> and <script type="math/tex">z</script> into the right hand sides of the two (paired) equations and this will generate a pair of values of <script type="math/tex">u</script> and <script type="math/tex">v</script>. 
</p>
<p>
An example of an explicit function of <script type="math/tex">\mathbb R^{3}\to \mathbb R^{2}</script> is <span style="color:#FF0000"><div id="a0000000642">
<script type="math/tex; mode=display">
\begin{align}
 u & = & x^{2}+yz+e^{x+y+z}; \nonumber \\ 
v & =&  \cos (x+z^{2})+xyz. \nonumber 
\end{align}
</script>
</div> </span> Here we input <script type="math/tex">x</script> <script type="math/tex">y</script> and <script type="math/tex">z</script> into the right hand side and this generates a unique values of <script type="math/tex">u</script> and <script type="math/tex">v</script>. 
</p>
</section><section class="subsubsection">
<h4 id="a0000000643">Implicit Function</h4>
<p>
A function is an <b class="bf">implicit function</b> if we have a description of the relationship between two (or more) variables, such as <script type="math/tex">x</script> and <script type="math/tex">y</script>, but the function, either is not, or may not be, written in a form that makes one of the variables explicitly the subject in a uniquely defined way. 
</p>
<p>
A simple example of an implicit function comes from the equation of a circle in the plane with centre the origin and radius 1, namely: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x^2 +y^2 = 1</script></span></span> The function is represented in the form <script type="math/tex">F(x,y)=x^{2}+y^{2}= constant</script>. Here, we cannot solve for <script type="math/tex">y</script> as a function of <script type="math/tex">x</script> in a way that is unique for all values <script type="math/tex">x</script> in the domain. Specifically, if we solve for <script type="math/tex">y</script>, we get <script type="math/tex">y = \pm \sqrt{x^2-1}</script>, and so for each <script type="math/tex">-1 <x <1</script>, there are two possible values of <script type="math/tex">y</script> and this violates the definition of function as discussed (albeit briefly) above. 
</p>
<p>
All the following are (non-specific) examples of how implicit functions are generally represented, i.e., as a function of the all variables = a constant (often zero, without loss of generality): <span style="color:#FF0000"> <div id="a0000000644">
<script type="math/tex; mode=display">
\begin{align}
 \ln (x+y)-1=0; \nonumber \\ 
F(x,y)=0 ; \nonumber \\ 
x^{2}+y^{2}+z^{2}-R^{2}=0;\nonumber \\ 
G(x,y,z)=0 \nonumber ; 
\end{align}
</script>
</div> </span> or <span style="color:#FF0000"> <span class="dmath"><script type="math/tex; mode=display">\left\{ \begin{array}{c}U(x_{1},x_{2},\dots , x_{n})=0 \\ V(x_{1},x_{2},\dots , x_{n})=0\end{array}\right.</script></span> </span>
</p>
<p>
In each case (and for given <script type="math/tex">F</script>, <script type="math/tex">G</script>, <script type="math/tex">U</script>, <script type="math/tex">V</script>), it may or may not be possible to solve the equational relation explicitly in terms of one of the variables. When it is possible or not will be studied later on. Actually we will not care whether an explicit representation is possible or not and we will just develop maths that can cope with both types of representations. 
</p>
</section>
</section>
</section><section class="section">
<h2 id="a0000000645">3.2 Graphical Representations of Multivariable Functions</h2>
<p>
Graphically we can represent <script type="math/tex">y=f(x)</script> by a set of points <script type="math/tex">(x,f(x))</script> in the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0002.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.4</span>
<span class="caption_text">Fig to be done</span>
</figcaption> </div>
</figure>
<p>
By contrast the explicit function <script type="math/tex">z =f(x,y)</script> can represent the height <script type="math/tex">z</script> of a surface above the <script type="math/tex">(x,y)</script> plane in the <script type="math/tex">(x,y,z)</script> space 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0008.jpg" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.5</span>
<span class="caption_text">Plot of a multivariate function where the height of the function is <script type="math/tex">z=f(x,y)</script> and is given by <script type="math/tex">f(x,y)=\sin (x)+\sin (y)</script></span>
</figcaption> </div>
</figure>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000646">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">2.1</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
<span class="rm">Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=1-x-y, \qquad 0\le x\le 1, \qquad 0\le y\le 1.</script></span></span> This maps the rectangular set of points <script type="math/tex">0\le x\le 1</script>, <script type="math/tex">0\le y\le 1</script> to a 2-D plane in <script type="math/tex">\mathbb R^{3}</script> passing through the (obvious) points <script type="math/tex">(1,0,0)</script>, <script type="math/tex">(0,1,0)</script> and <script type="math/tex">(0,0,1)</script>. <figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0010.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.6</span>
<span class="caption_text">Surface <script type="math/tex">z=1-x-y</script> plotted in positive octant <script type="math/tex">x\ge 0, y\ge 0, z\ge 0</script>.</span>
</figcaption> </div>
</figure> </span>
</p>
</div>
</div>
</p>
<p>
<div class="thmwrapper example_thmwrapper" id="a0000000647">
<div class="thmheading example_thmheading">
<span class="thmcaption example_thmcaption">
    Example
    </span>
<span class="thmlabel example_thmlabel">2.2</span>
</div>
<div class="thmcontent example_thmcontent">
<p>
<span class="rm"><p>
Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\sqrt{9-x^{2}-y^{2}},</script></span></span> The domain of this real function is given by the circle 
</p>
<span class="dmath"><script type="math/tex; mode=display">\textcolor{red}{D=\{ (x,y) \;  | \;  x^2+y^2\leqslant 9\} ,}</script></span>
<p>
 since any other values of <script type="math/tex">(x,y)</script> lead to complex numbers. 
</p>
<p>
Now if we set <script type="math/tex">z=f(x,y)</script>, then we have to plot the function <script type="math/tex">z=\sqrt{9-x^{2}-y^{2}}</script>. Squaring both sides and rearranging, we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x^{2}+y^{2}+z^{2}=9.</script></span></span> This says that the square of the distance from the origin of all the points on this surface in <script type="math/tex">(x,y,z)</script> space must be 9. Hence this is the equation of the surface of a sphere of radius 3. 
</p>
<p>
Now reverting back to the actual equation <script type="math/tex">z=\sqrt{9-x^{2}-y^{2}}</script>, if we assume that the square root function is positive only, then <script type="math/tex">f(x,y)</script> represents the surface of a hemisphere, centred the origin, radius 3 <b class="bf">above</b>, the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0012.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.7</span>
<span class="caption_text"><script type="math/tex">z=\sqrt{9-x^{2}-y^{2}}</script> where the positive square root is taken.</span>
</figcaption> </div>
</figure>
<p>
 The corresponding function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=-\sqrt{9-x^{2}-y^{2}},</script></span></span> represents the surface of a hemisphere, centred the origin, radius 3, <b class="bf">below</b> the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0014.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.8</span>
<span class="caption_text"><script type="math/tex">z=-\sqrt{9-x^{2}-y^{2}}</script> where the negative square root has been taken.</span>
</figcaption> </div>
</figure>
</span>
</p>
</div>
</div>
</p>
<section class="subsubsection">
<h4 id="a0000000648">Graphs in <script type="math/tex">\mathbb R^{n}, n>3</script></h4>
<p>
All the examples above are <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. We were able to plot these as 2D surfaces in 2+1=3D space. 
</p>
<p>
Consider a function 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">w=f(x,y,z)=x^{2}+y^{2}+z^{2}</script></span></span>
</p>
<p>
This is a mapping <script type="math/tex">\mathbb R^{3}\to \mathbb R</script>. If we wanted to draw both the domain and range on the same plot, we would need to be able to visualise a 3 dimensional <b class="bf">hypersurface</b> in 3+1=4 dimensional space. Clearly this is not possible (in our concept of the world!). 
</p>
<p>
Hence at best we might need to consider only partial representations of the graph. For example, we might consider what the surface <script type="math/tex">w=9</script> looks like and plotting it in <script type="math/tex">4-1=3</script> dimensional space <script type="math/tex">(x,y,z)</script>. We could then re-plot the graph for different chosen values of <script type="math/tex">w</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0016.png" style="width:144.54pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.9</span>
<span class="caption_text">Plot of <script type="math/tex">w=9</script> where <script type="math/tex">w=x^{2}+y^{2}+z^{2}</script>, i.e., a sphere of radius 3 in <script type="math/tex">(x,y,z)</script> space.</span>
</figcaption> </div>
</figure>
<p>
Hence, to avoid brain overload, when we want to visualise graphs, we shall henceforth largely stick to mappings of <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. 
</p>
</section>
</section><section class="section">
<h2 id="a0000000649">3.3 Contours</h2>
<p>
An alternative way of representing surfaces of the form <script type="math/tex">z = f (x, y)</script> is to use a contour plot. This is exactly what is used to represent the height of the ground on an Ordnance Survey map<a class="footnote" href="#a0000000650">
<sup class="footnotemark">1</sup>
</a>. 
</p>
<p>
The following diagram is based on data from Mathematica and depicts a relief and contour plot of Schielhallion. <a href="https://en.wikipedia.org/wiki/Schiehallion_experiment">Schielhallion</a> is a mountain in Perthshire in Scotland. Due to its distinctive shape, size and (lack of) proximity to other hills/mountains, it was chosen (initially by by the astronomer the Reverend Nevil Maskylene) in the 1770-1790s to verify the mean density of the earth . Those experiments required the calculation of the volume of the mountain, which in turn required the development of two vital mathematical techniques. Contour lines were invented (by Charles Hutton) to map out the level heights around the mountain so that it could be approximated as a series of column-like structures. The volume of these columns was calculated by the new technique of numerical integration.<a class="footnote" href="#a0000000651">
<sup class="footnotemark">2</sup>
</a>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0018.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.10</span>
<span class="caption_text">Left: Relief plot of Schielhallion. Right: Contour plot of the same region. </span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Definition: (Contour):</b> A contour (or level set) of a graph of <script type="math/tex">z = f(x,y)</script> is the set of points <script type="math/tex">(x,y)\in \mathbb R^{2}</script> satisfying <script type="math/tex">f(x,y)=c</script> for a chosen <script type="math/tex">c\in \mathbb R</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">L_ c = L_ c (f) = \{  (x,y)\in {\mathbb R}^2\:  |\:  f(x,y) = c\} .</script></span> </span>
</p>
<p>
In words, the contour (or level set of height <script type="math/tex">c</script>) is the set of points in the domain at which the function takes the value <script type="math/tex">c</script>. When presented in this form, the equation for contours is an implicit representation. 
</p>
<p>
One immediate consequence of this is that level sets of different heights are necessarily disjoint: by the definition of function, there cannot exist a point at which the function takes on two different <script type="math/tex">z</script>-values simultaneously. 
</p>
<p>
A contour plot is then the union of the contours for different values of <script type="math/tex">c\in \mathbb R</script>. It is a 2-D plot of a 3-D surface. 
</p>
<p>
<b class="bf">Example:</b> Determine the level contours of the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=1-x-y</script></span> </span>
</p>
<ul class="itemize" id="a0000000652">
<li id="a0000000653"> <p>
The level sets are given by <script type="math/tex">c=f(x,y)</script> for <script type="math/tex">c\in \mathbb R</script>. 
</p>
</li>
<li id="a0000000654"> <p>
Hence we have <script type="math/tex">c=1-x-y</script>. 
</p>
</li>
<li id="a0000000655"> <p>
Rearranging we obtain an explicit relation of <script type="math/tex">y=1-c-x</script>. 
</p>
</li>
<li id="a0000000656"> <p>
These are straight lines in the <script type="math/tex">(x,y)</script> plane of slope -1 and <script type="math/tex">y</script>-intercept <script type="math/tex">1-c</script>. 
</p>
</li>
<li id="a0000000657"> <p>
The contours may then be plotted as follows: 
</p>
</li>
</ul>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0020.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.11</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=1-x-y</script> in the positive <script type="math/tex">(x,y)</script>-plane (and plotted on the surface in the positive octant). These are curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">1-x-y=c</script>, or <script type="math/tex">y=-x+1-c</script>. </span>
</figcaption> </div>
</figure>
<p>
In practice we would only draw the 2-D plot on the right, since the whole point is to avoid having to cope with drawing 3-D surfaces. However in these first examples, we plot both the contours on the 3-D surface and in the 2-D <script type="math/tex">(x,y)</script> plane, just to give an idea of what the contours are and how they relate to the surface. 
</p>
<p>
<b class="bf">Example:</b> Determine the level sets of the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}+y^{2}</script></span> </span>
</p>
<ul class="itemize" id="a0000000658">
<li id="a0000000659"> <p>
<span style="color:#FF0000">The level sets are given by <script type="math/tex">c=f(x,y)</script>.</span>
</p>
</li>
<li id="a0000000660"> <p>
<span style="color:#FF0000">Hence we have <script type="math/tex">c=x^{2}+y^{2}</script>.</span>
</p>
</li>
<li id="a0000000661"> <p>
<span style="color:#FF0000">We see that for real <script type="math/tex">x</script> and <script type="math/tex">y</script>, <script type="math/tex">x^{2}+y^{2}\ge 0</script>. Hence <script type="math/tex">c\ge 0</script> only. So when</span>
</p>
<ul class="itemize" id="a0000000662">
<li id="a0000000663"> <p>
<span style="color:#FF0000"><script type="math/tex">c<0</script>: No real contours exist.</span>
</p>
</li>
<li id="a0000000664"> <p>
<span style="color:#FF0000"><script type="math/tex">c=0</script>: <script type="math/tex">x^{2}+y^{2}=0 \Rightarrow (x,y)=(0,0)</script>.</span>
</p>
</li>
<li id="a0000000665"> <p>
<span style="color:#FF0000"><script type="math/tex">c>0</script>: <script type="math/tex">x^{2}+y^{2}=c \Rightarrow </script> circles centred <script type="math/tex">(0,0)</script>, radius <script type="math/tex">\sqrt{c}</script></span>. 
</p>
</li>
</ul>
</li>
<li id="a0000000666"> <p>
The contours may then be plotted as follows: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0022.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.12</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=x^{2}+y^{2}</script>. These are curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}+y^{2}=c</script>, circles centre the origin of radius <script type="math/tex">\sqrt{c}</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000667"> <p>
Note from the analysis above, the function <script type="math/tex">f(x,y)=x^{2}+y^{2}</script> clearly has a local <b class="bf">minimum</b> value at <script type="math/tex">(0,0)</script>. If you walk away from the origin in whichever direction on the surface <script type="math/tex">z=x^{2}+y^{2}</script>, you will always walk uphill. 
</p>
</li>
<li id="a0000000668"> <p>
Clearly if you consider the function <script type="math/tex">f(x,y)=-(x^{2}+y^{2})</script>, you will have similar shapes of contours, but taking the corresponding negative values of <script type="math/tex">c</script>. Hence, for that function, the origin is a <b class="bf">maximum</b>. If you walk away from the origin in whichever direction on the surface <script type="math/tex">z=-(x^{2}+y^{2})</script>, you will always walk downhill. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0024.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.13</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=-(x^{2}+y^{2})</script>. These are curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}+y^{2}=-c</script>, but clearly <script type="math/tex">c<0</script> and decreases as <script type="math/tex">x^{2}+y^{2}</script> increases. They are still circles, centre the origin, of radius <script type="math/tex">\sqrt{-c}</script>.</span>
</figcaption> </div>
</figure>
</li>
</ul>
<p>
<b class="bf">Remark:</b> <span class="rm"><p>
If the contour levels <script type="math/tex">c</script> are equally spaced, clearly the closer the contour lines are together on the <script type="math/tex">(x,y)</script> plot, the “steeper” the surface is in that direction. 
</p>
<p>
<b class="bf">Example:</b> Determine the level contours of the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}-y^{2}</script></span> </span>
</p>
<ul class="itemize" id="a0000000669">
<li id="a0000000670"> <p>
<span style="color:#FF0000">The level sets are given by <script type="math/tex">c=f(x,y)</script>.</span>
</p>
</li>
<li id="a0000000671"> <p>
<span style="color:#FF0000">Hence we have <script type="math/tex">c=x^{2}-y^{2}</script>.</span>
</p>
</li>
<li id="a0000000672"> <p>
<span style="color:#FF0000">We see that for real <script type="math/tex">x</script> and <script type="math/tex">y</script>, <script type="math/tex">x^{2}-y^{2}\ge 0</script> may be positive, zero or negative.</span>
</p>
</li>
<li id="a0000000673"> <p>
<span style="color:#FF0000">For <script type="math/tex">c=0</script> we have <script type="math/tex">x^{2}=y^{2}</script> or <script type="math/tex">y=\pm x</script>. These are straight lines through the origin.</span>
</p>
</li>
<li id="a0000000674"> <p>
The contours may then be plotted as follows: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0026.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.14</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=x^{2}-y^{2}</script>. These are still curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}-y^{2}=c</script>. These are (for <script type="math/tex">c\ne 0</script>) hyperbolae. The contours corresponding to <script type="math/tex">c=0</script> are the lines <script type="math/tex">y=\pm x</script>. The regions <script type="math/tex">y<|x|</script> have <script type="math/tex">c>0</script>, the regions <script type="math/tex">y>|x|</script> have <script type="math/tex">c<0</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000675"> <p>
This is an example of a simple <b class="bf">saddle</b> point. The region around the origin is separated into four quadrants. 
</p>
</li>
<li id="a0000000676"> <p>
Walking away from the origin on the surface <script type="math/tex">z=x^{2}-y^{2}</script> into two of these quadrants (<script type="math/tex">|y|>|x|</script>) will result in you going downhill. 
</p>
</li>
<li id="a0000000677"> <p>
Walking away from the origin on the surface <script type="math/tex">z=x^{2}-y^{2}</script> into the other two quadrants (<script type="math/tex">|y|<|x|</script>) will result in you walking uphill. 
</p>
</li>
<li id="a0000000678"> <p>
Walking away from the origin on the surface <script type="math/tex">z=x^{2}-y^{2}</script> on the lines <script type="math/tex">y=\pm x</script> and you will keep the same height of 0 and neither walk up nor downhill. 
</p>
</li>
</ul>
<p>
More complicated contour plots can be drawn using computer packages, e.g., Maple, Mathematica or Matlab. Further examples are available on Blackboard. 
</p>
</span>
</p>
</section><section class="section">
<h2 id="a0000000679">3.4 Limits and Continuity</h2>
<section class="subsection">
<h3 id="a0000000680">3.4.1 Definition of limits in <script type="math/tex">\mathbb R^{2}</script></h3>
<p>
 For functions of a single variable, the concept of the limit 
</p>
<span class="dmath"><script type="math/tex; mode=display">\lim _{x\to a}f(x)</script></span>
<p>
 was discussed last semester. 
</p>
<p>
Recall that a function is continuous at <script type="math/tex">x = a</script> iff as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\lim _{x\to a^{+}}f(x) = \lim _{x\to a^{-}}f(x)= f(a).</script></span>
<p>
In detail this means three conditions: 
</p>
<ul class="itemize" id="a0000000681">
<li id="a0000000682"> <p>
First, <script type="math/tex">f</script> has to be defined at <script type="math/tex">a</script> (i.e., <script type="math/tex">c</script> must live in the domain of <script type="math/tex">f</script>). 
</p>
</li>
<li id="a0000000683"> <p>
Second, the limits on both sides of <script type="math/tex">a</script> has to exist. 
</p>
</li>
<li id="a0000000684"> <p>
Third, the value of this limit must equal <script type="math/tex">f(a)</script>. 
</p>
</li>
</ul>
<p>
All these concepts can be extended to multivariate functions as follows. 
</p>
<p>
<b class="bf">Definition: (Limit)</b> Given a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script>. We say <script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} f(x,y)=L,</script> whenever 
</p>
<ol class="enumerate" id="a0000000685" style="list-style: none">
<li id="a0000000686" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
every neighbourhood of the point <script type="math/tex">(a,b)</script> contains a point of the domain of <script type="math/tex">f</script> different from <script type="math/tex">(a,b)</script>, and 
</p>
</li>
<li id="a0000000687" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
for every <script type="math/tex">\varepsilon >0</script>, there exists <script type="math/tex">\delta > 0</script> such that if <script type="math/tex">(x,y)</script> is in the domain and satisfies 
</p>
<span class="dmath"><script type="math/tex; mode=display">0<\sqrt{(x-a)^2+(y-b)^2}< \delta ,</script></span>
<p>
 then <script type="math/tex">|f(x,y)-L|<\varepsilon </script>. 
</p>
</li>
</ol>
<p>
It’s much better to draw a diagram to explain what we mean: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0028.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.15</span>
<span class="caption_text"><script type="math/tex">\forall </script> <script type="math/tex">(x,y)</script> in this disk, we we must have <script type="math/tex">|(f(x,y)-L|\le \epsilon </script> if the limit of <script type="math/tex">f</script> at <script type="math/tex">(a,b)</script> exists.</span>
</figcaption> </div>
</figure>
<p>
 In words this means that for a limit to exist at <script type="math/tex">(a,b)</script>, the value of the function <script type="math/tex">f(x, y)</script> must approach the same value <script type="math/tex">L</script> as <script type="math/tex">(x, y)\to (a,b)</script> from <b class="bf">whichever</b> route you take. 
</p>
<p>
Sometimes it is possible to use the (dreaded) <script type="math/tex">\varepsilon , \delta </script> definition. 
</p>
<p>
<b class="bf">Example:</b> Let us find <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y) \to (0,0)}} (x^2 +y^2+7).</script></span></span> Note that as <script type="math/tex">(x,y)</script> tends to <script type="math/tex">(0,0)</script>, the function approaches the value <script type="math/tex">7</script>. So, we shall try to prove that this is the limit. The following steps gives the standard algorithm for proving the limit. 
</p>
<ul class="itemize" id="a0000000688">
<li id="a0000000689"> <p>
The domain is the <script type="math/tex">(x,y)</script> plane. So every neighbourhood of the point <script type="math/tex">(0,0)</script> is in the domain of <script type="math/tex">f</script> (condition (i) above). 
</p>
</li>
<li id="a0000000690"> <p>
We need to show that for any <script type="math/tex">\varepsilon >0</script>, there exists <script type="math/tex">\delta > 0</script> such that if <script type="math/tex">0<\sqrt{x^2+y^2}< \delta </script>, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">|{x^2 +y^2}+7-7 |<\varepsilon \qquad \Rightarrow \qquad |{x^2 +y^2} |<\varepsilon</script></span> </span>
</p>
</li>
<li id="a0000000691"> <p>
Obviously, if we now set <script type="math/tex">\delta =\sqrt{\varepsilon }</script> for any <script type="math/tex">\varepsilon >0</script> we have found the <script type="math/tex">\delta > 0</script> to satisfy the inequality condition (ii) in the definition above. 
</p>
</li>
<li id="lim-0"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y) \to (0,0)}} (x^2 +y^2+7)=7.</script></span></span>
</p>
</li>
</ul>
<p>
 This looks like a rather obvious answer. In the next example, the value of the limit at the limit point is not so obvious. 
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
Show that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y) \rightarrow (0,0)}} \frac{x^{2}y}{x^2 +y^2} =0.</script></span></span>
</p>
<ul class="itemize" id="a0000000692">
<li id="a0000000693"> <p>
The domain is the whole <script type="math/tex">(x,y)</script>-plane, excluding the origin, where the functional form is 0/0, so ambiguous. 
</p>
</li>
<li id="a0000000694"> <p>
Nevertheless, every neighbourhood of the point <script type="math/tex">(0,0)</script> is in the domain of <script type="math/tex">f</script> (condition (i) above). 
</p>
</li>
<li id="a0000000695"> <p>
Now, we need to show that for <script type="math/tex">\varepsilon >0</script>, there exists <script type="math/tex">\delta > 0</script> such that if <script type="math/tex">0<\sqrt{x^2+y^2}< \delta </script>, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left|\frac{x^{2}y}{x^2 +y^2} -0\right|<\varepsilon .</script></span></span>
</p>
</li>
<li id="a0000000696"> <p>
A shortcut that you can often deploy in these types of examples is to convert to polar coordinates: <script type="math/tex">x=r\cos \theta </script>, <script type="math/tex">y=r\sin \theta </script>. For then, since <script type="math/tex">|\cos \theta |\le 1</script> and <script type="math/tex">|\sin \theta |\le 1</script> and <script type="math/tex">r\ge 0</script>, we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left| \frac{x^{2}y}{x^2 +y^2} -0\right| = \left| \frac{r^{3}\cos ^{2}\theta \sin \theta }{r^{2}}\right|=\left| r\cos ^{2}\theta \sin \theta \right|< |r| =r</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \left| \frac{x^{2}y}{x^2 +y^2} -0\right| < r</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \left| \frac{x^{2}y}{x^2 +y^2} -0\right| < \sqrt{x^{2}+y^{2}}</script></span></span>
</p>
</li>
<li id="a0000000697"> <p>
Hence comparing with the definition of the limit above, if we see that if there has to be a <script type="math/tex">\delta >0</script> such that the LHS has to be less than <script type="math/tex">\epsilon >0</script> whenever <script type="math/tex">0< \sqrt{x^{2}+y^{2}}< \delta </script>, a natural choice is <script type="math/tex">\delta =\epsilon </script>. 
</p>
</li>
</ul>
</span>
</p>
</section><section class="subsection">
<h3 id="a0000000698">3.4.2 Sums, Products, Ratios, Composition of Limits in <script type="math/tex">\mathbb R^{2}</script></h3>
<p>
The above formal <script type="math/tex">\varepsilon , \delta </script> definition is usually too cumbersome to use in practice. Fortunately, to save a lot of pain, the following lemma holds. It speeds up limit-finding when functions are well behaved (proof of the lemma is not required). 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="limit_properties">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">4.1</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
 Let <script type="math/tex">f: \mathbb R^2 \to \mathbb R</script> and <script type="math/tex">g: \mathbb R^2 \to \mathbb R</script>. Suppose 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x,y)\to (a,b)}} f(x,y)=L\; \; \;  \mbox{and}\; \; \;  \displaystyle {\lim _{(x,y)\to (a,b)}} g(x,y)=M.</script></span>
<p>
 Then 
</p>
<ol class="enumerate" id="a0000000699" style="list-style: none">
<li id="a0000000700" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
<script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} (f(x,y)\pm g(x,y))= L\pm M</script>, 
</p>
</li>
<li id="a0000000701" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
<script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} (f(x,y) g(x,y)) =LM</script>, 
</p>
</li>
<li id="a0000000702" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
<script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} (f(x,y) /g(x,y)) =L/M</script>, as long as <script type="math/tex">M\neq 0</script>. 
</p>
</li>
<li id="a0000000703" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Given a function <script type="math/tex">h:\mathbb R\to \mathbb R</script> that is continuous at <script type="math/tex">L\in \mathbb R</script>, then <script type="math/tex">\displaystyle {\lim _{(x,y)\to (a,b)}} h(f(x,y)) =h(L)</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example</b> Find the limit of <script type="math/tex">f(x,y)={x^2+xy+5}</script> as <script type="math/tex">(x,y)</script> approaches <script type="math/tex">(1,0)</script>. 
</p>
<ul class="itemize" id="a0000000704">
<li id="a0000000705"> <p>
The domain contains all points of the <script type="math/tex">(x,y)</script>-plane, so the function is expected to exist at the limit point. Also we then have neighbourhood of the limit point that is in the domain. Therefore we expect that a limit may exist. 
</p>
</li>
<li id="a0000000706"> <p>
<script type="math/tex">f</script> is composed of the sum of the functions <script type="math/tex">x^{2}=x\times x</script>, <script type="math/tex">y= x\times y</script> and 5. 
</p>
</li>
<li id="a0000000707"> <p>
We start with the obvious results that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}x=1, \qquad \lim _{(x,y)\to (1,0)}y=0</script></span></span> This means that the limits exist for the basic building blocks of the function. We can now try to apply Lemma <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#limit_properties">4.1</a> as follows. 
</p>
</li>
<li id="quot"> <p>
We can say: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}x^{2}=\lim _{(x,y)\to (1,0)}\left(x \times x\right) = \underbrace{\left(\lim _{(x,y)\to (1,0)}x\right)\times \left(\lim _{(x,y)\to (1,0)}x\right)}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=1\times 1 =1</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}xy=\lim _{(x,y)\to (1,0)}\left(x \times y\right) = \underbrace{\left(\lim _{(x,y)\to (1,0)}x\right)\times \left(\lim _{(x,y)\to (1,0)}y\right)}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=1\times 0 =0</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}5=5</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,0)}(x^{2}+xy+5)=\underbrace{\lim _{(x,y)\to (1,0)}x^{2}+\lim _{(x,y)\to (1,0)}xy+\lim _{(x,y)\to (1,0)}5}_{\rm (i) \  of \  Lemma \  \ref{limit_ properties}}=1+0+6=6</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b>  Find the limit of <script type="math/tex">f(x,y)=\displaystyle {{3x}\over {x+4y}}</script> as <script type="math/tex">(x,y)</script> approaches <script type="math/tex">(1,1)</script>. 
</p>
<ul class="itemize" id="a0000000708">
<li id="a0000000709"> <p>
The domain contains the point <script type="math/tex">(x,y)=(1,1)</script>. 
</p>
</li>
<li id="a0000000710"> <p>
The locus of points where the function is not defined is the straight line <script type="math/tex">y=-x/4</script>. This line passes nowhere near the limit point. Hence, we then have neighbourhood of the limit point that is in the domain. 
</p>
</li>
<li id="a0000000711"> <p>
So the function is expected to exist at the limit point. We can now try to apply Lemma <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#limit_properties">4.1</a> as follows. 
</p>
</li>
<li id="a0000000712"> <p>
We obviously have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}x=1, \qquad \lim _{(x,y)\to (1,1)}y=1</script></span></span>
</p>
</li>
<li id="a0000000713"> <p>
Hence we can say: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}3x=\underbrace{3\times \lim _{(x,y)\to (1,1)}x}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=3\times 1 =3</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}x+4y=\underbrace{\lim _{(x,y)\to (1,1)}x+\lim _{(x,y)\to (1,1)}4y}_{\rm (i) \  of \  Lemma \  \ref{limit_ properties}}=1+\underbrace{4\times \lim _{(x,y)\to (1,1)}y}_{\rm (ii) \  of \  Lemma \  \ref{limit_ properties}}=1+4=5\ne 0</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (1,1)}\frac{3x}{x+4y}=\underbrace{\frac{\lim _{(x,y)\to (1,1)}{3x}}{\lim _{(x,y)\to (1,1)}x+4y}}_{\rm (iii) \  of \  Lemma \  \ref{limit_ properties}}=\frac{3}{5}</script></span></span>
</p>
</li>
</ul>
</section><section class="subsection">
<h3 id="a0000000714">3.4.3 Showing that limits do not exist</h3>
<p>
 Sometimes, you have to decide whether the limit exists or not. The following examples illustrate how the requirement that the <script type="math/tex">f(x,y)</script> approaches the same limit, no matter how the limit point is approached, is actually incredibly restrictive. 
</p>
<p>
<b class="bf">Example:</b> If <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\left\{ \begin{array}{cc}x^{2}/(x^{2}+y^{2}) &  (x,y)\ne 0 \\ 1 & (x,y)=0\end{array}\right.</script></span> </span> does <script type="math/tex">\lim _{(x,y)\to (0,0)}</script> exist? 
</p>
<ul class="itemize" id="a0000000715">
<li id="a0000000716"> <p>
The functional form <script type="math/tex">x^{2}/(x^{2}+y^{2})</script> is not defined when <script type="math/tex">(x,y)=(0,0)</script>, since it is of the form <script type="math/tex">0/0</script> (and we can’t use Lemma 2.4.1 part iii, since <script type="math/tex">M=0</script>). 
</p>
</li>
<li id="a0000000717"> <p>
However the function is <b class="bf">defined</b> to have the value 1 at the limit point. 
</p>
</li>
<li id="a0000000718"> <p>
Hence the function <script type="math/tex">f</script> <b class="bf">is</b> defined for the entire <script type="math/tex">(x,y)</script> plane, so it makes sense to ask if a limit exists. 
</p>
</li>
<li id="a0000000719"> <p>
The key thing we have to test is <b class="bf">whether the limit is the same regardless of how we approach the limit point</b>. We proceed as follows. 
</p>
</li>
<li id="a0000000720"> <p>
If we approach the limit point <script type="math/tex">(0,0)</script> along <script type="math/tex">y=0</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,0)=\frac{x^{2}}{x^{2}+0^{2}}=1 \qquad \Rightarrow \qquad \lim _{x\to 0}f(x,0)=1=f(0,0)</script></span> </span> This suggests that the limit may exist and be 1. However we need to check <b class="bf">every possible approach!</b>
</p>
</li>
<li id="a0000000721"> <p>
If we approach the limit point <script type="math/tex">(0,0)</script> along <script type="math/tex">x=0</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(0,y)=\frac{0^{2}}{0^{2}+y^{2}}=0 \qquad \Rightarrow \qquad \lim _{y\to 0}f(0,y)=0</script></span> </span>
</p>
</li>
<li id="a0000000722"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{y\to 0}f(0,y)\ne \lim _{x\to 0}f(x,0)</script></span> </span> and so the limit depends on how the limit point is approached, so the limit <b class="bf">is not unique</b> and so the limit <b class="bf">does not exist</b>! 
</p>
</li>
<li id="a0000000723"> <p>
In fact, consider an approach to the limit point at the origin along the straight lines <script type="math/tex">y=\alpha x</script>. Inserting this into the function we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,\alpha x)=\frac{x^{2}}{x^{2}+\alpha ^{2}x^{2}}=\frac{1}{1+\alpha ^{2}}, \qquad x\ne 0</script></span></span> Hence if we approach along <b class="bf">any</b> straight line, the limit will be different, and so does not exist. In practice it suffices to show that there is ambiguity between just two different ways of approaching. 
</p>
</li>
<li id="a0000000724"> <p>
A graph of the function is shown below, which helps to explain the ambiguity in the limit. Basically, the surface is vertical at the origin. Any curve you chose to take to walk towards the origin will therefore intersect at different heights, depending on how it enters the origin. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0030.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.16</span>
<span class="caption_text">Surface <script type="math/tex">z=f(x,y)=x^{2}/(x^{2}+y^{2})</script> (left). Values of function <script type="math/tex">f(x,\alpha x)</script> along the lines <script type="math/tex">y=\alpha x</script> (right), which take different values <script type="math/tex">\alpha ^{2}/(1+\alpha ^{2})</script> at the origin <script type="math/tex">(x,y)=(0,0)</script>, depending on the value of <script type="math/tex">\alpha </script>. </span>
</figcaption> </div>
</figure>
</li>
</ul>
<p>
This explains why the limit does not exist in this case. The definition of a limit above basically says that the value of a function must be unique at a point. Clearly in this case the function can take any value you like at <script type="math/tex">(x,y)=(0,0)</script> since it is vertical there. 
</p>
<p>
This next example shows the danger of relying on approaches to the limit point along straight lines to determine whether a limit exists or not. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=\frac{2x^{2}y}{x^{4}+y^{2}}</script></span></span> Investigate the limiting behaviour as <script type="math/tex">(x,y)\to (0,0)</script>. We can’t use Lemma 2.4.1 since at the limit point we have <script type="math/tex">0/0</script>, i.e., <script type="math/tex">M=0</script>. 
</p>
<ul class="itemize" id="a0000000725">
<li id="a0000000726"> <p>
Suppose we consider the behaviour of the function along any path with <script type="math/tex">y=\alpha x</script>. We have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,\alpha x)=\frac{2x^{2}\alpha x}{x^{4}+\alpha ^{2}x^{2}}=\frac{2\alpha x^{3}}{x^{2}(x^{2}+\alpha ^{2})}=\frac{2\alpha x}{(x^{2}+\alpha ^{2})}</script></span></span> Hence approaching the limit point along any straight line (<script type="math/tex">\alpha \ne 0</script>) into the origin has <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{x\to 0}f(x,\alpha x)=\lim _{x\to 0}\frac{2\alpha x}{(x^{2}+\alpha ^{2})}=\frac{0}{\alpha ^{2}}=0</script></span></span>
</p>
</li>
<li id="a0000000727"> <p>
This suggests that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{(x,y)\to (0,0)}f(x,y)=0.</script></span></span>
</p>
</li>
<li id="a0000000728"> <p>
However, now consider approaching the limit point along the curve <script type="math/tex">y=x^{2}</script>. Then we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,x^{2})=\frac{2x^{2}\times x^{2}}{x^{4}+(x^{2})^{2}}=\frac{2x^{4}}{x^{4}(1+1)}=1.</script></span></span> Hence approaching the limit point along any <script type="math/tex">y=x^{2}</script> into the origin has <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\lim _{x\to 0}f(x,x^{2})=\lim _{x\to 0}1=1.</script></span></span>
</p>
</li>
<li id="a0000000729"> <p>
Hence there is not a unique limit! This underlines the fact that for the limit to exist formally, it must be the same, no matter how the limit point is approached (or how complicated the path you take to approach the limit point). 
</p>
</li>
<li id="a0000000730"> <p>
What is actually going on with the surface near to <script type="math/tex">(x,y)=(0,0)</script> is illustrated below. The surface is vertical at the origin, but folded around the curve <script type="math/tex">y=x^{2}</script>. 
</p>
</li>
</ul>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0032.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.17</span>
<span class="caption_text">3-D plot of <script type="math/tex">z=f(x,y)=2x^{2}y/(x^{4}+y^{2})</script>. If we approach the origin along, say <script type="math/tex">x=0</script>, <script type="math/tex">\lim _{x\rightarrow 0}f(0,y)=0</script>. However, if we approach the origin along the curve <script type="math/tex">y=x^{2}</script> we find <script type="math/tex">\lim _{x\rightarrow 0}f(x,x^{2})=1</script>. In fact if we approach the origin along any curve <script type="math/tex">y=\beta x^{2}</script>, we find <script type="math/tex">\lim _{x\rightarrow 0}f(x,\beta x^{2})=\lim _{x\rightarrow 0}2\beta x^{4}/(x^{4}+\beta ^{2}x^{4})=2 \beta /(1+\beta ^{2})</script>. There is no unique value of <script type="math/tex">f(x,y)</script> at the origin <script type="math/tex">(x,y)=(0,0)</script>, since the surface is vertical there.</span>
</figcaption> </div>
</figure>
<p>
Clearly finding contradictions based on the choice of path taken to approach a limit point is a way of <b class="bf">disproving</b> the existence of a limit.<a class="footnote" href="#a0000000731">
<sup class="footnotemark">3</sup>
</a>
</p>
</section><section class="subsection">
<h3 id="a0000000732">3.4.4 Continuity of multivariable functions</h3>
<p>
Having defined the concept of a limit, we may now define continuity in multivariable functions 
</p>
<p>
<b class="bf">Definition: (Continuity)</b> <span class="rm"><p>
The function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is said to be <i class="it">continuous at <script type="math/tex">(a, b)\in \mathbb R^2</script></i> if 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(x, y)\to (a, b)}} f(x, y)=f(a, b).</script></span>
<p>
 If <script type="math/tex">f</script> is continuous at every point of a subset <script type="math/tex">D</script> of <script type="math/tex">\mathbb R^2</script>, then <script type="math/tex">f</script> is said to be <i class="it">continuous on <script type="math/tex">D</script></i>. If <script type="math/tex">D</script> is the whole domain, then <script type="math/tex">f</script> is simply said to be <i class="it">continuous</i>. 
</p>
<p>
It follows that sums and products of continuous functions are again continuous. That is, there are analogous statements to parts (i) and (ii) of Lemma <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#limit_properties">4.1</a> for continuity at a point. For quotients one needs to proceed with a bit of care as in part (iii) of Lemma <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#limit_properties">4.1</a>. 
</p>
<p>
Of the examples above, 
</p>
<ul class="itemize" id="a0000000733">
<li id="a0000000734"> <p>
<script type="math/tex">x^{2}+y^{2}+7</script> is continuous at <script type="math/tex">(0,0)</script> since the limit is the value of the function there. 
</p>
</li>
<li id="a0000000735"> <p>
<script type="math/tex">2x^{2}y/(x^{4}+y^{2})</script> is <b class="bf">not</b> continuous at <script type="math/tex">(0,0)</script> since its value at <script type="math/tex">(0,0)</script> is not unique. 
</p>
</li>
</ul>
</span>
</p>
</section>
</section><section class="section">
<h2 id="a0000000736">3.5 Partial Derivatives</h2>
<section class="subsection">
<h3 id="a0000000737">3.5.1 Definition of a Partial Derivative</h3>
<p>
 Given a curve <script type="math/tex">y = F(x)</script> we can work out the gradient (slope) of the curve at each point by differentiating <script type="math/tex">F</script>. The formal mathematical definition of a derivative of a function of one variable is 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\rm Slope} = \frac{dF}{dx}=\lim _{h\rightarrow 0}\left\{ \frac{F(x+h)-F(x)}{h}\right\}</script></span>
<p>
 For a smooth function with no kinks, this limit exists and is unique at each point <script type="math/tex">x</script>. There is only one unique slope at each point of a smooth curve. 
</p>
<p>
Now, suppose you are standing on a hill. What is the slope of the hill at that point? A little thought should tell you that it is not unique: It depends on the direction in which you are looking. 
</p>
<p>
For example, you could walk around the hill, on a level contour and keeping the same height. In that case the slope is zero in the direction you walk at each point. You could also aim for the summit, in which case you have to go uphill and the gradient will be far from zero! 
</p>
<p>
A hill can be represented as a function of two variables <script type="math/tex">z = f(x, y)</script> (see figure <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#3dplot123">3.17</a>) below. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0008.jpg" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.18</span>
<span class="caption_text">Plot of a multivariate function where the height of the function is <script type="math/tex">z=f(x,y)</script> and is given by <script type="math/tex">f(x,y)=\sin (x)+\sin (y)</script></span>
</figcaption> </div>
</figure>
<p>
Hence when we ask for the slope on a hill, this translates to asking: what is meant by the derivative of a multivariate function? 
</p>
<p>
The standard way to proceed is as follows. All but one of the variables (directions of walking on the hill) are kept constant and we differentiate with respect to the remaining one. Usually we pick two orthogonal directions and work out the slope in these directions. (You will learn in a later course how to find the slope in all other directions from these two). 
</p>
<p>
In two dimensions this corresponds to working out the slope looking at the slope either 
</p>
<ul class="itemize" id="a0000000738">
<li id="a0000000739"> <p>
in the <script type="math/tex">x</script> direction keeping <script type="math/tex">y</script>=constant, or 
</p>
</li>
<li id="a0000000740"> <p>
in the <script type="math/tex">y</script> direction keeping <script type="math/tex">x</script>=constant. 
</p>
</li>
</ul>
<p>
 As these derivatives only involve differentiation with respect to one of the possible variables, they are called <b class="bf">partial derivatives</b>. They are formally defined as follows: 
</p>
<p>
<b class="bf">Definition: (Partial Derivatives)</b> <span class="rm"><p>
For the function <script type="math/tex">z = f (x, y)</script>, the partial derivatives are defined as: 
</p>
<div id="a0000000741">
<script type="math/tex; mode=display">
\begin{align}
 {\rm Slope \  in \  } x {\rm \  direction \  } & =&  \left( \frac{\partial f}{\partial x}\right)_{y={\rm constant}} = \lim _{h\rightarrow 0} \left\{ \frac{f(x+h,y)-f(x,y)}{h}\right\}  \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
{\rm Slope \  in \  } y {\rm \  direction \  } & =&  \left( \frac{\partial f}{\partial y}\right)_{x={\rm constant}} = \lim _{k\rightarrow 0} \left\{ \frac{f(x,y+k)-f(x,y)}{k}\right\}  \nonumber 
\end{align}
</script>
</div>
<p>
 provided that these limits exist. 
</p>
<p>
<b class="bf">NB:</b> Note the curly <script type="math/tex">\partial </script> in the derivative, rather than the usual <script type="math/tex">d</script>. This is to denote that the derivative is of a <i class="it">multivariate</i> function and so is <i class="it">partial</i> with respect to only one of the variables, rather than with respect to all of them. It is <b class="bf">incorrect</b> to use an ordinary <script type="math/tex">d</script> in a partial derivative. Practice drawing the <script type="math/tex">\partial </script>!!! 
</p>
<p>
In practice you compute the partial derivatives in the same way as an ordinary derivative, treating all but the relevant variable as constants. Due to this, very similar rules exist for differentiating combinations of functions. 
</p>
</span>
</p>
</section><section class="subsection">
<h3 id="a0000000742">3.5.2 Partial Derivatives of Combinations of Functions</h3>
<p>
Partial derivatives of sums, products, quotients, compositions obey similar results derivatives involving single variables. 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="rules diff">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.1</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
 Let <script type="math/tex">f(x,y)</script> and <script type="math/tex">g(x,y)</script> be functions of two variables. 
</p>
<ol class="enumerate" id="a0000000743" style="list-style: none">
<li id="a0000000744" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> exists. Then for a constant <script type="math/tex">c\in {\mathbb R}</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x} (cf(x,y)) = c \left( \frac{\partial }{\partial x} f(x,y) \right) = c\frac{\partial f}{\partial x} (x,y),</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000745" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> and <script type="math/tex">\frac{\partial g}{\partial x} (x,y)</script> exist. Then 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x}(f(x,y) + g(x,y)) = \frac{\partial f}{\partial x} (x,y) + \frac{\partial g}{\partial x} (x,y),</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000746" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> and <script type="math/tex">\frac{\partial g}{\partial x} (x,y)</script> exist. For two functions <script type="math/tex">f(x,y)</script> and <script type="math/tex">g(x,y)</script>, we have the product rule: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x} (f(x,y) g(x,y)) = \left( \frac{\partial f}{\partial x} (x,y) \right) g(x,y) + f(x,y) \left( \frac{\partial g}{\partial x} (x,y) \right),</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000747" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Suppose <script type="math/tex">\frac{\partial f}{\partial x} (x,y)</script> and <script type="math/tex">\frac{\partial g}{\partial x} (x,y)</script> exist. For two functions <script type="math/tex">f(x,y)</script> and <script type="math/tex">g(x,y)</script>, we have the quotient rule: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x} \left( \frac{f(x,y)}{g(x,y)} \right) = \frac{\left( \frac{\partial f}{\partial x} (x,y) \right) g(x,y) - f(x,y) \left( \frac{\partial g}{\partial x} (x,y) \right)}{(g(x,y))^2},</script></span>
<p>
 and similarly for the partial derivative with respect to <script type="math/tex">y</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<div class="proof_wrapper" id="a0000000748">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We only prove part (i) to show that the proofs are analogous to those when the function has only one variable. Proofs for this lemma are <b class="bf">not</b> required. 
</p>
<span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial }{\partial x} (cf(x,y)) & = \lim _{h\rightarrow 0} \frac{cf(x+h,y) - cf(x,y)}{h} \\ & =c\left(\lim _{h\rightarrow 0} \frac{f(x+h,y) - f(x,y)}{h}\right) \\ & = c\left(\frac{\partial f}{\partial x} (x,y) \right). \end{align*}</script></span>
</div>
</div>
<p>
<b class="bf">Example:</b> <script type="math/tex">f(x,y)=x^{2}-1+y+\sin ({xy})</script>: <span style="color:#FF0000"><div id="a0000000749">
<script type="math/tex; mode=display">
\begin{align}
 \frac{\partial f}{\partial x}& =& \frac{\partial }{\partial x}\left( x^{2}\right)-\frac{\partial }{\partial x}\left( 1\right)+\frac{\partial }{\partial x}\left( y\right)+\frac{\partial }{\partial x} \left( \sin (xy)\right)=2x-0+0+y\cos (xy)=2x+y\cos (xy). \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial f}{\partial y}& =& \frac{\partial }{\partial y}\left( x^{2}\right)-\frac{\partial }{\partial y}\left( 1\right)+\frac{\partial }{\partial y}\left( y\right)+\frac{\partial }{\partial y} \left( \sin (xy)\right)=0-0+1+x\cos (xy)=1+x\cos (xy). 
\end{align}
</script>
</div></span>
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Find the partial derivatives of 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y) = \cos (x) \sin (y) + y\exp (x).</script></span>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}(x,y) = \left( \frac{\rm d}{{\rm d}x} \cos (x) \right) \sin (y) + y\left( \frac{\rm d}{{\rm d}x} \exp (x) \right) = -\sin (x)\sin (y) + y\exp (x).</script></span></span>
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial y}(x,y) = \cos (x) \left( \frac{\rm d}{{\rm d}y} \sin (y) \right)+ \left( \frac{\rm d}{{\rm d}y} y \right)\exp (x) = \cos (x)\cos (y) + \exp (x).</script></span></span>
</p>
<p>
<b class="bf">Example:</b> Find the partial derivatives of 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y) =\frac{\cos y}{x}.</script></span>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}(x,y) = \frac{x \frac{\partial }{\partial x}\left( \cos (y) \right)-\cos (y) \frac{\partial }{\partial x} \left( x\right)}{x^{2}}=\frac{x \times 0-\cos (y) \times 1}{x^{2}}=\frac{-\cos (y)}{x^{2}}.</script></span></span>
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial y}(x,y) = \frac{x \frac{\partial }{\partial y}\left( \cos (y) \right)-\cos (y) \frac{\partial }{\partial y} \left( x\right)}{x^{2}}=\frac{x \times (-\sin y)-\cos (y) \times 0}{x^{2}}=\frac{-\sin (y)}{x}.</script></span></span>
</p>
</section><section class="subsection">
<h3 id="a0000000750">3.5.3 Alternative Notation for Partial Derivatives</h3>
<p>
When a partial derivative of a function <script type="math/tex">z=f(x,y)</script> is evaluated at a point <script type="math/tex">(x, y) = (a,b)</script>, then you often see the following equivalent notation: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left.\frac{\partial z}{\partial x}\right|_{(a,b)} \qquad {\rm or} \qquad \left. \left(\frac{\partial }{\partial x}f(x,y)\right)\right|_{(a,b)} \qquad {\rm or} \qquad \partial _{x}f(x,y)|_{(a,b)} \qquad {\rm or} \qquad z_{x}(a,b)</script></span>
<p>
 for the <script type="math/tex">x</script>-partial derivatives and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left.\frac{\partial z}{\partial y}\right|_{(a,b)} \qquad {\rm or} \qquad \left. \left(\frac{\partial }{\partial y}f(x,y)\right)\right|_{(a,b)} \qquad {\rm or} \qquad \partial _{y}f(x,y)|_{(a,b)} \qquad {\rm or} \qquad z_{y}(a,b)</script></span>
<p>
 for the <script type="math/tex">y</script>-partial derivatives. 
</p>
<p>
<b class="bf">Example:</b> <span class="rm"><p>
For the function <script type="math/tex">f(x,y)=x^{2}-1+y+\sin ({xy})</script>, calculate the slope in the <script type="math/tex">x</script>-direction and <script type="math/tex">y</script>-direction at the point <script type="math/tex">(x,y)=(1,2)</script>. <span style="color:#FF0000"><div id="a0000000751">
<script type="math/tex; mode=display">
\begin{align}
 \left.\frac{\partial f}{\partial x}\right|_{(1,2)}& =& \left.2x+y\cos (xy)\right|_{(x,y)=(1,2)}=2+2\cos (2)=2(1+\cos 2). \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \left.\frac{\partial f}{\partial y}\right|_{(1,2)}& =& \left.1+x\cos (xy)\right|_{(x,y)=(1,2)}=1+\cos (2). 
\end{align}
</script>
</div></span>
</p>
</span>
</p>
</section><section class="subsection">
<h3 id="a0000000752">3.5.4 Partial Derivatives in Higher Dimensions</h3>
<p>
Partial derivatives in higher dimensions are defined as follows. 
</p>
<p>
<b class="bf">Definition:</b> For a function <script type="math/tex">f: {\mathbb R}^ n\rightarrow {\mathbb R}</script> given by <script type="math/tex">f(x_1,\ldots , x_ n)</script>, we have <script type="math/tex">n</script> first order partial derivatives, one with respect to each variable <script type="math/tex">x_1,\ldots , x_ n</script>, is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n)= \lim _{h\rightarrow 0} \left[ \frac{f(x_1,\ldots , x_{j-1}, x_ j + h, x_{j+1}, \ldots , x_ n) - f(x_1,\ldots , x_ n)}{h}\right].</script></span>
<p>
 provided the limit exists. 
</p>
<p>
We don’t normally use the definition to evaluate the partial derivatives of particular functions, any more than we use the definition for a function of one variable to calculate the derivative of that function. 
</p>
<p>
For combinations of functions in higher dimensions, the following lemma, analogous to Lemma 2.5.1, holds: 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="a0000000753">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.2</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
Let <script type="math/tex">f(x_1,\ldots , x_ n)</script> and <script type="math/tex">g(x_1,\ldots , x_ n)</script> be functions of <script type="math/tex">n</script>-variables. Then 
</p>
<ol class="enumerate" id="a0000000754" style="list-style: none">
<li id="a0000000755" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		1.
	</span>
<p>
For a constant <script type="math/tex">c\in {\mathbb R}</script> and for each <script type="math/tex">1\le j\le n</script>, 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x_ j} (cf(x_1,\ldots , x_ n)) = c\frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n);</script></span>
</li>
<li id="a0000000756" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		2.
	</span>
<p>
The derivative of a sum is the sum of the derivatives, namely 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x_ j} (f(x_1,\ldots , x_ n) + g(x_1,\ldots , x_ n)) = \frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n) + \frac{\partial g}{\partial x_ j} (x_1,\ldots , x_ n)</script></span>
<p>
 for each <script type="math/tex">1\le j\le n</script>; 
</p>
</li>
<li id="a0000000757" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		3.
	</span>
<p>
We have the product rule: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \lefteqn{\frac{\partial }{\partial x_ j} (f(x_1,\ldots , x_ n) g(x_1,\ldots , x_ n))} \\ &  = &  \left( \frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n) \right) g(x_1,\ldots , x_ n) + f(x_1,\ldots , x_ n) \left( \frac{\partial g}{\partial x_ j} (x_1,\ldots , x_ n) \right) \end{eqnarray*}</script></span>
<p>
 for each <script type="math/tex">1\le j\le n</script>; 
</p>
</li>
<li id="a0000000758" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		4.
	</span>
<p>
We have the quotient rule: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial }{\partial x_ j} \left( \frac{f(x_1,\ldots , x_ n)}{g(x_1,\ldots , x_ n)} \right)</script></span>
<span class="dmath"><script type="math/tex; mode=display">= \frac{\left( \frac{\partial f}{\partial x_ j} (x_1,\ldots , x_ n) \right) g(x_1,\ldots , x_ n) - f(x_1,\ldots , x_ n) \left( \frac{\partial g}{\partial x_ j} (x_1,\ldots , x_ n) \right)}{(g(x_1,\ldots , x_ n))^2}</script></span>
<p>
 for each <script type="math/tex">1\le j\le n</script>. 
</p>
</li>
</ol>
</div>
</div>
</p>
<p>
Really the only difference between this and the lemma for 2 variables (above), is the number of variables in the arguments of the function, and you remember that you treat all the variables as constants, except the one you are differentiating with respect to. 
</p>
<p>
<b class="bf">Example:</b> Find all the partial derivatives of the function 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y,z)=5x^3y^2z-y^2z^2+3x-4</script></span>
<p>
 at <script type="math/tex">(-1,0,2)</script>. 
</p>
<p>
Recall that when we differentiate with respect to <script type="math/tex">x</script>, we treat all other variables as constants and then differentiate normally. So, to calculate <script type="math/tex">\frac{\partial f}{\partial x}</script>, we treat <script type="math/tex">y</script> and <script type="math/tex">z</script> as constants and see that 
</p>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial f}{\partial x} (x,y,z) & = 5\frac{\partial }{\partial x}(x^3y^2z)-\frac{\partial }{\partial x}(y^2z^2)+3\frac{\partial }{\partial x}(x)-\frac{\partial }{\partial x}(4)\\ & =15x^2y^2z + 3.\\ \end{align*}</script></span></span> Similarly, to calculate <script type="math/tex">\frac{\partial f}{\partial y}</script>, we treat <script type="math/tex">x</script> and <script type="math/tex">z</script> as constants and see that <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial f}{\partial y} (x,y,z) & = 5\frac{\partial }{\partial y}(x^3y^2z)-\frac{\partial }{\partial y}(y^2z^2)+3\frac{\partial }{\partial y}(x)-\frac{\partial }{\partial y}(4)\\ & =10x^3y z -2yz^2.\\ \end{align*}</script></span></span> Similarly, to calculate <script type="math/tex">\frac{\partial f}{\partial y}</script>, we treat <script type="math/tex">x</script> and <script type="math/tex">y</script> as constants and see that <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{align*}  \frac{\partial f}{\partial z} (x,y,z) & = 5\frac{\partial }{\partial z}(x^3y^2z)-\frac{\partial }{\partial z}(y^2z^2)+3\frac{\partial }{\partial z}(x)-\frac{\partial }{\partial z}(4)\\ & =5x^3y^2 - 2y^2z. \end{align*}</script></span></span> Then <script type="math/tex">\frac{\partial f}{\partial x} (-1,0,2)=3</script>, <script type="math/tex">\frac{\partial f}{\partial y} (-1,0,2)=0</script>, and <script type="math/tex">\frac{\partial f}{\partial z} (-1,0,2)=0</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000759">3.5.5 Chain rule</h3>
<p>
Recall that in the single variable case, if we were given a function <script type="math/tex">z = z(x)</script> where <script type="math/tex">x = x(t)</script>, then we could express the derivative of the composite function <script type="math/tex">z = z(x(t))</script> with respect to <script type="math/tex">t</script> using the chain rule: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dt} = \lim _{h\rightarrow 0} \frac{z(x(t+h)) - z(x(t))}{h}= \lim _{h\rightarrow 0} \left( \frac{z(x(t+h)) - z(x(t))}{x(t+h)-x(t)}\right)\left(\frac{x(t+h) - x(t)}{h}\right)=\frac{dz}{dx}\frac{dx}{dt}.</script></span></span>
</p>
<p>
(This follows from the formula for the product of individually well-defined limits.) 
</p>
<p>
What is the analogous situation for multivariable functions? We can illustrate this with a definite example. 
</p>
<p>
<b class="bf">Example:</b> Suppose you are walking in a mountainous region with a map. Your horizontal coordinates on the map are given by <script type="math/tex">(x,y)</script> and your vertical height above sea level is <script type="math/tex">z=f(x,y)</script>. 
</p>
<p>
Now suppose you take a path so that your horizontal coordinates are given at time <script type="math/tex">t</script> by <script type="math/tex">(x,y)=(x(t),y(t))</script>. Your height at time <script type="math/tex">t</script> is then given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x(t),y(t)).</script></span>
<p>
So it is possible to now express <script type="math/tex">z</script> as a function of <script type="math/tex">t</script> only, i.e., <script type="math/tex">z=z(t)</script>. The question we pose is, give this, how fast is your height changing with time, i.e., what is <script type="math/tex">dz/dt</script>? <a class="footnote" href="#a0000000760">
<sup class="footnotemark">4</sup>
</a>
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0034.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.19</span>
<span class="caption_text">A schematic representation of the motion of a point on the surface <script type="math/tex">z=f(x,y)</script> that is given when we allow the coordinates of the point <script type="math/tex">(x,y,z)</script> to depend on an additional variable <script type="math/tex">t</script> so that the <script type="math/tex">x</script> coordinate moves as <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script>. The chain rule can then b used to calculate how the rate of change of <script type="math/tex">z</script> with respect to <script type="math/tex">t</script> may be expressed. For example if <script type="math/tex">t</script> is time, then <script type="math/tex">dz/dt</script> gives the vertical speed. </span>
</figcaption> </div>
</figure>
<p>
The solution is obtained by a series of careful steps. 
</p>
<p>
If we treat <script type="math/tex">z</script> as a function of just <script type="math/tex">t</script> we can write down the defintion of <script type="math/tex">dz/dt</script> as 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  {\frac{{\rm d} z}{{\rm d}t}} &  = &  \lim _{h\rightarrow 0} \frac{z(t+h) - z(t)}{h} \\ &  = &  \lim _{h\rightarrow 0} \frac{z(x(t+h), y(t+h)) - z(x(t), y(t))}{h} \\ &  = & \lim _{h\rightarrow 0} \frac{z(x(t+h), y(t+h)) +\left[- z(x(t), y(t+h)+z(x(t), y(t+h))\right]- z(x(t), y(t))}{h}\\ &  = &  \lim _{h\rightarrow 0} \frac{z(x(t+h), y(t+h)) - z(x(t), y(t+h))}{h}+ \lim _{h\rightarrow 0} \frac{z(x(t), y(t+h)) - z(x(t), y(t))}{h} \\ &  = &  \frac{\partial z}{\partial x} (x(t), y(t)) \:  \frac{{\rm d}x}{{\rm d}t} (t)+ \frac{\partial z}{\partial y} (x(t), y(t))\:  \frac{{\rm d}y}{{\rm d}t}(t). \end{eqnarray*}</script></span>
<p>
The last line follows by comparison with the 1-d chain rule above. 
</p>
<p>
Of course the result we have derived here is general and not dependent on the mountain walk context. 
</p>
<p>
So, the Chain Rule says that if <script type="math/tex">z=f(x,y)</script> and <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script> for differentiable <script type="math/tex">f, x</script> and <script type="math/tex">y</script>, and we compose the functions as <script type="math/tex">\mathbb R_{(t)}\to \mathbb R^2_{(x,y)}\to \mathbb R_{(z)}</script>, we have the following result: 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="a0000000761">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.3</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
If <script type="math/tex">z=z(x,y)</script> and <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script> for differentiable <script type="math/tex">f, x</script> and <script type="math/tex">y</script>, we have 
</p>
<div class="eqn" id="a0000000762">
<script type="math/tex; mode=display">\begin{equation}\boxed {{\frac{{\rm d} z}{{\rm d}t} = \frac{\partial z}{\partial x} \:  \frac{{\rm d}x}{{\rm d}t} + \frac{\partial z}{\partial y} \:  \frac{{\rm d}y}{{\rm d}t} .}}\tag{3.1}\end{equation}</script>
</div>
</div>
</div>
</p>
<p>
<b class="bf">Example:</b> Let <script type="math/tex">z=\sin (x+y^2)</script>, and <script type="math/tex">x=t^2</script>, <script type="math/tex">y=e^ t</script>. What is <script type="math/tex">dz/dt</script>? 
</p>
<p>
We have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dx}{dt}=2t, \qquad \frac{dy}{dt}=e^ t</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=\cos (x+y^2), \qquad \frac{\partial z}{\partial y}=2y\cos (x+y^2)</script></span></span>
</p>
<p>
Hence 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dt}= \frac{\partial z}{\partial x} \:  \frac{{\rm d}x}{{\rm d}t} + \frac{\partial z}{\partial y} \:  \frac{{\rm d}y}{{\rm d}t}= 2t\cos (x+y^2)+2ye^ t\cos (x+y^2)=\cos (t^2+e^{2t})\left(2t+2e^{2t}\right)</script></span></span>
</p>
<p>
Note that the last result could have been obtained by directly substituting first for <script type="math/tex">x=t^2</script> and <script type="math/tex">y=e^ t</script> to get <script type="math/tex">z(t)=\sin (t^2+e^ t)</script> and then differentiating <script type="math/tex">z</script> as a simple 1-d function with respect to <script type="math/tex">t</script>. 
</p>
<p>
So in this type of problem we see that <script type="math/tex">x</script> and <script type="math/tex">y</script> are <b class="bf">intermediate variables</b> and <script type="math/tex">t</script> is the actual independent variable. 
</p>
<p>
Suppose now that we have a composition <script type="math/tex">\mathbb R_{(s,t)}^{2}\to \mathbb R^2_{(x,y)}\to \mathbb R_{(z)}</script>, i.e., we have a function <script type="math/tex">z=f(x,y)</script>, but that we have intermediate variable <script type="math/tex">x=x(s,t)</script> and <script type="math/tex">y=y(s,t)</script> with the independent variables being now <script type="math/tex">s</script> and <script type="math/tex">t</script>, so that 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x(s,t),y(s,t))=z(s,t).</script></span>
<p>
The function <script type="math/tex">z</script> is now a multivariable function, depending on two indepdendent variables <script type="math/tex">s</script> and <script type="math/tex">t</script>. The derivatives of <script type="math/tex">z</script> with respect to <script type="math/tex">s</script> and <script type="math/tex">t</script> will now be partials. Hence the analogous chain rule questions to ask now is what are <script type="math/tex">\partial z/\partial s</script> and <script type="math/tex">\partial z/\partial t</script>? 
</p>
<p>
A derivation of the chain rule (not required) delivers the following results: 
</p>
<p>
<div class="thmwrapper lemma_thmwrapper" id="a0000000763">
<div class="thmheading lemma_thmheading">
<span class="thmcaption lemma_thmcaption">
    Lemma
    </span>
<span class="thmlabel lemma_thmlabel">5.4</span>
</div>
<div class="thmcontent lemma_thmcontent">
<p>
If <script type="math/tex">z=z(x,y)</script> and <script type="math/tex">x=x(s,t)</script> and <script type="math/tex">y=y(s,t)</script> for differentiable <script type="math/tex">f, x</script> and <script type="math/tex">y</script>, we have 
</p>
<div class="eqn" id="eq_221">
<script type="math/tex; mode=display">\begin{equation}\label{eq_221}\boxed { {\frac{\partial z}{\partial s} = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial s} + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial s}} \mbox{ \; \; \; \;  and \; \; \; \; } { \frac{\partial z}{\partial t} = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial t} + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial t} .}}\tag{3.2}\end{equation}</script>
</div>
</div>
</div>
</p>
<p>
<b class="bf">Example:</b> Consider the functions: 
</p>
<span class="dmath"><script type="math/tex; mode=display">z(x,y)=xe^{y},</script></span>
<p>
 with 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=s+3t, \qquad y=s-2t.</script></span>
<ul class="itemize" id="a0000000764">
<li id="a0000000765"> <p>
We have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=e^{y}, \qquad \frac{\partial z}{\partial y}=xe^{y},</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial x}{\partial s}=1, \qquad \frac{\partial x}{\partial t}=3, \qquad \frac{\partial y}{\partial s}=1, \qquad \frac{\partial y}{\partial t}=-2.</script></span></span>
</p>
</li>
<li id="a0000000766"> <p>
Hence the chain rule becomes: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial z}{\partial s}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial s}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial s}\\ & =& \frac{\partial z}{\partial x}+\frac{\partial z}{\partial y}=e^{y}+xe^{y}=e^{y}(1+x)\\ & =& e^{s-2t}(1+s+3t); \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000767"> <p>
and <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial z}{\partial t}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial t}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial t}\\ & =& 3\frac{\partial z}{\partial x}-2\frac{\partial z}{\partial y}=3e^{y}-2xe^{y}=e^{y}(3-2x)\\ & =& e^{s-2t}(3-2s-6t). \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Transformation to polar coordinates. Let <script type="math/tex">z=z(x,y)</script> where <script type="math/tex">x=r\cos \theta </script> and <script type="math/tex">y=r\sin \theta </script>. Find <script type="math/tex">\partial z/\partial r</script> and <script type="math/tex">\partial z/ \partial \theta </script>. 
</p>
<p>
We can use the chain rule from equation (<a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#eq_221">3.2</a>) with <script type="math/tex">s=r</script> and <script type="math/tex">t=\theta </script>. Then we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial r} = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial r} + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial r}</script></span></span> and <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial \theta } = \frac{\partial z}{\partial x}\:  \frac{\partial x}{\partial \theta } + \frac{\partial z}{\partial y}\:  \frac{\partial y}{\partial \theta }</script></span></span> But <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial x}{\partial r}=\cos \theta \qquad \frac{\partial y}{\partial r}=\sin \theta</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial x}{\partial \theta }=-r\sin \theta \qquad \frac{\partial y}{\partial \theta }=r\cos \theta</script></span></span> Hence the <script type="math/tex">r</script> and <script type="math/tex">\theta </script> partial derivatives of <script type="math/tex">z</script> may be expressed in terms of the <script type="math/tex">x</script> and <script type="math/tex">y</script> partial derivatives of <script type="math/tex">z</script> as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial r} = \frac{\partial z}{\partial x}\:  \cos \theta + \frac{\partial z}{\partial y}\:  \sin \theta</script></span></span> and <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial \theta } = -\frac{\partial z}{\partial x}\:  r\sin \theta + \frac{\partial z}{\partial y}\:  r\cos \theta</script></span></span>
</p>
<p>
<b class="bf">Note:</b> A convenient way to express the chain rule (<a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#eq_221">3.2</a>), that will be useful later, is to recognise that it can be written as a matrix multiplication: 
</p>
<div class="eqn" id="a0000000768">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial z}{\partial s} &  \dfrac {\partial z}{\partial t}\end{array}\right)=\left(\begin{array}{cc}\dfrac {\partial z}{\partial x} &  \dfrac {\partial z}{\partial y}\end{array}\right)\left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right)\tag{3.3}\end{equation}</script>
</div>
</section><section class="subsection">
<h3 id="a0000000769">3.5.6 Graphical Way to Work out the Chain Rule</h3>
<p>
There is a simplified graphical way to remember the chain rules for arbitrary compositions <script type="math/tex">\mathbb R_{(t_1,t_2, \dots t_ m)}\to \mathbb R_{(x_1, x_2, \dots ,x_ n)} \dots \to \mathbb R_{(z)}</script>. For the cases studied above we can construct a chart of chain links that indicates how all the variables depend on one another. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> When <script type="math/tex">z=z(x,y)</script> and <script type="math/tex">x=x(t)</script>, <script type="math/tex">y=y(t)</script> we have: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0036.png" style="width:198.74249999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.20</span>
<span class="caption_text">Chain rule for <script type="math/tex">z=z(x,y)</script>, when <script type="math/tex">x=x(t)</script> and <script type="math/tex">y=y(t)</script>.</span>
</figcaption> </div>
</figure>
<p>
 The rules are simple: 
</p>
<ul class="itemize" id="a0000000770">
<li id="a0000000771"> <p>
Each link in the chain is a partial derivative. 
</p>
</li>
<li id="a0000000772"> <p>
Successive links on a particular chain are multiplied. 
</p>
</li>
<li id="a0000000773"> <p>
Overall contributions from each chain are added. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> <script type="math/tex">z=z(x,y)=x^{2}y+y^{3}</script> with <script type="math/tex">y=\cos x</script>. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0038.png" style="width:191.51549999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.21</span>
<span class="caption_text">Chain rule for <script type="math/tex">z=z(x,y)</script>, when <script type="math/tex">y=y(x)</script></span>
</figcaption> </div>
</figure>
<p>
 Note that on substituting <script type="math/tex">y=\cos x</script> into <script type="math/tex">z=f(x,y)</script> we end up with <script type="math/tex">z=f(x,\cos x)=z(x)</script> only. In other words, if we make the substitution for <script type="math/tex">y</script> in the first place, we find that <script type="math/tex">z</script> is just a function of a single variable <script type="math/tex">x</script>. Hence the final derivative we seek using the chain rule will just be a total derivative <script type="math/tex">dz/dx</script>. 
</p>
<p>
However, if we just use the chain rule, on the way we do need to differentiate with respect to each of the <script type="math/tex">x</script> and <script type="math/tex">y</script> variables partially. Hence we will see <script type="math/tex">\partial z/\partial x</script> appear within the chain rule: this just means that we must differentiate with respect to the first of the original variables <script type="math/tex">x</script>, keeping the other one, <script type="math/tex">y</script>, as a constant. However since <script type="math/tex">y=y(x)</script> only, any derivatives of <script type="math/tex">y</script> with respect to <script type="math/tex">x</script> will also be total and so we can expect <script type="math/tex">dy/dx</script> to appear too. 
</p>
<p>
Hence, when we apply the diagram to derive the chain rule, we find: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dx}=\frac{\partial z}{\partial x}+\frac{\partial z}{\partial y}\frac{dy}{dx}.</script></span>
<p>
 Thus we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=2xy, \qquad \frac{\partial z}{\partial y}=x^{2}+3y^{2}.</script></span>
<p>
 We also have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=-\sin x.</script></span>
<p>
 So 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dz}{dx}=\frac{\partial z}{\partial x}+\frac{\partial z}{\partial y}\frac{dy}{dx}=2xy(x)+\left(x^{2}+3y(x)^{2}\right)\left(-\sin x\right)=2x\cos x-\left(x^{2}+3\cos ^{2}x\right)\sin x.</script></span>
<p>
<b class="bf">Exercise 4 U: </b> Check that if you do make the substitution <script type="math/tex">y=\cos x</script> and then differentiate <script type="math/tex">z(x)=f(x,\cos x)</script> with respect to <script type="math/tex">x</script>, that you obtain the same answer as above. 
</p>
<p>
<b class="bf">Example:</b> Suppose we have <script type="math/tex">z=z(x,y)</script>, but <script type="math/tex">x=x(s,t,u)</script> but <script type="math/tex">y=y(s,u)</script> only, and <script type="math/tex">u=u(v</script>). We can represent the functional relationships using the chain diagram below: 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0040.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.22</span>
<span class="caption_text">Chain rule for <script type="math/tex">z=z(x,y)</script>, when <script type="math/tex">x=x(s,t,u)</script> and <script type="math/tex">y=y(s,u)</script>.</span>
</figcaption> </div>
</figure>
<p>
Hence following the above shortcut rules, it is easy to see that ultimately <script type="math/tex">z=z(s,t,v)</script> and that. <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial z}{\partial s}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial s}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial s} \\[12 pt] \frac{\partial z}{\partial t}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial t} \\[12 pt] \frac{\partial z}{\partial v}& =& \frac{\partial z}{\partial x}\frac{\partial x}{\partial u}\frac{\partial u}{\partial v}+\frac{\partial z}{\partial y}\frac{\partial y}{\partial u}\frac{\partial u}{\partial v} \end{eqnarray*}</script></span></span>
</p>
</section><section class="subsection">
<h3 id="constant derivatives">3.5.7 Integration of Partial Derivatives</h3>
<p>
When we integrate an ordinary derivative, from the Fundamental Theorem of Calculus we have: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int \frac{dy}{dx}dx=y(x)+C,</script></span>
<p>
 where <script type="math/tex">C</script> is an arbitrary constant. This is because 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{d}{dx}\left(y(x)+C\right)=\frac{dy}{dx},</script></span>
<p>
 i.e., the derivative of the constant with respect to <script type="math/tex">x</script> is zero. 
</p>
<p>
When we integrate a partial derivative, we get something similar, but the role of the constant is taken by an arbitrary function of the variable(s) which has (have) been held constant in the partial differentiation. Consider a function <script type="math/tex">z(x,y)</script> which has partial derivatives: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}dx=z(x,y)+g(y),</script></span>
<p>
 where <script type="math/tex">g(y)</script> is an arbitrary function of <script type="math/tex">y</script>. This is because, when we differentiate the right hand side, <script type="math/tex">z(x,y)+g(y)</script>, partially with respect to <script type="math/tex">x</script>, keeping <script type="math/tex">y</script> constant, any arbitrary function of <script type="math/tex">y</script> has a zero partial derivative with respect to <script type="math/tex">x</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial }{\partial x}\left(z(x,y)+g(y)\right)\right)_{y={\rm const}}=\left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}+0=\left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}.</script></span>
<p>
Similarly we have: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}dy=z(x,y)+f(x),</script></span>
<p>
 where <script type="math/tex">f(x)</script> is an arbitrary function of <script type="math/tex">x</script>. This is because, when we differentiate the right hand side, <script type="math/tex">z(x,y)+f(x)</script>, partially with respect to <script type="math/tex">y</script>, keeping <script type="math/tex">x</script> constant, any arbitrary function of <script type="math/tex">x</script> has a zero partial derivative with respect to <script type="math/tex">y</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial }{\partial y}\left(z(x,y)+f(x)\right)\right)_{x={\rm const}}=\left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}+0=\left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}.</script></span>
<p>
Note that when we are given two partial derivatives of the same function <script type="math/tex">z</script> we can integrate both derivatives separately as above with respect to the relevant variable to obtain two apparently different representations for <script type="math/tex">z</script>. The resolution of this paradox is that by exploit the arbitrary nature of the functions <script type="math/tex">g(y)</script> and <script type="math/tex">f(x)</script> to “pattern match” the two expressions <script type="math/tex">z(x,y)+g(y)</script> and <script type="math/tex">z(x,y)+f(x)</script> to obtain identical expressions for both integrals: 
</p>
<p>
<b class="bf">Example:</b> Suppose you are <b class="bf">given</b> that a function <script type="math/tex">z(x,y)</script> exists such that 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}=2x+2y, \qquad \left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}=3y^{2}+2x.</script></span></span>
</p>
<p>
Then we have, respectively: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial x}\right)_{y={\rm const}}dx=x^{2}+2xy+g(y),</script></span></span>
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\int \left(\frac{\partial z}{\partial y}\right)_{x={\rm const}}dy=y^{3}+2xy+f(x).</script></span></span>
</p>
<p>
Given that we are told that <script type="math/tex">z(x,y)</script> exists, both of these expressions should be the same. Clearly both have a <script type="math/tex">2xy</script>, but otherwise they look different. However, a careful term-by-term comparison shows that can be made the same if we match up using the arbitrary functions as: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x)=x^{2}+C, \qquad g(y)=y^{3}+C,</script></span></span>
</p>
<p>
where <script type="math/tex">C</script> is an arbitrary constant. Note that the arbitrariness of the the constant <script type="math/tex">C</script> maintains the arbitrariness of <script type="math/tex">g</script> and <script type="math/tex">f</script>. Whence we have a single expression for <script type="math/tex">z(x,y)</script>, unique up to arbitrary constants (as in the single variable integration case): 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z(x,y)=x^{2}+y^{3}+2xy+C.</script></span></span>
</p>
<p>
You can check for yourselves that if you differentiate this function <script type="math/tex">z(x,y)</script> partially with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script> independently that you cover the partial derivatives that you started off with above. 
</p>
<p>
We can use integration of partial derivatives to arrive at the following neat result: 
</p>
<p>
 Let <script type="math/tex">u(x,y)</script> be a function of the variables <script type="math/tex">x</script> and <script type="math/tex">y</script>, and assume that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial u}{\partial x} (x,y) = \frac{\partial u}{\partial y} (x,y) = 0</script></span>
<p>
 for all <script type="math/tex">(x,y)\in {\mathbb R}^2</script>. Then, <script type="math/tex">u(x,y)</script> is constant on <script type="math/tex">{\mathbb R}^2</script>.   
</p>
<div class="proof_wrapper" id="a0000000774">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We start from the assumption that <script type="math/tex">\frac{\partial u}{\partial x} (x,y) = 0</script> for all <script type="math/tex">(x,y)\in {\mathbb R}^2</script> (i.e., everywhere and not just at a point). 
</p>
<ul class="itemize" id="a0000000775">
<li id="a0000000776"> <p>
Integrating with respect to <script type="math/tex">x</script>, we see that <script type="math/tex">u(x,y) =g(y)</script>, since (from the way integration works above) the constant of integration with respect to <script type="math/tex">x</script> must depend only on <script type="math/tex">y</script>. 
</p>
</li>
<li id="a0000000777"> <p>
Using now the assumption that <script type="math/tex">\frac{\partial u}{\partial y} (x,y)=0</script> everywhere, this means that <script type="math/tex">\frac{\partial u}{\partial y} (x,y)=g'(y)=0</script> everywhere. 
</p>
</li>
<li id="a0000000778"> <p>
Hence, integrating <script type="math/tex">g'(y)=0</script> with respect to <script type="math/tex">y</script>, since <script type="math/tex">g'(y)</script> is just a function of <script type="math/tex">y</script>, the ordinary 1-D rules of integration apply. Hence <script type="math/tex">g(y)</script>=constant everywhere, and hence that <script type="math/tex">u(x,y)</script> must be constant everywhere. 
</p>
</li>
</ul>
</div>
</div>
</section><section class="subsection">
<h3 id="a0000000779">3.5.8 Example of Use of Chain Rule: First Order PDEs</h3>
<p>
The chain rule is used in the solution of first order exact ordinary differential equations. Chain rules are also useful in the solution of partial differential equations (PDE) by converting the equations form something complicated when expressed in one set of variables, to something simpler to solve in another set. 
</p>
<p>
<b class="bf">Example:</b> Suppose you are looking for a solution to the first order PDE:<a class="footnote" href="#a0000000780">
<sup class="footnotemark">5</sup>
</a>
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial t}+c\frac{\partial z}{\partial x}=0,</script></span>
<p>
 where <script type="math/tex">c</script> is a constant. 
</p>
<p>
Suppose (Rabbit!) the we make a change of variable 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\xi =x-ct, \qquad \eta =x+ct</script></span></span>
</p>
<p>
so that <script type="math/tex">z(x,t)=z(x(\xi ,\eta ),t(\xi ,\eta ))=z(\xi ,\eta ).</script> We can use the chain rule to rewrite the partial derivatives with respect to <script type="math/tex">x</script> and <script type="math/tex">t</script> in the following form, 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial t}=\frac{\partial \xi }{\partial t}\frac{\partial z}{\partial \xi }+\frac{\partial \eta }{\partial t}\frac{\partial z}{\partial \eta }= -c\frac{d z}{d\xi }+c\frac{d z}{d\eta },</script></span></span>
</p>
<p>
and 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=\frac{\partial \xi }{\partial x}\frac{\partial z}{\partial \xi }+\frac{\partial \eta }{\partial x}\frac{\partial z}{\partial \eta }= \frac{\partial z}{\partial \xi }+\frac{\partial z}{\partial \eta }.</script></span></span>
</p>
<p>
Hence the equation simplifies to 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial t}+c\frac{\partial z}{\partial x}=–c\frac{d z}{d\xi }+c\frac{d z}{d\eta }+c\left(\frac{\partial z}{\partial \xi }+\frac{\partial z}{\partial \eta }\right)=2c\frac{\partial z}{\partial \eta }=0.</script></span></span>
</p>
<p>
Hence the PDE simplifies greatly and becomes: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial \eta }=0.</script></span></span>
</p>
<p>
Thus if we integrate with respect to <script type="math/tex">\eta </script> and remember that <script type="math/tex">z</script> also depends on <script type="math/tex">\xi </script> we see that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=F(\xi ),</script></span></span> In other words <script type="math/tex">z</script> is just an arbitrary function of <script type="math/tex">\xi </script> only. 
</p>
<p>
Converting back to the original <script type="math/tex">(x,t)</script> coordinates we have <script type="math/tex">z(x,t)=F(x-ct)</script>. The actual function <script type="math/tex">F</script> could be determined by specifying the initial profile of the wave at <script type="math/tex">t=0</script>. If we set this to be <script type="math/tex">z(x,0)=z_{0}(x)</script> we would then find <script type="math/tex">z(x,0)=F(x)=z_{0}(x).</script> Hence the solution would then be <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z(x,t)=z_{0}(x-ct).</script></span></span> The solution of this equation represents a wave of amplitude <script type="math/tex">z</script> traveling to the right (positive <script type="math/tex">x</script>) with speed <script type="math/tex">c</script> at time <script type="math/tex">t</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000781">3.5.9 Jacobian Matrix and the Chain Rule</h3>
<p>
In this section we consider the so-called <b class="bf">Jacobian matrices</b> of partial derivatives and show how they can be used to encode and to represent the chain rule. We then on to examine the relationship between the inverses of these matrices and so establish conditions for an inverse of a multivariable function to have a local inverse. 
</p>
<p>
Consider the <script type="math/tex">\mathbb R^2 \to \mathbb R^2</script> mapping 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf f}:(x,y)\to \left(f_1(x,y),f_2(x,y)\right).</script></span>
<p>
Here <b class="bf">f</b> is called a <b class="bf">vector</b> function, since the result is an ordered set of two functions <script type="math/tex">f_1(x,y)</script> and <script type="math/tex">f_2(x,y)</script>. These could be the component of a vector whose direction and magnitude depends on the <script type="math/tex">(x,y)</script> position in space, e.g., 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf f}(x,y)= f_1(x,y){\bf i}+f_2(x,y){\bf j}.</script></span>
<p>
The function <b class="bf">f</b> could represent, say, the wind velocity at sea level at any point on a map. 
</p>
<p>
<b class="bf">Definition: (Jacobian Matrix)</b> The Jacobian Matrix of <b class="bf">f</b> <span class="rm">:</span> <script type="math/tex">\mathbb R^2\to \mathbb R^2</script> is defined to be 
</p>
<span class="dmath"><script type="math/tex; mode=display">J_{\bf f}(x,y)=\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x} &  \dfrac {\partial f_2}{\partial y}\end{array}\right)</script></span>
<p>
This is a matrix of partial derivatives. Note the order of the entries. The independent variables <script type="math/tex">(x,y)</script> go on the bottom of each partial derivative as appropriate. Partial derivatives of the function <script type="math/tex">f_ i</script> are in the <script type="math/tex">i^{\rm th}</script> row. The <script type="math/tex">j^{\rm th}</script> column should contain the same independent variable. 
</p>
<p>
Now suppose that we make a change of variable from <script type="math/tex">\mathbb R^2 \to \mathbb R^2</script> defined by 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf g}:(s,t)\to \left(x(s,t),y(s,t)\right).</script></span>
<p>
 Then we can use the chain rule to write 
</p>
<div class="eqn" id="a0000000782">
<script type="math/tex; mode=display">\begin{equation}{\frac{\partial f_1}{\partial s} = \frac{\partial f_1}{\partial x} \:  \frac{\partial x}{\partial s} + \frac{\partial f_1}{\partial y} \:  \frac{\partial y}{\partial s} .}\tag{3.4}\end{equation}</script>
</div>
<div class="eqn" id="a0000000783">
<script type="math/tex; mode=display">\begin{equation}{\frac{\partial f_1}{\partial t} = \frac{\partial f_1}{\partial x} \:  \frac{\partial x}{\partial t} + \frac{\partial f_1}{\partial y} \:  \frac{\partial y}{{\rm d} t} .}\tag{3.5}\end{equation}</script>
</div>
<p>
A little bit of thought shows that we can combine these two equations and represent them as components in the following matrix multiplication: 
</p>
<div class="eqn" id="a0000000784">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial s} &  \dfrac {\partial f_1}{\partial t}\end{array}\right)=\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y}\end{array}\right)\left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right)\tag{3.6}\end{equation}</script>
</div>
<p>
Likewise we could do the same for <script type="math/tex">f_2</script> and obtain 
</p>
<div class="eqn" id="a0000000785">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial f_2}{\partial s} &  \dfrac {\partial f_2}{\partial t}\end{array}\right)=\left(\begin{array}{cc}\dfrac {\partial f_2}{\partial x} &  \dfrac {\partial f_2}{\partial y}\end{array}\right)\left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right)\tag{3.7}\end{equation}</script>
</div>
<p>
Due to the identity of the final <script type="math/tex">2 \times 2</script> matrix in both these expressions, we could again combine these results and write them as a <script type="math/tex">2 \times 2</script> matrix multiplication: 
</p>
<div class="eqn" id="a0000000786">
<script type="math/tex; mode=display">\begin{equation}\left(\begin{array}{cc}\dfrac {\partial f_1}{\partial s} &  \dfrac {\partial f_1}{\partial t} \\[12 pt] \dfrac {\partial f_2}{\partial s} &  \dfrac {\partial f_2}{\partial t}\end{array}\right)= \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x} &  \dfrac {\partial f_2}{\partial y}\end{array}\right) \left(\begin{array}{cc}\dfrac {\partial x}{\partial s} &  \dfrac {\partial x}{\partial t} \\[12 pt] \dfrac {\partial y}{\partial s} &  \dfrac {\partial y}{\partial t}\end{array}\right).\tag{3.8}\end{equation}</script>
</div>
<p>
Or in terms of the definition of the Jacobian Matrix the chain rule for the mapping 
</p>
<span class="dmath"><script type="math/tex; mode=display">\mathbb R^2_{(s,t)} \stackrel{{\bf g}}{\rightarrow } \mathbb R^2_{(x,y)}\stackrel{{\bf f}}{\rightarrow } \mathbb R^2_{(f_1, f_2)},</script></span>
<p>
may be summarised as: 
</p>
<div class="eqn" id="chain">
<script type="math/tex; mode=display">\begin{equation}\boxed {J_{{\bf f\circ g}}(s,t)=J_{{\bf f}}(x,y)J_{{\bf g}}(s,t)}\tag{3.9}\end{equation}</script>
</div>
<p>
This can be generalised to arbitrary dimensional functions as follows. 
</p>
<p>
<b class="bf">Definition: (Jacobian Matrix in Higher Dimensions)</b> Let <script type="math/tex">F: {\mathbb R}^ n \rightarrow {\mathbb R}^ p</script> be a function where <script type="math/tex">n\ge 1</script> and <script type="math/tex">p\ge 1</script>. Assume <script type="math/tex">\frac{\partial f_ i}{\partial x_ j}</script> exists for all <script type="math/tex">1\leqslant i\leqslant p</script> and <script type="math/tex">1\leqslant j\leqslant n</script> at a point <script type="math/tex">(x_1, \dots ,x_ n)\in D</script>. The <i class="it">Jacobian matrix</i> at <script type="math/tex">(x_1, \dots , x_ n)</script> is the <script type="math/tex">p\times n</script> matrix of first order partial derivatives of the component functions of <script type="math/tex">F(x_1,\ldots , x_ n)</script>. Specifically, for 
</p>
<span class="dmath"><script type="math/tex; mode=display">F(x_1,\ldots , x_ n) = (f_1(x_1,\ldots , x_ n), \ldots , f_ p(x_1,\ldots , x_ n)),</script></span>
<p>
 we set 
</p>
<span class="dmath"><script type="math/tex; mode=display">J_ F(x_1,\ldots , x_ n) = \left( \frac{\partial f_ i}{\partial x_ j}\right) = \left( \begin{array}{ccc} \frac{\partial f_1}{\partial x_1}(x_1,\ldots , x_ n) &  \cdots &  \frac{\partial f_1}{\partial x_ n}(x_1,\ldots , x_ n) \\ \cdot & &  \cdot \\ \cdot & &  \cdot \\ \cdot & &  \cdot \\ \frac{\partial f_ p}{\partial x_1}(x_1,\ldots , x_ n) &  \cdots &  \frac{\partial f_ p}{\partial x_ n}(x_1,\ldots , x_ n) \end{array} \right).</script></span>
<p>
Next, we state the most general form of the Chain Rule. 
</p>
<p>
[The Chain Rule] Let <script type="math/tex">G: \mathbb R^ m\to \mathbb R^ n</script> be differentiable at a point <script type="math/tex">{\bf a} \in \mathbb R^ m</script> and <script type="math/tex">F: \mathbb R^ n\to \mathbb R^ p</script> be differentiable at the point <script type="math/tex">{\bf b}=G({\bf a})</script>. Then <script type="math/tex">F\circ G:\mathbb R^ m\to \mathbb R^ p</script> is differentiable at <script type="math/tex">{\bf a}</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\boxed {J_{F\circ G}({\bf a})=J_ F({\bf b}) \cdot J_ G({\bf a}).}</script></span>
<p>
<b class="bf">Example</b>: Jacobians need not be square matrices! For example, if we have a function: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  F:\mathbb R^ n\to \mathbb R^ p \qquad F & =&  \left(f_1(x_1, \dots , x_ n), \dots , f_ p(x_1, \dots , x_ n)\right) \\ G:\mathbb R^ p\to \mathbb R^ q \qquad G & =&  \left(g_1(f_1, \dots , f_ p), \dots , g_ q(f_1, \dots , f_ p)\right) \end{eqnarray*}</script></span>
<p>
 for arbitrary integer <script type="math/tex">p, q, n</script>, not necessarily equal, is then the chain rule is the matrix product 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \underbrace{\left(\begin{array}{ccc}\dfrac {\partial g_1}{\partial x_1} &  \cdots &  \dfrac {\partial g_1}{\partial x_ n} \\ \vdots &  \ddots &  \vdots \\ \dfrac {\partial g_ q}{\partial x_1} &  \cdots &  \dfrac {\partial g_ q}{\partial x_ n} \end{array}\right)}_{q\times n}= \underbrace{\left(\begin{array}{ccc}\dfrac {\partial g_1}{\partial f_1} &  \cdots &  \dfrac {\partial g_1}{\partial f_ p} \\ \vdots &  \ddots &  \vdots \\ \dfrac {\partial g_ q}{\partial f_1} &  \cdots &  \dfrac {\partial g_ q}{\partial f_ p} \end{array}\right)}_{q\times p} \underbrace{\left(\begin{array}{ccc}\dfrac {\partial f_1}{\partial x_1} &  \cdots &  \dfrac {\partial f_1}{\partial x_ n} \\ \vdots &  \ddots &  \vdots \\ \dfrac {\partial f_ p}{\partial x_1} &  \cdots &  \dfrac {\partial f_ p}{\partial x_ n} \end{array}\right)}_{p\times n} \end{eqnarray*}</script></span>
<p>
<b class="bf">Example:</b> The ordinary total derivative for compositions of single variable <script type="math/tex">\mathbb R\to \mathbb R</script> functions <script type="math/tex">g(x)=g(f(x))</script> is a special case of this result with <script type="math/tex">q=n=p=1</script>. For then the above matrices degenerate to a single entry (with partial derivatives becoming total derivatives): 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dg}{dx}=\frac{dg}{df}\frac{df}{dx}.</script></span>
</section><section class="subsection">
<h3 id="a0000000787">3.5.10 Relationships between Partial Derivatives and Jacobians</h3>
<p>
Recall that in 1 dimension, if <script type="math/tex">y=y(x)</script>, then the inverse function, if it exists, may be denoted by <script type="math/tex">x=x(y)</script>. Inserting the definition of <script type="math/tex">y</script> into the inverse function, we obtain the (tautological) result: 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=x(y(x)).</script></span>
<p>
 Assuming both the function and its inverse to be differentiable, if we differentiate both sides with respect to <script type="math/tex">x</script> we end up with 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dx}{dx}=\frac{dx}{dy}\frac{dy}{dx} \qquad 1=\frac{dx}{dy}\frac{dy}{dx} \qquad \frac{dy}{dx}=1\bigg/\  \left(\frac{dx}{dy}\right).</script></span>
<p>
Does the same result hold for partial derivatives, i..e, given a differentiable <script type="math/tex">z=f(x,y)</script>, does 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial z}{\partial x}=1\bigg/\  \left(\frac{\partial x}{\partial z}\right)?</script></span>
<p>
In general, the answer is an emphastic <b class="bf">NOOOOOOOOOOOOOOOO!</b>
</p>
<p>
The analogous answer (and question!) is obtained by considering the following example: 
</p>
<p>
<b class="bf">Example:</b> Consider the following <script type="math/tex">\mathbb R^2\to \mathbb R^2</script> function 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf f}:(x,y)\to (f_1,f_2)=(f_1(x,y),f_2(x,y))={\bf f}({\bf x})</script></span>
<p>
 and suppose that locally, it has an inverse function 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf x}:(f_1,f_2)\to (x,y)=(x(f_1,f_2),y(f_1,f_2))={\bf x}({\bf f})</script></span>
<p>
 Now, substituting the inverse function into the function (as in the 1-D case) we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf x}={\bf x}({\bf f}({\bf x})).</script></span>
<p>
 The 2-D chain rule with <script type="math/tex">n=p=q=2</script> and <script type="math/tex">g_1 \to x</script> and <script type="math/tex">g_2 \to y</script> gives 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(\begin{array}{cc}\dfrac {\partial x}{\partial x} &  \dfrac {\partial x}{\partial y} \\[12 pt] \dfrac {\partial y}{\partial x}&  \dfrac {\partial y}{\partial y}\end{array} \right)= \left(\begin{array}{cc}\dfrac {\partial x}{\partial f_1} &  \dfrac {\partial x}{\partial f_2} \\[12 pt] \dfrac {\partial y}{\partial f_1}&  \dfrac {\partial y}{\partial f_2}\end{array} \right) \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x}&  \dfrac {\partial f_2}{\partial y}\end{array} \right) \end{eqnarray*}</script></span>
<p>
 Now since <script type="math/tex">x</script> and <script type="math/tex">y</script> are independent variables, 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(\begin{array}{cc}\dfrac {\partial x}{\partial x} &  \dfrac {\partial x}{\partial y} \\[12 pt] \dfrac {\partial y}{\partial x}&  \dfrac {\partial y}{\partial y}\end{array} \right)= \left(\begin{array}{cc}1 &  0 \\[12 pt] 0 &  1 \end{array} \right). \end{eqnarray*}</script></span>
<p>
 Hence we have 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(\begin{array}{cc}1 &  0 \\[12 pt] 0 &  1 \end{array} \right)= \left(\begin{array}{cc}\dfrac {\partial x}{\partial f_1} &  \dfrac {\partial x}{\partial f_2} \\[12 pt] \dfrac {\partial y}{\partial f_1}&  \dfrac {\partial y}{\partial f_2}\end{array} \right) \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x}&  \dfrac {\partial f_2}{\partial y}\end{array} \right) \end{eqnarray*}</script></span>
<p>
 Since the LHS is the identity matrix, the matrices on the RHS must be inverses of each other, i.e., 
</p>
<div id="Jacinv">
<div class="eqnarrayid" id="a0000000788"></div><script type="math/tex; mode=display">
\begin{align}
\tag{3.10}\label{Jacinv} \left(\begin{array}{cc}\dfrac {\partial x}{\partial f_1} &  \dfrac {\partial x}{\partial f_2} \\[12 pt] \dfrac {\partial y}{\partial f_1}&  \dfrac {\partial y}{\partial f_2}\end{array} \right)= \left(\begin{array}{cc}\dfrac {\partial f_1}{\partial x} &  \dfrac {\partial f_1}{\partial y} \\[12 pt] \dfrac {\partial f_2}{\partial x}&  \dfrac {\partial f_2}{\partial y}\end{array} \right)^{\displaystyle -1}. 
\end{align}
</script>
</div>
<p>
 Hence the matrices of the Jacobians of the inverse functions are inverses of each other. This is a general result for <script type="math/tex">n=p=q</script> maps leading to square Jacobian matrices. 
</p>
<p>
So in general, for multivariable functions, you can see that <b class="bf">not much</b> can be said about the relationship between individual partial derivatives <script type="math/tex">\partial f/\partial x</script> and <script type="math/tex">\partial x/\partial f</script>. 
</p>
<p>
What can be said is that the Jacobian matrices of the function and the inverse function are inverses of each other! 
</p>
<p>
<b class="bf">Remark:</b> Note that in the case of <script type="math/tex">n=p=q=1</script> for single variable functions, the matrices collapse to just as single entry, so the matrix inverse is just the inverse of a scalar (i.e., the reciprocal), the partials become total derivatives and so we recover the single variable ratio result above: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dx}{df}=1\bigg/\  \left(\frac{df}{dx}\right).</script></span>
<p>
A rather useful result follows from the above derivation. 
</p>
<p>
<b class="bf">Definition: (Jacobian Determinant) </b> Let <script type="math/tex">{\bf f}:\mathbb R^ n\to \mathbb R^ n=(f_1(x_1,\dots , x_ n),f_ n(x_1,\dots x_ n))</script>, then the <b class="bf">Jacobian Determinant</b> is just the determinant of the Jacobian matrix <script type="math/tex">J_{f}</script> and is written as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\rm det} J_{\bf f}=\frac{\partial (f_1 \dots f_ n)}{\partial (x_1 \dots x_ n)}</script></span>
<p>
Then, e.g., in the case of <script type="math/tex">n=2</script>, the following theorem holds. 
</p>
<p>
<b class="bf">(Inverse Functions, Implicit Function Theorem)</b> If <script type="math/tex">f_1=f_1(x,y)</script> and <script type="math/tex">f_2=f_2(x,y)</script> have continuous partial derivatives at a point <script type="math/tex">P: (x,y)=(a,b)</script>, then provided that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left. \frac{\partial (f_1, f_2)}{\partial (x,y)} \right|_ P\ne 0,</script></span>
<p>
 there exists locally a set of inverse functions <script type="math/tex">x=x(f_1,f_2), y=y(f_1,f_2)</script>.  
</p>
<p>
<b class="bf">Very Sketchy Proof:</b> (Not required, but outlined here for information. Note that we are using <script type="math/tex">x_{1}=x, x_{2}=y</script> in the <script type="math/tex">\mathbb R^{2}\to \mathbb R^{2}</script> version of the theorem.) The result (<a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#Jacinv">3.10</a>) assumed that inverse functions existed. Hence in that instance, the Jacobian matrices will have inverses. For a <script type="math/tex">2\times 2</script> matrix, a necessary condition for the inverse to exist is that its determinant does not vanish. Hence if the Jacobian determinant does not vanish, the inverse matrix will exist, and so by implication the inverse functions. 
</p>
<p>
Note that the theorem does not find the inverse functions, it just guarantees that they exist. They may be complicated or even impossible to write down explicitly. Hence the use of the term <b class="bf">implicit</b> function theorem. 
</p>
<p>
<b class="bf">Example:</b> Given <script type="math/tex">x=r\cos \theta </script> and <script type="math/tex">y=r\sin \theta </script>, find where the inverse functions <script type="math/tex">r(x,y)</script> and <script type="math/tex">\theta (x,y)</script> exist. 
</p>
<p>
From the Implicit Function Theorem, we require the Jacobian determinant to be non-vanishing. We have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial (x, y)}{\partial (r,\theta )}=\left|\begin{array}{cc} \dfrac {\partial x}{\partial r}& \dfrac {\partial x}{\partial \theta } \\[12 pt] \dfrac {\partial y}{\partial r} &  \dfrac {\partial y}{\partial \theta }\end{array}\right|= \left|\begin{array}{cc} \cos \theta & -r\sin \theta \\[12 pt] \sin \theta &  r\cos \theta \end{array}\right|=r</script></span>
<p>
 Hence we see that inverse functions exist locally wherever <script type="math/tex">r\ne 0</script>. This is the polar origin, at which <script type="math/tex">\theta </script> is ambiguous: it can take any value from <script type="math/tex">0</script> to <script type="math/tex">2\pi </script>. 
</p>
<p>
The determinant of a Jacobian matrix will return again later when we consider changes of variables in integrals over multivariate functions. 
</p>
<p>
And finally, Jacobians should not be confused with Jacobites (who were 18th supporters of the claim of the descendants of James II of England (or VII of Scotland) to the throne of England and Scotland). :-) Jacobians are in fact, named after the mathematician Carl Gustav Jacobi (1804-1851). 
</p>
</section>
</section><section class="section">
<h2 id="a0000000789">3.6 Calculation of Derivatives of Implicit Functions.</h2>
<p>
We can use the chain rule and Jacobians to calculate (partial) derivatives associated with implicit functions. 
</p>
<section class="subsection">
<h3 id="a0000000790">3.6.1 Calculation of a Total Derivative</h3>
<p>
Consider the implicit representation: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=0,</script></span></span> for a known, given, real function <script type="math/tex">F</script> for which the partial derivatives with respect to the real variables <script type="math/tex">x</script> and <script type="math/tex">y</script> may be found. Suppose that, in principle, it is possible to rewrite this function with <script type="math/tex">y</script> as the subject, i.e., <script type="math/tex">y=y(x)</script>, locally in some interval around <script type="math/tex">x=x_{0}</script>. What is the derivative of the function <script type="math/tex">y</script> with respect to <script type="math/tex">x</script>, i.e., <script type="math/tex">dy/dx</script>? 
</p>
<p>
We can work this out using the chain rule <i class="it">without needing to even solve initially and explicitly for <script type="math/tex">y=y(x)</script>!</i>
</p>
<ul class="itemize" id="a0000000791">
<li id="a0000000792"> <p>
First, if <script type="math/tex">y=y(x)</script> (whatever <script type="math/tex">y(x)</script> may be - we don’t care), then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=F(x,y(x))=0</script></span></span>
</p>
</li>
<li id="a0000000793"> <p>
Using the chain rule, we can differentiate this with respect to <script type="math/tex">x</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}+\frac{\partial F}{\partial y}\frac{dy}{dx}=0.</script></span></span>
</p>
</li>
<li id="a0000000794"> <p>
Solving this we can obtain: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial y}.</script></span></span>
</p>
</li>
</ul>
<p>
Note that for the total derivative <script type="math/tex">dy/dx</script> to exist the partial derivatives of <script type="math/tex">F</script> need to exist and that <script type="math/tex">\partial F/\partial y \ne 0</script>. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Consider the implicit function representation of the unit circle: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=x^{2}+y^{2}-1=0.</script></span></span>
</p>
<ul class="itemize" id="a0000000795">
<li id="a0000000796"> <p>
We can compute the partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}=2x \qquad \frac{\partial F}{\partial y}=2y.</script></span></span>
</p>
</li>
<li id="a0000000797"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial y}=-\frac{2x}{2y}=-\frac{x}{y}, \qquad y\ne 0.</script></span></span>
</p>
</li>
</ul>
<figure id="ImplicitFirstExample">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0042.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.23</span>
<span class="caption_text">Chain rule for implicit function <script type="math/tex">F(x,y(x))=0</script> (left). The derivative <script type="math/tex">dy/dx</script> is the slope of the tangent line to the curve <script type="math/tex">F(x,y)=x^{2}+y^{2}-1=0</script> in the vicinity of the point <script type="math/tex">(x_{0},y_{0})</script> when, e.g., when solving the implicit representation and taking <script type="math/tex">y=+\sqrt{1-x^{2}}</script> as the explicit, single valued, representation (right). The value of <script type="math/tex">dy/dx</script> can also be checked in this case by differentiating the explicit function representation <script type="math/tex">y=+\sqrt{1-x^{2}}</script>. In more complicated problems, this latter direct approach may not be possible if no explicit representation can be found.</span>
</figcaption> </div>
</figure>
</section><section class="subsection">
<h3 id="a0000000798">3.6.2 Calculation of Partial Derivatives from an Implicit Function</h3>
<p>
Consider the implicit function representation: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y,z)=0,</script></span></span> for a known, given, real function <script type="math/tex">F</script> for which the partial derivatives with respect to the real variables <script type="math/tex">x</script>, <script type="math/tex">y</script> and <script type="math/tex">z</script> may be found. Suppose that, in principle, we could solve this locally in some domain around <script type="math/tex">(x,y)=(x_{0},y_{0})</script> to rewrite this with <script type="math/tex">z</script> as the subject, i.e., <script type="math/tex">z=z(x,y)</script>. What are the partial derivatives of the function <script type="math/tex">z</script> with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script>, i.e., <script type="math/tex">{\partial z}/{\partial x}</script>, and <script type="math/tex">{\partial z}/{\partial y}</script>? 
</p>
<p>
We can do this using the chain rule, <i class="it">without needing to even solve initially and explicitly for <script type="math/tex">z=z(x,y)</script>!</i>
</p>
<ul class="itemize" id="a0000000799">
<li id="a0000000800"> <p>
First, if <script type="math/tex">z=z(x,y)</script>, then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=F(x,y,z(x,y))=0</script></span></span>
</p>
</li>
<li id="a0000000801"> <p>
Using the chain rule, we can differentiate this with respect to <script type="math/tex">x</script> and solve for <script type="math/tex">\partial z/\partial x</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}+\frac{\partial F}{\partial z}\left(\frac{\partial z}{\partial x}\right)_{y}=0 \qquad \Rightarrow \qquad \left(\frac{\partial z}{\partial x}\right)_{y}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial z}.</script></span></span>
</p>
</li>
<li id="a0000000802"> <p>
Similarly, using the chain rule, we can differentiate this with respect to <script type="math/tex">y</script> and solve for <script type="math/tex">\partial z/\partial y</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial y}+\frac{\partial F}{\partial z}\left(\frac{\partial z}{\partial y}\right)_{x}=0 \qquad \Rightarrow \qquad \left(\frac{\partial z}{\partial y}\right)_{x}=-\frac{\partial F}{\partial y}\bigg/\frac{\partial F}{\partial z}.</script></span></span>
</p>
</li>
</ul>
<p>
 In both cases we see that locally around <script type="math/tex">(x,y)=(x_{0},y_{0})</script>, the partials of <script type="math/tex">z</script> with respect to the independent variables <script type="math/tex">(x,y)</script> exist provided that the partial derivatives of <script type="math/tex">F</script> exist and that <script type="math/tex">\partial F/\partial z\ne 0</script>. 
</p>
<p>
<b class="bf">Example:</b> Consider the implicit function: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">F(x,y)=y\sin (x+z)+\ln (y)=0.</script></span></span>
</p>
<ul class="itemize" id="a0000000803">
<li id="a0000000804"> <p>
We can compute the partial derivatives at <script type="math/tex">(x,y,z)=(0,1,0)</script> as follows (note that <script type="math/tex">F(0, 1, 0)=0</script>!): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}=y\cos (x+z) \qquad \frac{\partial F}{\partial y}=\sin (x+z)+1/y, \qquad \frac{\partial F}{\partial z}=y\cos (x+z).</script></span></span>
</p>
</li>
<li id="a0000000805"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial z}{\partial x}\right)_{y}=-\frac{\partial F}{\partial x}\bigg/\frac{\partial F}{\partial z}=-\frac{y\cos (x+z)}{y\cos (x+z)}=-\frac{\cos (0)}{\cos (0)}=-1.</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial z}{\partial y}\right)_{x}=-\frac{\partial F}{\partial y}\bigg/\frac{\partial F}{\partial z}=-\frac{\sin (x+z)+1/y}{y\cos (x+z)}=-\frac{\sin (0)+1}{\cos (0)}=-1.</script></span></span>
</p>
</li>
</ul>
</section><section class="subsection">
<h3 id="a0000000806">3.6.3 Generalisation to Systems of Implicit Functions</h3>
<p>
<i class="it">This section is included for completeness. It is not examinable, but is useful background material.</i>
</p>
<p>
Consider the implicit function representation: 
</p>
<span class="dmath"><script type="math/tex; mode=display">F(x,y,z,w)=0, \qquad G(x,y,z,w)=0.</script></span>
<p>
 for known, given, real functions <script type="math/tex">F</script> and <script type="math/tex">G</script> for which the partial derivatives with respect to the real variables <script type="math/tex">x</script>, <script type="math/tex">y</script>, <script type="math/tex">z</script>, <script type="math/tex">w</script> may be found. Here we may have multiple ways that we might try to solve these relations to obtain an explicit relationships. We may seek solutions at a point in terms of pairs of independent and dependent variables as follows (!!!): 
</p>
<div class="centered"> <table class="tabular">
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(z,w) \\ y=y(z,w),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(y,w) \\ z=z(y,w),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(y,z) \\ w=w(y,z),\end{array}\right.</script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}y=y(x,w) \\ z=y(x,w),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}y=y(x,z) \\ w=w(x,z),\end{array}\right.</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}z=z(x,y) \\ w=w(x,y),\end{array}\right.</script>
</p>
</td>
</tr>
</table> </div>
<p>
Suppose we are asked to find <script type="math/tex">\partial x/\partial z</script>. 
</p>
<p>
If we had been dealing with a single function <script type="math/tex">F(x,y,z)=0</script>, this <b class="bf">partial</b> derivative automatically would imply that <script type="math/tex">x</script> was going to be a function of the remaining variables <script type="math/tex">y</script> and <script type="math/tex">z</script>, i.e., was <script type="math/tex">\left(\partial x/\partial z\right)_{y}</script>, the derivative of <script type="math/tex">x=x(y,z)</script> with respect to <script type="math/tex">z</script>, keeping <script type="math/tex">y</script> constant. 
</p>
<p>
When we were dealing with a more than one function <script type="math/tex">F(x,y,z,w)=0, \  G(x,y,z,w)</script>, asking for <script type="math/tex">\partial x/\partial z</script> alone is ambiguous. Looking at the possible pairs of relations between independent and dependent variables above, we see that <script type="math/tex">x</script> could be expressed in terms of <script type="math/tex">z</script> and either <script type="math/tex">y</script> <b class="bf">or</b> <script type="math/tex">w</script> depending on which pair of independent variables are chosen: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left\{ \begin{array}{c}x=x(z,w) \\ y=y(z,w),\end{array}\right. \qquad {\rm or} \qquad \left\{ \begin{array}{c}x=x(y,z) \\ w=w(y,z),\end{array}\right.</script></span>
<p>
In such cases, we therefore have to specify explicitly the variables we are keeping constant in the partial derivatives: 
</p>
<div class="centered"> <table class="tabular">
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left(\partial x/\partial z\right)_{w}</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Rightarrow </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(z,w) \\ y=y(z,w),\end{array}\right. </script>
</p>
</td>
</tr>
<tr><td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left(\partial x/\partial z\right)_{y}</script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\Rightarrow </script>
</p>
</td>
<td colspan="" rowspan="" style="text-align:center"><p>
<script type="math/tex">\left\{ \begin{array}{c}x=x(y,z) \\ w=w(y,z).\end{array}\right.</script>
</p>
</td>
</tr>
</table> </div>
<p>
Suppose we now look for <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script>. We are treating the independent variables then as <script type="math/tex">z</script> and <script type="math/tex">w</script>. We therefore consider <script type="math/tex">F</script> and <script type="math/tex">G</script> as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">F(x(z,w),y(z,w),z,w)=0, \qquad G(x(z,w),y(z,w),z,w)=0,</script></span>
<p>
 and partially differentiate them with respect to <script type="math/tex">z</script> using the chain rule: 
</p>
<figure id="ChainImplicitSystem">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0044.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.24</span>
<span class="caption_text">Chain rule for implicit function <script type="math/tex">F(x(z,w),y(z,w),z,w)=0</script>. A parallel diagram for <script type="math/tex">G(x(z,w),y(z,w),z,w)=0</script> exists, identical in structure, after replacing <script type="math/tex">F</script> with <script type="math/tex">G</script>.</span>
</figcaption> </div>
</figure>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial F}{\partial x}\left(\frac{\partial x}{\partial z}\right)_{w}+\frac{\partial F}{\partial y}\left(\frac{\partial y}{\partial z}\right)_{w}+\frac{\partial F}{\partial z}=0, \qquad \frac{\partial G}{\partial x}\left(\frac{\partial x}{\partial z}\right)_{w}+\frac{\partial G}{\partial y}\left(\frac{\partial y}{\partial z}\right)_{w}+\frac{\partial G}{\partial z}=0.</script></span>
<p>
Now for given, known, <script type="math/tex">F</script> and <script type="math/tex">G</script>, all the partial derivatives of <script type="math/tex">F</script> and <script type="math/tex">G</script> with respect to <script type="math/tex">x</script>, <script type="math/tex">y</script> and <script type="math/tex">z</script> will be known. The thing we want to find is <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script>. However we also see that each of these expressions involve the also unknown <script type="math/tex">\left(\partial y/\partial z\right)_{w}</script>. This is not a problem, since we now have two linear algebraic equations in two unknowns, <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script> and <script type="math/tex">\left(\partial y/\partial z\right)_{w} </script>, with known coefficients <script type="math/tex">\partial F/\partial x</script>, <script type="math/tex">\partial F/\partial y</script>, <script type="math/tex">\partial F/\partial z</script>, <script type="math/tex">\partial G/\partial x</script>, <script type="math/tex">\partial G/\partial y</script>, <script type="math/tex">\partial G/\partial z</script>. This can be solved easily, (for example using Cramer’s rule or directly by algebraic elimination) to give: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial x}{\partial z}\right)_{w}=-\frac{(\partial F/\partial z)(\partial G/\partial y)- (\partial F/\partial y)(\partial G/\partial z)}{(\partial F/\partial x)(\partial G/\partial y)- (\partial F/\partial y)(\partial G/\partial x)}=-\frac{\partial (F,G)}{\partial (z,y)}\bigg/\frac{\partial (F,G)}{\partial (x,y)}.</script></span>
<p>
Hence the partial derivative <script type="math/tex">\left(\partial x/\partial z\right)_{w}</script> is expressed as the ratio of two Jacobian determinants of <script type="math/tex">F,G</script> with respect to the other variables <script type="math/tex">x, y, z</script>. The corresponding other solution of the algebraic equation gives the other partial derivative as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left(\frac{\partial y}{\partial z}\right)_{w}=-\frac{(\partial F/\partial z)(\partial G/\partial x)- (\partial F/\partial x)(\partial G/\partial z)}{(\partial F/\partial y)(\partial G/\partial x)- (\partial F/\partial x)(\partial G/\partial y)}=-\frac{\partial (F,G)}{\partial (z,x)}\bigg/\frac{\partial (F,G)}{\partial (y,x)}.</script></span>
<p>
Here we see that a condition for the two functions <script type="math/tex">F</script> and <script type="math/tex">G</script> to be solvable locally at a point <script type="math/tex">(x,y,z,w)=(x_{0},y_{0},z_{0},w_{0})</script> in the form of <script type="math/tex">x=x(z,w)</script> and <script type="math/tex">y=y(z,w)</script> is that the Jacobian determinant of <script type="math/tex">F</script> and <script type="math/tex">G</script> with respect to the newly chosen dependent variables <script type="math/tex">x</script> and <script type="math/tex">y</script> does not vanish, i.e., 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial (F,G)}{\partial (x,y)}\ne 0.</script></span>
<p>
 Generalisations to <script type="math/tex">n</script> functions <script type="math/tex">F_{i}, i=1, \dots n</script> in terms of <script type="math/tex">n+m</script> variables <script type="math/tex">x_{1}, x_{2}, \dots , x_{m}, y_{1},y_{2}, \dots y_{n}</script> are possible. This leads to expressions for partial derivatives <script type="math/tex">(\partial y_{i}/\partial x_{j})_{x_{1},\dots , x_{j-1},x_{j+1}\dots x_{m}}</script> expressed in terms of ratios of <script type="math/tex">n \times n</script> Jacobian determinants. However, that is an exercise in extreme tedium. 
</p>
</section>
</section><section class="section">
<h2 id="a0000000807">3.7 Definition of Gradient</h2>
<p>
We have seen that for a multivariable function <script type="math/tex">f:\mathbb R^{2}\to \mathbb R</script>, we have, in general, two “obvious” partial derivatives that we may take, namely <script type="math/tex">\partial f/\partial x</script> and <script type="math/tex">\partial f/\partial y</script>. A combination of these that is extremely useful, and which will come up time and time again in equations is the <b class="bf">gradient</b> of <script type="math/tex">f</script>. 
</p>
<p>
<b class="bf">Definition: (Gradient)</b> Let <script type="math/tex">f: {\mathbb R}^2\rightarrow {\mathbb R}</script> be a function. Assume that both partial derivatives exist at a point <script type="math/tex">(x,y)\in \mathbb R^2</script>. We define the <em>gradient</em> of <script type="math/tex">f(x,y)</script> to be the vector of partial derivatives 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) = \left( \frac{\partial f}{\partial x} (x,y), \frac{\partial f}{\partial y} (x,y) \right).</script></span>
<p>
One important thing to note is that, while <script type="math/tex">f: {\mathbb R}^2\rightarrow {\mathbb R}</script>, its gradient <script type="math/tex">\nabla f (x,y)</script> is a <b class="bf">vector</b> function <script type="math/tex">\nabla f: {\mathbb R}^2\rightarrow {\mathbb R}^2</script>. For this reason in <script type="math/tex">\mathbb R^{2}</script>, if we assign unit vectors <b class="bf">i</b> and <b class="bf">j</b> to the positive <script type="math/tex">x, y</script> directions respectively, we can write <script type="math/tex">\nabla f</script> as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) = \frac{\partial f}{\partial x} {\bf i} +\frac{\partial f}{\partial y}{\bf j},</script></span>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0046.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.25</span>
<span class="caption_text">Representation of the vector which is the gradient of a function <script type="math/tex">f(x,y)</script> in the <script type="math/tex">(x,y)</script> plane at a point <script type="math/tex">P</script>, <script type="math/tex">(x_{p},y_{p})</script>.</span>
</figcaption> </div>
</figure>
<p>
More generally, we can define the <i class="it">gradient</i> of a function <script type="math/tex">f(x_1,\ldots , x_ n)</script> of <script type="math/tex">n</script> variables to again be the vector of partial derivatives 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x_1, \ldots , x_ n) = \left( \frac{\partial f}{\partial x_1} (x_1,\ldots , x_ n), \ldots , \frac{\partial f}{\partial x_ n} (x_1,\ldots , x_ n)\right).</script></span>
<p>
For <script type="math/tex">f(x,y,z):\mathbb R^{3}\to \mathbb R</script> the gradient can be written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y,z) = \frac{\partial f}{\partial x} {\bf i} +\frac{\partial f}{\partial y}{\bf j}+\frac{\partial f}{\partial z}{\bf k},</script></span>
<p>
 where <b class="bf">k</b> is the unit vector pointing in the positive <script type="math/tex">z</script> direction. 
</p>
<figure id="3dplot123">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0048.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.26</span>
<span class="caption_text">Representation of the vector which is the gradient of a function <script type="math/tex">f(x,y,z)</script> in <script type="math/tex">(x,y,z)</script> space at a point <script type="math/tex">P</script>, <script type="math/tex">(x_{p},y_{p},z_{p})</script>.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b> Find the gradients of the functions <script type="math/tex">f(x,y)=x+y -1</script>,  <script type="math/tex">g(x, y)= e^ x + xe^ y</script>, and <script type="math/tex">h(x, y, z )=x^2+y^2 +z^2+3</script>. 
</p>
<p>
<span style="color:#FF0000"><script type="math/tex">\nabla f(x,y) = \left( \frac{\partial f}{\partial x} (x,y), \frac{\partial f}{\partial y} (x,y) \right)= (1, 1),</script></span>
</p>
<p>
<span style="color:#FF0000"><script type="math/tex">\nabla g(x,y) = (e^ x+e^ y, xe^ y),</script></span>
</p>
<p>
<span style="color:#FF0000"><script type="math/tex">\nabla h(x,y, z) = (2x, 2y, 2z)</script>.</span>
</p>
<p>
<br/>
</p>
</section><section class="section">
<h2 id="a0000000808">3.8 Tangent Planes</h2>
<p>
A differentiable curve in one dimension has a tangent line at each point. This is the straight line that passes through the chosen point on the curve, but which has the same slope of the curve at that point. 
</p>
<figure id="TangentLine">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0050.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.27</span>
<span class="caption_text">Tangent line (dotted), tangent vector <b class="bf">t</b> and normal vector <b class="bf">n</b> at a point <script type="math/tex">P</script> on the (differentiable) curve <script type="math/tex">y=f(x)</script>.</span>
</figcaption> </div>
</figure>
<p>
We can set up unit vectors <b class="bf">i</b>, <b class="bf">j</b>, in the <script type="math/tex">x,y,</script> directions respectively. 
</p>
<p>
Note that a vector that is tangential to the curve at a chosen point <script type="math/tex">P</script> is given by (see figure <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#TangentLine">3.27</a>), 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf t}={\bf i} +\left(\frac{df}{dx}\right)_ P{\bf j}.</script></span>
<p>
A vector <b class="bf">n</b> normal to this curve satisfies <script type="math/tex">{\bf t.n}=0</script>. A little bit of thought gives this as 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf n}=-\left(\frac{df}{dx}\right)_ P{\bf i} +{\bf j}.</script></span>
<p>
Suppose we now consider the smooth surface <script type="math/tex">z=f(x,y)</script> (we return to what we mean by “smooth” later, but for now just think of it has having no kinks or creases). At each point on this surface, there will be two normal directions to the surface (parallel, but in opposite directions to each other). 
</p>
<p>
It is then possible to define a <b class="bf">tangent plane</b> <script type="math/tex">{\mathcal T}</script> at a chosen point <script type="math/tex">P</script> on the surface. This is the plane that passes through the point <script type="math/tex">P</script>, but is everywhere perpendicular to either of the normal directions <script type="math/tex">\pm {\bf n}</script> (see figure <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#TangentPlane226a">3.28</a>). 
</p>
<figure id="TangentPlane226a">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0052.png" style="width:271.0125pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.28</span>
<span class="caption_text">Tangent plane <script type="math/tex">{\mathcal T}</script> at the point <script type="math/tex">P:(a,b,f(a,b)</script> that is everywhere normal to one of the normal vectors <script type="math/tex">\pm {\bf n}</script>. Also show is a general point <script type="math/tex">{\bf r}</script> in the tangent plane and the vector <script type="math/tex">{\bf r}-{\bf OP}</script> that lies wholly within the tangent plane.</span>
</figcaption> </div>
</figure>
<p>
What is the equation of this tangent plane at <script type="math/tex">P</script>? We can proceed as follows: 
</p>
<ul class="itemize" id="a0000000809">
<li id="a0000000810"> <p>
We can set up unit vectors <b class="bf">i</b>, <b class="bf">j</b>, <b class="bf">k</b> in the <script type="math/tex">x,y,</script> and <script type="math/tex">z</script> directions respectively. 
</p>
</li>
<li id="a0000000811"> <p>
Now suppose that the chosen point <script type="math/tex">P</script> on the surface has <script type="math/tex">(x,y,z)</script> coordinates given by <script type="math/tex">(a,b,f(a,b))</script>. It will have a position vector relative to the origin given by <b class="bf">OP</b> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf OP}=a{\bf i}+b{\bf j}+f(a,b){\bf k}.</script></span>
</li>
<li id="a0000000812"> <p>
We know the slope of the surface in the <script type="math/tex">x</script> direction. It is given by <script type="math/tex">(\partial f/\partial x)_ p</script>. This is the rate of change of the height of the surface in the <script type="math/tex">x</script> direction. Hence, by analogy with the 1-D case above, a vector tangential to the surface in the <script type="math/tex">x</script> direction is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf t_ x}={\bf i} +\left(\frac{\partial f}{\partial x}\right)_ P{\bf k}</script></span>
</li>
<li id="a0000000813"> <p>
We also know the slope of the surface in the <script type="math/tex">y</script> direction. It is given by <script type="math/tex">\partial f/\partial y</script>. This is the rate of change of the height of the surface in the <script type="math/tex">y</script> direction. Hence, by analogy with the 1-D case above, a vector tangential to the surface in the <script type="math/tex">y</script> direction is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf t_ y}={\bf j} +\left(\frac{\partial f}{\partial y}\right)_ P{\bf k}</script></span>
</li>
<li id="a0000000814"> <p>
We can now find a normal <b class="bf">n</b> to the surface by taking the vector product of the two tangent vectors. 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf n}={\bf t_ x}\times {\bf t_ y}=\left|\begin{array}{ccc}{\bf i} &  {\bf j} &  {\bf k} \\ 1 &  0 &  \left( \dfrac {\partial f}{\partial x} \right)_ P \\[12 pt] 0 &  1 &  \left( \dfrac {\partial f}{\partial y}\right)_ P \end{array}\right|= -\left(\frac{\partial f}{\partial x}\right)_ P{\bf i}-\left(\frac{\partial f}{\partial y}\right)_ P{\bf j}+{\bf k}</script></span>
</li>
<li id="a0000000815"> <p>
The other normal in the other direction is then 
</p>
<span class="dmath"><script type="math/tex; mode=display">-{\bf n}= \left(\frac{\partial f}{\partial x}\right)_ P{\bf i}+\left(\frac{\partial f}{\partial y}\right)_ P{\bf j}-{\bf k}</script></span>
</li>
<li id="a0000000816"> <p>
Now suppose that the chosen point <script type="math/tex">P</script> on the surface has <script type="math/tex">(x,y,z)</script> coordinates given by <script type="math/tex">(a,b,f(a,b))</script>. It will have a position vector relative to the origin given by <b class="bf">OP</b> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf OP}=a{\bf i}+b{\bf j}+f(a,b){\bf k}.</script></span>
</li>
<li id="a0000000817"> <p>
Likewise, suppose a general point on the tangent plane is given by the position vector <b class="bf">r</b> where 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf r}=x{\bf i}+y{\bf j}+z{\bf k}</script></span>
</li>
<li id="a0000000818"> <p>
The vector <b class="bf">r-OP</b> is a vector that joins the point <script type="math/tex">P</script> to any other general point on the tangent plane at <script type="math/tex">P</script>. The vector <b class="bf">r-OP</b> therefore lies wholly within the tangent plane. Consequently it must be perpendicular to either of the normals <script type="math/tex">\pm </script><b class="bf">n</b> at <script type="math/tex">P</script>. Hence we must have 
</p>
<span class="dmath"><script type="math/tex; mode=display">({\bf r-OP})\cdot {\bf n}=0.</script></span>
</li>
<li id="a0000000819"> <p>
Substituting for <b class="bf">r</b>, <b class="bf">OP</b> and <b class="bf">n</b> this equation becomes 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left\{  x{\bf i}+y{\bf j}+z{\bf k}-(a{\bf i}+b{\bf j}+f(a,b){\bf k})\right\} \cdot {\bf n}=0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">\left\{  (x-a){\bf i}+(y-b){\bf j}+(z-f(a,b)){\bf k}\right\} \cdot {\bf n}=0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">\left\{  (x-a){\bf i}+(y-b){\bf j}+(z-f(a,b)){\bf k}\right\} \cdot \left\{  -\left(\frac{\partial f}{\partial x}\right)_ P{\bf i}-\left(\frac{\partial f}{\partial y}\right)_ P{\bf j}+{\bf k}\right\} =0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">-(x-a)\left(\frac{\partial f}{\partial x}\right)_ P-(y-b)\left(\frac{\partial f}{\partial y}\right)_ P+(z-f(a,b))=0.</script></span>
<span class="dmath"><script type="math/tex; mode=display">\boxed { z=f(a,b)+(x-a)\left(\frac{\partial f}{\partial x}\right)_ P+(y-b)\left(\frac{\partial f}{\partial y}\right)_ P}.</script></span>
</li>
</ul>
<p>
Note that we can express the equation of the plane in terms of the gradient of the function evaluated at <script type="math/tex">P</script> in the following way: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\boxed { z=f(a,b)+\nabla f(a,b) \cdot \left( (x-a){\bf i}+(y-b){\bf j}\right)}.</script></span>
<p>
<b class="bf">Example:</b> Compute the tangent plane to the surface <script type="math/tex">z=x^2+y^2</script> at the point P above <script type="math/tex">(x,y)=(1,2)</script>. 
</p>
<ul class="itemize" id="a0000000820">
<li id="a0000000821"> <p>
Note that <script type="math/tex">z=x^2+y^2</script>, so that in the notation of derivation above we have <script type="math/tex">f(x,y)=x^2-y^2</script>. 
</p>
</li>
<li id="a0000000822"> <p>
We also have the coordinates of the point <script type="math/tex">P</script> on the surface as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">(a,b,f(a,b))=(1,2,f(1,2))=(1,2,1^2+2^2)=(1,2,5)</script></span>.</span>
</p>
</li>
<li id="a0000000823"> <p>
Hence the ingredients for the formula for the tangent surface are: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}=2x, \qquad \Rightarrow \qquad \left(\frac{\partial f}{\partial x}\right)_ P=2\times 1=2</script></span> <span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial y}=2y, \qquad \Rightarrow \qquad \left(\frac{\partial f}{\partial x}\right)_ P=2\times 2=4</script></span></span>
</p>
</li>
<li id="a0000000824"> <p>
Hence the tangent surface at <script type="math/tex">P</script> is given by <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  z& =& f(a,b)+(x-a)\left(\frac{\partial f}{\partial x}\right)_ P+(y-b)\left(\frac{\partial f}{\partial y}\right)_ P\\ \Rightarrow z& =& 5+2(x-1)+4(y-2)\\ \Rightarrow z& =& 2x+4y-5 \end{eqnarray*}</script></span></span>
</p>
</li>
</ul>
<figure id="TangentPlane1">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0054.png" style="width:505.89pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.29</span>
<span class="caption_text">Different views of the tangent plane <script type="math/tex">z=2x+4y-5</script> to the surface <script type="math/tex">z=x^{2}+y^{2}</script> at <script type="math/tex">P=(1,2,5)</script>.</span>
</figcaption> </div>
</figure>
<p>
Recall that for a curve <script type="math/tex">y=F(x)</script> in 1-D, the tangent line at the point <script type="math/tex">(a,F(a))</script> is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">y=F(a)+\left(\frac{df}{dx}\right)_{x=a}(x-a).</script></span>
<p>
 The tangent line gives a linear approximation to the line and is the first two terms of the Taylor series expansion of <script type="math/tex">y=F(x)</script> about <script type="math/tex">(a, F(a))</script>. 
</p>
<p>
It is then not too difficult to see that the tangent plane is a linear expansion of the function <script type="math/tex">z=f(x,y)</script> about the point <script type="math/tex">P= (a,b,f(a,b))</script>. In fact it is the first two terms in the multivariable Taylor series expansion of <script type="math/tex">z=f(x,y)</script> at <script type="math/tex">P</script>, which we will study later. 
</p>
<p>
Tangent hyper-planes can also be derived for hypersurfaces <script type="math/tex">f:\mathbb R^ n\to \mathbb R</script>. The formula take a similar form to that derived above: a sum of linear differences in the variable from the tangent point multiplied by the appropriate partial derivative at that point plus the value of the function at that point. 
</p>
</section><section class="section">
<h2 id="a0000000825">3.9 Differentiability</h2>
<p>
We now examine what it means for a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> to be differentiable. We again recall the definition of a derivative of a function <script type="math/tex">f(x)</script> in one variable at a point <script type="math/tex">x=a</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">f’(a) = \lim _{h\rightarrow 0}\frac{f(a+h) -f(a)}{h}.</script></span>
<p>
 Since <script type="math/tex">f'(a)</script> is a constant, we can carry it over to the right hand side and use basic properties of limits to see that we can rewrite this equation as 
</p>
<div class="eqn" id="a0000000826">
<script type="math/tex; mode=display">\begin{equation}\lim _{h\rightarrow 0} \frac{f(a+h) -f(a) - f'(a)h}{h}=0.\tag{3.11}\end{equation}</script>
</div>
<p>
We can then say that the function <script type="math/tex">f:\mathbb R\to \mathbb R</script> is <i class="it">differentiable</i> at a point <script type="math/tex">x=a</script> if there exists <script type="math/tex">f'(a)\in \mathbb R</script> so that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a+h)-f(a)-f'(a)h}{h}=0.</script></span>
<p>
We also know that the derivative <script type="math/tex">f'(a)</script> has a geometric interpretation as the slope of the line tangent to the graph of the function at the point <script type="math/tex">(a, f(a))\in \mathbb R^2</script>. So, the function is differentiable when such a tangent line exists and hence its slope is well-defined. 
</p>
<p>
If we now consider a function of two variables <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> instead, then the tangent line is replaced by the tangent plane at a given point <script type="math/tex">(a,b, f(a,b))</script>. So, the function would be differentiable at <script type="math/tex">(a,b)</script> when such a tangent plane exists. 
</p>
<p>
The tangent plane does not have a single slope but rather many slopes coming from different directions. We then compute the slopes in the <script type="math/tex">x</script> and <script type="math/tex">y</script> directions, that is, when we fix <script type="math/tex">y=b</script> and <script type="math/tex">x=a</script> respectively and consider the slopes of the lines <script type="math/tex">(x,b, f(x,b))</script> and <script type="math/tex">(a,y, f(a,y))</script> in the tangent plane. These slopes are precisely the partial derivatives of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(a,b)</script>. 
</p>
<p>
So, for a function <script type="math/tex">f(x,y)</script> to be differentiable at <script type="math/tex">(a,b)</script>, the gradient <script type="math/tex">\nabla f(a,b)</script> needs to exist.<a class="footnote" href="#a0000000827">
<sup class="footnotemark">6</sup>
</a>
</p>
<section class="subsection">
<h3 id="a0000000828">3.9.1 Differentiability in the case of two variable functions</h3>
<p>
 Now, let us make the precise definition of differentiability. We will only do this for a function <script type="math/tex">f:\mathbb R^2 \to \mathbb R</script>: 
</p>
<p>
<b class="bf">Definition: (Differentiability)</b> A function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is <i class="it">differentiable</i> at a point <script type="math/tex">(a,b)\in \mathbb R^2</script> if there is a vector <script type="math/tex">{\bf v}=(v_1, v_2)\in \mathbb R^2</script> so that 
</p>
<div class="eqn" id="diff_cont">
<script type="math/tex; mode=display">\begin{equation}\label{diffd}\displaystyle {\lim _{(h,k) \rightarrow (0,0)}} \frac{f(a+h, b+k)-f(a,b)- {\bf v}\cdot (h,k)}{\sqrt{h^2 +k^2}}=0.\tag{3.12}\end{equation}</script>
</div>
<p>
The vector <script type="math/tex">{\bf v}</script> is a bit mysterious. However, the following theorem shows why it is natural in the definition of differentiability and explains precisely what it is. 
</p>
<p>
 If the function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is differentiable at a point <script type="math/tex">(a,b)\in \mathbb R^2</script>, then it is continuous at <script type="math/tex">(a,b)</script>. Moreover, the vector <script type="math/tex">{\bf v}</script> defined by (<a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#diff_cont">3.12</a>) is unique and is equal to <script type="math/tex">\nabla f(a,b)</script>.  
</p>
<p>
<b class="bf">Proof:</b>
</p>
<ul class="itemize" id="a0000000829">
<li id="a0000000830"> <p>
To see the first assertion note that <script type="math/tex">\displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {\sqrt{h^2 +k^2}}=0.</script> This together with (<a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#diff_cont">3.12</a>) and the limit rules in lemma 1.4.1, gives us 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {\sqrt{h^2 +k^2}}\cdot \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} \frac{f(a+h, b+k)-f(a,b)- {\bf v}\cdot (h,k)}{\sqrt{h^2 +k^2}}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {f(a+h, b+k)-f(a,b)- {\bf v}\cdot (h,k)}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {f(a+h, b+k)-f(a,b)}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{(h,k) \rightarrow (0,0)}} {f(a+h, b+k)=f(a,b)}.</script></span>
<p>
This is the definition of continuity (see section 1.4.4) and so a differentiable function at a point is continuous there also. (NB the converse is <b class="bf">not</b> true! Just fold a piece of paper and make a crease: the surface is continuous, but not differentiable for the reason we now see below.) 
</p>
</li>
<li id="diff"> <p>
To see the second assertion, note that we get the same limit if we let <script type="math/tex">k=0</script> in (<a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#diff_cont">3.12</a>), since for the limit to exist, which it does by assumption, the value must be the same, regardless of the direction of approach. We can pick to approach the limit from a direction where <script type="math/tex">k=0</script>, without loss of generality. Hence we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{(h,0) \rightarrow (0,0)}} \frac{f(a+h, b)-f(a,b)-(v_1, v_2)\cdot (h,0)}{|h|}=0.</script></span>
<p>
Since the limit exists by assumption and equals zero by definition, it does not depend on whether <script type="math/tex">h>0</script> or <script type="math/tex">h<0</script> (any extra negative sign <script type="math/tex">(-1)</script> from the modulus may be divided away into the zero). Hence we can write: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h \rightarrow 0}}\frac{f(a+h, b)-f(a,b)-(v_1, v_2)\cdot (h,0)}{h}=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \displaystyle {\lim _{h \rightarrow 0}} \frac{f(a+h, b)-f(a,b)}{h}-v_1=0,</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad v_1=\displaystyle {\lim _{h \rightarrow 0}} \frac{f(a+h, b)-f(a,b)}{h}=\frac{\partial f}{\partial x}(a,b).</script></span>
<p>
Similarly, by letting <script type="math/tex">h=0</script>, we get 
</p>
<span class="dmath"><script type="math/tex; mode=display">v_2=\displaystyle {\lim _{k\rightarrow 0}} \frac{f(a, b+k)-f(a,b)}{h}=\frac{\partial f}{\partial y}(a,b).</script></span>
<p>
 Note that the vector 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf v}=(v_1, v_2)=\left(\frac{\partial f}{\partial x}(a,b),\frac{\partial f}{\partial y}(a,b)\right)</script></span>
<p>
 is thus just the gradient of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(a,b)</script>. 
</p>
</li>
</ul>
<p>
We have just shown that if a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> is differentiable at a point <script type="math/tex">(a,b)\in \mathbb R^2</script>, then it is continuous at <script type="math/tex">(a,b)</script> and its partial derivatives <script type="math/tex">{\displaystyle \frac{\partial f}{\partial x}}</script> and <script type="math/tex">{\displaystyle \frac{\partial f}{\partial y}}</script> exist at that point. Equivalently, if <script type="math/tex">f</script> is differentiable, <script type="math/tex">\nabla f</script> exists at <script type="math/tex">(a,b)</script>. 
</p>
<p>
There is a useful criteria that almost states the converse, guaranteeing that a function is differentiable at a given point. The proof of the theorem is not required, but we will use it in the subsequent examples. 
</p>
<p>
 If both partial derivatives <script type="math/tex">{\displaystyle \frac{\partial f}{\partial x}}</script> and <script type="math/tex">{\displaystyle \frac{\partial f}{\partial y}}</script> of a function <script type="math/tex">f: \mathbb R^2\to \mathbb R</script> exist and are continuous on a neighbourhood of a point <script type="math/tex">(a,b)</script> then <script type="math/tex">f</script> is differentiable at <script type="math/tex">(a,b)</script>.  
</p>
<p>
<b class="bf">Example:</b> Show that the function 
</p>
<span class="dmath"><script type="math/tex; mode=display">f(x,y)= x^2 +y^2+ xy \exp {(x^2+y^2)}</script></span>
<p>
 is differentiable. 
</p>
<p>
First, we compute the partial derivatives. <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\displaystyle \frac{\partial f}{\partial x}}(x,y)=2x +y\exp {(x^2+y^2)}+ 2x^2y\exp {(x^2+y^2)},</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\displaystyle \frac{\partial f}{\partial y}}(x,y)=2y +x\exp {(x^2+y^2)}+ 2xy^2\exp {(x^2+y^2)}.</script></span></span> As these partial derivatives are formed from continuous functions via products, sums and compositions they are also continuous. So, by Theorem <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#diff">2</a>, <script type="math/tex">f(x,y)</script> is differentiable. 
</p>
<p>
The definition of differentiability leads us on to a really neat trick. 
</p>
</section>
</section><section class="section">
<h2 id="direction">3.10 Directional derivative</h2>
<section class="subsection">
<h3 id="a0000000831">3.10.1 Definition of Directional Derivative</h3>
<p>
For a function of two or more variables, we have already seen that its partial derivatives describe the rate of change of the function in either <script type="math/tex">x</script> or <script type="math/tex">y</script> directions depending which partial derivative we consider. In this section we discuss how one can measure the rate of change of such a function in <b class="bf">any</b> chosen direction. 
</p>
<p>
We can appeal to the definitions of partial derivatives of a function <script type="math/tex">f(x,y)</script> in the <script type="math/tex">x</script> and <script type="math/tex">y</script> directions and write down a definition of the derivative of a function in the direction of a unit vector <b class="bf">w</b> emerging from the point <script type="math/tex">(a, b, f(a,b))</script> and tangential to the surface in that direction. 
</p>
<p>
<b class="bf">Definition: (Directional Derivative)</b> Let <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> and <script type="math/tex">{\bf u}</script> be a unit vector in <script type="math/tex">{\mathbb R}^2</script>. The <em>directional derivative</em> (or <em>rate of change</em>) of <script type="math/tex">f</script> in the direction <script type="math/tex">{\bf u}</script> at the point <script type="math/tex">(a,b)\in \mathbb R^2</script> is defined to be 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u}(f)(a,b) = \lim _{h\rightarrow 0} \frac{f((a,b) + h{\bf u}) - f(a,b)}{h}.</script></span>
<p>
 provided this limit exists. 
</p>
<figure id="DirectionalDerivativs">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0056.png" style="width:271.0125pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.30</span>
<span class="caption_text">The tangent plane <script type="math/tex">{\mathcal T}</script> to surface <script type="math/tex">z=f(x,y)</script> at point <script type="math/tex">P:(a,b,f(a,b))</script> contains an infinite number of vectors <script type="math/tex">{\bf w}_ i</script>. The derivative of the function <script type="math/tex">f(x,y)</script> is, in general, different in each of these directions. The projection of these vectors <script type="math/tex">{\bf w}_{i}</script> onto a unit disk <script type="math/tex">{\mathcal C}</script> centred at <script type="math/tex">Q:(a,b)</script> are unit vectors <script type="math/tex">{\bf u}_{i}</script>. <script type="math/tex">(x,y)</script> plane are unit vectors <script type="math/tex">{\bf u}_{i}</script></span>
</figcaption> </div>
</figure>
<p>
Actually, by working through the definition of the derivative, we can come up with a much simpler formula for the directional derivative that is easy to use in practice. 
</p>
<p>
 Suppose <script type="math/tex">f: \mathbb R^2\to \mathbb R</script> is differentiable at <script type="math/tex">(a,b)\in \mathbb R^2</script> and <script type="math/tex">{\bf u}</script> is a unit vector. Then the directional derivative of <script type="math/tex">f</script> in the direction <script type="math/tex">{\bf u}</script> at <script type="math/tex">(a,b)</script> is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (a,b) = \nabla f(a,b) \cdot {\bf u}.</script></span>
<div class="proof_wrapper" id="a0000000832">
<div class="proof_heading">
<span class="proof_caption">
    Proof.
    </span>
</div>
<div class="proof_content">
<p>
We can write <script type="math/tex">{\bf u} = (\alpha , \beta )\in \mathbb R^2</script> where <script type="math/tex">\alpha ^2+\beta ^2=1</script>, because <script type="math/tex">{\bf u}</script> is a unit vector. Since <script type="math/tex">f: \mathbb R^2\to \mathbb R</script> is differentiable at <script type="math/tex">(a,b)</script>, by (<a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#diff_cont">3.12</a>) and Theorem <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#diff_cont">3.12</a>, we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a +h\alpha ,b+h\beta )-f(a,b)- {\nabla f(a,b)}\cdot (h\alpha ,h\beta )}{\sqrt{(h\alpha )^2 +(h\beta )^2}}=0</script></span>
<p>
 Since <script type="math/tex">\alpha ^2+\beta ^2=1</script>, it follows that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a +h\alpha ,b+h\beta )-f(a,b)- {\nabla f(a,b)}\cdot (h\alpha ,h\beta )}{h}=0.</script></span>
<p>
 This gives us 
</p>
<span class="dmath"><script type="math/tex; mode=display">\displaystyle {\lim _{h\rightarrow 0}} \frac{f(a +h\alpha ,b+h\beta )-f(a,b)}{h}=\nabla f(a,b) \cdot (\alpha , \beta ).</script></span>
<p>
 But the left-hand side of the above identity is exactly the directional derivative and thus 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u}(f)(a,b)=\nabla f(a,b) \cdot {\bf u}</script></span>
<p>
 as desired. 
</p>
</div>
</div>
</section><section class="subsection">
<h3 id="a0000000833">3.10.2 Geometric Meaning of Directional Derivative</h3>
<p>
 We are now in a position to deduce the geometric meaning of the gradient that we introduced above, from the definition of the directional derivative. We use the property of dot products that 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf a}\cdot {\bf b} = |{\bf a}|\:  |{\bf b}|\cos (\theta )</script></span>
<p>
 where <script type="math/tex">\theta </script> is the angle between <script type="math/tex">{\bf a}</script> and <script type="math/tex">{\bf b}</script>. Letting <script type="math/tex">\theta </script> be the angle between <script type="math/tex">\nabla f(a,b)</script> and <script type="math/tex">{\bf u}</script>, we see that 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (a,b) = \nabla f(a,b) \cdot {\bf u} = | \nabla f(a,b)| \:  |{\bf u}|\cos (\theta ) = | \nabla f(a,b)|\cos (\theta ),</script></span>
<p>
 since <script type="math/tex">{\bf u}</script> is a unit vector. 
</p>
<p>
We see that since <script type="math/tex">\nabla f(a,b)</script> is given constant vector when evaluated at the point <script type="math/tex">(a,b)</script>, to maximise <script type="math/tex">D_{\bf u} (f) (a,b)</script>, we only need to maximise <script type="math/tex">\cos (\theta )</script>. Therefore, we obtain the following geometric properties of the gradient. 
</p>
<figure id="TangentPlane">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0058.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.31</span>
<span class="caption_text">Geometric meaning of directional derivative relative to a unit vector <b class="bf">u</b> and the gradient vector <script type="math/tex">\nabla f</script> at a point <script type="math/tex">(a,b)</script>, superimposed on a contour plot of a <script type="math/tex">\mathbb R^{2}\to \mathbb R</script> function.</span>
</figcaption> </div>
</figure>
<ol class="enumerate" id="a0000000834" style="list-style: none">
<li id="a0000000835" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
The function <script type="math/tex">f</script> increase the most rapidly at <script type="math/tex">(a,b)</script> when <script type="math/tex">\theta = 0</script>, which is when <script type="math/tex">{\bf u}</script> is pointing in the same direction as <script type="math/tex">\nabla f(a,b)</script>.<br/>
</p>
</li>
<li id="a0000000836" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
The function <script type="math/tex">f</script> decrease the most rapidly at <script type="math/tex">(a,b)</script> when <script type="math/tex">\theta = \pi </script>, which is when <script type="math/tex">{\bf u}</script> is pointing in the opposite direction as <script type="math/tex">\nabla f(a,b)</script>.<br/>
</p>
</li>
<li id="a0000000837" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
The rate of change of the function <script type="math/tex">f</script> is zero <script type="math/tex">(a,b)</script> when <script type="math/tex">\theta = {\pi \over 2}</script>, which is when <script type="math/tex">{\bf u}</script> is perpendicular to the direction of <script type="math/tex">\nabla f(a,b)</script>. 
</p>
</li>
<li id="a0000000838" value="4">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Choosing <b class="bf">u</b>=<b class="bf">i</b> we obtain 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf i} (f) (x,y)=\nabla f \cdot {\bf i}=\frac{\partial f}{\partial x}</script></span>
</li>
<li id="a0000000839" value="5">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iv)
	</span>
<p>
Choosing <b class="bf">u</b>=<b class="bf">j</b> we obtain 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{\bf j} (f) (x,y)=\nabla f \cdot {\bf j}=\frac{\partial f}{\partial y}</script></span>
</li>
</ol>
<p>
 For a given function <script type="math/tex">f(x,y)</script>, the sorts of calculations we do with the directional derivative involve solving the equation <script type="math/tex">D_{\bf u}(f)(a,b) = c</script> when two of the parameters <script type="math/tex">{\bf u}</script>, <script type="math/tex">(a,b)</script> and <script type="math/tex">c</script> are specified. 
</p>
</section><section class="subsection">
<h3 id="a0000000840">3.10.3 Examples of Directional Derivative</h3>
<p>
<b class="bf">Examples:</b>
</p>
<p>
Evaluate the directional derivative of the function <script type="math/tex">z=f(x,y)</script> where <script type="math/tex">f(x,y)=e^{x^2+y^2}</script> at the point <script type="math/tex">(x,y)=(1,1)</script> in the direction 
</p>
<p>
(a) <script type="math/tex">{\bf i}+{\bf j}</script>. 
</p>
<ul class="itemize" id="a0000000841">
<li id="a0000000842"> <p>
Remember that to find the directional derivative <b class="bf">u</b> has to be a <b class="bf">unit vector</b>. Hence we must have that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\frac{{\bf i}+{\bf j}}{|{\bf i}+{\bf j}|}=\frac{1}{\sqrt{2}}\left({\bf i}+{\bf j}\right).</script></span></span>
</p>
</li>
<li id="a0000000843"> <p>
We calculate the gradient of <script type="math/tex">f(x,y)</script> as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) =\frac{\partial }{\partial x}\left(e^{x^2+y^2}\right){\bf i}+\frac{\partial }{\partial y}\left(e^{x^2+y^2}\right){\bf j}=2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000844"> <p>
Therefore we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (x,y) = \nabla f(x,y) \cdot {\bf u}=\left(2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}\right)\cdot \frac{1}{\sqrt{2}}\left({\bf i}+{\bf j}\right)=\left(\sqrt{2}xe^{x^2+y^2}+\sqrt{2}ye^{x^2+y^2}\right).</script></span></span>
</p>
</li>
<li id="a0000000845"> <p>
Hence when <script type="math/tex">(x,y)=(1,1)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (1,1)=\left(\sqrt{2}e^{2}+\sqrt{2}e^{2}\right)=2\sqrt{2}e^{2}.</script></span></span>
</p>
</li>
</ul>
<p>
(b) <script type="math/tex">{\bf i}-{\bf j}</script>
</p>
<ul class="itemize" id="a0000000846">
<li id="a0000000847"> <p>
Remember that to find the directional derivative <b class="bf">u</b> has to be a <b class="bf">unit vector</b>. Hence we must have that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\frac{{\bf i}+{\bf j}}{|{\bf i}-{\bf j}|}=\frac{1}{\sqrt{2}}\left({\bf i}-{\bf j}\right).</script></span></span>
</p>
</li>
<li id="a0000000848"> <p>
We calculate the gradient of <script type="math/tex">f(x,y)</script> as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) =\frac{\partial }{\partial x}\left(e^{x^2+y^2}\right){\bf i}+\frac{\partial }{\partial y}\left(e^{x^2+y^2}\right){\bf j}=2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000849"> <p>
Therefore we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (x,y) = \nabla f(x,y) \cdot {\bf u}=\left(2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}\right)\cdot \frac{1}{\sqrt{2}}\left({\bf i}-{\bf j}\right)=\left(\sqrt{2}xe^{x^2+y^2}-\sqrt{2}ye^{x^2+y^2}\right).</script></span></span>
</p>
</li>
<li id="a0000000850"> <p>
Hence when <script type="math/tex">(x,y)=(1,1)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (1,1)=\left(\sqrt{2}e^{2}-\sqrt{2}e^{2}\right)=0.</script></span></span> So we may also conclude that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\frac{1}{\sqrt{2}}\left({\bf i}-{\bf j}\right)</script></span></span> is in the direction of the level contour of <script type="math/tex">f(x,y)</script> at the point <script type="math/tex">(x,y)=(1,1)</script>. 
</p>
</li>
</ul>
<figure id="TangentPlane">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0060.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.32</span>
<span class="caption_text">The level contour lines of <script type="math/tex">f(x,y)=e^{-(x^{2}+2y^{2})}</script> with gradient vectors at the point <script type="math/tex">(x,y)=(1,1)</script> superimposed. The unit vector <b class="bf">u</b><script type="math/tex">=({\bf i}-{\bf j})/Sqrt{2}</script> extending from <script type="math/tex">(1,1)</script> is also shown. Since <script type="math/tex">\nabla f(1,1)\cdot {\bf u}=0</script>, the vector <b class="bf">u</b> is perpendicular to the gradient vector and is thus locally parallel to the level contour line.</span>
</figcaption> </div>
</figure>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b>
</p>
<p>
Evaluate the Directional derivative of the above function at <script type="math/tex">(x,y) =(0,0)</script> in every direction. Comment on the result: 
</p>
<ul class="itemize" id="a0000000851">
<li id="a0000000852"> <p>
Let <script type="math/tex">{\bf u}=\alpha {\bf i}+ \beta {\bf j}</script> where <script type="math/tex">\alpha ^2+\beta ^2=1</script>, so that <script type="math/tex">{\bf u}</script> is a unit vector. 
</p>
</li>
<li id="a0000000853"> <p>
We know that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y)=2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}</script></span></span>
</p>
</li>
<li id="a0000000854"> <p>
Hence <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (x,y)=\left(2xe^{x^2+y^2}{\bf i}+2ye^{x^2+y^2}{\bf j}\right)\cdot \left(\alpha {\bf i}+\beta {\bf j}\right)=\left(2\alpha xe^{x^2+y^2}+2\beta ye^{x^2+y^2}\right)</script></span></span>
</p>
</li>
<li id="a0000000855"> <p>
Hence when <script type="math/tex">(x,y)=(1,1)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">D_{\bf u} (f) (0,0)=\left(2\alpha \times 0 \times e^{0^2+0^2}+2\beta \times 0 \times e^{0^2+0^2}\right)=0, \qquad \forall (\alpha , \beta ).</script></span></span> Hence the directional derivative at <script type="math/tex">(0,0)</script> is everywhere zero in no matter what direction you look in. 
</p>
</li>
<li id="a0000000856"> <p>
Does this mean the function is everywhere constant? Clearly from the previous examples, we know that the directional derivatives do vary, depending on the evaluation point. The actual reason is easily seen by realising that at <script type="math/tex">(x,y)=(0,0)</script> the surface has a local maximum. This gives a hint towards how we are going to find local maxima and minima in the next couple of sections. 
</p>
</li>
</ul>
<figure id="LocalMaximum">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0062.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.33</span>
<span class="caption_text">Value of directional derivative of <script type="math/tex">z=e^{-(x^{2}+y^{2})}</script> at <script type="math/tex">(x,y)=(0,0)</script> in any direction <b class="bf">u</b> is zero, since the function is locally horizontal at that point, and is in fact a local maximum. This can also be seen from the fact that the contour at that point is just an isolated point and not a line.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b>
</p>
<p>
Given the function <script type="math/tex">z=f(x,y)=x^2+2y^2</script>, work out the direction of the steepest ascent and the steepest descent at the point <script type="math/tex">(x,y)=(2,1)</script>. 
</p>
<ul class="itemize" id="a0000000857">
<li id="a0000000858"> <p>
We know that the function increases most rapidly at <script type="math/tex">(2,1)</script> when <b class="bf">u</b> is pointing in the same direction as <script type="math/tex">\nabla f(2,1)</script>. 
</p>
</li>
<li id="a0000000859"> <p>
We also know that at that point <script type="math/tex">f</script> decreases most rapidly in the direction <script type="math/tex">-\nabla f(2,1)</script>. 
</p>
</li>
<li id="a0000000860"> <p>
We find that <script type="math/tex">\nabla f(x,y)</script> is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=\frac{\partial }{\partial x}\left(x^2+2y^2\right){\bf i}+\frac{\partial }{\partial y}\left(x^2+2y^2\right){\bf j}=2x{\bf i}+4y{\bf j}</script></span></span>
</p>
</li>
<li id="a0000000861"> <p>
Hence we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(2,1)=(2\times 2){\bf i}+(4\times 1){\bf j}=4{\bf i}+4{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000862"> <p>
Hence the path of steepest ascent at <script type="math/tex">(x,y)=(2,1)</script> is in the direction <script type="math/tex">4{\bf i}+4{\bf j}</script>, or <script type="math/tex">({\bf i}+{\bf j})/\sqrt{2}</script> if you want to express it as a unit vector. 
</p>
</li>
<li id="a0000000863"> <p>
Hence the path of steepest descent at <script type="math/tex">(x,y)=(2,1)</script> is in the direction <script type="math/tex">-4{\bf i}-4{\bf j}</script> or <script type="math/tex">-({\bf i}+{\bf j})/\sqrt{2}</script> if you want to express it as a unit vector. 
</p>
</li>
</ul>
<figure id="TangentPlane">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0064.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.34</span>
<span class="caption_text">The level contour lines of <script type="math/tex">f(x,y)=x^{2}+2y^{2}</script> with gradient vectors at the point <script type="math/tex">(x,y)=(2,1)</script> superimposed. Left: The vector <script type="math/tex">\nabla f(2,1)</script> gives the direction of steepest <i class="it">ascent</i> at the point <script type="math/tex">(2,1)</script>, i.e., the direction perpendicular to the level contours lines of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(2,1)</script> with a positive gradient. The value of <script type="math/tex">|\nabla f(2,1)|</script> gives the slope of the surface at that point in the steepest ascent direction. Right: The <b class="bf">unit</b> vector <script type="math/tex">-\nabla f(2,1)/|\nabla f(2,1)|</script> gives the direction of steepest <i class="it">descent</i> at the point <script type="math/tex">(2,1)</script>, i.e., the direction perpendicular to the level contours lines of <script type="math/tex">f(x,y)</script> at <script type="math/tex">(2,1)</script> with a negative gradient. The value of <script type="math/tex">-|\nabla f(2,1)|</script> gives the slope of the surface at that point in the steepest descent direction (although we have chosen only to draw the unit vector on the diagram). </span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b>
</p>
<p>
For the same function calculate the direction of the contour lines through <script type="math/tex">(x,y)=(2,1)</script>. 
</p>
<ul class="itemize" id="a0000000864">
<li id="a0000000865"> <p>
The direction of the level contour lines <b class="bf">u</b> through a point satisfy 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f(2,1)\cdot {\bf u} =0,</script></span>
<p>
 i.e., the directional derivative in that direction is zero. 
</p>
</li>
<li id="a0000000866"> <p>
Let <script type="math/tex">{\bf u}=\cos \theta {\bf i} + \sin \theta {\bf j}</script>, where <script type="math/tex">\theta </script> is the angle in the horizontal <script type="math/tex">(x,y)</script> plane to the positive real axis of the level lines at <script type="math/tex">(x,y)=(2,1)</script>. 
</p>
</li>
<li id="a0000000867"> <p>
We thus have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(2,1) \cdot {\bf u} =\left(4{\bf i}+4{\bf j}\right)\cdot \left(\cos \theta {\bf i} + \sin \theta {\bf j}\right)=4\left(\cos \theta +\sin \theta \right)=0.</script></span></span>
</p>
</li>
<li id="a0000000868"> <p>
Hence <script type="math/tex">\theta </script> must satisfy: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\cos \theta +\sin \theta =0 \qquad \Rightarrow \qquad \sin \theta = -\cos \theta \qquad \Rightarrow \qquad \tan \theta =-1 \qquad \Rightarrow \qquad \theta =-\frac{\pi }{4} \  {\rm or} \  \frac{3\pi }{4}.</script></span></span>
</p>
</li>
<li id="a0000000869"> <p>
Hence the level lines are in the directions <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\cos \left(-\frac{\pi }{4} \right) {\bf i} + \sin \left(-\frac{\pi }{4} \right) {\bf j}=\frac{1}{\sqrt{2}}\left( {\bf i} - {\bf j}\right)</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\bf u}=\cos \left(\frac{3\pi }{4} \right) {\bf i} + \sin \left(\frac{3\pi }{4} \right) {\bf j}=\frac{1}{\sqrt{2}}\left( -{\bf i} + {\bf j}\right)</script></span></span>
</p>
</li>
</ul>
<figure id="TangentPlane">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0066.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.35</span>
<span class="caption_text">The level contour lines of <script type="math/tex">f(x,y)=x^{2}+2y^{2}</script> with the direction vectors <script type="math/tex">{\bf u}=\pm ({\bf i}-{\bf j})/\sqrt{2}</script> superimposed as <script type="math/tex">(x,y)=(2,1)</script>, where they are parallel to the level contours through that point.</span>
</figcaption> </div>
</figure>
</section>
</section><section class="section">
<h2 id="a0000000870">3.11 Computation of Steepest Paths and Contour Lines</h2>
<p>
 Having seen that we can derive the direction of steepest ascent/descent or level lines at any particular point, we now examine how to compute the corresponding paths of steepest ascent/descent or level lines as you take an extended walk away from any particular point. 
</p>
<p>
<b class="bf">Example:</b> The height on a hill is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=\frac{1}{\sqrt{(1+x^{2}+2y^{2})}}.</script></span>
<p>
 A stream starts at the point <script type="math/tex">(2,1, f(2,1))</script> follows the path of steepest descent away from that point. Compute the trajectory of stream. 
</p>
<ul class="itemize" id="a0000000871">
<li id="a0000000872"> <p>
We know that the path of steepest descent is in the direction of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-\nabla f=-\frac{\partial f}{\partial x}{\bf i} -\frac{\partial f}{\partial y}{\bf j}=-\frac{x}{(1+x^{2}+2y^{2})^{3/2}}{\bf i} -\frac{2y}{(1+x^{2}+2y^{2})^{3/2}}{\bf j}.</script></span></span>
</p>
</li>
<li id="a0000000873"> <p>
Let the path of steepest descent in projection be given by <script type="math/tex">y=y(x)</script>. The slope <script type="math/tex">y'(x)</script> must then be parallel at each point to <script type="math/tex">-\nabla f</script>. 
</p>
</li>
<li id="a0000000874"> <p>
Hence we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{y {\rm \  component \  of} (-\nabla f)}{x{\rm \  component \  of} (-\nabla f)}=\frac{-2y}{(1+x^{2}+2y^{2})^{3/2}}\times \frac{(1+x^{2}+2y^{2})^{3/2}}{-x}=\frac{2y}{x}.</script></span></span>
</p>
</li>
<li id="a0000000875"> <p>
Thus the steepest path satisfies <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{2y}{x} \qquad \Rightarrow \qquad \int \frac{dy}{y}=2\int \frac{dx}{x} \qquad \Rightarrow \qquad \ln y=2\ln x + \ln C</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \ln y=\ln \left(Cx^{2}\right) \qquad \Rightarrow \qquad y=Cx^{2}</script></span></span>
</p>
</li>
<li id="a0000000876"> <p>
Inserting the initial point of <script type="math/tex">(x,y)=(2,1)</script> we see that <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1=C \times 2^{2}\qquad \Rightarrow \qquad C=1/4.</script></span></span>
</p>
</li>
<li id="a0000000877"> <p>
Hence the steepest descent path from <script type="math/tex">(2,1)</script> follows the path <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=x^{2}/4</script></span></span> in the <script type="math/tex">(x,y)</script> plane. 
</p>
<figure id="SD1">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0068.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.36</span>
<span class="caption_text">Steepest descent path from point above <script type="math/tex">(2,1)</script> on surface <script type="math/tex">z=\frac{1}{\sqrt{1+x^{2}+2y^{2}}}</script>. The left hand diagram shows the contour plot of <script type="math/tex">f(x,y)=</script> constant, together with the projection of the steepest descent path from <script type="math/tex">(2,1)</script> in the <script type="math/tex">(x,y)</script> plane. The right hand diagram is a plot of the surface <script type="math/tex">(x,y,z=f(x,y))</script> in <script type="math/tex">\mathbb R^{3}</script>. The steepest descent path from <script type="math/tex">(2.1)</script> is also show. It is the three dimensional curve with coordinates given by <script type="math/tex">(x,y(x), z=f(x,y(x)))</script> as explained in the text.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000878"> <p>
In <script type="math/tex">(x,y,z)\in \mathbb R^{3}</script>, the steepest descent curve of course sits on the surface <script type="math/tex">z=f(x,y)</script>. Its coordinates are thus given parametrically by <script type="math/tex">(x,y(x), z=f(x,y(x)))</script>, where 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  x& =& x, \\ y& =& y(x)=x^2/4, \\ z& =& f(x,y(x))=\frac{1}{\sqrt{1+x^2+2(x^2/4)^2}}=\frac{1}{\sqrt{1+x^2+{x^4}/8}}. \end{eqnarray*}</script></span>
</li>
</ul>
<p>
<b class="bf">Example:</b> The height on a hill is given by 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=e^{-(x^{2}+3y^{2})}.</script></span>
<p>
 Find the equation of the level contours, i.e., <script type="math/tex">z(x,y)=c</script> (without doing the obvious!). 
</p>
<ul class="itemize" id="a0000000879">
<li id="a0000000880"> <p>
We know that the contour is in the direction <script type="math/tex">{\bf v}</script>, where <script type="math/tex">{\bf v}.\nabla f=0</script>. 
</p>
</li>
<li id="a0000000881"> <p>
We have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla f=\frac{\partial f}{\partial x}{\bf i} +\frac{\partial f}{\partial y}{\bf j}=-2xe^{-(x^{2}+3y^{2})}{\bf i} -6ye^{-(x^{2}+3y^{2})}{\bf j}.</script></span>
</li>
<li id="a0000000882"> <p>
Hence a suitable <b class="bf">v</b> would be: 
</p>
<span class="dmath"><script type="math/tex; mode=display">{\bf v}=6ye^{-(x^{2}+3y^{2})}{\bf i} -2xe^{-(x^{2}+3y^{2})}{\bf j}.</script></span>
</li>
<li id="a0000000883"> <p>
Let the level contour in projection be given by <script type="math/tex">y=y(x)</script>. The slope <script type="math/tex">y'(x)</script> must then be parallel at each point to <script type="math/tex">{\bf v}</script>. 
</p>
</li>
<li id="a0000000884"> <p>
Hence we have 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{y {\rm \  component \  of \  } {\bf v}}{x{\rm \  component \  of \  } {\bf v}}=\frac{-2xe^{-(x^{2}+3y^{2})}}{6ye^{-(x^{2}+3y^{2})}}=\frac{-x}{3y}.</script></span>
</li>
<li id="a0000000885"> <p>
Thus the level contour satisfies 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{dy}{dx}=\frac{-x}{3y} \qquad \Rightarrow \qquad 3\int y \,  dy=-\int x\,  dx \qquad \Rightarrow \qquad \frac{3}{2}y^{2}=-\frac{x^{2}}{2}+C</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Rightarrow \qquad \frac{x^{2}}{2}+\frac{3}{2}y^{2}=C \Rightarrow \qquad \frac{x^{2}}{2C}+\frac{3}{2C}y^{2}=1.</script></span>
</li>
<li id="a0000000886"> <p>
These are confocal ellipses of semi major/minor axes <script type="math/tex">\sqrt{2C}</script> and <script type="math/tex">\sqrt{2C/3}</script>. 
</p>
</li>
<li id="a0000000887"> <p>
Inserting an initial point of <script type="math/tex">(x,y)=(1,1)</script>, say, we see that 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{1^{2}}{2}+\frac{3}{2}1^{2}=C \qquad \Rightarrow \qquad C=2.</script></span>
</li>
<li id="a0000000888"> <p>
Hence the level contour through <script type="math/tex">(1,1)</script> follows the path 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{x^{2}}{4}+\frac{3}{4}y^{2}=1</script></span>
<p>
. 
</p>
</li>
</ul>
<figure id="SD1">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0070.png" style="width:198.74249999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.37</span>
<span class="caption_text">Level contours <script type="math/tex">\frac{x^{2}}{4C}+\frac{3}{4C}y^{2}=1</script> of surface <script type="math/tex">z=e^{-(x^{2}+3y^{2})}</script>. The bold contour is the level contour through <script type="math/tex">(1,1)</script>, i.e., <script type="math/tex">\frac{x^{2}}{4}+\frac{3}{4}y^{2}=1</script>.</span>
</figcaption> </div>
</figure>
<p>
Of course, we could have just spotted what the level contours were by just observing that <script type="math/tex">z=</script> constant when <script type="math/tex">x^{2}+3y^{2}</script>=constant. However this example is to demonstrate how curves other than steepest descent ones may be calculated. 
</p>
</section><section class="section">
<h2 id="PD1">3.12 Higher Order Partial Derivatives</h2>
<p>
So far we have just looks at the first partial derivatives of multivariable functions. Now we consider higher order partial derivatives. Again we initially focus on <script type="math/tex">f:\mathbb R^2\to \mathbb R</script>. 
</p>
<p>
Suppose that a function <script type="math/tex">f:\mathbb R^2\to \mathbb R</script> may be differentiated twice. We then have the following sequence of partial derivatives. 
</p>
<figure>
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0072.png" style="width:415.55249999999995pt"/>
</div>
</figure>
<p>
Thus we have up to four second-order partial derivatives. At higher orders the pyramid structure propagates. (Question: How many partial derivatives are there at order <script type="math/tex">n</script>?) 
</p>
<p>
For ease of writing the subscript notation is often used: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^2 f}{\partial x^2}=f_{xx}, \qquad \frac{\partial ^2 f}{\partial y\partial x}=f_{yx}, \qquad \frac{\partial ^2 f}{\partial x\partial y}=f_{xy}, \qquad \frac{\partial ^2 f}{\partial y^2}=f_{yy}.</script></span>
<p>
<b class="bf">Example:</b> <script type="math/tex">f(x,y)=x^{2}-1+y+\sin ({xy})</script> <span style="color:#FF0000"><div id="a0000000889">
<script type="math/tex; mode=display">
\begin{align}
 \frac{\partial ^{2} f}{\partial x^{2}}& =& \frac{\partial }{\partial x}\left(2x+y\cos (xy)\right)=2-y^{2}\sin (xy). \nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial ^2 f}{\partial y\partial x}& =& \frac{\partial }{\partial y}\left(2x+y\cos (xy)\right)=\cos (xy)-xy\sin (xy).\nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial ^2 f}{\partial x\partial y}& =& \frac{\partial }{\partial x}\left(1+x\cos (xy)\right)=\cos (xy)-xy\sin (xy).\nonumber \\ 
\nonumber \\ 
\nonumber \\ 
\nonumber \frac{\partial ^{2} f}{\partial y^{2}}& =& \frac{\partial }{\partial y}\left(1+x\cos (xy)\right)=-x^{2}\sin (xy). 
\end{align}
</script>
</div></span>
</p>
<p>
<b class="bf">Example:</b> Given <script type="math/tex">w=f(x,y,z)=x\cos (z)+\sin (xy)</script>, calculate <script type="math/tex">\displaystyle {\frac{\partial ^3 w}{\partial z\partial x^2} }</script>, <script type="math/tex">\displaystyle {\frac{\partial ^3 w}{\partial x\partial z\partial x}} </script>, and <script type="math/tex">\displaystyle {\frac{\partial ^3 w}{\partial x^2\partial z}} </script>. 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\frac{\partial ^3 w}{\partial z\partial x^2} }=\frac{\partial ^2 w}{\partial z\partial x}(\cos (z)+y\cos (xy))=\frac{\partial w}{\partial z}(-y^2\sin (x))=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\frac{\partial ^3 w}{\partial x\partial z\partial x} }=\frac{\partial ^2 w}{\partial x\partial z}(\cos (z)+y\cos (xy))=\frac{\partial w}{\partial x}(-\sin (z))=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\displaystyle {\frac{\partial ^3 w}{\partial x^2\partial z} }=\frac{\partial ^2 w}{\partial x^2}(-x\sin (z))=\frac{\partial w}{\partial x}(-\sin (z))=0.</script></span></span>
</p>
<p>
The above examples suggest that under certain circumstances the order in which the partial derivatives are performed is irrelevant. In fact the following theorem holds. 
</p>
<p>
 Let <script type="math/tex">f: \mathbb R^ n\to \mathbb R</script> be a function. Suppose for some positive integer <script type="math/tex">k</script>, there exists a neighbourhood <script type="math/tex">U</script> of a point <script type="math/tex">P\in \mathbb R^ n</script> such that <script type="math/tex">f</script> and all its partial derivatives of order less than <script type="math/tex">k</script> are continuous on <script type="math/tex">U</script>. Then any two mixed partial derivatives of order <script type="math/tex">k</script> involving the same variables but in different sequential orders are equal at <script type="math/tex">P</script>, provided those partial derivatives are continuous at <script type="math/tex">P</script>.  
</p>
<p>
Boiled down to something digestible for <script type="math/tex">f:\mathbb R^{2}\to \mathbb R</script> and for second order partial derivatives, we also have the theorem: 
</p>
<p>
<b class="bf">Theorem:</b> If <script type="math/tex">f_{xy}</script> and <script type="math/tex">f_{yx}</script> are continuous at <script type="math/tex">(x,y)= (a,b)</script> then they are equal there. 
</p>
<p>
<b class="bf">Proof:</b> Uses the mean value theorem, but is not required. 
</p>
<p>
So provided the mixed partial derivatives of order up to <script type="math/tex">k</script> are continuous at a point, then all the mixed partial derivatives of order <script type="math/tex">k</script> will all be equal. This reduces dramatically the number of partial derivatives at higher order, so that for example, sufficiently continuous functions and their partial derivatives, <script type="math/tex">f_{xxy}</script> = <script type="math/tex">f_{xyx} = f_{yxx}</script> etc. Hence for such functions, the order in which you do the partial derivatives doesn’t matter. 
</p>
</section><section class="section">
<h2 id="a0000000890">3.13 Changes of Variables in PDES</h2>
<p>
We have seen above that combining the chain rule and changes of variables can be used to simplify first order (partial) differential equations and make them easier to solve. It may be that when expressed in a new set of coordinates that respect the symmetry of the geometry, such an approach can also either simplify the form of PDEs or express the equation in a form that is more amenable to solution in certain geometries. 
</p>
<p>
<b class="bf">Example: (Solving the wave equation in cartesian coordinates)</b> Consider the second order wave equation 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2}u}{\partial t^{2}}=c^{2}\frac{\partial ^{2}u}{\partial x^{2}}.</script></span>
<p>
 We shall see below that the solution of this equation is a superposition of waves travelling to the left and right with speed <script type="math/tex">c</script>. We shall use the intermediate variables: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\xi =x-ct, \qquad \eta =x+ct,</script></span>
<p>
 to write 
</p>
<span class="dmath"><script type="math/tex; mode=display">u=u(\xi (x,t), \eta (x,t))</script></span>
<p>
. 
</p>
<p>
For then we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial t}& =& \frac{\partial u}{\partial \xi }\frac{\partial \xi }{\partial t}+\frac{\partial u}{\partial \eta }\frac{\partial \eta }{\partial t}= c\left(\frac{\partial u}{\partial \xi }-\frac{\partial u}{\partial \eta }\right), \\ \Rightarrow \qquad \frac{\partial ^{2} u}{\partial t^{2}}& =&  \frac{\partial }{\partial t} \left(\frac{\partial u}{\partial t}\right)=c\left(\frac{\partial }{\partial \xi }-\frac{\partial }{\partial \eta }\right)c\left(\frac{\partial u}{\partial \xi }-\frac{\partial u}{\partial \eta }\right) \\ & =& c^{2}\left(\frac{\partial ^{2} u}{\partial \xi ^{2}}-2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right)\\ \end{eqnarray*}</script></span></span> <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial x}& =& \frac{\partial u}{\partial \xi }\frac{\partial \xi }{\partial x}+\frac{\partial u}{\partial \eta }\frac{\partial \eta }{\partial x}= \left(\frac{\partial u}{\partial \xi }+\frac{\partial u}{\partial \eta }\right), \\ \Rightarrow \qquad \frac{\partial ^{2} u}{\partial x^{2}}& =&  \frac{\partial }{\partial x} \left(\frac{\partial u}{\partial x}\right)=\left(\frac{\partial }{\partial \xi }+\frac{\partial }{\partial \eta }\right)\left(\frac{\partial u}{\partial \xi }+\frac{\partial u}{\partial \eta }\right) \\ & =& \left(\frac{\partial ^{2} u}{\partial \xi ^{2}}+2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right)\\ \end{eqnarray*}</script></span></span> So now substituting these two expressions back into the wave equation we obtain: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u}{\partial t^{2}}& =& c\frac{\partial ^{2}u}{\partial x^{2}} \\ c^{2}\left(\frac{\partial ^{2} u}{\partial \xi ^{2}}-2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right)& =& c^{2}\left(\frac{\partial ^{2} u}{\partial \xi ^{2}}+2\frac{\partial ^{2}u}{\partial \eta \partial \xi }+\frac{\partial ^{2} u}{\partial \eta ^{2}}\right) \\ \Rightarrow \frac{\partial ^{2}u}{\partial \eta \partial \xi }& =& 0 \\ \Rightarrow u(\xi , \eta )& =& F(\xi )+G(\eta ), \\ \Rightarrow u(x, t)& =& F(x-ct)+G(x+ct), \end{eqnarray*}</script></span></span> for arbitrary functions <script type="math/tex">F</script> and <script type="math/tex">G</script>. These might be determined by giving the initial values of the function <script type="math/tex">u(x,0)=F(x)+G(x)</script> and <script type="math/tex">u_{x}(x,0)=F'(x)+G'(x)</script>. You will learn about how to solve such PDEs in second year modules. 
</p>
<p>
<b class="bf">Example: (Rewriting Laplace’s equation in polar coordinates)</b> Consider Laplace’s equation in cartesian coordinates <script type="math/tex">(x,y)</script>: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2}u}{\partial x^{2}}+\frac{\partial ^{2}u}{\partial y^{2}}=0.</script></span>
<p>
 Laplace’s equation is widespread in mathematics and its applications. Its solution in 2-D represents, for example, the shape formed by a soap bubble, the electrostatic potential away from a charge distribution, the gravitational potential away from a mass, the real (or imaginary) part of an analytic complex function, the components of velocity of a steady 2-D incompressible, irrotational fluid flow, <i class="it">etc</i>. In this example we transform the equation from cartesian to plane polar coordinates. This is used to solve the equation whenever there is cylindrical symmetry in the problem. <a class="footnote" href="#a0000000891">
<sup class="footnotemark">7</sup>
</a>
</p>
<p>
Consider the transformations: 
</p>
<span class="dmath"><script type="math/tex; mode=display">x=r\cos \theta , \qquad y= r \sin \theta \qquad \Rightarrow \qquad r=\sqrt{x^{2}+y^{2}}, \qquad \tan \theta =y/x.</script></span>
<p>
 The chain rule is then about transforming from <script type="math/tex">(x,y)</script> to <script type="math/tex">(r,\theta )</script>. We have 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial x}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial x}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial x}, \\ \frac{\partial u}{\partial y}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial y}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial y}. \end{eqnarray*}</script></span>
<p>
Hence we are going to need the following partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial r}{\partial x}=\frac{2x}{2\sqrt{x^{2}+y^{2}}}=\frac{x}{r}=\frac{r\cos \theta }{r}=\cos \theta .</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial r}{\partial y}=\frac{2y}{2\sqrt{x^{2}+y^{2}}}=\frac{y}{r}=\frac{r\sin \theta }{r}=\sin \theta .</script></span></span> The derivatives of <script type="math/tex">\theta </script> with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script> are a little more tricky: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (\tan \theta )}{\partial x}=\sec ^{2}\theta \frac{\partial \theta }{\partial x} \qquad {\rm but} \qquad \frac{\partial (y/x)}{\partial x}=- \frac{y}{x^{2}},</script></span></span> Combining these two identities, using the fact that <script type="math/tex">y/x=\tan \theta </script>, we have in <script type="math/tex">(r,\theta )</script> coordinates: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial \theta }{\partial x} =-\cos ^{2}\theta \frac{y}{x^{2}}= -\cos ^{2}\theta \frac{r\sin \theta }{r^{2}\cos ^{2}\theta }= -\frac{\sin \theta }{r}.</script></span></span> Similarly we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (\tan \theta )}{\partial y}=\sec ^{2}\theta \frac{\partial \theta }{\partial y} \qquad {\rm but} \qquad \frac{\partial (y/x)}{\partial y}= \frac{1}{x},</script></span></span> hence combining these two identities, we have <script type="math/tex">(r,\theta )</script> coordinates: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial \theta }{\partial y} =\frac{\cos ^{2}\theta }{x}=\frac{ \cos ^{2}\theta }{r\cos \theta }= \frac{\cos \theta }{r}</script></span>.</span> Combining these results with the chain rule above we obtain: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial u}{\partial x}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial x}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial x}=\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta }, \\ \frac{\partial u}{\partial y}& =& \frac{\partial u}{\partial r}\frac{\partial r}{\partial y}+\frac{\partial u}{\partial \theta }\frac{\partial \theta }{\partial y}=\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta }. \end{eqnarray*}</script></span>
<p>
 Hence in polar coordinates we can see that the partial derivatives can be written as the following operators: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial }{\partial x}& =& \cos \theta \frac{\partial }{\partial r}-\frac{\sin \theta }{r}\frac{\partial }{\partial \theta }, \\ \frac{\partial }{\partial y}& =& \sin \theta \frac{\partial }{\partial r}+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }. \end{eqnarray*}</script></span></span> Thus we can now write down the second derivatives with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script>: 
</p>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u }{\partial x^{2}}& =& \frac{\partial }{\partial x}\left(\frac{\partial u}{\partial x}\right)=\left(\cos \theta \frac{\partial }{\partial r}- \frac{\sin \theta }{r}\frac{\partial }{\partial \theta }\right)\left(\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta } \right), \\ & =& \cos \theta \frac{\partial }{\partial r}\left(\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta }\right)- \frac{\sin \theta }{r}\frac{\partial }{\partial \theta }\left(\cos \theta \frac{\partial u}{\partial r}-\frac{\sin \theta }{r}\frac{\partial u}{\partial \theta }\right), \\ & =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-\cos \theta \sin \theta \frac{\partial }{\partial r}\left(\frac{1}{r}\frac{\partial u}{\partial \theta }\right)-\frac{\sin \theta }{r}\frac{\partial }{\partial \theta }\left(\cos \theta \frac{\partial u}{\partial r}\right)+\frac{\sin \theta }{r^{2}}\frac{\partial }{\partial \theta }\left(\sin \theta \frac{\partial u}{\partial \theta }\right), \\ & =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }-\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\sin ^{2}\theta }{r}\frac{\partial u}{\partial r }-\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }\\ & \qquad &  + \frac{\sin \theta \cos \theta }{r^{2}}\frac{\partial u }{\partial \theta }+\frac{\sin ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}} \\ & =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }-2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\sin ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\sin ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}}.\\ \end{eqnarray*}</script></span></span>
</p>
<p>
Similarly we have: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u }{\partial y^{2}}& =& \frac{\partial }{\partial y}\left(\frac{\partial u}{\partial y}\right)=\left(\sin \theta \frac{\partial }{\partial r}+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }\right)\left(\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta } \right), \\ & =& \sin \theta \frac{\partial }{\partial r}\left(\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta } \right)+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }\left(\sin \theta \frac{\partial u}{\partial r}+\frac{\cos \theta }{r}\frac{\partial u}{\partial \theta } \right), \\ & =& \sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+\sin \theta \cos \theta \frac{\partial }{\partial r}\left(\frac{1}{r}\frac{\partial u}{\partial \theta }\right)+\frac{\cos \theta }{r}\frac{\partial }{\partial \theta }\left(\sin \theta \frac{\partial u}{\partial r}\right)+\frac{\cos \theta }{r^{2}}\frac{\partial }{\partial \theta }\left(\cos \theta \frac{\partial u}{\partial \theta }\right), \\ & =& \sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-\frac{\sin \theta \cos \theta }{r^{2}}\frac{\partial u}{\partial \theta }+\frac{\sin \theta \cos \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\cos ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial \theta \partial r}\\ & \qquad &  - \frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u }{\partial \theta }+\frac{\cos ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}} \\ & =& \sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }+2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\cos ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\cos ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}}.\\ \end{eqnarray*}</script></span>
<p>
 Now we add the left and right and sides together: 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial ^{2}u }{\partial x^{2}}+\frac{\partial ^{2}u }{\partial y^{2}}& =& \cos ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}+2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }-2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\sin ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\sin ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}},\\ & \qquad &  +\sin ^{2} \theta \frac{\partial ^{2} u}{\partial r^{2}}-2\frac{\cos \theta \sin \theta }{r^{2}}\frac{\partial u}{\partial \theta }+2\frac{\cos \theta \sin \theta }{r}\frac{\partial ^{2} u}{\partial r \partial \theta }+\frac{\cos ^{2}\theta }{r}\frac{\partial u}{\partial r }+\frac{\cos ^{2}\theta }{r^{2}}\frac{\partial ^{2}u }{\partial \theta ^{2}},\\ & =& \left(\cos ^{2} \theta +\sin ^{2}\theta \right)\frac{\partial ^{2} u}{\partial r^{2}}+\frac{\left(\cos ^{2} \theta +\sin ^{2}\theta \right)}{r}\frac{\partial u}{\partial r}+\frac{\left(\cos ^{2} \theta +\sin ^{2}\theta \right)}{r^{2}}\frac{\partial ^{2} u}{\partial \theta ^{2}}, \\ \frac{\partial ^{2}u }{\partial x^{2}}+\frac{\partial ^{2}u }{\partial y^{2}}& =& \frac{\partial ^{2} u}{\partial r^{2}}+\frac{1}{r}\frac{\partial u}{\partial r}+\frac{1}{r^{2}}\frac{\partial ^{2} u}{\partial \theta ^{2}}. \\ \end{eqnarray*}</script></span>
<p>
 Hence in plane polar coordinates, Laplace’s equation can be written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2} u}{\partial r^{2}}+\frac{1}{r}\frac{\partial u}{\partial r}+\frac{1}{r^{2}}\frac{\partial ^{2} u}{\partial \theta ^{2}}=0.</script></span>
<p>
 Phew! 
</p>
<p>
This result actually has a simpler form: multiply first through by <script type="math/tex">r</script>, then note that the sum of the partial derivatives in <script type="math/tex">r</script> can be written as a derivative 
</p>
<span class="dmath"><script type="math/tex; mode=display">r\frac{\partial ^{2} u}{\partial r^{2}}+\frac{\partial u}{\partial r}=\frac{\partial }{\partial r}\left(r\frac{\partial u}{\partial r}\right).</script></span>
<p>
 Hence Laplace’s equation can be written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">r\frac{\partial }{\partial r}\left(r\frac{\partial u}{\partial r}\right)+\frac{\partial ^{2} u}{\partial \theta ^{2}}=0,</script></span>
<p>
 or 
</p>
<span class="dmath"><script type="math/tex; mode=display">r\frac{\partial }{\partial r}\left(r\frac{\partial u}{\partial r}\right)=-\frac{\partial ^{2} u}{\partial \theta ^{2}}.</script></span>
<p>
 The key point here is that everything on the LHS involves derivatives wrt <script type="math/tex">r</script> and everything on the RHS, derivatives wrt to <script type="math/tex">\theta </script>. This is a key step in solving the equation by separation of variables in plane polar coordinates: see second year modules! 
</p>
<p>
As an aside, suppose we want to find a solution of Laplace’s equation that is a function of <script type="math/tex">r</script>, i.e., radial distance from the origin. Then we have <script type="math/tex">u=u(r)</script> only and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial u}{\partial \theta }=\frac{\partial ^{2} u}{\partial \theta ^{2}}=0.</script></span>
<p>
 Laplace’s equation then becomes: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">r\frac{d }{d r}\left(r\frac{d u}{d r}\right)=0,</script></span></span> i.e., all reference to <script type="math/tex">\theta </script> vanishes and the partial derivatives with respect to <script type="math/tex">r</script> become total. 
</p>
<p>
After dividing by <script type="math/tex">r</script> (for <script type="math/tex">r\ne 0</script>) we can integrate this, now, ODE, twice to obtain: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \left(r\frac{d u}{d r}\right)& =& A, \\ \frac{d u}{d r}& =& \frac{A}{r}\\ u(r)& =& A \log r + B. \end{eqnarray*}</script></span></span> for arbitrary constants <script type="math/tex">A</script> and <script type="math/tex">B</script>. This shows, for example, that the electrostatic potential due to a straight line source of charge decays logarithmically with radial distance <script type="math/tex">r</script> from the line source. 
</p>
<p>
In three (cartesian) dimensions, Laplace’s equation becomes 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial ^{2}u}{\partial x^{2}}+\frac{\partial ^{2}u}{\partial y^{2}}+\frac{\partial ^{2}u}{\partial z^{2}}=0.</script></span>
<p>
 An exercise for you is to show that a radially symmetric solution in 3-D is given by: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">u(r)=\frac{A}{r}+B</script></span></span> where <script type="math/tex">r=\sqrt{x^{2}+y^{2}+z^{2}}</script>. 
</p>
<p>
More generally, in arbitrary coordinates and dimensions, Laplace’s equation is written as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\nabla ^{2}u=0.</script></span>
<p>
 The symbol “<script type="math/tex">\nabla </script>” is pronounced “del” (short for “upside down delta”), so that <script type="math/tex">\nabla ^{2}</script> is pronounced “del-squared”. It can be thought of <script type="math/tex">\nabla \cdot \nabla </script>, i.e., the result of taking the scalar product of two gradient operators. (Try this for yourself using the cartesian definition <script type="math/tex">\nabla = \frac{\partial }{\partial x}{\bf i}+ \frac{\partial }{\partial y}{\bf j}</script>. More of this type of thing will come in second year modules. 
</p>
</section><section class="section">
<h2 id="a0000000892">3.14 Multivariable Taylor Series</h2>
<p>
We saw above that the tangent plane could be interpreted as a linear approximation to a multivariate function around a given point <script type="math/tex">P</script>. We can improve on that approximation using the chain rule and higher order derivatives. 
</p>
<p>
Recall that for a single-variable function <script type="math/tex">g(t)</script>, if all the derivatives g exist at a point, say <script type="math/tex">t = 0</script> (that is <script type="math/tex">g(0)</script>, <script type="math/tex">g'(0)</script>, <script type="math/tex">g''(0)</script>,... all exist), then <script type="math/tex">g</script> can be expanded as a power series in a neighbourhood of <script type="math/tex">t = 0</script> via the Taylor-Maclaurin Series expansion 
</p>
<span class="dmath"><script type="math/tex; mode=display">g(t)=\sum _{r=0}^{\infty }\frac{g^{(k)}(0)}{r!}t^{r}=g(0)+g’(0)t+\frac{g''(0)}{2!}t^{2}+\frac{g'''(0)}{3!}t^{3}+\dots .</script></span>
<p>
Now suppose that <script type="math/tex">g(t)</script> is defined as <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(t)=f(a+ht,b+kt),</script></span></span> where <script type="math/tex">a, b, h, k</script> are real and <script type="math/tex">f</script> is a multivariate function <script type="math/tex">f(x,y):\mathbb R^{2}\to \mathbb R</script>, with independent variables <script type="math/tex">(x,y)</script> with 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x=x(t)=a+ht, \qquad y=y(t)=b+kt.</script></span></span>
</p>
<p>
But if we want to write down a Taylor series for <script type="math/tex">g(t)</script> about <script type="math/tex">t=0</script>, then we need to compute the derivatives of <script type="math/tex">g</script> at <script type="math/tex">t=0</script>. To do that we will need to use the chain rule: 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g’(t)=\frac{d}{dt}f(x(t),y(t))=\frac{\partial f}{\partial x}\frac{dx}{dt}+\frac{\partial f}{\partial y}\frac{dy}{dt}=h\frac{\partial f}{\partial x}+k\frac{\partial f}{\partial y}.</script></span></span>
</p>
<p>
So far so good, now we need the higher derivatives. From above we can see that a derivative with respect to <script type="math/tex">t</script> is, by the chain rule, in this case equivalent to the following linear combination of partial derivatives with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script> acting on <script type="math/tex">f</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{d}{dt}=h\frac{\partial }{\partial x}+k\frac{\partial }{\partial y}</script></span></span> We can apply this to <script type="math/tex">g'(t)</script> to get <script type="math/tex">g''(t)</script> as follows: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  g”(t)& =& \frac{d}{dt}g’(t)=\left(h\frac{\partial }{\partial x}+k\frac{\partial }{\partial y}\right)\left(h\frac{\partial f}{\partial x}+k\frac{\partial f}{\partial y}\right)\\ & =& \left(h^{2}\frac{\partial ^{2} f}{\partial x^{2}}+2hk\frac{\partial ^{2} f}{\partial x\partial y}+k^{2}\frac{\partial f^{2}}{\partial y^{2}}\right) \end{eqnarray*}</script></span></span> We can repeat this for <script type="math/tex">g'''(t)</script> and we find 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*} g”’(t)& =& \frac{d}{dt}g”(t)=\left(h\frac{\partial }{\partial x}+k\frac{\partial }{\partial y}\right)\left(h^{2}\frac{\partial ^{2} f}{\partial x^{2}} +2hk\frac{\partial ^{2} f}{\partial x\partial y}+k^{2}\frac{\partial ^{2} f}{\partial y^{2}}\right)\\ & =& \left(h^{3}\frac{\partial ^{3} f}{\partial x^{3}} +3h^{2}k\frac{\partial ^{3} f}{\partial ^{2}x\partial y}+3hk^{2}\frac{\partial ^{3} f}{\partial x\partial ^{2}y}+k^{3}\frac{\partial ^{3} f}{\partial y^{3}}\right) \end{eqnarray*}</script></span>
<p>
 Going one step further we find, 
</p>
<span class="dmath"><script type="math/tex; mode=display">g^{(iv)}(t)=\left(h^{4}\frac{\partial ^{4} f}{\partial x^{4}} +4h^{3}k\frac{\partial ^{4} f}{\partial ^{3}x\partial y}+6h^{2}k^{2}\frac{\partial ^{4} f}{\partial x^{2}\partial ^{2}y}+4hk^{3}\frac{\partial ^{4} f}{\partial x\partial ^{3}y}+k^{4}\frac{\partial ^{4}f}{\partial y^{4}}\right)</script></span>
<p>
 The pattern should now be a bit clear: 
</p>
<p>
The <script type="math/tex">n^{\rm th}</script> derivative of <script type="math/tex">g(t)=f(a+ht, b+kt)</script> can be represented as the sum of the <script type="math/tex">n^{\rm th}</script> mixed partial derivatives of <script type="math/tex">f</script>, with respect to <script type="math/tex">x</script> and <script type="math/tex">y</script>, weighted by the Pascal triangle combinatorial coefficients multiplied by the powers of <script type="math/tex">h</script> and <script type="math/tex">k</script> corresponding to the respective order of the partial derivatives (<script type="math/tex">h</script> with <script type="math/tex">x</script> and <script type="math/tex">k</script> with <script type="math/tex">y</script>). 
</p>
<p>
The final bit is to realise that if we insert this into the Taylor series for <script type="math/tex">g(t)</script>, then we have to evaluate all the derivatives at <script type="math/tex">t=0</script>. Hence we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  g(0)& =& f(x(0),y(0))=f(a,b),\\ g’(0)& =& h\left(\frac{\partial f}{\partial x}\right)_{(a,b)}+k\left(\frac{\partial f}{\partial y}\right)_{(a,b)}, \\ g”(0)& =& h^{2}\left(\frac{\partial ^{2} f}{\partial x^{2}}\right)_{(a,b)}+2hk\left(\frac{\partial ^{2} f}{\partial x\partial y}\right)_{(a,b)} +k^{2}\left(\frac{\partial ^{2} f}{\partial y^{2}}\right)_{(a,b)}, \\ g”’(0)& =& \dots . \end{eqnarray*}</script></span></span>
</p>
<p>
So finally we can insert the above expressions into the Taylor series for <script type="math/tex">g(t)</script>, but then <b class="bf">chose</b> to set <script type="math/tex">t=1</script> on the LHS. We have <script type="math/tex">g(1)=f(a+h,b+k)</script> so the Taylor series becomes 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  f(a+h,b+k)& =& f(a,b)+h\left(\frac{\partial f}{\partial x}\right)_{(a,b)}+k\left(\frac{\partial f}{\partial y}\right)_{(a,b)}+ \\ & +& \frac{1}{2!}\left(h^{2}\left(\frac{\partial ^{2} f}{\partial x^{2}}\right)_{(a,b)}+2hk\left(\frac{\partial ^{2} f}{\partial x\partial y}\right)_{(a,b)} +k^{2}\left(\frac{\partial ^{2} f}{\partial y^{2}}\right)_{(a,b)}\right) \\ & +& \frac{1}{3!}\left(h^{3}\left(\frac{\partial ^{3} f}{\partial x^{3}}\right)_{(a,b)} +3h^{2}k\left(\frac{\partial ^{3} f}{\partial ^{2}x\partial y}\right)_{(a,b)}+3hk^{2}\left(\frac{\partial ^{3} f}{\partial x\partial ^{2}y}\right)_{(a,b)}+k^{3}\left(\frac{\partial ^{3} f}{\partial y^{3}}\right)_{(a,b)}\right) \\ & +&  \dots . \end{eqnarray*}</script></span>
<p>
 We may substitute for <script type="math/tex">h=x-a</script> and <script type="math/tex">k=y-b</script> and use the more compact subscript notation partial derivatives to obtain 
</p>
<span><script type="math/tex; mode=display">\begin{eqnarray*}  f(x,y)& =& f(a,b)+(x-a)f_{x}(a,b)+(y-b)f_{y}(a,b)+ \\ & +& \frac{1}{2!}\left\{ (x-a)^{2}f_{xx}(a,b)+2(x-a)(y-b)f_{xy}(a,b)+(y-b)^{2}f_{yy}(a,b)\right\}  \end{eqnarray*}</script></span>
<span class="dmath"><script type="math/tex; mode=display">+\frac{1}{3!}\left\{ (x-a)^{3}f_{xxx}(a,b)+3(x-a)^{2}(y-b)f_{xxy}(a,b)+3(x-a)(y-b)^{2}f_{yxx}(a,b)+(y-b)^{3}f_{yyy}(a,b)\right\}</script></span>
<span class="dmath"><script type="math/tex; mode=display">+ \dots .</script></span>
<p>
<b class="bf">Notes:</b>
</p>
<ul class="itemize" id="a0000000893">
<li id="a0000000894"> <p>
This gives a way of approximating the function <script type="math/tex">f</script> at points <script type="math/tex">x=a+h</script> and <script type="math/tex">y=b+h</script> given the value of the function and all its partial derivatives at <script type="math/tex">(x,y)=(a,b)</script>. 
</p>
</li>
<li id="a0000000895"> <p>
The first line of the formula is equivalent to the tangent plane approximation of the function <script type="math/tex">z=f(x,y)</script> at the point <script type="math/tex">(x,y,z)=(a,b,f(a,b))</script>. 
</p>
</li>
<li id="a0000000896"> <p>
The “<script type="math/tex">\dots </script>” denotes an infinite sum of terms of increasingly higher order partial derivatives. We make no statement about whether this sum converges (i.e., adds up to something finite). This type of question will be explored in MATH2039. 
</p>
</li>
<li id="a0000000897"> <p>
Nevertheless for the functions we shall deal with here, we can assume that the more terms we take in the multivariate Taylor series, the better the approximation to the function <script type="math/tex">f(x,y)</script>, given the data at <script type="math/tex">(x,y)=(a,b).</script>
</p>
</li>
<li id="a0000000898"> <p>
An analogous argument may be deployed to find the Taylor series for a function <script type="math/tex">f:\mathbb R^{n}\to \mathbb R</script> about a point <script type="math/tex">(x_{1},x_{2}, \dots , x_{n})=(a_{1},a_{2}, \dots a_{n})</script>, but we will restrict ourselves in this module to only <script type="math/tex">n=2</script>. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Calculate the Taylor series expansion of <script type="math/tex">f (x, y) = e^{x} \sin y</script> about the point <script type="math/tex">(1,0)</script> up to third order in <script type="math/tex">x</script> and <script type="math/tex">y</script>: <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  f(x,y)=e^{x}\sin y \qquad & \Rightarrow &  \qquad f(1,0)=e^{1}\sin 0 =0 \\ f_{x}=e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{x}(1,0)=e^{1}\sin 0 =0 \\ f_{y}=e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{y}(1,0)=e^{1}\cos 0 =e \\ f_{xx}=e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{xx}(1,0)=e^{1}\sin 0 =0 \\ f_{xy}=e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{xy}(1,0)=e^{1}\cos 0 =e \\ f_{yy}=-e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{yy}(1,0)=-e^{1}\sin 0 =0 \\ f_{xxx}=e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{xx}(1,0)=e^{1}\sin 0 =0 \\ f_{xxy}=e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{xy}(1,0)=e^{1}\cos 0 =e \\ f_{xyy}=-e^{x}\sin y \qquad & \Rightarrow &  \qquad f_{yy}(1,0)=-e^{1}\sin 0 =0 \\ f_{yyy}=-e^{x}\cos y \qquad & \Rightarrow &  \qquad f_{yy}(1,0)=-e^{1}\cos 0 =-e \end{eqnarray*}</script></span></span> Substituting into the Taylor series and retaining terms up to third order in <script type="math/tex">x</script> and <script type="math/tex">y</script> we have <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  e^{x}\sin y& =& 0+0(x-1)+e(y-0)+\\ & +& \frac{1}{2!}\left\{ 0(x-1)^{2}+2e(x-1)(y-0)+0(y-0)^{2}\right\}  + \\ & +& \frac{1}{3!}\left\{ 0(x-1)^{3}+3e(x-1)^{2}(y-0)+3.0(x-1)(y-0)^{2}-e(y-1)^{3}\right\}  + \dots \\ e^{x}\sin y& =& e\left\{ (y+2(x-1)y+\frac{1}{2}(x-1)^{2}y-\frac{1}{6}y^{3}+\dots \right\} . \end{eqnarray*}</script></span></span>
</p>
</section><section class="section">
<h2 id="a0000000899">3.15 The Differential</h2>
<p>
<b class="bf">Definition:</b> Given a function <script type="math/tex">z=f(x,y)</script> we may define the <b class="bf">differential</b> <script type="math/tex">dz</script> as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">dz=df=\frac{\partial f}{\partial x}dx+\frac{\partial f}{\partial y}dy.</script></span>
<p>
 For a (differentiable) function that possesses a Taylor series expansion, if we interpret <script type="math/tex">dx</script> and <script type="math/tex">dy</script> as small shifts away from the expansion point <script type="math/tex">(a,b)</script>, so that <script type="math/tex">dx=x-a</script> and <script type="math/tex">dy=y-b</script> it can be seen from the definition of the multivariable Taylor series that the differential <script type="math/tex">dz</script> is an approximation to the corresponding change in <script type="math/tex">f</script>, i.e., <script type="math/tex">f(x,y)-f(a,b)</script>. 
</p>
<figure id="TangentPlane">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0074.png" style="width:289.08pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.38</span>
<span class="caption_text">The graphical interpretation of the differential <script type="math/tex">dz</script> for a function <script type="math/tex">z=f(x,y)</script>. A point <script type="math/tex">P</script> on the surface is given by the coordinates <script type="math/tex">(a,b, f(a,b))</script>. If the x coordinate <script type="math/tex">a</script> is shifted by an amount <script type="math/tex">dx</script> and the <script type="math/tex">y</script> coordinate by an amount <script type="math/tex">dy</script>, <script type="math/tex">P</script> moves to become <script type="math/tex">P'</script> on the surface with coordinates <script type="math/tex">(a+dx, b+dy, f(a+dx, b+dy)</script>. For (vanishingly) small values of <script type="math/tex">dx</script> and <script type="math/tex">dy</script>, the change in the height of <script type="math/tex">P'</script> relative to <script type="math/tex">P</script> is given by <script type="math/tex">dz=(\partial f/\partial x) dx +(\partial f/\partial y) dy \approx \Delta z =f(a+dx,b+dy)-f(a,b)</script>.</span>
</figcaption> </div>
</figure>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Consider <script type="math/tex">z=f(x,y)= x^{2}+y^{3}</script>. Find the differential <script type="math/tex">dz</script> and if <script type="math/tex">x</script> changes from <script type="math/tex">1</script> to <script type="math/tex">1.05</script> and from <script type="math/tex">2</script> to <script type="math/tex">1.95</script>, compare the values of <script type="math/tex">dz</script> and <script type="math/tex">\Delta z =f(1.05,1.95)-f(1,2)</script>. 
</p>
<ul class="itemize" id="a0000000900">
<li id="a0000000901"> <p>
The differential is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dz =\frac{\partial f}{\partial x}dx+\frac{\partial f}{\partial y}dy=2x \,  dx + 3y \,  dy.</script></span></span>
</p>
</li>
<li id="a0000000902"> <p>
We have the increments <script type="math/tex">dx</script> and <script type="math/tex">dy</script> given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dx=1.05-1.00=0.05 \qquad dy=1.95-2=-0.05</script></span></span>
</p>
</li>
<li id="a0000000903"> <p>
Hence at the point <script type="math/tex">(x,y)=(1,2)</script> we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dz =2\times 1 \times 0.05+3\times 2^{2} \times (-0.05)= 0.1-0.3 =-0.5.</script></span></span>
</p>
</li>
<li id="a0000000904"> <p>
Finally evaluating <script type="math/tex">\Delta z =f(1.05,1.95)-f(1,2)</script> we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Delta z =f(1.05,1.95)-f(1,2)=1.05^{2}+1.95^{3}-1^{2}-2^{3}=-0.48.</script></span></span> Hence for these small changes <script type="math/tex">dx</script> and <script type="math/tex">dy</script> in the location of <script type="math/tex">(1,2)</script> we see that <script type="math/tex">dz \approx \Delta z</script>. 
</p>
</li>
</ul>
<p>
Differentials are often useful for estimating the dependence of a result on a small change in the underlying independent variables. 
</p>
<p>
<b class="bf">Example:</b> The volume <script type="math/tex">V</script> of a right cylinder of radius <script type="math/tex">r</script> and height <script type="math/tex">h</script> is given by <script type="math/tex">V=\pi r^{2}h</script>. Suppose that <script type="math/tex">r</script> and <script type="math/tex">h</script> are measured as being <script type="math/tex">20</script> cm and <script type="math/tex">10</script> cm respectively, with a maximum error or of <script type="math/tex">0.1</script> cm. Use differentials to estimate the corresponding maximum error in the volume of the cylinder. 
</p>
<ul class="itemize" id="a0000000905">
<li id="a0000000906"> <p>
The differential <script type="math/tex">dV</script> is given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV =\frac{\partial v}{\partial r}dr+\frac{\partial V}{\partial h}dh=2 \pi rh \,  dr + \pi r^{2} \,  dh.</script></span></span>. 
</p>
</li>
<li id="a0000000907"> <p>
The maximum possible errors in the measurements of <script type="math/tex">r</script> and <script type="math/tex">h</script> are given by <script type="math/tex">dr</script> and <script type="math/tex">dh</script>. <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dr =|0.1|, \qquad dh=|0.1|.</script></span></span> We take these to be positive, since this from the form of the differential, and the fact that both <script type="math/tex">r>0</script> and <script type="math/tex">h>0</script>, this choice will given the largest value of the differential, and hence an estimate of the maximum possible error (overestimate) of the volume. 
</p>
</li>
<li id="a0000000908"> <p>
We could take them both negative too, but this just gives an identical maximum <b class="bf">underestimate</b> of the volume. Taking opposite signs in <script type="math/tex">dr</script> and <script type="math/tex">dh</script> will not give either the maximum value of <script type="math/tex">|dV|</script>. 
</p>
</li>
<li id="a0000000909"> <p>
Hence we have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV =2 \pi rh \,  dr + \pi r^{2} \,  dh = 2\pi \times 20 \times 10 \times |0.1| +\pi \times 20^{2}\times 10 \times |0.1|= 251.327 {\rm cm}^{3}.</script></span></span>
</p>
</li>
<li id="a0000000910"> <p>
This seems like a lot, but bear in mind that <script type="math/tex">V=\pi r^{2}h= 4000\pi = 12,566.4 {\rm cm}^{3}</script>. Hence, given a relative errors in <script type="math/tex">r</script> and <script type="math/tex">h</script> of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dr/r=0.1/20=0.5\%  \qquad dh/h=0.1/10=1\% ,</script></span></span> the relative error in <script type="math/tex">V</script>, is then <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">dV/V =251.327/12,566.4 = 0.02 = 2\% .</script></span></span>
</p>
</li>
</ul>
<p>
 The definition of a differential generalises easily and obviously to <script type="math/tex">\mathbb R^{n}\to \mathbb R</script> functions: 
</p>
<span class="dmath"><script type="math/tex; mode=display">z=f(x_{1},x_{2}, \dots , x_{n}) \qquad \Rightarrow \qquad dz=df=\frac{\partial f}{\partial x_{1}}dx_{1}+\frac{\partial f}{\partial x_{2}}dx_{2}+\dots +\frac{\partial f}{\partial x_{n}}dx_{n}.</script></span>
<p>
<br/>
</p>
</section><section class="section">
<h2 id="a0000000911">3.16 Critical Points of Multivariate Functions</h2>
<p>
 Recall that for a function of one variable, <script type="math/tex">y = f(x)</script> the stationary points are located at the solutions of 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{df}{dx}=0</script></span>
<p>
. 
</p>
<p>
The type of stationary point is characterised according to the value of the second derivative. 
</p>
<figure id="TangentPlane">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0076.png" style="width:433.62pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.39</span>
<span class="caption_text">Different types of stationary points for <script type="math/tex">{\mathbb R}\rightarrow {\mathbb R}</script> functions.</span>
</figcaption> </div>
</figure>
<span class="dmath"><script type="math/tex; mode=display">\frac{d^{2}f}{dx^{2}}>0: {\rm Minimum} \qquad \frac{d^{2}f}{dx^{2}}<0: {\rm Maximum} \qquad \frac{d^{2}f}{dx^{2}}=0: {\rm Test \  Further}</script></span>
<p>
What is the corresponding set of tests for the existence of a minimum or maximum in multivariate functions? We shall again focus on <script type="math/tex">f:\mathbb R^{2}\to \mathbb R</script>, but the condition we derive is valid for <script type="math/tex">f:\mathbb R^{n}\to \mathbb R</script>. 
</p>
<section class="subsection">
<h3 id="extreme">3.16.1 Conditions for a Local Isolated Critical Point</h3>
<p>
Suppose we <b class="bf">assume</b> there is a local isolated maximum of <script type="math/tex">z=f(x,y)</script> at <script type="math/tex">(x,y)=(a,b)</script> and that the partial derivatives of <script type="math/tex">f</script> exist there. Let us consider the directional derivatives at <script type="math/tex">(a,b)</script>. 
</p>
<span class="dmath"><script type="math/tex; mode=display">D_{{\bf u}}(f)=\frac{\partial f}{\partial {\bf u}}=\nabla f\cdot {\bf u},</script></span>
<p>
 in the direction <script type="math/tex">{\bf u}=\cos \theta {\bf i}+\sin \theta {\bf j}</script>, where <script type="math/tex">0\le \theta \le 2\pi </script>. 
</p>
<p>
Let us suppose that <script type="math/tex">\nabla f\ne {\bf 0}</script> at this maximum. Then for <script type="math/tex">\theta </script> such that <b class="bf">u</b> is in the direction of <script type="math/tex">\nabla f</script> we have <script type="math/tex">{\bf u}=\nabla f/|\nabla f|</script> and 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial {\bf u}}=\nabla f\cdot \frac{\nabla f}{|\nabla f|}=\frac{|\nabla f|^{2}}{|\nabla f|}=|\nabla f|>0.</script></span>
<p>
Thus in the direction <script type="math/tex">{\bf u} = \nabla f/|\nabla f|</script>, the function is <b class="bf">increasing</b>, which contradicts that the assumption that <script type="math/tex">(a,b)</script> was a local maximum. Hence if the partial derivates exist at a maximum, then the only other possible situation is that <script type="math/tex">\nabla f= {\bf 0}</script> there. 
</p>
<p>
An analogous argument holds for a local minimum by considering the directional derivative in the direction of <script type="math/tex">-\nabla f</script>. 
</p>
<p>
Hence, by contradiction, a local maximum or minimum in an interior part of a domain must have <script type="math/tex">\nabla f={\bf 0}</script>. Points at which this occurs are called <b class="bf">critical points</b>. 
</p>
<p>
A little more work (not required here) leads to a theorem that holds for <script type="math/tex">f:\mathbb R^{n}\to \mathbb R</script>: 
</p>
<p>
 A function <script type="math/tex">f:D\subseteq \mathbb R^ n\to \mathbb R</script> has an absolute or local minimum or maximum value at <script type="math/tex">{\bf a}\in D</script> only if either 
</p>
<ol class="enumerate" id="a0000000912" style="list-style: none">
<li id="a0000000913" value="1">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(i)
	</span>
<p>
<script type="math/tex">{\bf a}</script> is a <b class="bf">critical point</b> of <script type="math/tex">f</script>, that is, when <script type="math/tex">\nabla f({\bf a})={\bf 0}</script>, or 
</p>
</li>
<li id="a0000000914" value="2">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(ii)
	</span>
<p>
<script type="math/tex">{\bf a}</script> is a <b class="bf">singular point</b> of <script type="math/tex">f</script>, that is, when <script type="math/tex">\nabla f({\bf a})</script> does not exist, or 
</p>
</li>
<li id="a0000000915" value="3">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
		(iii)
	</span>
<p>
<script type="math/tex">{\bf a}</script> is a <b class="bf">boundary point</b> of the domain <script type="math/tex">D</script>. 
</p>
</li>
</ol>
<ul class="itemize" id="a0000000916">
<li id="a0000000917"> <p>
Part (i) of the theorem is easy to visualise in <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. 
</p>
<p>
<b class="bf">Example:</b> Consider the function <script type="math/tex">z=f(x,y)=1-x^{2}-y^{2}</script>. This has a critical point when <script type="math/tex">\nabla f={\bf 0}</script>, i.e., when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=-2x{\bf i}-2y{\bf j}={\bf 0}.</script></span></span> Note that this implies that both components have to be equal to 0 <b class="bf">simultaneously</b>. Hence we have a critical point when both <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-2x=0, \qquad \Rightarrow \qquad x=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-2y=0, \qquad \Rightarrow \qquad y=0,</script></span></span> i.e., when <script type="math/tex">(x,y)=(0,0)</script>, see figure <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#IsoMax">3.40</a>. 
</p>
<figure id="IsoMax">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0078.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.40</span>
<span class="caption_text">Plot of <script type="math/tex">z=f(x,y)=1-x^{2}-y^{2}</script> showing the point <script type="math/tex">(x,y,z)=(0,0,1)</script> at which <script type="math/tex">\nabla f={\bf 0}</script>: which is horizontal at that point and a maximum.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000918"> <p>
Part (ii) in the theorem holds, for example if there is no critical point, but the function is singular and diverges. 
</p>
<p>
<b class="bf">Example:</b> Consider the function <script type="math/tex">z=f(x,y)=1/(x^{2}+y^{2})</script> when evaluated over any domain <script type="math/tex">D:(x,y)</script> including <script type="math/tex">(x,y)=(0,0)</script>. 
</p>
<p>
We have <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f(x,y) =\frac{2x}{(x^{2}+y^{2})^{2}}{\bf i}+\frac{2y}{(x^{2}+y^{2})^{2}}{\bf j}.</script></span></span>
</p>
<p>
At the origin, <script type="math/tex">(x,y)=(0,0)</script> a little limit exercise<a class="footnote" href="#a0000000919">
<sup class="footnotemark">8</sup>
</a> shows that both components in <script type="math/tex">\nabla f(0,0)</script> diverges and so does not exist. 
</p>
<p>
A sketch of the function <script type="math/tex">z=1/(x^{2}+y^{2)}</script> shows that it too diverges to <script type="math/tex">+\infty </script> at <script type="math/tex">(x,y)=(0,0)</script> but nowhere else, and so it is a local maximum (see figure <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#SingMax">3.41</a>). 
</p>
<figure id="SingMax">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0080.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.41</span>
<span class="caption_text">Plot of <script type="math/tex">z=1/(x^{2}+y^{2})</script>.</span>
</figcaption> </div>
</figure>
</li>
<li id="a0000000920"> <p>
Part (iii) in the theorem holds, for example if there is no critical point, but there is a finite bounded domain. 
</p>
<p>
<b class="bf">Example:</b> Consider the plane <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=1-x-y</script></span></span> when evaluated over the domain <script type="math/tex">D:(x,y):\left\{ x\ge 0, y\ge 0, y\ge 1-x\right\} </script>. 
</p>
<p>
There is no point on that domain which has <script type="math/tex">\nabla f ={\bf 0}</script>, since the partial derivatives are both just a constant <script type="math/tex">-1</script>. 
</p>
<p>
But clearly on the boundary of that domain, the point <script type="math/tex">(x,y,z)=(0,0,1)</script> is a local maximum (see figure <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#PlaneMax">3.42</a>). 
</p>
<p>
This is an example of how when no point interior to a domain satisfies <script type="math/tex">\nabla f={\bf 0}</script>, the maxima or minima of a function may be found on the boundary. This is an example of a <b class="bf">constrained</b> maximum 
</p>
<figure id="PlaneMax">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0082.png" style="width:180.67499999999998pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.42</span>
<span class="caption_text">Constained maximum on a boundary</span>
</figcaption> </div>
</figure>
</li>
</ul>
<p>
Note that <b class="bf">critical points</b> are not just local <b class="bf">maxima</b> or <b class="bf">minima</b>! 
</p>
<p>
<b class="bf">Example:</b> Consider the function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">z=f(x,y)=x^{2}-y^{2}.</script></span></span> This has a critical point when <script type="math/tex">\nabla f={\bf 0}</script>, i.e., when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=2x{\bf i}-2y{\bf j}={\bf 0}.</script></span></span> Note that this implies that both components have to be equal to 0 <b class="bf">simultaneously </b>. Hence we have a critical point when both <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x=0, \qquad \Rightarrow \qquad x=0,</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2y=0, \qquad \Rightarrow \qquad y=0,</script></span></span> i.e., when <script type="math/tex">(x,y)=(0,0)</script>. However if we plot the function <script type="math/tex">z=f(x,y)</script> near to the origin, see figure <a class="ref" href="../../../notes/notes_by_chapter/multivariable_functi/index.html#IsoSaddle">3.43</a>, we see that even though <script type="math/tex">\nabla f=0</script> there, that point is neither a maximum not a minimum. 
</p>
<figure id="IsoSaddle">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0026.png" style="width:361.34999999999997pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.43</span>
<span class="caption_text">Level height contours of <script type="math/tex">z=x^{2}-y^{2}</script>. These are still curves where <script type="math/tex">z=c</script> where <script type="math/tex">c</script> is a constant, i.e., <script type="math/tex">x^{2}-y^{2}=c</script>. These are (for <script type="math/tex">c\ne 0</script>) hyperbolae. The contours corresponding to <script type="math/tex">c=0</script> are the lines <script type="math/tex">y=\pm x</script>. The regions <script type="math/tex">y<|x|</script> have <script type="math/tex">c>0</script>, the regions <script type="math/tex">y>|x|</script> have <script type="math/tex">c<0</script>.</span>
</figcaption> </div>
</figure>
<p>
For: 
</p>
<ul class="itemize" id="a0000000921">
<li id="a0000000922"> <p>
If you take a vertical section through the origin along the <script type="math/tex">x</script> axis, the origin looks like a minimum, <script type="math/tex">z=f(x,0)=x^{2}</script>. 
</p>
</li>
<li id="a0000000923"> <p>
If you take a vertical section through the origin along the <script type="math/tex">y</script> axis, the origin looks like a maximum, <script type="math/tex">z=f(0,y)=-y^{2}</script>
</p>
</li>
</ul>
<p>
 The origin is the typical example of the third type of critical point that satisfies <script type="math/tex">\nabla f={\bf 0}</script>, namely a <b class="bf">saddle point</b>. It is called a saddle point because the local shape of the surface <script type="math/tex">z=f(x,y)</script> looks like a horse saddle. 
</p>
<p>
Note that is also possible to have <b class="bf">non-isolated critical points</b>. For these situations, <script type="math/tex">\nabla f={\bf 0}</script> along whole curves, not just at single points. An easy visualisation is to take a piece of paper and curve it over to create a “<script type="math/tex">\cup </script>” or “<script type="math/tex">\cap </script>” shape. We do not consider such cases in this module. 
</p>
</section><section class="subsection">
<h3 id="a0000000924">3.16.2 Higher Dimensions</h3>
<p>
In higher dimensions the same condition for the existence of a critical point holds. 
</p>
<p>
<b class="bf">Example:</b> Consider the function <script type="math/tex">f:\mathbb R^{3}\to \mathbb R</script> given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y,z)=5+x^{2}+y^{2}+z^{2}+xy.</script></span></span> The critical points are given by <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}+f_{z}{\bf k}={\bf 0}.</script></span></span> Hence we simultaneously need: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{x}=2x+y=0, \qquad f_{y}=2y+x=0, \qquad f_{z}=2z=0.</script></span></span> The third equation immediate gives <script type="math/tex">z=0</script>. Solving the first two as simultaneous equations for <script type="math/tex">x</script> and <script type="math/tex">y</script> gives <script type="math/tex">x=0</script>, <script type="math/tex">y=0</script>. hence there is a critical point at <script type="math/tex">(x,y,z)=(0,0,0)</script>. 
</p>
</section><section class="subsection">
<h3 id="a0000000925">3.16.3 Characterisation of an Isolated Interior Critical Point: Hessian Matrix</h3>
<p>
We focus on case (i) in the theorem above, i.e., critical points for which <script type="math/tex">\nabla f={\bf 0}</script>. Having seen that this can lead to a maximum, a minimum or a saddle, how can we systematically tell the difference between them algebraically? As in the 1-d case, this will use the second (here partial) derivatives. We shall again restrict an explicit discussion to <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. 
</p>
<p>
Consider the Taylor expansion of the function <script type="math/tex">z=f(x,y)</script> around an isolated interior critical point <script type="math/tex">P</script> at the point <script type="math/tex">(x,y)=(a,b)</script>. From above, we know that <script type="math/tex">\nabla f(a, b)={\bf 0}</script>. So the Taylor series expansion about <script type="math/tex">P</script> becomes <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  f(x,y) = f(a,b)& +& \left\{ \cancelto {=0}{f_{x}}(a,b)(x-a)+\cancelto {=0}{f_{y}}(a,b)(y-b)\right\} +\\ & +& \frac{1}{2!}\left\{ f_{xx}(a,b)(x-a)^{2}+2f_{xy}(a,b)(x-a)(y-b)+f_{yy}(a,b)(x-a)^{2}\right\} +\dots \\ \end{eqnarray*}</script></span></span> which on using the shorthand <script type="math/tex">h=(x-a)</script> and <script type="math/tex">k=(y-b)</script> becomes <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\Rightarrow f(x,y) = f(a,b)+\frac{1}{2!}\left\{ h^{2}f_{xx}(a,b)+2hkf_{xy}(a,b)+k^{2}f_{yy}(a,b)\right\} +\dots</script></span></span> Let us now suppose that we are in the immediate neighbourhood <script type="math/tex">N</script> of the critical point <script type="math/tex">P</script>, such that the orders higher than quadratic in the Taylor series are negligible. 
</p>
<p>
Thus whether the critical point is a maximum or minimum will depend on the sign of the quadratic terms, or quadratic form: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">Q=\left\{ h^{2}f_{xx}(a,b)+2hkf_{xy}(a,b)+k^{2}f_{yy}(a,b)\right\} .</script></span></span> Clearly we have: 
</p>
<ul class="itemize" id="a0000000926">
<li id="a0000000927"> <p>
If <script type="math/tex">Q>0</script> <script type="math/tex">\forall </script> <script type="math/tex">(h,k)\ne (0,0)\in N</script>, <script type="math/tex">\Rightarrow </script> <script type="math/tex">P</script> is a <b class="bf">minimum</b> (<script type="math/tex">f</script> is greater than <script type="math/tex">f(a,b)</script> in <script type="math/tex">N</script>). 
</p>
</li>
<li id="a0000000928"> <p>
If <script type="math/tex">Q<0</script> <script type="math/tex">\forall </script> <script type="math/tex">(h,k)\ne (0,0)\in N</script>. <script type="math/tex">\Rightarrow </script> <script type="math/tex">P</script> is a <b class="bf">maximum</b> (<script type="math/tex">f</script> is less than than <script type="math/tex">f(a,b)</script> in <script type="math/tex">N</script>). 
</p>
</li>
</ul>
<p>
 We don’t really want to have to check this for all <script type="math/tex">(h,k)\in N</script> as we would be here forever. Fortunately, we can rearrange the formula to put it in terms of sums of squared quantities. 
</p>
<span class="dmath"><script type="math/tex; mode=display">Q=\frac{1}{f_{xx}}\left\{ \left(hf_{xx}+kf_{xy}\right)^{2}+\left(f_{xx}f_{yy}-f_{xy}^{2}\right)k^{2}\right\}</script></span>
<p>
It’s now not too difficult to see that the sign of <script type="math/tex">Q</script> depends on the sign of <script type="math/tex">f_{xx}</script> and the sign of the combination <script type="math/tex">f_{xx}f_{yy}-f_{xy}^{2}</script>, since all the other terms in the expression are squared and so are positive. Since these are independent of <script type="math/tex">h</script> and <script type="math/tex">k</script> we don;t have to check the sign of <script type="math/tex">Q</script> throughout the neighbourhood, but just by evaluating these quantities at <script type="math/tex">P</script>. 
</p>
<p>
Hence we can state the following. 
</p>
<p>
For a critical point <script type="math/tex">P</script> with <script type="math/tex">\nabla f(a,b)={\bf 0}</script>, 
</p>
<ul class="itemize" id="a0000000929">
<li id="a0000000930"> <p>
<script type="math/tex">f_{xx}(a,b)>0</script> and <script type="math/tex">f_{xx}(a,b)f_{yy}(a,b)-f_{xy}^{2}(a,b)>0</script> <script type="math/tex">\Rightarrow </script> <script type="math/tex">Q>0</script>, so <b class="bf">minimum</b>; 
</p>
</li>
<li id="a0000000931"> <p>
<script type="math/tex">f_{xx}(a,b)<0</script> and <script type="math/tex">f_{xx}(a,b)f_{yy}(a,b)-f_{xy}^{2}(a,b)>0</script> <script type="math/tex">\Rightarrow </script> <script type="math/tex">Q<0</script>, so <b class="bf">maximum</b>. 
</p>
</li>
</ul>
<p>
What happens if <script type="math/tex">f_{xx}(a,b)f_{yy}(a,b)-f_{xy}^{2}(a,b)<0</script>? 
</p>
<p>
For the sake of brevity, if this is the case we define <script type="math/tex">f_{xx}f_{yy}-f_{xy}^{2}=-D^{2}</script>, where <script type="math/tex">D</script> is real, so that <script type="math/tex">-D^{2}</script> is always negative. Then the equation <script type="math/tex">Q=0</script> has two real roots and <script type="math/tex">Q</script> may be rearranged as (Gory and we’ll just quote and use the result!): 
</p>
<span class="dmath"><script type="math/tex; mode=display">Q=\gamma (k-\alpha h)(k-\beta h); \qquad \alpha =\frac{-f_{xx}}{f_{xy}-D}, \qquad \beta =\frac{-f_{xx}}{f_{xy}+D}, \qquad \gamma =f_{yy}.</script></span>
<p>
 Recalling the definitions of <script type="math/tex">h=x-a</script> and <script type="math/tex">k=y-b</script>, we can sketch the following diagrams in the neighbourhood of <script type="math/tex">P</script>, i.e, <script type="math/tex">(h,k)=(0,0)</script>: 
</p>
<figure id="Saddle">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0085.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.44</span>
<span class="caption_text">Schematic representation of the domains giving the signs of <script type="math/tex">Q</script> in the neighbourhood of <script type="math/tex">h=x-a</script> and <script type="math/tex">k=y-b</script>.</span>
</figcaption> </div>
</figure>
<p>
The diagram shows that in two sectors, <script type="math/tex">f</script> increases away from the critical point, whereas in two others, it decreases. The critical point is neither a maximum nor a minimum, but the <b class="bf">saddle point</b> we saw above. 
</p>
<p>
Notice that the quantity <script type="math/tex">f_{xx}f_{yy}-f_{xy}^{2}</script> is a major player in determining the nature of the critical point. Notice that it can also be written as the determinant of a matrix of partial derivatives. This is called a Hessian determinant: 
</p>
<p>
<b class="bf">Definition:</b> Assuming that the function <script type="math/tex">z=f(x.y)</script> possesses continuous second partial derivatives and that all the first partial derivatives exist. We define the <b class="bf">Hessian matrix</b> of <script type="math/tex">f</script> as 
</p>
<span class="dmath"><script type="math/tex; mode=display">H(f)(x,y)=\left(\begin{array}{cc}\dfrac {\partial ^{2}f}{\partial x^{2}} &  \dfrac {\partial ^{2}f}{\partial x\partial y} \\[12 pt]\dfrac {\partial ^{2}f}{\partial y\partial x} &  \dfrac {\partial ^{2}f}{\partial y^{2}} \end{array}\right)</script></span>
<p>
 The <b class="bf">Hessian determinant</b> <script type="math/tex">\Delta </script> is defined as 
</p>
<span class="dmath"><script type="math/tex; mode=display">\Delta (x,y)={\rm det}H(f)(x,y)=\left|\begin{array}{cc}\dfrac {\partial ^{2}f}{\partial x^{2}} &  \dfrac {\partial ^{2}f}{\partial x\partial y} \\[12 pt]\dfrac {\partial ^{2}f}{\partial y\partial x} &  \dfrac {\partial ^{2}f}{\partial y^{2}} \end{array}\right|.</script></span>
<p>
All of the above can now be summarised in the following theorem (no proof required): 
</p>
<p>
<b class="bf">(Classification of Critical points in <script type="math/tex">\mathbb R^{2}</script>):</b> Let <script type="math/tex">f(x,y)</script> be a function of two variables and let <script type="math/tex">(a,b)</script> be a critical point. Assume that <script type="math/tex">f(x,y)</script> has continuous second order partial derivatives on a neighbourhood of <script type="math/tex">(a,b)</script>. Set <script type="math/tex">\Delta (a,b) = {\rm det} H(f)(a,b)</script>. 
</p>
<ul class="itemize" id="a0000000932">
<li id="a0000000933" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(i)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) >0</script> and <script type="math/tex">\frac{\partial ^2 f}{\partial x^2}(a,b) > 0</script>, then <script type="math/tex">f(x,y)</script> has a local minimum at <script type="math/tex">(a,b)</script>. 
</p>
</li>
<li id="a0000000934" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(ii)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) >0</script> and <script type="math/tex">\frac{\partial ^2 f}{\partial x^2}(a,b) < 0</script>, then <script type="math/tex">f(x,y)</script> has a local maximum at <script type="math/tex">(a,b)</script>. 
</p>
</li>
<li id="a0000000935" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(iii)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) < 0</script>, then <script type="math/tex">f(x,y)</script> has a saddlepoint at <script type="math/tex">(a,b)</script>. 
</p>
</li>
<li id="second derivative 2 variable" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(iv)
		</span>
<p>
If <script type="math/tex">\Delta (a,b) = 0</script>, then we have no information. 
</p>
</li>
</ul>
<p>
<b class="bf">NB:</b> You may be worrying about what happens when <script type="math/tex">\Delta (a,b)>0</script> and <script type="math/tex">\partial ^{2}f/\partial x^{2}=0</script>. The answer is that it can never occur because the condition on the continuity of of the second order partial derivatives means that the mixed partials are equal: <script type="math/tex">f_{xy}(a,b)=f_{yx}(a,b)</script>. Hence <script type="math/tex">\Delta (a,b)=f_{xx}(a,b)f_{y}(a,b)-f_{xy}(a,b)^{2}</script>and so if <script type="math/tex">f_{xx}=0</script>, <script type="math/tex">\Delta (a,b)\le 0</script>. 
</p>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}+y^{2}</script></span>.</span> From an example above, we know that there is a single critical point at <script type="math/tex">(x,y)=(0,0)</script>. Evaluating the second partial derivatives we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=2, \qquad f_{xy}(x,y)=0, \qquad f_{yy}(x,y)=2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(0,0)=2 >0, \qquad \Delta (0,0)=f_{xx}(0,0)f_{yy}(0,0)-f_{xy}^{2}(0,0) = 2.2 -0 =4 >0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(0,0)</script> is a minimum</span>. 
</p>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=1-x^{2}-xy-y^{2}</script></span>. </span>
</p>
<ul class="itemize" id="a0000000936">
<li id="a0000000937"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(-2x-y){\bf i}+(-x-2y){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000938"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-2x-y=0 \qquad \Rightarrow \qquad y=-2x</script></span> <span class="dmath"><script type="math/tex; mode=display">-x-2y=0 \qquad \Rightarrow \qquad y=-x/2</script></span></span>
</p>
</li>
<li id="a0000000939"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <span style="color:#FF0000"><script type="math/tex">(x,y)=(0,0)</script>.</span>
</p>
</li>
<li id="a0000000940"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2, \qquad f_{xy}(x,y)=-1, \qquad f_{yy}(x,y)=-2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(0,0)=-2 <0, \qquad \Delta (0,0)=f_{xx}(0,0)f_{yy}(0,0)-f_{xy}^{2}(0,0) = (-2).(-2) -(-1)^{2} =3 >0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(0,0)</script> is a maximum</span>. 
</p>
</li>
</ul>
<p>
<br/>
</p>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x+y-x^{2}-xy</script></span>. </span>
</p>
<ul class="itemize" id="a0000000941">
<li id="a0000000942"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(1-2x-y){\bf i}+(1-x){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000943"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1-2x-y=0 \qquad \Rightarrow \qquad y=-2x+1</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1-x=0 \qquad \Rightarrow \qquad x=1</script></span></span>
</p>
</li>
<li id="a0000000944"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <script type="math/tex">(x,y)=(1,-1)</script>
</p>
</li>
<li id="a0000000945"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2, \qquad f_{xy}(x,y)=-1, \qquad f_{yy}(x,y)=0,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(1,-1)=-2<0, \qquad \Delta (1,-1)=f_{xx}(1,-1)f_{yy}(1,-1)-f_{xy}^{2}(1,-1) = -2.0 -(-1)^{2} =-1 <0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(1,-1)</script> is a saddlepoint</span>. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x+y^{2}-x^{3}/3</script></span>.</span>
</p>
<ul class="itemize" id="a0000000946">
<li id="a0000000947"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(1-x^{2}){\bf i}+(2y){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000948"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">1-x^{2}=0 \qquad \Rightarrow \qquad x=\pm 1</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=0 \qquad \Rightarrow \qquad y=0</script></span></span>
</p>
</li>
<li id="a0000000949"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <script type="math/tex">(x,y)=(1,0)</script> and <script type="math/tex">(x,y)=(-1,0)</script>
</p>
</li>
<li id="a0000000950"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: 
</p>
<ul class="itemize" id="a0000000951">
<li id="a0000000952"> <p>
At (1,0): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2x, \qquad f_{xy}(x,y)=0, \qquad f_{yy}(x,y)=2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(1,0)=-2<0, \qquad \Delta (1,0)=f_{xx}(1,0)f_{yy}(1,0)-f_{xy}^{2}(1,0) = -2.2 -(0)^{2} =-4 <0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(1,0)</script> is a saddlepoint.</span>
</p>
</li>
<li id="a0000000953"> <p>
At (-1,0): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=-2x, \qquad f_{xy}(x,y)=0, \qquad f_{yy}(x,y)=2,</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(-1,0)=2>0, \qquad \Delta (-1,0)=f_{xx}(-1,0)f_{yy}(-1,0)-f_{xy}^{2}(-1,0) = 2.2 -(0)^{2} =+4 >0,</script></span></span> so <span style="color:#FF0000"><script type="math/tex">(-1,0)</script> is a minimum.</span>
</p>
</li>
</ul>
</li>
</ul>
<figure id="Saddle">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0087.png" style="width:216.81pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.45</span>
<span class="caption_text">The surface <script type="math/tex">z=x+y^{2}-x^{3}/3</script> and its critical points.</span>
</figcaption> </div>
</figure>
<p>
<b class="bf">Example:</b> Classify the critical points of the function <script type="math/tex">z=f(x,y)</script> where <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=x^{2}-3xy^{2}+2y^{4}</script></span>.</span>
</p>
<ul class="itemize" id="a0000000954">
<li id="a0000000955"> <p>
This has a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=f_{x}{\bf i}+f_{y}{\bf j}=(2x-3y^{2}){\bf i}+(-6xy+8y^{3}){\bf j}={\bf 0}.</script></span></span>
</p>
</li>
<li id="a0000000956"> <p>
This gives us two simultaneous equations to solve: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x-3y^{2}=0 \qquad \Rightarrow \qquad y^{2}=2x/3</script></span></span> <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">-6xy+8y^{3}=0 \qquad \Rightarrow \qquad y=0, y^{2}=3x/4</script></span></span>
</p>
</li>
<li id="a0000000957"> <p>
Solving these simultaneously we obtain that <script type="math/tex">f</script> has a critical point at <script type="math/tex">(x,y)=(0,0)</script>. 
</p>
</li>
<li id="a0000000958"> <p>
To determine the nature of the critical point we evaluate the second partial derivatives: 
</p>
<ul class="itemize" id="a0000000959">
<li id="a0000000960"> <p>
At (0,0): <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(x,y)=2, \qquad f_{xy}(x,y)=-6y, \qquad f_{yy}(x,y)=-6x+24y^{2},</script></span></span> so, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f_{xx}(0,0)=2>0, \qquad \Delta (0,0)=f_{xx}(0,0)f_{yy}(0,0)-f_{xy}^{2}(0,0) = 2.(-6.0+24.0)-(-6.0)^{2} =0,</script></span></span> so the Hessian matrix test fails at <span style="color:#FF0000"><script type="math/tex">(0,0)</script>.</span> More information is needed. (In fact looking at contour plots around <script type="math/tex">(0,0)</script> suggests that the critical point is a saddlpoint.) 
</p>
</li>
</ul>
</li>
</ul>
</section><section class="subsection">
<h3 id="a0000000961">3.16.4 Higher Dimensions</h3>
<p>
The classification of critical points in higher dimensions follows from a simple extension of the above results. It proceeds by calculation of successive sub-determinants of the relevant Hessian matrix. 
</p>
<p>
<b class="bf">Example:</b> The Hessian matrix of a doubly differentiable <script type="math/tex">\mathbb R^{3}\to \mathbb R</script> function <script type="math/tex">f(x,y,z)</script> is 
</p>
<span class="dmath"><script type="math/tex; mode=display">Hf=\left(\begin{array}{ccc}f_{xx} &  f_{xy} &  f_{xz} \\ f_{yx} &  f_{yy} &  f_{yz} \\ f_{zx} &  f_{zy} &  f_{zz}\end{array}\right)</script></span>
<p>
<b class="bf">Definition:</b> Given an <script type="math/tex">n</script> by <script type="math/tex">n</script> matrix with elements <script type="math/tex">a_{ij}</script>, we define a sequence of <script type="math/tex">k</script> by <script type="math/tex">k</script> determinants (<script type="math/tex">k=1</script> to <script type="math/tex">n</script>) of upper-left sub-determinants as: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\Delta _{0}=1; \qquad \Delta _{1}=a_{11}; \qquad \Delta _{2}=\left|\begin{array}{cc}a_{11} &  a_{12} \\ a_{21} &  a_{22}\end{array}\right|; \qquad \dots \qquad \Delta _{k}=\left|\begin{array}{ccc}a_{11} &  \cdots &  a_{1k} \\ \vdots &  \ddots &  \vdots \\ a_{k1} &  \cdots &  a_{kk}\end{array}\right|.</script></span>
<p>
Given this definition, the following theorem can be proved (proof not required): 
</p>
<p>
<b class="bf">(Classification of Critical Points in <script type="math/tex">\mathbb R^{n}</script>):</b> Suppose that <script type="math/tex">P</script> is a critical point of a multivariate function <script type="math/tex">f</script> interior to the domain of <script type="math/tex">f</script>. Suppose that the second partial derivatives of <script type="math/tex">f</script> are continuous in the neighbourhood of <script type="math/tex">P</script>. Then 
</p>
<ul class="itemize" id="a0000000962">
<li id="a0000000963" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(a)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has <script type="math/tex">\Delta _{i}>0, i=0,\dots , n</script>, then <script type="math/tex">f</script> has a local <b class="bf">minimum</b> at <script type="math/tex">P</script>; 
</p>
</li>
<li id="a0000000964" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(b)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has <script type="math/tex">\Delta _{i}\ne 0, i=0,\dots , n</script>, with <script type="math/tex">\Delta _{1}<0, \Delta _{2}>0, \Delta _{3}<0, \Delta _{4}>0 \dots </script>, etc., then <script type="math/tex">f</script> has a local <b class="bf">maximum</b> at <script type="math/tex">P</script>; 
</p>
</li>
<li id="a0000000965" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(c)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has <script type="math/tex">\Delta _{i}\ne 0, i=0,\dots , n</script> but the <script type="math/tex">\Delta _{i}</script> have neither of the above sign patterns, then <script type="math/tex">f</script> has a <b class="bf">saddlepoint</b> at <script type="math/tex">P</script>; 
</p>
</li>
<li id="a0000000966" style="list-style: none;">
<span style="transform: translateX(-100%);padding-right: 10px;position: absolute;">
			(d)
		</span>
<p>
If <script type="math/tex">\left.Hf\right|_{P}</script> has one or more <script type="math/tex">\Delta _{i}=0</script>, then no information about <script type="math/tex">P</script> may be obtained from this test. there may be a maximum, minimum or saddlepoint at <script type="math/tex">P</script>. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> Classify the critical points of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">w=f(x,y,z)=5+x^{2}+y^{2}+z^{2}+xy</script></span>.</span>
</p>
<ul class="itemize" id="a0000000967">
<li id="a0000000968"> <p>
The critical point is at <script type="math/tex">\nabla f={\bf 0}</script>. So we have 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\nabla f=\frac{\partial f}{\partial x}{\bf i}+\frac{\partial f}{\partial y}{\bf j}+\frac{\partial f}{\partial z}{\bf k}=(2x+y){\bf i}+(2y+x){\bf j}+2z{\bf k}={\bf 0}.</script></span></span>
</p>
<p>
From which we immediately see that <script type="math/tex">z=0</script>. 
</p>
<p>
The <script type="math/tex">x</script> and <script type="math/tex">y</script> and <script type="math/tex">z</script> coordinates of <script type="math/tex">P</script> are given by the simultaneous solution of 
</p>
<p>
<span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x+y=0, \qquad x+2y=0, \qquad z=0,</script></span></span>
</p>
<p>
from which we see that <script type="math/tex">x=y=z=0</script>. 
</p>
<p>
Hence <script type="math/tex">P</script> is at <script type="math/tex">(0,0,0)</script>. 
</p>
</li>
<li id="a0000000969"> <p>
The Hessian matrix and its sub-determinants are: 
</p>
<span class="dmath"><script type="math/tex; mode=display">\left.Hf\right|_{P}=\left(\begin{array}{ccc}f_{xx} &  f_{xy} &  f_{xz} \\ f_{yx} &  f_{yy} &  f_{yz} \\ f_{zx} &  f_{zy} &  f_{zz}\end{array}\right)_{P}=\left(\begin{array}{ccc}2 &  1 &  0 \\ 1 &  2 &  0 \\ 0 &  0 &  2\end{array}\right)</script></span>
<span class="dmath"><script type="math/tex; mode=display">\Delta _{0}=1; \qquad \Delta _{1}=2; \qquad \Delta _{2}=\left|\begin{array}{cc}2 &  1 \\ 1 &  2\end{array}\right|=2; \qquad \Delta _{3}=\left|\begin{array}{ccc}2 &  1 &  0 \\ 1 &  2 &  0 \\ 0 &  0 &  2\end{array}\right|=6.</script></span>
<p>
Hence all the <script type="math/tex">\Delta _{i}, i=0,1,2,3</script> are greater than zero. Hence the critical point <script type="math/tex">P</script> is a minimum. 
</p>
</li>
</ul>
<p>
Hessians should not be confused with mercenaries used in the American War of Independence, or Deputy-Führers of the same names. 
</p>
</section>
</section><section class="section">
<h2 id="a0000000970">3.17 Maximisation and Minimisation with a Constraint: <br/>Lagrange Multipliers </h2>
<p>
Consider the following problem: 
</p>
<p>
<b class="bf">Example:</b> Find the dimensions and area of the largest rectangle inside the ellipse 
</p>
<span class="dmath"><script type="math/tex; mode=display">\frac{x^{2}}{4}+y^{2}=1.</script></span>
<figure id="Saddle">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0089.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.46</span>
<span class="caption_text">Rectangle of area <script type="math/tex">A=4xy</script> embedded within the ellipse <script type="math/tex">x^{2}/4+y^{2}=1</script>.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000971">
<li id="a0000000972"> <p>
Consider a rectangle that lies within the ellipse with the top right corner being at the point <script type="math/tex">(x,y)</script> that lies on the ellipse (see diagram). By symmetry the other three corners of the rectangle are at <script type="math/tex">(x, -y), (-x,y)</script> and <script type="math/tex">(-x,-y)</script>. 
</p>
</li>
<li id="a0000000973"> <p>
The lengths of the sides are <script type="math/tex">2x</script> and <script type="math/tex">2y</script>, so the area of the rectangle within the ellipse is <script type="math/tex">A=4xy</script>. 
</p>
</li>
<li id="a0000000974"> <p>
The goal is then to <b class="bf">maximise</b> <script type="math/tex">A=4xy</script> subject to the <b class="bf">constraint </b>that <script type="math/tex">x^{2}/4+y^{2}=1</script>. 
</p>
</li>
<li id="a0000000975"> <p>
In this example it is easy to see that we could eliminate <script type="math/tex">y</script> by solving the constraint for <script type="math/tex">y</script> and substituting the resulting expression<a class="footnote" href="#a0000000976">
<sup class="footnotemark">9</sup>
</a> <script type="math/tex">y=\sqrt{4-x^{2}}/2</script> in terms of <script type="math/tex">x</script> into the formula for <script type="math/tex">A</script> to obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">A=2x\sqrt{4-x^{2}}.</script></span></span>
</p>
</li>
<li id="a0000000977"> <p>
The finding of the critical point <script type="math/tex">x</script> corresponding to the maximum of <script type="math/tex">A</script> would then take place by just differentiating <script type="math/tex">A</script> with respect to <script type="math/tex">x</script> and setting <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{dA}{dx}=2\sqrt{4-x^{2}}-\frac{2x^{2}}{\sqrt{4-x^{2}}}=0 \qquad \Rightarrow \qquad x=\sqrt{2}.</script></span></span> where we have taken the positive value of <script type="math/tex">x</script> since it is the length of a rectangle. 
</p>
</li>
<li id="a0000000978"> <p>
Hence we have <script type="math/tex">y=\sqrt{4-2}/2=1/\sqrt{2}</script> and so <script type="math/tex">A=4\sqrt{2}/\sqrt{2}=4.</script>
</p>
</li>
</ul>
<p>
In this case we were able to reduce the problem to one of single variable calculus by being able to solve the constraint equation (<script type="math/tex">x^{2}/4+y^{2}=1</script>) exactly for one of the variables. What happens when the constraint is not solvable for one of the variables, e.g., <script type="math/tex">(x+y)=e^{-xy}</script>? In the general case, we shall use the <b class="bf">Method of Lagrange Multipliers.</b>
</p>
<section class="subsection">
<h3 id="a0000000979">3.17.1 General Statement of Problem of Optimisation with an Algebraic Constraint </h3>
<p>
We will restrict ourselves to <script type="math/tex">\mathbb R^{2}\to \mathbb R</script>. We require the solution of the following problem. 
</p>
<p>
<b class="bf">Problem:</b> Find the maximum or minimum of <script type="math/tex">f(x,y)</script>, subject to <script type="math/tex">g(x,y)=0</script>. 
</p>
<ul class="itemize" id="a0000000980">
<li id="a0000000981"> <p>
To do this we form what is called the the <b class="bf">Lagrangian</b> <script type="math/tex">{\mathcal L}</script>: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">{\mathcal L(x,y,\lambda )}=f(x,y)+\lambda g(x,y),</script></span></span> where <script type="math/tex">\lambda </script> is a constant, called the <b class="bf">Lagrange multipler</b>. 
</p>
</li>
<li id="a0000000982"> <p>
Now <script type="math/tex">g(x,y)=0</script> defines a curve <script type="math/tex">\mathcal C</script> in <script type="math/tex">\mathbb R^{2}</script>. 
</p>
</li>
<li id="a0000000983"> <p>
We seek to optimise <script type="math/tex">{\mathcal L}</script> with respect to all three of its variables <script type="math/tex">x, y,\lambda </script>. The critical point is when <script type="math/tex">\nabla _{x,y,\lambda }{\mathcal L}={\bf 0}</script>, i.e., when <span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial {\mathcal L}}{\partial x}& =& \frac{\partial f}{\partial x}+\lambda \frac{\partial g}{\partial x}=0, \\ \frac{\partial {\mathcal L}}{\partial y}& =& \frac{\partial f}{\partial y}+\lambda \frac{\partial g}{\partial y}=0, \\ \frac{\partial {\mathcal L}}{\partial \lambda }& =& g(x,y)=0. \end{eqnarray*}</script></span></span>
</p>
</li>
<li id="a0000000984"> <p>
Clearly from the third line, if we find the critical point of <script type="math/tex">{\mathcal L}</script> we automatically satisfy the constraint <script type="math/tex">g(x,y)=0</script>. Hence the critical points of <script type="math/tex">{\mathcal L}</script> lie on <script type="math/tex">{\mathcal C}</script>. 
</p>
</li>
<li id="a0000000985"> <p>
But the Lagrangian <script type="math/tex">\mathcal L</script> is identical to <script type="math/tex">f</script> on <script type="math/tex">{\mathcal C}</script> (where <script type="math/tex">g(x,y)=0</script>). 
</p>
</li>
<li id="a0000000986"> <p>
Hence if we are on <script type="math/tex">{\mathcal C}</script> and we find the critical point of <script type="math/tex">\mathcal L</script> from the above three equations, we are also finding the critical point of <script type="math/tex">f</script> on <script type="math/tex">{\mathcal C}</script>, i.e., we are finding the max/min of <script type="math/tex">f(x,y)</script> subject to the constraint <script type="math/tex">g(x,y)=0</script>. 
</p>
</li>
<li id="a0000000987"> <p>
We can go further, and eliminate the Lagrange multiplier <script type="math/tex">\lambda </script> from the first two equations: 
</p>
<p>
<span style="color:#FF0000"><span><script type="math/tex; mode=display">\begin{eqnarray*}  \frac{\partial f}{\partial x}+\lambda \frac{\partial g}{\partial x}=0, \qquad & \Rightarrow &  \qquad \lambda = -\frac{\partial f}{\partial x}\bigg/ \  \frac{\partial g}{\partial x} \\ \frac{\partial f}{\partial y}+\lambda \frac{\partial g}{\partial y}=0 \qquad & \Rightarrow &  \qquad \lambda = -\frac{\partial f}{\partial y}\bigg/ \  \frac{\partial g}{\partial y} \\ \Rightarrow \frac{\partial f}{\partial x}\bigg/ \  \frac{\partial g}{\partial x}& =& \frac{\partial f}{\partial y}\bigg/ \  \frac{\partial g}{\partial y} \end{eqnarray*}</script></span></span> which may be rearranged to give: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x} \frac{\partial g}{\partial y}- \frac{\partial g}{\partial x}\frac{\partial f}{\partial y}=0</script></span></span> or, in terms of the Jacobian determinant, <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=0.</script></span></span>
</p>
</li>
<li id="a0000000988"> <p>
Hence the critical point will be given by the simultanenous solution of <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=0, \qquad g(x,y)=0.</script></span></span>
</p>
</li>
<li id="a0000000989"> <p>
Note that the actual value of the Lagrange multiplier is therefore <b class="bf">irrelevant</b>! 
</p>
</li>
</ul>
<p>
We may now repeat the above example as follows: 
</p>
<p>
<b class="bf">Example:</b> We have the area function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=4xy</script></span></span> and the constraint function <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=x^{2}/4+y^{2}-1=0</script></span>.</span>
</p>
<ul class="itemize" id="a0000000990">
<li id="a0000000991"> <p>
Using the above method, the relevant partial derivatives are: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}=4y, \qquad \frac{\partial f}{\partial y}=4x, \qquad \frac{\partial g}{\partial x}=\frac{x}{2}, \qquad \frac{\partial g}{\partial y}=2y.</script></span></span>
</p>
</li>
<li id="a0000000992"> <p>
Substituting into the Jacobian determinant we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=\left(\frac{\partial f}{\partial x}\frac{\partial g}{\partial y}-\frac{\partial g}{\partial x}\frac{\partial f}{\partial y}\right)=(4y)(2y)-(4x)(x/2)=8y^{2}-2x^{2}=0</script></span></span>
</p>
</li>
<li id="a0000000993"> <p>
Hence we have a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y^{2}=x^{2}/4</script></span></span> <b class="bf">and</b> (from the third equation <script type="math/tex">\partial {\mathcal L}/\partial \lambda =0</script> above) <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=x^{2}/4+y^{2}-1=0.</script></span></span> Hence we can substitute for <script type="math/tex">y</script> in <script type="math/tex">g</script> to obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">x^{2}/4+x^{2}/4-1=0 \qquad \Rightarrow x^{2}=2 \qquad \Rightarrow x=\pm \sqrt{2}.</script></span></span> Hence using <script type="math/tex">y^{2}=x^{2}/4</script> we obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y^{2}=2/4 \qquad \Rightarrow x=\pm 1/\sqrt{2}.</script></span></span>
</p>
</li>
<li id="a0000000994"> <p>
Finally since <script type="math/tex">x</script> and <script type="math/tex">y</script> are meant to be the lengths of sides of a rectangle, they both have to be positive. So the critical point is when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">(x,y)=(\sqrt{2},1/\sqrt{2})</script></span></span> and the area is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">4\sqrt{2}/\sqrt{2}=4.</script></span></span>
</p>
</li>
<li id="a0000000995"> <p>
Note that we don’t choose to show that this is a maximum here. 
</p>
</li>
</ul>
<p>
<b class="bf">Example:</b> A farmer wants to enclose a rectangle of land next to a stream (see diagram) She will build 3 fences, the two perpendicular to the stream will be of length <script type="math/tex">x</script>, the one parallel to the stream will be of length <script type="math/tex">y</script>. If the farmer has only 100m length of fencing, what is the maximum area that she may enclose? 
</p>
<figure id="Saddle">
<div class="centered"> <img src="../../../notes/notes_by_chapter/multivariable_functi/images/img-0091.png" style="width:252.945pt"/>
<figcaption>
<span class="caption_title">Figure</span>
<span class="caption_ref">3.47</span>
<span class="caption_text">Area of enclosed rectangular field is <script type="math/tex">A=xy</script>. Since it is adjacent to the stream only three fences are built with total perimeter <script type="math/tex">2x+y=100</script>m.</span>
</figcaption> </div>
</figure>
<ul class="itemize" id="a0000000996">
<li id="a0000000997"> <p>
The problem is to maximise <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">f(x,y)=xy</script></span></span> subject to <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=2x+y-100=0.</script></span></span>
</p>
</li>
<li id="a0000000998"> <p>
Using the above method, the relevant partial derivatives are: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial f}{\partial x}=y, \qquad \frac{\partial f}{\partial y}=x, \qquad \frac{\partial g}{\partial x}=2, \qquad \frac{\partial g}{\partial y}=1.</script></span></span>
</p>
</li>
<li id="a0000000999"> <p>
Substituting into the Jacobian determinant we have: <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">\frac{\partial (f,g)}{\partial (x,y)}=\left(\frac{\partial f}{\partial x}\frac{\partial g}{\partial y}-\frac{\partial g}{\partial x}\frac{\partial f}{\partial y}\right)=(y)(1)-(x)(2)=y-2x=0</script></span></span>
</p>
</li>
<li id="a0000001000"> <p>
Hence we have a critical point when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=2x</script></span> </span> <b class="bf">and</b> (from the third equation <script type="math/tex">\partial {\mathcal L}/\partial \lambda =0</script> above) <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">g(x,y)=2x+y-100=0.</script></span></span> Hence we can substitute for <script type="math/tex">y</script> in <script type="math/tex">g</script> to obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">2x+2x-100=0 \qquad \Rightarrow x=25.</script></span></span> Hence using <script type="math/tex">y=2x</script> we obtain <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">y=50.</script></span></span>
</p>
</li>
<li id="a0000001001"> <p>
So the critical point is when <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">(x,y)=(25,50)</script></span></span> and the area is <span style="color:#FF0000"><span class="dmath"><script type="math/tex; mode=display">25\times 50 =1,250 {\rm m}^{2}.</script></span></span>
</p>
</li>
</ul>
<p>
Other types of problems involving optimisation with a constraint are possible (e.g., there are multiple constraints and/or at least on of the constraints is an inequality), but we will leave these for later modules. 
</p>
<p>
One interesting use of optimisation with a set of algebraic constraints is in the selection of an optimal portfolio of stocks to maximise the expected return. This problem is dealt with in MATH3022.  
</p>
</section>
</section>
<hr/>
<ol>
<li id="a0000000650">the OS are actually based in Southampton <a href="https://www.ordnancesurvey.co.uk/">https://www.ordnancesurvey.co.uk/</a> </li>
<li id="a0000000651">You can read more about the mathematical aspects of the experiment <a href="https://www.citylab.com/design/2016/06/contour-lines-hutton-schiehallion/486308/">here</a>. Details of the theory underpinning the calculation can be found <a href="https://en.wikipedia.org/wiki/Schiehallion_experiment">here</a>. The original experiment was accurate to around 20% of the currently accepted value for the density of the earth. Subsequent experiments on the same mountain achieve estimates within 1%.</li>
<li id="a0000000731">Don’t panic! if you have a problem like this in an exam, you will be given a hint.</li>
<li id="a0000000760">Note that in this example, when <script type="math/tex">z</script> is expressed in terms of the ultimate independent variables we find that there is only 1 indepdendent variable. Therefore the final derivative with respect to that variable is a total one.</li>
<li id="a0000000780">DON’T PANIC: you won’t be expected to do this until MATH2038! This is just an example to show you how the chain rule is useful.</li>
<li id="a0000000827">One should expect the converse not to be true as we only choose two specific lines on the tangent plane in order to describe the gradient vector. But as we shall see, this is almost true.</li>
<li id="a0000000891">Such problems will be discussed next year, but the transformation here serves as a good exercise in use of the chain rule.</li>
<li id="a0000000919">Use <script type="math/tex">x=r\cos \theta </script> and <script type="math/tex">y=r\sin \theta </script> etc.</li>
<li id="a0000000976">We take the positive square root as <script type="math/tex">y</script> is a length.</li>
</ol>

            </div>
        </div>
    </div>

        </main>
		
		<footer class="text-muted">
	<hr>
	<div class="container">
		<div class="float-right">
			<ul style="list-style: none">
			<li><a href="#">Back to top</a></li>
			
			
			<li><a href="../../../notes/notes_by_chapter/multivariable_functi/multivariable_functi.pdf" target="_blank"><i class="fa fa-file-pdf-o"></i>&nbsp;Download as PDF</a></li>
			
			</ul>
		</div>
		<p>Generated using <a target="_blank" href="https://github.com/chirun-ncl/chirun">Chirun</a>, written by the E-Learning Unit, School of Mathematics &amp; Statistics, Newcastle University</p>
		<p>This page last generated: 2022-07-03</p>
	</div>
</footer>
		
    </body>
</html>
