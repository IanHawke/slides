<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Lecture 9</title>

		<meta name="description" content="Math1058">
		<meta name="author" content="Ian Hawke">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="../reveal.js/dist/reset.css">
		<link rel="stylesheet" href="../reveal.js/dist/reveal.css">
		<link rel="stylesheet" href="../reveal.js/dist/theme/white.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="../reveal.js/plugin/highlight/monokai.css">


	<style type="text/css">
	  .reveal p {
	    text-align: left;
	  }
	  .reveal ul {
	    display: block;
	  }
	  .reveal ol {
	    display: block;
	  }
	</style>




	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section id="Title">

					<section>
						<h2 class="r-fit-text">Simplex Method and Basic Solutions</h2>
						<p>
							<ul style="list-style: none;">
								<li> Ian Hawke
								<li> Giles Richardson
							</ul>
						</p>

						<aside class="notes">
							We introduce the Simplex Method.
						</aside>
					</section>

				</section>

				<section id="Simplex">

					<section>

						<h2>Simplex Method</h2>
						<div style="position:absolute; width:768px; top:150px; left:0px">
							<ul>
								<li>
									Solutions to linear programs at vertices.
								</li>
								<li>
									Simplex method: move from one vertex to adjacent until optimal found.
								</li>
								<li class="fragment" data-fragment-index=1>
									Ingredients:
									<ol>
										<li>
											How to characterize vertex algebraically?
										</li>
										<li>
											How to check vertex is optimal?
										</li>
										<li>
											How to move from vertex to better vertex?
										</li>
									</ol>
								</li>
							</ul>
							<p class="fragment" data-fragment-index=2>
								How to start? How much does it cost?
							</p>
						</div>
						<div style="position:absolute; width:768px; top:150px; left:768px">
							<img style="width:768px" src="images/09_simplex_basics/lp_simplex_vertex.svg">
						</div>

						<aside class="notes">
							We know, from the fundamental theorem, that an optimal solution to a linear program can be found at a vertex. We also know, from cost discussions, that looking at every vertex is impractical.
							<br>
							Following the intuition from the graphical solution, we instead consider moving from one vertex to an adjacent, better, vertex. This is the foundation of the simplex method of Dantzig.
							<br>
							This will work if we can algebraically say what a vertex is, and if we can work out how to move to an adjacent vertex, and if we can easily check it to be better, and if we can easily check if it is optimal. That is a lot of conditions that we need to check.
							<br>
							Once we have the algorithm we can then check how much it costs, and work out how to start. Constructing this will take some time.
						</aside>
					</section>

					<section>
						<h2>Form and goal</h2>

						<p>
							Write LP in standard form:
						</p>
						\[
						\begin{array}{rcrcl}
						\min_x & \quad & c x && \\
						\text{subject to} & & A x & = & b \\
						& & x & \ge & 0.
						\end{array}
						\]
						<div class="fragment">
							<p>
								Want to pick submatrix $A_B$ so that
							</p>
							\[
							x = A_B^{-1} b
							\]
							<p>
								makes sense. These <em>basic solutions</em> "are" vertices.
							</p>
						</div>

						<aside class="notes">
							Because we want to do algebraic operations the best form to use is the standard form. Remember the transformation rules allow us to convert any linear program to this form.
							<br>
							For this lecture we are looking to characterize a vertex algebraically. In general the linear system defined by the standard form has a huge number of solutions. What we want to do is pick specific solutions. To do this we want to construct an invertible submatrix, which will give us a single solution to the problem. The precise assumptions that go into building this submatrix are the key blocks for today.
						</aside>
					</section>

				</section>

				<section id="Basic">

					<section>
						<h2>Assumptions</h2>
						\[
						\begin{array}{rcrcl}
						\min_x & \quad & c x && \\
						\text{subject to} & & A x & = & b \\
						& & x & \ge & 0.
						\end{array}
						\]
						<p>
							Assumptions:
						</p>
						<ol>
							<li class="fragment">
								$b \ge 0$. If not, multiply rows by $-1$.
							</li>
							<li class="fragment">
								$m < n$ (fewer constraints than variables). Needed to get multiple solutions.
							</li>
							<li class="fragment">
								$A$ full row rank.
							</li>
						</ol>
						<div class="fragment">
							<div style="position:absolute; width:768px; left:0px">
								\[
								\begin{alignat*}{5}
								2 & x_1 + & & x_2 + & & x_3 & = & 2 & \quad \text{(I)}   & \\
							  	& x_1 + & & x_2   & &     & = & 1 & \quad \text{(II)}  & \\
							  	& x_1   & & \phantom{x_2}    + & & x_3 & = & 1 & \quad \text{(III)} &
								\end{alignat*}
								\]
								<p>
									Linearly dependent: drop any constraint.
								</p>
							</div>
							<div style="position:absolute; width:668px; left:868px" class="fragment">
								\[
								\begin{alignat*}{5}
								2 & x_1 + & & x_2 + & & x_3 & = & 2 & \quad \text{(I)}   & \\
							  	& x_1 + & & x_2   & &     & = & 1 & \quad \text{(II)}  & \\
							  	& x_1   & & \phantom{x_2}    + & & x_3 & = & \color{red}{2} & \quad \text{(III)} &
								\end{alignat*}
								\]
								<p>
									Inconsistent - problem infeasible.
								</p>
							</div>
						</div>

						<aside class="notes">
							We make a few assumptions, some of which simplify the solution, and some of which are necessary.
							<br>
							The assumption that all components of the right-hand-side vector are non-negative is a simplification. If any component is negative, then another transformation rule can be used: multiply that entire row (so, all components of the $A$ matrix and that component of $b$) by -1.
							<br>
							The assumption that there are fewer constraints than variables is needed. If there were the same number then we have a linear system with a unique solution (or no solution, or an infinite number), which is neither expected nor useful. If there were more constraints then it would be over-determined, and again we would expect no solution.
							<br>
							This may seem surprising as most problems written down so far have had more constraints than variables. Think about the optimal portfolio problem with two variables and five constraints. However, this is because we have used the canonical form up to now. In transforming to standard form we have to introduce a slack or surplus variable for each constraint, guaranteeing more variables than constraints.
							<br>
							The final assumption is that $A$ has full row rank, so that the rows are linearly independent. If this were not true we could transform the matrix so that two rows of the matrix had the same coefficients. There are then two possibilities. In the first, the associated right-hand-side coefficients are also identical. In this case one constraint is redundant and can be dropped. In the other case the right-hand-side coefficients are different, and the constraints are inconsistent. This means the problem has no feasible solutions.
						</aside>
					</section>

					<section>

						<h2>Basic matrices</h2>

						<p>
							<b>Definition:</b> Let $B \subseteq \{ 1, \dots, n \}$ with $|B| = m$. Let $A_B$ be the submatrix of $A$ with column indexes $B$. If the columns are linearly independent, $A_B$ is a <em>basic matrix</em>.
						</p>
						<ul class="fragment">
							<li>
								$A_B$ is square.
							</li>
							<li>
								$A_B$ has full row and column rank (by definition).
							</li>
							<li>
								$A_B$ is invertible.
							</li>
						</ul>

						<aside class="notes">
							This is our key definition. By assumption the full matrix $A$ has more columns than rows, because each column is associated with a variable and each row with a constraint. We want to extract the right number of rows to get a square matrix. We do this because we want to solve the resulting linear system $A_B x = b$ to give us <em>some</em> solution. In order for this solution to exist and be unique we need the basic matrix to be invertible, which means it has to have full column rank and row rank. The full row rank follows from the full matrix $A$; the linear independence of the columns for the basic matrix is therefore needed in addition.
						</aside>

					</section>

					<section>
						<h2>Optimal Portfolio revisited</h2>
						<div class="fragment fade-out" style="position:absolute; width:1536px; left:0px" data-fragment-index=1>
							\[
							\begin{alignat*}{4}
							\max \quad && 0.02 & x_1 + & 0.03 & x_2 &&  \\
							\text{subject to} && & x_1 + && x_2 & \le & 10 \\
							&& & x_1 & && \le & 7 \\
							&& && & x_2  & \le & 5 \\
							&& & x_1, && x_2  & \ge & 0.
							\end{alignat*}
							\]
						</div>
						<div class="fragment fade-in-then-out" style="position:absolute; width:1536px; left:0px" data-fragment-index=1>
							\[
							\begin{alignat*}{7}
							\min \quad && -0.02 & x_1 - & 0.03 & x_2 && && && && \\
							\text{subject to} && & x_1 + && x_2 + & \phantom{0.00}& x_3 & \phantom{0.00}& & \phantom{0.00}& & = & 10 \\
							&& & x_1 & & && \phantom{x_3} + && x_4 && & = & 7 \\
							&& && & x_2 &&  && \phantom{x_4} + && x_5 &  = & 5 \\
							&& & x_1, && x_2, && x_3, && x_4, && x_5 & \ge & 0.
							\end{alignat*}
							\]
						</div>
						<div class="fragment fade-in" style="position:absolute; width:1536px; left:0px" data-fragment-index=2>
							\[
							\begin{pmatrix}
							1 & 1 & 1 & 0 & 0 \\
							1 & 0 & 0 & 1 & 0 \\
							0 & 1 & 0 & 0 & 1
							\end{pmatrix}
							x =
							\begin{pmatrix}
							10 \\ 7 \\ 5
							\end{pmatrix}
							\]
						</div>
						<div class="fragment fade-in-then-out" style="position:absolute; width:1536px; left:0px; top:380px" data-fragment-index=3>
							<p>
								$B = \{3, 4, 5\}$:
							</p>
							\[
								A_B = \begin{pmatrix}
								1 & 0 & 0 \\
								0 & 1 & 0 \\
								0 & 0 & 1
								\end{pmatrix}.
							\]
							<p>
								$A_B$ is invertible: basic matrix.
							</p>
						</div>
						<div class="fragment fade-in" style="position:absolute; width:1536px; left:0px; top:380px" data-fragment-index=4>
							<p>
								$B = \{2, 3, 5\}$:
							</p>
							\[
								A_B = \begin{pmatrix}
								1 & 1 & 0 \\
								0 & 0 & 0 \\
								1 & 0 & 1
								\end{pmatrix}.
							\]
							<p>
								$A_B$ not invertible: not a basic matrix.
							</p>
						</div>

						<aside class="notes">
							The optimal portfolio problem was our standard example for the graphical solution method. We first have to get it into standard form. This means switching the sign of the objective function and introducing slack variables for all constraints.
							<br>
							We see by inspection that the matrix has full row rank. There are many ways that we might choose a candidate basic matrix, by selecting three columns (to match the three constraints). Some are obviously suitable. In particular, the columns associated with the slack variables automatically give an identity matrix which has full column rank. Combining this with the full row rank from the full matrix this makes it invertible.
							<br>
							However, some column selections are not linearly independent. These cases will not form an invertible matrix, and so neither will they form a basic matrix.
						</aside>

					</section>

					<section>
						<h2>Partitioning</h2>

						<p>
							Let $N = \{1, \dots, n\} \setminus B$. Index parts of vectors and matrices by their set:
						</p>
						\[
						c = \left( \begin{array}{c|c} c_B & c_N \end{array} \right), \quad
						A = \left( \begin{array}{c|c} A_B & A_N \end{array} \right), \quad
						x = \left( \begin{array}{c|c} x_B & x_N \end{array} \right).
						\]
						<div class="fragment fade-in-then-out" style="position:absolute; width:1536px; left:0px; top:280px" >
							<p>
								Problem splits:
							</p>
							\[
							\begin{aligned}
							\min \left( \begin{array}{c} c \end{array} \right) \left( \begin{array}{c} x \end{array} \right) & & \to && \min \left( \begin{array}{c|c} c_B & c_N \end{array} \right) \left( \begin{array}{c} x_B \\ \hline x_N \end{array} \right) \\
							\left( \begin{array}{c} A \end{array} \right) \left( \begin{array}{c} x \end{array} \right) & = \left( \begin{array}{c} b \end{array} \right) & \to && \left( \begin{array}{c|c} A_B & A_N \end{array} \right) \left( \begin{array}{c} x_B \\ \hline x_N \end{array} \right) & = \left( \begin{array}{c} b \end{array} \right) \\
							\left( \begin{array}{c} x \end{array} \right) & \ge \left( \begin{array}{c} 0 \end{array} \right) & \to && \left( \begin{array}{c} x_B \\ \hline x_N \end{array} \right) & = \left( \begin{array}{c} 0 \\ \hline 0 \end{array} \right).
							\end{aligned}
							\]
						</div>
						<div class="fragment fade-in" style="position:absolute; width:1536px; left:0px; top:280px" >
							<p>
								Summary form:
							</p>
							\[
							\begin{aligned}
							\begin{array}{rcrcl}
							\min_x & \; & c x && \\
							\text{s.t.} & & A x & = & b \\
							& & x & \ge & 0
							\end{array} & \to &
							\begin{array}{rcrcl}
							\min_x & \; & c_B x_B + c_N x_N && \\
							\text{s.t.} & & A_B x_B + A_N x_N & = & b \\
							& & x_B, x_N & \ge & 0.
							\end{array}
							\end{aligned}
							\]
						</div>

						<aside class="notes">
							When we have chosen the basic matrix by picking some set of columns, we can perform column swaps to split all of the coefficients in the problems into a partitioned form. We move the columns (and hence variables) corresponding to basic matrix to the beginning. The remaining variables are non-basic.
							<br>
							This partitioning allows us to write the problem in two pieces. The objective function and all the constraints split into the basic and non-basic parts.
						</aside>

					</section>

					<section>
						<h2>Partitioning the optimal portfolio</h2>
						\[
						\min -0.02 x_1 - 0.03 x_2 \quad \text{s.t.} \quad
						\begin{pmatrix}
						1 & 1 & 1 & 0 & 0 \\
						1 & 0 & 0 & 1 & 0 \\
						0 & 1 & 0 & 0 & 1
						\end{pmatrix}
						x =
						\begin{pmatrix}
						10 \\ 7 \\ 5
						\end{pmatrix}
						\]
						<div class="fragment fade-in-then-out" style="position:absolute; width:1536px; left:0px; top:380px" data-fragment-index=1>
							<p>
								$B = \{3, 4, 5\}, N = \{1, 2\}$:
							</p>
							\[
							\begin{aligned}
								A_B & = \begin{pmatrix}
								1 & 0 & 0 \\
								0 & 1 & 0 \\
								0 & 0 & 1
								\end{pmatrix}, & A_N & =
								\begin{pmatrix}
								1 & 1 \\
								1 & 0 \\
								0 & 1
								\end{pmatrix}, \\
								c_B & = \begin{pmatrix} 0 & 0 & 0 \end{pmatrix}, & c_N & = \begin{pmatrix} -0.02 & -0.03 \end{pmatrix}.
								\end{aligned}
							\]
						</div>
						<div class="fragment fade-in-then-out" style="position:absolute; width:1536px; left:0px; top:380px" data-fragment-index=2>
							<p>
								Note $x \to (x_3, x_4, x_5 | x_1, x_2)$. Problem becomes:
							</p>
							\[
							\begin{aligned}
							\begin{array}{rcrlcrlc}
							\min_x & \; & \begin{pmatrix} 0 & 0 & 0 \end{pmatrix} & \begin{pmatrix} x_3 \\ x_4 \\ x_5 \end{pmatrix} & + & \begin{pmatrix} -0.02 & -0.03 \end{pmatrix} & \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} && \\
							\text{s.t.} & & \begin{pmatrix}
							1 & 0 & 0 \\
							0 & 1 & 0 \\
							0 & 0 & 1
							\end{pmatrix} & \begin{pmatrix} x_3 \\ x_4 \\ x_5 \end{pmatrix} & + & \begin{pmatrix}
							1 & 1 \\
							1 & 0 \\
							0 & 1
							\end{pmatrix} & \begin{pmatrix} x_1 \\ x_2 \end{pmatrix} & = & \begin{pmatrix} 10 \\ 7 \\ 5 \end{pmatrix} \\
							& & & x_{3,4,5} & , & & x_{1,2} & \ge & 0.
							\end{array}
							\end{aligned}
							\]
						</div>
						<div class="fragment fade-in-then-out" style="position:absolute; width:1536px; left:0px; top:380px" data-fragment-index=3>
							<p>
								$B = \{1, 2, 5\}, N = \{3, 4\}$:
							</p>
							\[
							\begin{aligned}
								A_B & = \begin{pmatrix}
								1 & 1 & 0 \\
								1 & 0 & 0 \\
								0 & 1 & 1
								\end{pmatrix}, & A_N & =
								\begin{pmatrix}
								1 & 0 \\
								0 & 1 \\
								0 & 0
								\end{pmatrix}, \\
								c_B & = \begin{pmatrix} -0.02 & -0.03 & 0 \end{pmatrix}, & c_N & = \begin{pmatrix} 0 & 0 \end{pmatrix}.
								\end{aligned}
							\]
						</div>
						<div class="fragment fade-in-then-out" style="position:absolute; width:1536px; left:0px; top:380px" data-fragment-index=4>
							<p>
								Note $x \to (x_1, x_2, x_5 | x_3, x_4)$. Problem becomes:
							</p>
							\[
							\begin{aligned}
							\begin{array}{rcrlcrlc}
							\min_x & \; & \begin{pmatrix} -0.02 & -0.03 & 0 \end{pmatrix} & \begin{pmatrix} x_1 \\ x_2 \\ x_5 \end{pmatrix} & + & \begin{pmatrix} 0 & 0 \end{pmatrix} & \begin{pmatrix} x_3 \\ x_4 \end{pmatrix} && \\
							\text{s.t.} & & \begin{pmatrix}
							1 & 1 & 0 \\
							1 & 0 & 0 \\
							0 & 1 & 1
							\end{pmatrix} & \begin{pmatrix} x_1 \\ x_2 \\ x_5 \end{pmatrix} & + & \begin{pmatrix}
							1 & 0 \\
							0 & 1 \\
							0 & 0
							\end{pmatrix} & \begin{pmatrix} x_3 \\ x_4 \end{pmatrix} & = & \begin{pmatrix} 10 \\ 7 \\ 5 \end{pmatrix} \\
							& & & x_{1,2,5} & , & & x_{3,4} & \ge & 0.
							\end{array}
							\end{aligned}
							\]
						</div>

						<aside class="notes">
							We return to the optimal portfolio problem and look at possible choices of basic matrices and how this partitions the full problem.
							<br>
							In the first case we choose all the slack variables to be the basic variables. This is the easy choice, as the associated basic matrix is the identity which is clearly invertible. We see that, in this case, the basic variables do not contribute to the objective function at all.
							<br>
							In the second case we have all of the non-slack variables in the basic variables, along with one slack variable to ensure linear independence and hence make the basic matrix invertible. In this case the non-basic variables have no impact on the objective function.
						</aside>
					</section>

					<section>
						<h2>Basic solutions</h2>
						<p>
							If $x_B = A_B^{-1} b$ and $x_N = 0$ then $x = (x_B | x_N)$ is a <em>basic solution</em>.
						</p>
						<ul>
							<li>
								Constraints $A x = b$ all satisfied.
							</li>
							<li>
								Non-negativity constraints need not be satisfied:
								<ul>
									<li>
										$x_N = 0$ means $x_N \ge 0$;
									</li>
									<li>
										$x_B$ unconstrained.
									</li>
								</ul>
							</li>
							<li class="fragment">
								If $x_B \ge 0$ the solution is <em>basic feasible</em>.
							</li>
							<li class="fragment">
								All constraints satisfied <em>as equalities</em>, hence a vertex.
							</li>
						</ul>

						<aside class="notes">
							The key reason for constructing the basic matrix is that it is invertible and hence allows us to construct some part of the solution. In particular, it allows us to set the basic variables $x_B$ in the partitioned system by solving the linear system. If we then choose the non-basic decision variables to zero then it immediately follows that the constraints from $A x = b$ are satisfied. This follows from the partitioned form, where $A x = A_B x_B + A_N x_N$. The first part is $b$ by construction, and the second part vanishes by choice of $x_N$. This is a basic solution.
							<br>
							Of course, these are not the only constraints in the system. We also need all the decision variables to be non-negative. By choice the non-basic variables are non-negative as we have set them to zero. However, the basic variables follow from the solution of the linear system, and these could be negative. If they are non-negative then the basic solution is feasible.
							<br>
							Intuitively we can see how this construction is linked to a vertex. The indexes in the basis are the indexes of the constraints that have been chosen to be satisfied as equalities. That is, they describe the hyperplanes whose intersection gives the vertex. The non-negativity constraint that makes the basic solution feasible then checks to see that it really is a vertex, not an intersection that cannot lie in the feasible region.
						</aside>
					</section>

				</section>

				<section id="Summary">
					<section>
						<h1>Summary</h1>

						<ul>
							<li>
								Simplex method relies on standard form.
							</li>
							<li>
								A basic matrix $A_B$ is an invertible submatrix of $A$.
							</li>
							<li>
								A basic solution is $(A_B^{-1} | 0 )$.
							</li>
							<li>
								Basic feasible solutions are vertices?
							</li>
						</ul>
					</section>
				</section>

			</div>

		</div>


		<script src="../reveal.js/dist/reveal.js"></script>
		<script src="../reveal.js/plugin/zoom/zoom.js"></script>
		<script src="../reveal.js/plugin/notes/notes.js"></script>
		<script src="../reveal.js/plugin/search/search.js"></script>
		<script src="../reveal.js/plugin/markdown/markdown.js"></script>
		<script src="../reveal.js/plugin/highlight/highlight.js"></script>
		<script src="../reveal.js/plugin/math/math.js"></script>
		<script src="../reveal.js/plugin/spotlight/spotlight.js"></script>
		<script>

			// Also available as an ES module, see:
			// https://revealjs.com/initialization/
			Reveal.initialize({
				width: 1536,
			  height: 960,
			  margin: 0.04,
				controls: false,
				progress: true,
				center: true,
				hash: true,
				transition: 'none',
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight, RevealMath.KaTeX, RevealSpotlight ],
				spotlight: {
					presentingCursor: 'default',
				}
			});

		</script>


	</body>
</html>
