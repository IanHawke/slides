<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Lecture 14</title>

		<meta name="description" content="Math1058">
		<meta name="author" content="Ian Hawke">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="../reveal.js/dist/reset.css">
		<link rel="stylesheet" href="../reveal.js/dist/reveal.css">
		<link rel="stylesheet" href="../reveal.js/dist/theme/white.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="../reveal.js/plugin/highlight/monokai.css">


	<style type="text/css">
	  .reveal p {
	    text-align: left;
	  }
	  .reveal ul {
	    display: block;
	  }
	  .reveal ol {
	    display: block;
	  }
	</style>




	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section id="Title">

					<section>
						<h2 class="r-fit-text">Two-phase simplex method</h2>
						<p>
							<ul style="list-style: none;">
								<li> Ian Hawke
								<li> Giles Richardson
							</ul>
						</p>

						<aside class="notes">
							Starting the Simplex Method.
						</aside>
					</section>

				</section>

				<section id="Simplex">

					<section>

						<h2>Simplex Method</h2>
						<div style="position:absolute; width:768px; top:150px; left:0px">
							<ul>
								<li>
									Solutions to linear programs at vertices.
								</li>
								<li>
									Simplex method: move from one vertex to adjacent until optimal found.
								</li>
								<li>
									Ingredients:
									<ol>
										<li>
											How to characterize vertex algebraically? <b>Done</b>.
										</li>
										<li>
											How to check vertex is optimal? <b>Done</b>.
										</li>
										<li>
											How to move from vertex to better vertex? <b>Done</b>.
										</li>
									</ol>
								</li>
							</ul>
							<p>
								<b>How to start?</b>
							</p>
						</div>
						<div style="position:absolute; width:768px; top:150px; left:768px">
							<img style="width:768px" src="images/09_simplex_basics/lp_simplex_vertex.svg">
						</div>

						<aside class="notes">
							We have seen how the simplex method works, and its practical implementation using the tableau form. However, we have always assumed that a basic set (and hence basic matrix and basic form) is given to us, so that some sub-matrix of the tableau is in the form of an identity matrix.
							<br>
							Today we ask how to take a general problem and put it in that form.
						</aside>
					</section>

					<section>
						<h2>A starting problem</h2>
						\[
						\begin{array}{rrlcrlcrlcl}
						\min_x      &    & x_1 & + & & x_2 & & &   &     &   & \\
						\text{s.t.} &    &     &   & & x_2 & + & 4 & x_3 & = & 2 \\
						            & -2 & x_1 & + & & x_2 & - & 6 & x_3 & = & 2 \\
												&    & x_1 & , & & x_2 & , &   & x_3 & \ge & 0.
						\end{array}
						\]
						<div class="fragment">
							<p>
								Transfer to <em>tableau form</em>:
							</p>
							<table style="table-layout:fixed; width:60%">
								<tbody>
									<tr>
										<td style="border-right:none; border-bottom:none; border=top:none">
										</td>
										<td style="border-right:none; border-bottom:1px solid black; border=top:none">
										</td>
										<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
											$x_1$
										</td>
										<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
											$x_2$
										</td>
										<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
											$x_3$
										</td>
									</tr>
									<tr>
										<td style="border-right:1px solid black; border-bottom:none; border=top:none">
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
											0
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
											1
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
											1
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
											0
										</td>
									</tr>
									<tr>
										<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
											??
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
											2
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
											0
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
											1
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
											4
										</td>
									</tr>
									<tr>
										<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
											??
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
											2
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
											-2
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
											1
										</td>
										<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
											-6
										</td>
									</tr>
								</tbody>
							</table>
						</div>
						<p class="fragment">
							Where is the basic matrix? Where are the basic variables?
						</p>

						<aside class="notes">
							Here is a (somewhat random) problem in standard form. With three variables and two constraints, which are linearly independent, the problem can be solved. However, it is not at all obvious which columns should be chosen as the basic variables.
							<br>
							In this case we can, in fact, pick any pair. However, we will use this problem as an illustration of how to take an arbitrary problem without an obvious basic set, and to construct a basic solution which we can use to start the simplex method.
						</aside>
					</section>

				</section>

				<section id="Two phase">

					<section>
						<h2>Two-phase simplex method</h2>
						<p>
							Solution: solve two problems.
						</p>
						<ol>
							<li>
								First minimize error in constraints imposing basic form.
							</li>
							<li>
								Second, transfer solution to tableau, solve standard simplex.
							</li>
						</ol>
						<p class="fragment">
							If phase one fails the problem is infeasible.
						</p>

						<aside class="notes">
							We have a hammer, which is the (one phase) simplex method. The question is whether we can write this new problem, of finding the starting vertex, as if it were a nail.
							<br>
							The trick is to note that we can start from <em>any</em> point, or any solution (with non-negative values), provided we add additional "slack" variables that encode how much the standard form constraints are violated. As we know, introducing one slack variable per constraint gives us an obvious basis. If we can write a new problem where the optimal solution guarantees that all these variables vanish, then all the constraints must be satisfied.
							<br>
							This gives us a two step method. We introduce a new problem with additional variables and a new objective function. We solve this using the simplex method to find an optimal solution where all the new variables vanish, so it must be basic feasible. We then transfer this basic set back to the original problem and solve using the simplex method again.
							<br>
							If the optimal solution of the first phase cannot be found, or its solution is not the new variables all vanishing, then this means the original problem is not feasible.
						</aside>

					</section>

					<section>
						<h2>Auxiliary problem</h2>
						<p>
							Assume standard form
						</p>
						\[
						\begin{array}{rcrcl}
						\min_x & \quad & c x && \\
						\text{subject to} & & A x & = & b \\
						& & x & \ge & 0.
						\end{array}
						\]
						<p>
							Auxiliary problem is
						</p>
						\[
						\begin{array}{rlrlcrlcl}
						\min_y            & \quad &   &    &   & e & y &   & \\
						\text{subject to} &       & A & x  & + & I & y & = & b \\
						                  &       &   & x  & , &   & y & \ge & 0.
						\end{array}
						\]
						<p>
							Contains $m$ new variables $y$. New cost vector $e = (1, \dots, 1)$.
						</p>
						<p class="fragment">
							Original constraints satisfied if $y = 0$.
						</p>

						<aside class="notes">
							The auxiliary problem is bigger than the original problem as we have to add an additional variable for every constraint. However, the problem is automatically in basic form, as the columns linked to these new variables are automatically in basic form. Therefore we can solve this auxiliary problem using the standard simplex method, where the initial basic solution is given by these new variables.
							<br>
							The solution that we want is when all of the new variables vanish. In this case the original constraints are satisfied.
							<br>
							Note that we can use the constraints of the auxiliary problem to solve for the new variables y (this is similar to the basic form: y is multiplied by the identity).
						</aside>

					</section>

					<section>
						<h2>Auxiliary solution</h2>
						<p>
							<b>Proposition:</b> The auxiliary problem admits an optimal solution $(x^*, y^*)$ with $e y^* = 0$ if and only if the original problem is feasible.
						</p>
						<p class="fragment">
							If the optimal solution has $e y^* > 0$ then $y^* \ne 0$ and the constraints are not satisfied. The original problem is not feasible.
						</p>
						<p class="fragment">
							If the original problem has a feasible solution $x'$, then $(x', 0)$ is feasible for the auxiliary problem with $e y' = 0$.
						</p>

						<aside class="notes">
							It is straightforward to check that the feasibility of the original problem is equivalent to the optimal solution having vanishing auxiliary variables. Note that this proof does not rely on the exact form of the vector e, as long as all entries are strictly positive.
						</aside>

					</section>

					<section>
						<h2>Reduced costs problem: 1</h2>
						<p>
							The auxiliary problem
						</p>
						\[
						\begin{array}{rlrlcrlcl}
						\min_y            & \quad &   &   &   & e & y &   & \\
						\text{subject to} &       & A & x & + & I & y & = & b \\
						                  &       &   & x & , &   & y & \ge & 0.
						\end{array}
						\]
						<p>
							does not correctly have zero reduced costs:
						</p>
						<table>
							<tbody>
								<tr>
									<td style="border-bottom:none; border-top:none;">
									</td>
									<td>
									</td>
									<td style="text-align:center;">
										$x_1$
									</td>
									<td style="text-align:center;">
										$\dots$
									</td>
									<td style="text-align:center;">
									  $x_n$
									</td>
									<td style="text-align:center;">
										$y_1$
									</td>
									<td style="text-align:center;">
										$\dots$
									</td>
									<td style="text-align:center;">
										$y_m$
									</td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;"></td>
									<td style="text-align:center;border-right:1px solid black;">
										$0$
									</td>
									<td style="text-align:center;">
									</td>
									<td style="text-align:center;">
										$0$
									</td>
									<td style="text-align:center;border-right:1px solid black;">
									</td>
									<td style="text-align:center;">
										$1$
									</td>
									<td style="text-align:center;">
										$\dots$
									</td>
									<td style="text-align:center;border-right:1px solid black;">
										$1$
									</td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
										$y_1$
									</td>
									<td style="border-right:1px solid black; border-bottom:none;"></td>
									<td style="border-bottom:none;">
									</td>
									<td style="border-bottom:none;"></td>
									<td style="border-right:1px solid black; border-bottom:none;">
									</td>
									<td style="border-bottom:none;">
									</td>
									<td style="border-bottom:none;"></td>
									<td style="border-right:1px solid black; border-bottom:none;"></td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
										$\vdots$
									</td style="border-right:1px solid black; border-bottom:none; border-top:none;">
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
										$b$
									</td>
									<td style="text-align:center;border-bottom:none; border-top:none;">
									</td>
									<td style="text-align:center;border-bottom:none; border-top:none;">
										$A$
									</td>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
									</td>
									<td style="text-align:center;border-bottom:none; border-top:none;">
									</td>
									<td style="text-align:center; border-bottom:none; border-top:none;">
										$I$
									</td>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
									</td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black;">
										$y_m$
									</td>
									<td style="border-right:1px solid black; border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-right:1px solid black; border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-right:1px solid black; border-bottom:1px solid black; border-top:none"></td>
								</tr>
							</tbody>
						</table>

						<aside class="notes">
							We have the tableau form of the auxiliary problem. However, it is not yet in basic form, so we cannot apply the simplex method. The problem is that the basic variables (which we are going to choose to be the auxiliary slack variables) do not have vanishing reduced costs.
							<br>
							To get around this, we can use the constraints in the auxiliary problem to rewrite the new variables y in terms of b, A and x. This means the reduced costs are now only non-zero for the non-basic variables, as required. However, we note the objective function now starts from zero.
							<br>
							As a useful cross-check for later stages, note that if the vector e is all ones (as is conventional), then the sum of all entries in the columns corresponding to the right-hand-side b and the non-basic variables x must vanish: the terms in the reduced costs row are the sum of the other terms below.
						</aside>

					</section>

					<section>
						<h2>Reduced costs problem: 2</h2>
						<p>
							Using $y = b - A x$, the <em>equivalent</em> auxiliary problem
						</p>
						\[
						\begin{array}{rlrlcrlcl}
						\min_y            & e b   & -e A & x &   &   &   &   & \\
						\text{subject to} &       & A    & x & + & I & y & = & b \\
						                  &       &      & x & , &   & y & \ge & 0.
						\end{array}
						\]
						<p>
							does have zero reduced costs:
						</p>
						<table>
							<tbody>
								<tr>
									<td style="border-bottom:none; border-top:none;">
									</td>
									<td>
									</td>
									<td style="text-align:center;">
										$x_1$
									</td>
									<td style="text-align:center;">
										$\dots$
									</td>
									<td style="text-align:center;">
									  $x_n$
									</td>
									<td style="text-align:center;">
										$y_1$
									</td>
									<td style="text-align:center;">
										$\dots$
									</td>
									<td style="text-align:center;">
										$y_m$
									</td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;"></td>
									<td style="text-align:center;border-right:1px solid black;">
										$-e b$
									</td>
									<td style="text-align:center;">
									</td>
									<td style="text-align:center;">
										$-e A$
									</td>
									<td style="text-align:center;border-right:1px solid black;">
									</td>
									<td style="text-align:center;">
										$0$
									</td>
									<td style="text-align:center;">
										$\dots$
									</td>
									<td style="text-align:center;border-right:1px solid black;">
										$0$
									</td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
										$y_1$
									</td>
									<td style="border-right:1px solid black; border-bottom:none;"></td>
									<td style="border-bottom:none;">
									</td>
									<td style="border-bottom:none;"></td>
									<td style="border-right:1px solid black; border-bottom:none;">
									</td>
									<td style="border-bottom:none;">
									</td>
									<td style="border-bottom:none;"></td>
									<td style="border-right:1px solid black; border-bottom:none;"></td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
										$\vdots$
									</td style="border-right:1px solid black; border-bottom:none; border-top:none;">
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
										$b$
									</td>
									<td style="text-align:center;border-bottom:none; border-top:none;">
									</td>
									<td style="text-align:center;border-bottom:none; border-top:none;">
										$A$
									</td>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
									</td>
									<td style="text-align:center;border-bottom:none; border-top:none;">
									</td>
									<td style="text-align:center; border-bottom:none; border-top:none;">
										$I$
									</td>
									<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
									</td>
								</tr>
								<tr>
									<td style="text-align:center;border-right:1px solid black;">
										$y_m$
									</td>
									<td style="border-right:1px solid black; border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-right:1px solid black; border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-bottom:1px solid black; border-top:none"></td>
									<td style="border-right:1px solid black; border-bottom:1px solid black; border-top:none"></td>
								</tr>
							</tbody>
						</table>



						<aside class="notes">
							In general, we now see how this works. We have a tableau with a basic form. We solve the auxiliary problem, as in the last lecture, to end up with the optimal solution (or we show it is unbounded, in which case the original problem cannot be solved). If the optimal solution is non-zero the original problem is infeasible; if zero, we can use the basis to solve the original problem.
							<br>
							However, there are some technical and conceptual issues we need to address. The technical issues are how we re-write the solution of the auxiliary problem to solve the original problem. This needs two steps. The simple one is to throw away the auxiliary information added, which is the columns corresponding to y. The less simple is to rewrite the objective function in terms of only the x variables. This needs the use of the constraints in the final tableau form, as we will show by example.
							<br>
							The conceptual problem is to do with the basis. What happens if, in the final solution of the auxiliary problem, there are still y terms within the basis? This can only happen if the problem is infeasible, <em>or</em> if the basic feasible solution is degenerate (so that there are zero entries in both x and y). The latter case is the only one we need care about. In that case we want to keep pivoting to switch all y variables out of the basis in terms of x variables.
						</aside>
					</section>

					<section>
						<h2>Algorithm</h2>
						<ol>
							<li>
								Solve auxiliary problem, optimal solution $(x^*, y^*)$.
								<ol style="list-style-type: lower-alpha;">
									<li>
										If $e y^* > 0$, problem infeasible.
									</li>
									<li>
										If $e y^* = 0$:
										<ol style="list-style-type: lower-roman;">
											<li>
												use pivoting to remove degenerate $y_i$ from basis;
											</li>
											<li>
												delete columns corresponding to $y$;
											</li>
											<li>
												re-write objection function in terms of $x_N$.
											</li>
										</ol>
									</li>
								</ol>
							</li>
							<li>
								Ensure objective function in terms of $x_N$.
							</li>
							<li>
								Write tableau using basic solution found in phase one.
							</li>
						</ol>
						<aside class="notes">
							This highlighst the additional steps needed; note in particular the issues with degenerate solutions.
						</aside>
					</section>

					<section>
						<h2>Degeneracy</h2>
						<p>
							If auxiliary solution degenerate could have $y_i = 0 = x_j$, but $y_i$ still in $B$.
						</p>
						<table>
							<tr>
								<td style="text-align:center;border-right: none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$x_1$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$\dots$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$x_j$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$\dots$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$x_n$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$y_1$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$\dots$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$y_i$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$\dots$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$y_m$
								</td>
							</tr>
							<tr>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:1px solid black; border-top:none;">
									$0$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:1px solid black; border-top:none;">
								</td>
							</tr>
							<tr>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$0$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
							</tr>
							<tr>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$\vdots$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
							</tr>
							<tr>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
									$y_i$
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
									$0$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$\bar{a}_{i1}$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$\dots$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$\bar{a}_{ij}$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$\dots$
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
									$\bar{a}_{in}$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$1$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
							</tr>
							<tr>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
									$\vdots$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
							</tr>
							<tr>
								<td style="text-align:center;border-right:1px solid black; border-bottom:none; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
									$0$
								</td>
								<td style="text-align:center;border-right:none; border-bottom:1px solid black; border-top:none;">
								</td>
								<td style="text-align:center;border-right:1px solid black; border-bottom:1px solid black; border-top:none;">
								</td>
							</tr>
						</table>
						<p class="fragment">
							Pivot on $\bar{a}_{ij} \ne 0$, send $x_j \to B, y_i \to N$.
						</p>

						<aside class="notes">
							The problem with degenerate solutions in this case is that the final basic solution may not have only variables that we want to keep in the basis. In this case there will be some entry in the matrix that links a non-basic variable that we want to keep with a basic auxiliary variable. We can pivot, even if the entry is negative, to switch these two variables.
							<br>
							There is one final case which is where the degenerate solution has an auxiliary variable where every entry in the matrix is zero. In this case the matrix is not full row rank, the auxiliary variable contains no useful information, and it can be directly removed (and hence the entire row can be removed).
						</aside>

					</section>

				</section>

				<section id="Example">
					<section>
						<h2>The starting problem</h2>
						<p>
							<span class="fragment" data-fragment-index=1>Construct auxiliary problem.</span> <span class="fragment" data-fragment-index=2>Re-express objective function, using $y_1 = 2 - x_2 - 4 x_3$ and $y_2 = 2 + 2 x_1 - x_2 + 6 x_3$.</span>
						</p>
						<div class="r-stack" style="width:1536px">
							<div class="fragment fade-out" data-fragment-index=1>
\[
\begin{alignat*}{6}
\min_x      & \; &    & x_1 & + &  & x_2 &   &   &     &  & \\
\text{s.t.} &    &    &     &   &  & x_2 & + & 4 & x_3 & = & 2 \\
            &    & -2 & x_1 & + &  & x_2 & - & 6 & x_3 & = & 2 \\
						&    &    & x_1 & , &  & x_2 & , &   & x_3 & \ge & 0.
\end{alignat*}
\]
							</div>
							<div class="fragment fade-in-then-out" data-fragment-index=1>
\[
\begin{alignat*}{10}
\min_y & \; &    &    &     &   & &     &   &   &     &   & & y_1 & + & & y_2 &   &   & \\
\text{s.t.}&&    &    &     &   & & x_2 & + & 4 & x_3 & + & & y_1 &   & &     & = & 2 \\
       &    &    & -2 & x_1 & + & & x_2 & - & 6 & x_3 &   & &     & + & & y_2 & = & 2 \\
			 &		&    &    & x_1 & , & & x_2 & , &   & x_3 & , & & y_1 & , & & y_2 &  \ge & 0.
\end{alignat*}
\]
							</div>
							<div class="fragment fade-in" data-fragment-index=2>
\[
\begin{alignat*}{11}
\min_y & \; &  4 & + & 2 &  x_1   &  -  & 2 & x_2 &  +  & 2 & x_3 &     &   & &  &  & &  &   &   & \\
\text{s.t.}&&    &   &   &        &     &   & x_2 &   + & 4 & x_3 & + & & y_1 &   & &     & = & 2 \\
          & &    &    & -2 & x_1 &   + &   & x_2 & -   & 6 & x_3 &   & &     & + & & y_2 & = & 2 \\
			 &&		&    &    & x_1 & , & & x_2 & , &   & x_3 & , & & y_1 & , & & y_2 &  \ge & 0.
\end{alignat*}
\]
							</div>
						</div>

						<aside class="notes">
							We go back to our original problem. This is not obviously in basic form.
							<br>
							We first introduce the auxiliary problem by adding the slack variables y that encode how much the constraints are violated, and writing the objective function that sums these variables.
							<br>
							We then have to replace these new decision variables in terms of the original variables and a constant, so that the "obvious" basic variables, the new slack y variables, have zero reduced costs.
							<br>
							This allows us to transfer to a tableau and note that the starting basis contains just the auxiliary variables. Note the non-zero objective function to start, and that the first four columns sum to zero.
						</aside>

					</section>

					<section>
						<h2>Phase one</h2>
						<p>
							Take problem
						</p>
						\[
						\begin{alignat*}{11}
						\min_y & \; &  4 & + & 2 &  x_1   &  -  & 2 & x_2 &  +  & 2 & x_3 &     &   & &  &  & &  &   &   & \\
						\text{s.t.}&&    &   &   &        &     &   & x_2 &   + & 4 & x_3 & + & & y_1 &   & &     & = & 2 \\
						          & &    &    & -2 & x_1 &   + &   & x_2 & -   & 6 & x_3 &   & &     & + & & y_2 & = & 2 \\
									 &&		&    &    & x_1 & , & & x_2 & , &   & x_3 & , & & y_1 & , & & y_2 &  \ge & 0.
						\end{alignat*}
						\]
						<p>
							to tableau:
						</p>

						<table style="table-layout:fixed; width:60%">
							<tbody>
								<tr>
									<td style="border-right:none; border-bottom:none; border=top:none">
									</td>
									<td style="border-right:none; border-bottom:1px solid black; border=top:none">
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_3$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_2$
									</td>
								</tr>
								<tr>
									<td style="border-right:1px solid black; border-bottom:none; border=top:none">
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										-4
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										-2
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										4
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$y_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										-2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										-6
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										1
									</td>
								</tr>
							</tbody>
						</table>

						<aside class="notes">
							This allows us to transfer to a tableau and note that the starting basis contains just the auxiliary variables. Note the non-zero objective function to start, and that the first four columns sum to zero.
						</aside>

					</section>

					<section>
						<h2>Phase one: iteration 1</h2>
						<table style="table-layout:fixed; width:60%">
							<tbody>
								<tr>
									<td style="border-right:none; border-bottom:none; border=top:none">
									</td>
									<td style="border-right:none; border-bottom:1px solid black; border=top:none">
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_3$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_2$
									</td>
								</tr>
								<tr>
									<td style="border-right:1px solid black; border-bottom:none; border=top:none">
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										-4
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										<span class="fragment highlight-current-blue" data-fragment-index=0>-2</span>
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										<span class="fragment highlight-current-green" data-fragment-index=0>2</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										<span class="fragment highlight-current-green" data-fragment-index=0>0</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										<span class="fragment highlight-red" data-fragment-index=0>1</span>
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										<span class="fragment highlight-current-green" data-fragment-index=0>4</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										<span class="fragment highlight-current-green" data-fragment-index=0>1</span>
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										<span class="fragment highlight-current-green" data-fragment-index=0>0</span>
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$y_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										-2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										<span class="fragment highlight-current-blue" data-fragment-index=0>1</span>
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										-6
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										1
									</td>
								</tr>
							</tbody>
						</table>

						<table style="table-layout:fixed; width:60%" class="fragment" data-fragment-index=1>
							<tbody>
								<tr>
									<td style="border-right:none; border-bottom:none; border=top:none">
									</td>
									<td style="border-right:none; border-bottom:1px solid black; border=top:none">
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_3$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_2$
									</td>
								</tr>
								<tr>
									<td style="border-right:1px solid black; border-bottom:none; border=top:none">
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										10
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										2
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$\color{red}{x_2}$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										4
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$y_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										-2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										-10
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										-1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										1
									</td>
								</tr>
							</tbody>
						</table>

						<aside class="notes">
							We now apply the standard one-phase simplex method to the auxiliary problem. There is only one negative reduced cost, so the column is s=2. Minimum ratio test tells us that any row would work, so Bland's rule says to pick the first, r=1.
							<br>
							Pivoting divides through the first row by 1, so it does not change. We then set the other entries in column 2 to zero by row operations. This switches the first slack y with the second original variable x between the basis and non-basis sets.
						</aside>

					</section>

					<section>
						<h2>Phase one: iteration 2</h2>
						<p>
							Auxiliary optimal, but degenerate; drive $y_2$ out of basis.
						</p>
						<table style="table-layout:fixed; width:60%">
							<tbody>
								<tr>
									<td style="border-right:none; border-bottom:none; border=top:none">
									</td>
									<td style="border-right:none; border-bottom:1px solid black; border=top:none">
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_3$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_2$
									</td>
								</tr>
								<tr>
									<td style="border-right:1px solid black; border-bottom:none; border=top:none">
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										<span class="fragment highlight-current-blue" data-fragment-index=0>2</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										10
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										2
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										4
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$y_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										<span class="fragment highlight-current-green" data-fragment-index=0>0</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										<span class="fragment highlight-red" data-fragment-index=0>-2</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										<span class="fragment highlight-current-green" data-fragment-index=0>0</span>
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										<span class="fragment highlight-current-green" data-fragment-index=0>-10</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										<span class="fragment highlight-current-green" data-fragment-index=0>-1</span>
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										<span class="fragment highlight-current-green" data-fragment-index=0>1</span>
									</td>
								</tr>
							</tbody>
						</table>

						<table style="table-layout:fixed; width:60%" class="fragment" data-fragment-index=1>
							<tbody>
								<tr>
									<td style="border-right:none; border-bottom:none; border=top:none">
									</td>
									<td style="border-right:none; border-bottom:1px solid black; border=top:none">
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_3$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_2$
									</td>
								</tr>
								<tr>
									<td style="border-right:1px solid black; border-bottom:none; border=top:none">
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										1
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										4
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$\color{red}{x_1}$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										1
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										5
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										1/2
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										-1/2
									</td>
								</tr>
							</tbody>
						</table>

						<aside class="notes">
							At this point the auxiliary problem is optimal as there are no negative reduced costs. The objective function is zero, which means the original problem is feasible. However, the constructed solution is degenerate, as the second auxiliary variable is still in the basis (with value zero).
							<br>
							To proceed we need to swap this auxiliary variable with some decision variable. Looking at the row, we can choose either the first or third decision variable on which to pivot, even though the entries are negative (as both variables have value zero, this will not change the objective function). Bland's rule says to choose the first, which leads to the new tableau.
						</aside>

					</section>

					<section>
						<h2>Construct new tableau: objective</h2>
						<p>
							Need new objective function.
						</p>

						<table style="table-layout:fixed; width:60%">
							<tbody>
								<tr>
									<td style="border-right:none; border-bottom:none; border=top:none">
									</td>
									<td style="border-right:none; border-bottom:1px solid black; border=top:none">
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_3$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$y_2$
									</td>
								</tr>
								<tr>
									<td style="border-right:1px solid black; border-bottom:none; border=top:none">
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										1
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										4
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										0
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										1
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										5
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										1/2
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										1/2
									</td>
								</tr>
							</tbody>
						</table>
						\[
						\begin{array}{ccrlcrlcrlcl}
						&            &     &   & x_2 & + & 4 & x_3 & = & 2 \\
						&            & x_1 & + &     &   & 5 & x_3 & = & 0 \\
						\iff & \quad & x_1 & + & x_2 &   &   &     & = & 2 - 9 x_3.
						\end{array}
						\]


						<aside class="notes">
							We now need to construct the new tableau. The crucial step will be to re-express the objective function solely in terms of the original decision variables x. To do this we read off the constraints as given at this basic feasible solution. We can do this as all the auxiliary variables are non-basic, which means they take value zero. This allows us to express the original objective function (which was the sum of the first two decision variables) at this particular basic solution.
						</aside>

					</section>

					<section>
						<h2>Construct new tableau</h2>
						<p>
							Drop $y$ columns, objective now $2 - 9 x_3$:
						</p>

						<table style="table-layout:fixed; width:60%">
							<tbody>
								<tr>
									<td style="border-right:none; border-bottom:none; border=top:none">
									</td>
									<td style="border-right:none; border-bottom:1px solid black; border=top:none">
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										$x_3$
									</td>
								</tr>
								<tr>
									<td style="border-right:1px solid black; border-bottom:none; border=top:none">
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										<span style="color:red">-2</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										<span style="color:red">0</span>
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:1px solid black">
										<span style="color:red">0</span>
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:1px solid black">
										<span style="color:red">9</span>
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$x_2$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										2
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:none; border=top:1px solid black">
										1
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:1px solid black">
										4
									</td>
								</tr>
								<tr>
									<td style="text-align:center; border-right:1px solid black; border-bottom:none; border=top:none">
										$x_1$
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										1
									</td>
									<td style="text-align:center; border-right:none; border-bottom:1px solid black; border=top:none">
										0
									</td>
									<td style="text-align:center; border-right:1px solid black; border-bottom:1px solid black; border=top:none">
										5
									</td>
								</tr>
							</tbody>
						</table>
						<p class="fragment">
							Already optimal, degenerate; $x^* = (0, 2, 0)$, objective is $2$.
						</p>

						<aside class="notes">
							We can now build the tableau. We take the tableau from the first phase and delete the columns related to the auxiliary variables y.
							<br>
							However, we now need to fill in the row with the objective function and the reduced costs. The row from the first phase is now irrelevant. We know that the entries corresponding to the basic variables must have zero reduced costs. The non-basic reduced costs and the objective function come from the final step in the first phase, where we re-expressed the objective function purely in terms of the <em>non-basic</em> x variables.
							<br>
							At this point we have a tableau in basic form, and we can apply the single-phase simplex method again. However, in this specific case, we can see that there are no negative reduced costs. Therefore this basic feasible solution is already optimal, and we can read off the solution immediately.
						</aside>

					</section>

				</section>

				<section id="Summary">
					<section>
						<h1>Summary</h1>

						<ul>
							<li>
								Two phase simplex method finds a starting vertex.
							</li>
							<li>
								First phase solves a related linear program.
							</li>
							<li>
								First phase fails only if problem infeasible.
							</li>
							<li>
								Degenerate solutions make transferring between first and second phase more complex.
							</li>
							<li>
								This approach of "minimising constraint violations" can be used to eg solve systems of equations, or the sorting problem.
							</li>
						</ul>
					</section>
				</section>

			</div>

		</div>


		<script src="../reveal.js/dist/reveal.js"></script>
		<script src="../reveal.js/plugin/zoom/zoom.js"></script>
		<script src="../reveal.js/plugin/notes/notes.js"></script>
		<script src="../reveal.js/plugin/search/search.js"></script>
		<script src="../reveal.js/plugin/markdown/markdown.js"></script>
		<script src="../reveal.js/plugin/highlight/highlight.js"></script>
		<script src="../reveal.js/plugin/math/math.js"></script>
		<script src="../reveal.js/plugin/spotlight/spotlight.js"></script>
		<script>

			// Also available as an ES module, see:
			// https://revealjs.com/initialization/
			Reveal.initialize({
				width: 1536,
			  height: 960,
			  margin: 0.04,
				controls: false,
				progress: true,
				center: true,
				hash: true,
				transition: 'none',
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealZoom, RevealNotes, RevealSearch, RevealMarkdown, RevealHighlight, RevealMath.KaTeX, RevealSpotlight ],
				spotlight: {
					presentingCursor: 'default',
				}
			});

		</script>


	</body>
</html>
